# Vulnerability Information: CVE-2022-25308

## Vulnerability Description
A **stack-based buffer overflow** flaw was found in the Fribidi package. This flaw allows an attacker to pass a specially crafted file to the Fribidi application, which leads to a possible memory leak or a denial of service.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** memory leak and denial of service
- **vector:** pass a specially crafted file
- **attacker:** attacker
- **product:** Fribidi package

## CVE Reference Links Content Summary
```json
{
  "vulnerability": {
    "overview": "A stack-based buffer overflow vulnerability exists in the fribidi library.",
    "root_cause": "The vulnerability is caused by a missing conditional check for the length of a string before accessing a pointer. Specifically, the code attempts to access `S_[len - 1]` without verifying that `len` is greater than 0. If `strlen()` returns 0, `len - 1` results in a negative index, leading to a stack buffer underflow.",
     "weaknesses": [
        "Stack-based buffer overflow",
        "Missing input validation"
      ],
    "impact": "An attacker can exploit this vulnerability by providing a specially crafted input file, leading to a memory leak, denial of service, or potentially arbitrary code execution.",
    "attack_vector": "The attack vector is local, meaning the attacker needs to provide the crafted file to the vulnerable application running on the system.",
    "attacker_capabilities": "The attacker needs to be able to provide a specially crafted file as input to the fribidi application.",
    "additional_details": "The vulnerability was identified using AddressSanitizer. The issue occurs in the main function of fribidi-main.c. The vulnerable code accesses memory using a length obtained from strlen, which could return zero, leading to an out-of-bounds access on the stack."
  },
  "affected_component": {
    "name": "fribidi library",
    "version": "v1.0.11 and earlier"
  },
  "remediation": {
        "recommendation": "The vulnerability was addressed by adding a conditional check to ensure that the length of the string is greater than 0 before attempting to access the pointer with a calculated index.",
        "patch_details": "The fix involved adding a check `if (len > 0)` before the line accessing `S_[len - 1]`."
  },
   "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-25308",
        "https://github.com/fribidi/fribidi/issues/181",
        "https://github.com/fribidi/fribidi/pull/184",
        "https://access.redhat.com/security/cve/CVE-2022-25308",
        "https://bugzilla.redhat.com/show_bug.cgi?id=2047890",
        "https://access.redhat.com/errata/RHSA-2022:7514",
        "https://access.redhat.com/errata/RHSA-2022:8011",
       "https://github.com/advisories/GHSA-p3q8-prqm-8535"
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7136 | dense, sparse, graph | dense: 0.478, sparse: 0.259, graph: 0.913 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7034 | dense, sparse, graph | dense: 0.530, sparse: 0.263, graph: 0.805 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6446 | dense, sparse, graph | dense: 0.489, sparse: 0.270, graph: 0.686 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6036 | dense, sparse, graph | dense: 0.529, sparse: 0.234, graph: 0.713 |
| 5 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5695 | dense, sparse, graph | dense: 0.470, sparse: 0.232, graph: 0.563 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3984 | dense, sparse | dense: 0.540, sparse: 0.282 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3856 | dense, sparse | dense: 0.549, sparse: 0.250 |
| 8 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3834 | dense, sparse | dense: 0.486, sparse: 0.245 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3777 | dense, sparse | dense: 0.491, sparse: 0.231 |
| 10 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.3739 | dense, sparse | dense: 0.471, sparse: 0.242 |

