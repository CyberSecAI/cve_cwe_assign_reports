# Vulnerability Information: CVE-2022-30472

## Vulnerability Description
Tenda AC Seris Router AC18_V15.03.05.19(6318) has a **stack-based buffer overflow** vulnerability in function fromAddressNat

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **product:** Tenda AC Seris Router
- **version:** AC18_V15.03.05.19(6318)
- **component:** function fromAddressNat

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Stack-based buffer overflow in the `fromAddressNat` function.
- **Weaknesses/vulnerabilities present**: The function `sprintf` copies user-provided parameters (`entrys` and `mitInterface`) into a stack-based buffer `s` without any length checks.
- **Impact of exploitation**: Attackers can cause a Denial of Service (DoS) or achieve Remote Code Execution (RCE) by providing crafted overflow data.
- **Attack vectors**: Sending a request to the `/goform/addressNat` page with a large `entrys` and `mitInterface` parameters is the attack vector.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable device and have knowledge of the vulnerable page and parameters to exploit the overflow.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.5483 | dense, sparse, graph | dense: 0.481, sparse: 0.104, graph: 0.766 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3778 | sparse, graph | sparse: 0.095, graph: 0.905 |
| 3 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.3760 | sparse, graph | sparse: 0.097, graph: 0.984 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3721 | dense, sparse | dense: 0.613, sparse: 0.169 |
| 5 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3300 | sparse, graph | sparse: 0.084, graph: 0.789 |
| 6 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2869 | dense, sparse | dense: 0.474, sparse: 0.087 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.2808 | dense, sparse | dense: 0.472, sparse: 0.078 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2742 | dense, sparse | dense: 0.488, sparse: 0.093 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2684 | dense, sparse | dense: 0.487, sparse: 0.083 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.1670 | dense, sparse | dense: 0.475, sparse: 0.082 |

