# Raw Retriever Results for CVE-2021-33912

# Raw Retriever Results for CVE-2021-33912

## Query
libspf2 before 1.2.11 has a four-byte heap-based buffer overflow that might allow remote attackers to execute arbitrary code (via an unauthenticated e-mail message from anywhere on the Internet) with a crafted SPF DNS record, because of incorrect sprintf usage in SPF_record_expand_data in spf_expand.c. The vulnerable code may be part of the supply chain of a sites e-mail infrastructure (e.g., with additional configuration, Exim can use libspf2 the Postfix web site links to unofficial patches for use of libspf2 with Postfix older versions of spfquery relied on libspf2) but most often is not.

## Keyphrases
- **rootcause**: incorrect sprintf usage
- **weakness**: heap-based buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5264 | 0.5819 | 0.5470 | 0.5440 | 20 |
| Sparse | 429.0948 | 1014.0847 | 706.0530 | 742.0904 | 20 |
| Graph | 1.6848 | 2.5747 | 2.0451 | 2.1483 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 193 | Off-by-one Error | Base | 2.5747 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.3998 | Allowed |
| 3 | 787 | Out-of-bounds Write | base | 2.2776 | Allowed |
| 4 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 5 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 6 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 8 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 11 | 190 | Integer Overflow or Wraparound | Base | 2.0865 | Allowed |
| 12 | 126 | Buffer Over-read | Variant | 2.0016 | Allowed |
| 13 | 125 | Out-of-bounds Read | Base | 1.9293 | Allowed |
| 14 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 15 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 122 | Heap-based Buffer Overflow | Variant | 0.5819 | 0.5819 | Allowed |
| 2 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5742 | 0.5742 | Allowed |
| 3 | 121 | Stack-based Buffer Overflow | Variant | 0.5690 | 0.5690 | Allowed |
| 4 | 126 | Buffer Over-read | Variant | 0.5667 | 0.5667 | Allowed |
| 5 | 190 | Integer Overflow or Wraparound | Base | 0.5622 | 0.5622 | Allowed |
| 6 | 193 | Off-by-one Error | Base | 0.5560 | 0.5560 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5542 | 0.5542 | Allowed |
| 8 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5529 | 0.5529 | Allowed |
| 9 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.5488 | 0.5488 | Allowed |
| 10 | 346 | Origin Validation Error | Class | 0.5448 | 0.5448 | Allowed-with-Review |
| 11 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.5431 | 0.5431 | Allowed |
| 12 | 134 | Use of Externally-Controlled Format String | Base | 0.5382 | 0.5382 | Allowed |
| 13 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5378 | 0.5378 | Allowed |
| 14 | 125 | Out-of-bounds Read | Base | 0.5367 | 0.5367 | Allowed |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5314 | 0.5314 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-122 | Heap-based Buffer Overflow | 1014.0847 | 1014.0847 | Allowed |
| 2 | CWE-190 | Integer Overflow or Wraparound | 844.3471 | 844.3471 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 808.1432 | 808.1432 | Allowed |
| 4 | CWE-125 | Out-of-bounds Read | 796.2531 | 796.2531 | Allowed |
| 5 | CWE-193 | Off-by-one Error | 791.4670 | 791.4670 | Allowed |
| 6 | CWE-126 | Buffer Over-read | 789.8719 | 789.8719 | Allowed |
| 7 | CWE-121 | Stack-based Buffer Overflow | 774.2706 | 774.2706 | Allowed |
| 8 | CWE-295 | Improper Certificate Validation | 763.0535 | 763.0535 | Allowed |
| 9 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 756.3344 | 756.3344 | Allowed |
| 10 | CWE-20 | Improper Input Validation | 750.8610 | 750.8610 | Discouraged |
| 11 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 733.3197 | 733.3197 | Allowed |
| 12 | CWE-770 | Allocation of Resources Without Limits or Throttling | 722.6971 | 722.6971 | Allowed |
| 13 | CWE-306 | Missing Authentication for Critical Function | 718.5208 | 718.5208 | Allowed |
| 14 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 715.9912 | 715.9912 | Allowed-with-Review |
| 15 | CWE-502 | Deserialization of Untrusted Data | 712.1401 | 712.1401 | Allowed |
