# Vulnerability Information: CVE-2022-26307

## Vulnerability Description
LibreOffice supports the storage of passwords for web connections in the users configuration database. The stored passwords are encrypted with a single master key provided by the user. A flaw in LibreOffice existed where **master key was poorly encoded** resulting in weakening its entropy from 128 to 43 bits making the stored passwords vulerable to a brute force attack if an attacker has access to the users stored config. This issue affects The Document Foundation LibreOffice 7.2 versions prior to 7.2.7 7.3 versions prior to 7.3.3.

### Vulnerability Description Key Phrases
- **rootcause:** **master key was poorly encoded**
- **impact:** stored passwords vulnerable to brute force attack
- **product:** LibreOffice
- **version:** 7.2 prior to 7.2.7, 7.3 prior to 7.3.3

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described in CVE-2022-26307:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a flaw in how LibreOffice (and Apache OpenOffice) encodes the master key used to encrypt stored passwords for web connections. This poor encoding significantly reduces the entropy of the master key.

**Weaknesses/Vulnerabilities Present:**

*   **Weak Master Key Encoding:** The primary weakness is the inadequate encoding of the master key, which reduces its effective strength from 128 bits to 43 bits. This makes it significantly easier to crack through brute-force attacks.
*   **Password Storage Vulnerability:**  The stored passwords are encrypted using the weakened master key, making them vulnerable to compromise.

**Impact of Exploitation:**

*   **Compromised Stored Passwords:** An attacker who gains access to the user's stored configuration data (where passwords are kept) can use brute-force techniques to recover the weakened master key. With the master key compromised, they can decrypt all the stored passwords for web connections.
*   **Access to Web Services:**  Compromised passwords could enable an attacker to access the user's web accounts/services.

**Attack Vectors:**

*   **Access to User's Configuration Data:** The attacker must first gain access to the user's configuration data, where LibreOffice stores encrypted password information. This could involve malware, physical access to the system, or other methods of data exfiltration.
*  **Brute-Force Attack:** Once the configuration data is obtained, the attacker will attempt to brute force the weak master key.

**Required Attacker Capabilities/Position:**

*   **Access to User's Configuration:** The attacker needs to be able to read the user's configuration files/database where LibreOffice stores encrypted password data.
*   **Computational Resources:** The attacker requires sufficient computing power to perform a brute-force attack on the weakened master key. Although the key is weakened, cracking it still requires some level of resource investment.

**Additional details from the provided content:**

*   **Affected Software:** The vulnerability affects LibreOffice versions prior to 7.2.7 and 7.3.3, and Apache OpenOffice versions prior to 4.1.13.
*   **Mitigation:** Fixed versions of LibreOffice prompt the user to re-enter their master password to re-encrypt their stored data using the fixed encoding method.
*   **Credit:** OpenSource Security GmbH on behalf of the German Federal Office for Information Security is credited with discovering the vulnerability.

In summary, CVE-2022-26307 describes a vulnerability where a poorly encoded master key significantly weakens the encryption protecting stored passwords in LibreOffice and Apache OpenOffice, allowing an attacker with access to the user's configuration to potentially decrypt their passwords using a brute-force attack.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-331 | Insufficient Entropy | Base | Allowed | 0.8212 | dense, sparse, graph | dense: 0.477, sparse: 0.686, graph: 0.532 |
| 2 | CWE-1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | 0.8065 | dense, sparse, graph | dense: 0.520, sparse: 0.620, graph: 0.536 |
| 3 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.7197 | dense, sparse, graph | dense: 0.476, sparse: 0.423, graph: 0.670 |
| 4 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.7147 | dense, sparse, graph | dense: 0.526, sparse: 0.407, graph: 0.611 |
| 5 | CWE-257 | Storing Passwords in a Recoverable Format | Base | Allowed | 0.6955 | dense, sparse, graph | dense: 0.506, sparse: 0.392, graph: 0.610 |
| 6 | CWE-172 | Encoding Error | Class | Allowed-with-Review | 0.5062 | dense, sparse, graph | dense: 0.478, sparse: 0.823, graph: 0.424 |
| 7 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.4686 | dense, sparse | dense: 0.473, sparse: 0.405 |
| 8 | CWE-316 | Cleartext Storage of Sensitive Information in Memory | Variant | Allowed | 0.4189 | dense, sparse | dense: 0.461, sparse: 0.390 |
| 9 | CWE-1391 | Use of Weak Credentials | Class | Allowed-with-Review | 0.2683 | dense, sparse | dense: 0.464, sparse: 0.392 |
| 10 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.2373 | sparse | sparse: 0.415 |

