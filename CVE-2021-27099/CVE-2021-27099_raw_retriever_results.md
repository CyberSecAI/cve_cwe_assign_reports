# Raw Retriever Results for CVE-2021-27099

# Raw Retriever Results for CVE-2021-27099

## Query
In SPIRE before versions 0.8.5, 0.9.4, 0.10.2, 0.11.3 and 0.12.1, the aws_iid Node Attestor improperly normalizes the path provided through the agent ID templating feature, which may allow the issuance of an arbitrary SPIFFE ID within the same trust domain, if the attacker controls the value of an EC2 tag prior to attestation, and the attestor is configured for agent ID templating where the tag value is the last element in the path. This issue has been fixed in SPIRE versions 0.11.3 and 0.12.1

## Keyphrases
- **rootcause**: improperly normalizes the path

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4110 | 0.5763 | 0.4331 | 0.4179 | 20 |
| Sparse | 495.2263 | 1133.7261 | 536.4637 | 503.6689 | 20 |
| Graph | 1.4040 | 2.3296 | 1.7588 | 1.6072 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3296 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.3296 | Allowed |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | base | 2.3296 | Allowed |
| 4 | 117 | Improper Output Neutralization for Logs | base | 2.2100 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 6 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.9236 | Allowed |
| 8 | 1270 | Generation of Incorrect Security Tokens | Base | 1.6558 | Allowed |
| 9 | 1290 | Incorrect Decoding of Security Identifiers  | Base | 1.6123 | Allowed |
| 10 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |
| 11 | 1389 | Incorrect Parsing of Numbers with Different Radices | Base | 1.6044 | Allowed |
| 12 | 613 | Insufficient Session Expiration | Base | 1.5237 | Allowed |
| 13 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 14 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 15 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 1.4857 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 706 | Use of Incorrectly-Resolved Name or Reference | Class | 0.5763 | 0.5763 | Allowed-with-Review |
| 2 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 0.4656 | 0.4656 | Allowed |
| 3 | 1290 | Incorrect Decoding of Security Identifiers  | Base | 0.4541 | 0.4541 | Allowed |
| 4 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4538 | 0.4538 | Allowed |
| 5 | 1389 | Incorrect Parsing of Numbers with Different Radices | Base | 0.4430 | 0.4430 | Allowed |
| 6 | 1311 | Improper Translation of Security Attributes by Fabric Bridge | Base | 0.4416 | 0.4416 | Allowed |
| 7 | 291 | Reliance on IP Address for Authentication | Variant | 0.4237 | 0.4237 | Allowed |
| 8 | 1292 | Incorrect Conversion of Security Identifiers | Base | 0.4222 | 0.4222 | Allowed |
| 9 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 0.4191 | 0.4191 | Allowed |
| 10 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4186 | 0.4186 | Allowed |
| 11 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4173 | 0.4173 | Allowed |
| 12 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.4172 | 0.4172 | Allowed |
| 13 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 0.4165 | 0.4165 | Allowed |
| 14 | 1294 | Insecure Security Identifier Mechanism | Class | 0.4149 | 0.4149 | Allowed-with-Review |
| 15 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4148 | 0.4148 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-706 | Use of Incorrectly-Resolved Name or Reference | 1133.7261 | 1133.7261 | Allowed-with-Review |
| 2 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 527.8069 | 527.8069 | Allowed |
| 3 | CWE-93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 517.6051 | 517.6051 | Allowed |
| 4 | CWE-287 | Improper Authentication | 512.8235 | 512.8235 | Discouraged |
| 5 | CWE-732 | Incorrect Permission Assignment for Critical Resource | 512.5623 | 512.5623 | Allowed-with-Review |
| 6 | CWE-295 | Improper Certificate Validation | 508.8086 | 508.8086 | Allowed |
| 7 | CWE-863 | Incorrect Authorization | 508.5223 | 508.5223 | Allowed-with-Review |
| 8 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 507.4643 | 507.4643 | Allowed-with-Review |
| 9 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 505.3630 | 505.3630 | Allowed-with-Review |
| 10 | CWE-1390 | Weak Authentication | 505.1547 | 505.1547 | Allowed-with-Review |
| 11 | CWE-20 | Improper Input Validation | 502.1831 | 502.1831 | Discouraged |
| 12 | CWE-1284 | Improper Validation of Specified Quantity in Input | 501.6957 | 501.6957 | Allowed |
| 13 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 501.1980 | 501.1980 | Allowed |
| 14 | CWE-755 | Improper Handling of Exceptional Conditions | 498.9035 | 498.9035 | Discouraged |
| 15 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 498.8714 | 498.8714 | Allowed |
