# Vulnerability Information: CVE-2021-35005

## Vulnerability Description
This vulnerability allows local attackers to disclose sensitive information on affected installations of TeamViewer. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the TeamViewer service. The issue results from the **lack of proper validation of user-supplied data**, which can result in a read past the end of an allocated array. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of SYSTEM. Was ZDI-CAN-13818.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of proper validation of user-supplied data**
- **impact:** disclose sensitive information
- **vector:** obtain the ability to execute low-privileged code
- **attacker:** local attackers
- **product:** TeamViewer

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the lack of proper validation of user-supplied data within the TeamViewer service. This leads to a read operation beyond the boundaries of an allocated array.

**Weaknesses/Vulnerabilities:**

*   **Improper Input Validation:** The primary weakness is the insufficient validation of array index data provided by a user. This allows for out-of-bounds read access.
*   **Out-of-bounds Read:** The lack of input validation leads to an out-of-bounds read on an allocated array.

**Impact of Exploitation:**

*   **Information Disclosure:** By triggering the out-of-bounds read, an attacker can disclose sensitive information from the TeamViewer service's memory.
*   **Potential for further exploitation:** The disclosed memory can be used in conjunction with other vulnerabilities to potentially escalate privileges and achieve arbitrary code execution in the context of the SYSTEM user.

**Attack Vectors:**

*   **Local Access:** The attacker must have the ability to execute low-privileged code on the target system.
*   **Shared Memory Manipulation:** The attacker needs to manipulate shared memory to trigger the out-of-bounds read within the TeamViewer service.
*   **Log File Access**:  The service writes the out-of-bounds read data to the log file, which can be read by the attacker.

**Required Attacker Capabilities/Position:**

*   **Local, low-privileged access:** The attacker must be able to execute code with low privileges on the target machine.

**Additional Notes:**

*   The vulnerability was patched in TeamViewer version 15.21.2, released on August 24th, 2021.
*   The vulnerability was responsibly disclosed by Kharosx0 and the Trend Micro Zero Day Initiative.
*   The vendor stated there was no indication of exploitation in the wild.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.8035 | dense, sparse, graph | dense: 0.597, sparse: 0.496, graph: 0.618 |
| 2 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5927 | sparse, graph | sparse: 0.500, graph: 0.857 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5905 | sparse, graph | sparse: 0.481, graph: 0.882 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5360 | dense, sparse | dense: 0.560, sparse: 0.447 |
| 5 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4851 | sparse, graph | sparse: 0.453, graph: 0.631 |
| 6 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.3375 | dense, sparse | dense: 0.587, sparse: 0.491 |
| 7 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2621 | dense, sparse | dense: 0.563, sparse: 0.531 |
| 8 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.2580 | sparse | sparse: 0.451 |
| 9 | CWE-620 | Unverified Password Change | Base | Allowed | 0.2528 | sparse | sparse: 0.442 |
| 10 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.2449 | sparse | sparse: 0.464 |

