# Vulnerability Information: CVE-2022-20013

## Vulnerability Description
In vow driver, there is a possible **memory corruption** due to a **race condition**. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation. Patch ID ALPS05837742 Issue ID ALPS05837742.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **weakness:** **memory corruption**
- **impact:** local escalation of privilege
- **product:** vow driver

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 131)
- CWE-362 (Count: 33)
- CWE-667 (Count: 29)

## CVE Reference Links Content Summary
The provided document contains security bulletins for MediaTek products. Here's the relevant information regarding CVE-2022-20013:

**CVE ID:** CVE-2022-20013
**Title:** Time-of-check time-of-use (toctou) race condition in vow driver
**Severity:** Medium
**Vulnerability Type:** EoP (Elevation of Privilege)
**CWE:** CWE-367 Time-of-check Time-of-use (TOCTOU) Race Condition
**Description:** In the vow driver, a race condition can lead to memory corruption.
**Impact:** This vulnerability could allow a local attacker to escalate privileges to System level.
**Attack vector:** Local
**Required attacker capabilities/position:** System execution privileges are required for exploitation. User interaction is not needed.
**Affected Chipsets:** MT6781, MT6785, MT6833, MT6853, MT6853T, MT6873, MT6877, MT6883, MT6885, MT6889, MT6891, MT6893, MT8185, MT8789, MT8791, MT8797
**Affected Software Versions:** Android 10.0, 11.0

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.8059 | dense, sparse, graph | dense: 0.572, sparse: 0.446, graph: 0.740 |
| 2 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.5254 | dense, sparse | dense: 0.575, sparse: 0.416 |
| 3 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5065 | dense, sparse | dense: 0.559, sparse: 0.397 |
| 4 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.4650 | dense, sparse, graph | dense: 0.583, sparse: 0.478, graph: 0.633 |
| 5 | CWE-416 | Use After Free | Variant | Allowed | 0.4460 | sparse, graph | sparse: 0.389, graph: 0.729 |
| 6 | CWE-667 | Improper Locking | Class | Allowed-with-Review | 0.3311 | dense, sparse | dense: 0.588, sparse: 0.471 |
| 7 | CWE-662 | Improper Synchronization | Class | Discouraged | 0.2663 | sparse, graph | sparse: 0.470, graph: 0.911 |
| 8 | CWE-413 | Improper Resource Locking | Base | Allowed | 0.2163 | sparse | sparse: 0.378 |
| 9 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2118 | sparse | sparse: 0.370 |
| 10 | CWE-366 | Race Condition within a Thread | Base | Allowed | 0.2104 | sparse | sparse: 0.368 |

