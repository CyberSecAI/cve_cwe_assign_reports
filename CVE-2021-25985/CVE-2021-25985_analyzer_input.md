# Vulnerability Information: CVE-2021-25985

## Vulnerability Description
In Factor (App Framework & Headless CMS) v1.0.4 to v1.8.30, improperly invalidate a users session even after the user logs out of the application. In addition, user sessions are stored in the browsers local storage, which by default does not have an expiration time. This makes it possible for an attacker to steal and reuse the cookies using techniques such as XSS attacks, followed by a local account takeover.

### Vulnerability Description Key Phrases
- **impact:** steal and reuse cookies
- **vector:** XSS attacks
- **attacker:** attacker
- **product:** Factor (App Framework & Headless CMS)
- **version:** v1.0.4 to v1.8.30

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "cve": "CVE-2021-25985",
      "root_cause": "The application does not properly invalidate user sessions after logout and stores them in the browser's local storage without an expiration time.",
      "weaknesses": [
        "Insufficient session expiration",
         "Storing session tokens in local storage without expiration"
      ],
      "impact": "An attacker can use a previously used or available session token to take over an account and login as a legitimate user.",
      "attack_vectors": [
        "Stealing session tokens from local storage after user logout",
        "Exploiting an XSS vulnerability to steal session tokens from local storage"
      ],
      "attacker_capabilities": "An attacker needs to either have access to a previously used session token or be able to execute arbitrary javascript in the user's browser (e.g. via XSS).",
      "additional_details": "The vulnerability exists because user sessions are stored in local storage, which by default does not have an expiration time, and the application does not properly invalidate these sessions upon logout. A proof of concept is provided demonstrating how to log back in after logout by pasting the token back into localStorage. Additionally, the provided XSS PoC allows an attacker to log the user's token into the browser console."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.7309 | dense, sparse, graph | dense: 0.551, sparse: 0.171, graph: 1.000 |
| 2 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.4780 | dense, sparse, graph | dense: 0.467, sparse: 0.096, graph: 0.530 |
| 3 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4134 | sparse, graph | sparse: 0.103, graph: 0.991 |
| 4 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.3678 | dense, sparse, graph | dense: 0.457, sparse: 0.101, graph: 0.536 |
| 5 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.3380 | sparse, graph | sparse: 0.098, graph: 0.789 |
| 6 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.2927 | sparse, graph | sparse: 0.099, graph: 0.729 |
| 7 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.2809 | sparse, graph | sparse: 0.096, graph: 0.631 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1734 | sparse, graph | sparse: 0.108, graph: 0.911 |
| 9 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.1541 | sparse, graph | sparse: 0.103, graph: 0.570 |
| 10 | CWE-290 | Authentication Bypass by Spoofing | Base | Allowed | 0.0583 | sparse | sparse: 0.102 |

