# Fully Enhanced Analysis for Critic Review - CVE-2021-25985

# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-613 | Insufficient Session Expiration | 0.95 | Base | Allowed | The application does not properly invalidate user sessions after logout. |
| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 0.75 | Base | Allowed | Session tokens are stored in local storage, making them vulnerable to XSS attacks. |

## Evidence and Confidence

*   **Confidence Score:** 0.85
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**  
  - *Explanation:* The primary weakness is **insufficient session expiration (CWE-613)**. The vulnerability description states the application "improperly invalidate a users session even after the user logs out of the application" and that "user sessions are stored in the browsers local storage, which by default does not have an expiration time." This aligns directly with CWE-613, which describes a scenario where a website permits an attacker to reuse old session credentials or session IDs for authorization. The CVE Reference Links Content Summary further reinforces this by stating "The application does not properly invalidate user sessions after logout and stores them in the browser's local storage without an expiration time."
  The secondary weakness is **Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (CWE-79)**, since "user sessions are stored in the browsers local storage, which by default does not have an expiration time. This makes it possible for an attacker to steal and reuse the cookies using techniques such as XSS attacks, followed by a local account takeover".
  CWE-613 is a Base level CWE and is ALLOWED per MITRE mapping guidance.

  - *Relationship Analysis:* CWE-613 is related to weaknesses like CWE-352 (Cross-Site Request Forgery) and CWE-287 (Improper Authentication). It can also be a contributing factor to CWE-290 (Authentication Bypass by Spoofing) if an attacker reuses an unexpired session to bypass authentication.

- **Confidence Score:**  
  - Confidence: 0.95 (High confidence due to clear evidence in the vulnerability description and CVE reference materials). The retriever results also had a high score for CWE-613, further increasing confidence.
  - Confidence: 0.75 (Medium confidence due to clear evidence in the vulnerability description and CVE reference materials). The retriever results also had a high score for CWE-79, further increasing confidence.

---



## Known Examples for CWE-613: Insufficient Session Expiration
### Top 25 Examples
- **CVE-2021-25985**: In Factor (App Framework & Headless CMS) v1.0.4 to v1.8.30, improperly invalidate a user’s session even after the user logs out of the application. In addition, user sessions are stored in the browser’s local storage, which by default does not have an expiration time. This makes it possible for an attacker to steal and reuse the cookies using techniques such as XSS attacks, followed by a local account takeover.
- **CVE-2021-31408**: Authentication.logout() helper in com.vaadin:flow-client versions 5.0.0 prior to 6.0.0 (Vaadin 18), and 6.0.0 through 6.0.4 (Vaadin 19.0.0 through 19.0.3) uses incorrect HTTP method, which, in combination with Spring Security CSRF protection, allows local attackers to access Fusion endpoints after the user attempted to log out.
- **CVE-2021-3183**: Files.com Fat Client 3.3.6 allows authentication bypass because the client continues to have access after a logout and a removal of a login profile.
- **CVE-2021-20378**: IBM Guardium Data Encryption (GDE) 3.0.0.2 and 4.0.0.4 does not invalidate session after logout which could allow an authenticated user to impersonate another user on the system. IBM X-Force ID: 195709.
- **CVE-2021-3144**: In SaltStack Salt before 3002.5, eauth tokens can be used once after expiration. (They might be used to run command against the salt master or minions.)
- **CVE-2020-18701**: Incorrect Access Control in Lin-CMS-Flask v0.1.1 allows remote attackers to obtain sensitive information and/or gain privileges due to the application not invalidating a user's authentication token upon logout, which allows for replaying packets.
- **CVE-2021-22820**: A CWE-614 Insufficient Session Expiration vulnerability exists that could allow an attacker to maintain an unauthorized access over a hijacked session to the charger station web server even after the legitimate user account holder has changed his password. Affected Products: EVlink City EVC1S22P4 / EVC1S7P4 (All versions prior to R8 V3.4.0.2 ), EVlink Parking EVW2 / EVF2 / EVP2PE (All versions prior to R8 V3.4.0.2), and EVlink Smart Wallbox EVB1A (All versions prior to R8 V3.4.0.2)
- **CVE-2022-24895**: Symfony is a PHP framework for web and console applications and a set of reusable PHP components. When authenticating users Symfony by default regenerates the session ID upon login, but preserves the rest of session attributes. Because this does not clear CSRF tokens upon login, this might enables same-site attackers to bypass the CSRF protection mechanism by performing an attack similar to a session-fixation. This issue has been fixed in the 4.4 branch. 
- **CVE-2022-43844**: IBM Robotic Process Automation for Cloud Pak 20.12 through 21.0.3 is vulnerable to broken access control. A user is not correctly redirected to the platform log out screen when logging out of IBM RPA for Cloud Pak. IBM X-Force ID: 239081.
- **CVE-2022-30277**: BD Synapsys™, versions 4.20, 4.20 SR1, and 4.30, contain an insufficient session expiration vulnerability. If exploited, threat actors may be able to access, modify or delete sensitive information, including electronic protected health information (ePHI), protected health information (PHI) and personally identifiable information (PII).
