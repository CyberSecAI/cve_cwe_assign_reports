# Vulnerability Information: CVE-2021-45078

## Vulnerability Description
stab_xcoff_builtin_type in stabs.c in GNU Binutils through 2.37 allows attackers to cause a denial of service (**heap-based buffer overflow**) or possibly have unspecified other impact, as demonstrated by an out-of-bounds write. NOTE this issue exists because of an incorrect fix for CVE-2018-12699.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-based buffer overflow**
- **impact:** denial of service and out-of-bounds write
- **attacker:** attackers
- **product:** GNU Binutils
- **version:** through 2.37
- **component:** stab_xcoff_builtin_type in stabs.c

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-45078:

**Root cause of vulnerability:**
- An out-of-bounds write vulnerability exists in the `stab_xcoff_builtin_type` function within `stabs.c` of GNU Binutils.

**Weaknesses/vulnerabilities present:**
- **Out-of-bounds write:** The code uses a negated `typenum` variable as an index into the `info->xcoff_types` array without proper bounds checking, leading to writing outside the array's allocated memory.
- **Integer handling:** The type number was a signed integer, which when negated, can become a large positive number exceeding array bounds.

**Impact of exploitation:**
- **Memory Corruption:** Writing outside the bounds of the `info->xcoff_types` array corrupts adjacent memory, specifically overwriting the `info->tags` field.
- **Denial of Service (DoS):** The memory corruption can eventually lead to a segmentation fault due to illegal memory access during the `finish_stab` function, which crashes the program.
- **Potential for sensitive information disclosure or data modification:** The NetApp advisory suggests that successful exploitation could lead to disclosure of sensitive information or modification of data, beyond the immediate DoS. This may be due to the program attempting to use the corrupted memory to perform later actions.

**Attack vectors:**
- **File Processing:** The vulnerability is triggered when processing a specially crafted binary or object file containing a specific type of debugging information (stab). The objdump utility is mentioned in the provided text as a potential trigger.

**Required attacker capabilities/position:**
- **Ability to supply malformed input:** The attacker needs to be able to provide a crafted input file (binary or object) to a vulnerable tool within the binutils suite, such as objdump.

**Technical details:**
- The vulnerability occurs at the line `info->xcoff_types[-typenum] = rettype;` in `stabs.c`.
- The issue arises because `typenum` can be a negative number. When this negative number is negated, the resulting positive number can exceed the allocated size of the `info->xcoff_types` array leading to out-of-bounds access.
- The fix involves making `typenum` unsigned and adjusting bounds checking and switch cases to correctly handle type numbers.

**Additional notes:**
- The vulnerability can be triggered when processing XCOFF stab debug information.
- The issue was assigned Bugzilla ID 28694, and the fix was committed with commit ID `161e87d12167b1e36193385485c1f6ce92f74f02`.
- Several vendors such as Gentoo, Fedora, and NetApp acknowledged and provided updates to address this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7599 | dense, sparse, graph | dense: 0.521, sparse: 0.301, graph: 0.913 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7130 | dense, sparse, graph | dense: 0.568, sparse: 0.284, graph: 0.745 |
| 3 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.6709 | dense, sparse, graph | dense: 0.553, sparse: 0.226, graph: 0.741 |
| 4 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6705 | dense, sparse, graph | dense: 0.525, sparse: 0.285, graph: 0.686 |
| 5 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6367 | dense, sparse, graph | dense: 0.568, sparse: 0.263, graph: 0.714 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4349 | dense, sparse | dense: 0.579, sparse: 0.317 |
| 7 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.4315 | sparse, graph | sparse: 0.246, graph: 0.813 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4161 | dense, sparse | dense: 0.543, sparse: 0.252 |
| 9 | CWE-170 | Improper Null Termination | Base | Allowed | 0.4146 | sparse, graph | sparse: 0.231, graph: 0.789 |
| 10 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.4100 | dense, sparse | dense: 0.539, sparse: 0.245 |

