# Vulnerability Information: CVE-2021-23994

## Vulnerability Description
A **WebGL framebuffer was not initialized early enough**, resulting in memory corruption and an out of bound write. This vulnerability affects Firefox ESR < 78.10, Thunderbird < 78.10, and Firefox < 88.

### Vulnerability Description Key Phrases
- **rootcause:** **WebGL framebuffer was not initialized early enough**
- **impact:** memory corruption
- **vector:** out of bound write
- **product:** Firefox ESR, Thunderbird, Firefox
- **version:** ESR < 78.10, Thunderbird < 78.10, and Firefox < 88

## CVE Reference Links Content Summary
### CVE-2021-23994
**Root cause:** A WebGL framebuffer was not initialized early enough.
**Vulnerability:** Out-of-bounds write due to memory corruption.
**Impact:** Memory corruption and potential denial of service (crash).
**Attack vector:** Exploiting the WebGL API in a malicious webpage.
**Attacker capabilities:** Ability to craft a malicious WebGL program that triggers the vulnerability.
**Additional Details:** The vulnerability occurs during the execution of the `drawBuffers()` function after calling `deleteFramebuffer()`. The root cause is that the `mDrawBufferStates` and `mReadBufferState` variables are not initialized correctly in certain scenarios leading to a large value being passed to the memset function resulting in the OOB write.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.7472 | dense, sparse, graph | dense: 0.552, sparse: 0.250, graph: 0.918 |
| 2 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.6972 | dense, sparse, graph | dense: 0.447, sparse: 0.202, graph: 1.000 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6145 | dense, sparse, graph | dense: 0.494, sparse: 0.168, graph: 0.759 |
| 4 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.6007 | dense, sparse, graph | dense: 0.446, sparse: 0.181, graph: 0.767 |
| 5 | CWE-416 | Use After Free | Variant | Allowed | 0.5561 | dense, sparse, graph | dense: 0.513, sparse: 0.174, graph: 0.688 |
| 6 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3485 | dense, sparse | dense: 0.507, sparse: 0.165 |
| 7 | CWE-457 | Use of Uninitialized Variable | Variant | Allowed | 0.3214 | sparse, graph | sparse: 0.192, graph: 0.667 |
| 8 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.3185 | dense, sparse | dense: 0.451, sparse: 0.162 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3049 | dense, sparse | dense: 0.488, sparse: 0.151 |
| 10 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.2314 | sparse, graph | sparse: 0.302, graph: 0.619 |

