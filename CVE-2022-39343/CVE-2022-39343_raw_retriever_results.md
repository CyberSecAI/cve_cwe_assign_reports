# Raw Retriever Results for CVE-2022-39343

# Raw Retriever Results for CVE-2022-39343

## Query
Azure RTOS FileX is a FAT-compatible file system thats fully integrated with Azure RTOS ThreadX. In versions before 6.2.0, the Fault Tolerant feature of Azure RTOS FileX includes integer under and overflows which may be exploited to achieve buffer overflow and modify memory contents. When a valid log file with correct ID and checksum is detected by the `_fx_fault_tolerant_enable` function an attempt to recover the previous failed write operation is taken by call of `_fx_fault_tolerant_apply_logs`. This function iterates through the log entries and performs required recovery operations. When properly crafted a log including entries of type `FX_FAULT_TOLERANT_DIR_LOG_TYPE` may be utilized to introduce unexpected behavior. This issue has been patched in version 6.2.0. A workaround to fix line 218 in fx_fault_tolerant_apply_logs.c is documented in the GHSA.

## Keyphrases
- **weakness**: integer under and overflows

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4221 | 0.5071 | 0.4441 | 0.4381 | 20 |
| Sparse | 554.1630 | 789.9084 | 598.2018 | 571.3036 | 20 |
| Graph | 1.4923 | 2.4202 | 1.8112 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.4202 | Allowed |
| 2 | 347 | Improper Verification of Cryptographic Signature | base | 2.3296 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 5 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.9094 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.7869 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 9 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 10 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 11 | 193 | Off-by-one Error | base | 1.6848 | Allowed |
| 12 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 13 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 1.6848 | Allowed |
| 14 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 1.6470 | Allowed |
| 15 | 190 | Integer Overflow or Wraparound | Base | 1.6357 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5071 | 0.5071 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | Base | 0.4800 | 0.4800 | Allowed |
| 3 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4654 | 0.4654 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4620 | 0.4620 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4569 | 0.4569 | Allowed |
| 6 | 121 | Stack-based Buffer Overflow | Variant | 0.4527 | 0.4527 | Allowed |
| 7 | 122 | Heap-based Buffer Overflow | Variant | 0.4496 | 0.4496 | Allowed |
| 8 | 126 | Buffer Over-read | Variant | 0.4461 | 0.4461 | Allowed |
| 9 | 125 | Out-of-bounds Read | Base | 0.4429 | 0.4429 | Allowed |
| 10 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4425 | 0.4425 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 0.4337 | 0.4337 | Allowed-with-Review |
| 12 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4316 | 0.4316 | Discouraged |
| 13 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4312 | 0.4312 | Allowed |
| 14 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4289 | 0.4289 | Allowed |
| 15 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4276 | 0.4276 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | 789.9084 | 789.9084 | Allowed |
| 2 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 749.8555 | 749.8555 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 676.6825 | 676.6825 | Allowed |
| 4 | CWE-347 | Improper Verification of Cryptographic Signature | 603.1639 | 603.1639 | Allowed |
| 5 | CWE-122 | Heap-based Buffer Overflow | 598.4002 | 598.4002 | Allowed |
| 6 | CWE-125 | Out-of-bounds Read | 592.6458 | 592.6458 | Allowed |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | 587.2863 | 587.2863 | Allowed |
| 8 | CWE-476 | NULL Pointer Dereference | 579.0922 | 579.0922 | Allowed |
| 9 | CWE-121 | Stack-based Buffer Overflow | 578.0613 | 578.0613 | Allowed |
| 10 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 573.1141 | 573.1141 | Allowed |
| 11 | CWE-787 | Out-of-bounds Write | 569.4930 | 569.4930 | Allowed |
| 12 | CWE-667 | Improper Locking | 567.7057 | 567.7057 | Allowed-with-Review |
| 13 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 567.1102 | 567.1102 | Discouraged |
| 14 | CWE-287 | Improper Authentication | 566.6413 | 566.6413 | Discouraged |
| 15 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | 566.4831 | 566.4831 | Allowed |
