# Vulnerability Information: CVE-2022-20775

## Vulnerability Description
Multiple vulnerabilities in the CLI of Cisco SD-WAN Software could allow an authenticated, local attacker to gain elevated privileges. These vulnerabilities are due to **improper access controls** on commands within the application CLI. An attacker could exploit these vulnerabilities by running a malicious command on the application CLI. A successful exploit could allow the attacker to execute arbitrary commands as the root user.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access controls**
- **impact:** gain elevated privileges
- **vector:** malicious command on application CLI
- **attacker:** authenticated local attacker
- **product:** Cisco SD-WAN Software
- **component:** CLI

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-22

#### Top CWEs
- CWE-22 (Count: 6)

## CVE Reference Links Content Summary
```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "relates_to_cve": true,
    "extracted_information": {
      "root_cause": "The vulnerability is due to improper access controls on commands within the application CLI of Cisco SD-WAN Software. Specifically, the `confd_cli_grp` reads a file to determine user groups, but the username used in the file path is attacker-controlled, leading to a path traversal vulnerability.",
      "weaknesses": [
        "Improper access controls on commands within the application CLI.",
        "Path traversal vulnerability in `confd_cli_grp` when reading user group files.",
        "Path traversal vulnerability in `libnss_viptela.so` when checking the user validity.",
        "Potential stack buffer overflow in `confd_cli_grp` due to uncontrolled file content when loading group files."
      ],
      "impact": "Successful exploitation allows a local attacker to execute arbitrary commands as the *root* user, resulting in a local privilege escalation. The vulnerability can lead to an unconstrained root shell.",
      "attack_vectors": [
        "Local access via the `vshell` command.",
        "Exploitation of the `confd_cli_grp` by setting the `USER` environment variable to trigger the path traversal.",
        "Man-in-the-middle attack by using `CONFD_IPC_PORT` to intercept and modify the session configuration parameters."
      ],
      "required_attacker_capabilities": "An attacker needs to have local access to the affected device with the ability to execute commands via `vshell` or other means. The attacker also requires to set environment variables (e.g., `USER` and `CONFD_IPC_PORT`) to exploit the vulnerability. The attacker also needs to create files and symbolic links in writable directories such as `/tmp`"
    },
    "additional_details": "The provided content offers more details than the basic CVE description, including the specific vulnerable component (`confd_cli_grp`), the vulnerable library (`libnss_viptela.so`), the attack methodology (setting `USER` environment variable for path traversal), and a full proof-of-concept demonstration including a description of how to intercept and forge the signed session parameters using a Man-in-the-Middle attack. It also specifies the affected software versions and the fixed versions."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7361 | dense, sparse, graph | dense: 0.619, sparse: 0.366, graph: 0.606 |
| 2 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.7344 | dense, sparse, graph | dense: 0.633, sparse: 0.341, graph: 0.623 |
| 3 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.6935 | dense, sparse, graph | dense: 0.555, sparse: 0.331, graph: 0.633 |
| 4 | CWE-266 | Incorrect Privilege Assignment | Base | Allowed | 0.4570 | dense, sparse | dense: 0.561, sparse: 0.308 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.4542 | dense, sparse | dense: 0.567, sparse: 0.298 |
| 6 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2732 | dense, sparse | dense: 0.573, sparse: 0.311 |
| 7 | CWE-25 | Path Traversal: '/../filedir' | Variant | Allowed | 0.2582 | sparse | sparse: 0.489 |
| 8 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.2354 | dense, sparse | dense: 0.631, sparse: 0.368 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2240 | dense, sparse | dense: 0.574, sparse: 0.373 |
| 10 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2060 | dense, sparse | dense: 0.563, sparse: 0.313 |

