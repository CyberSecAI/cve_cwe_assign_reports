# Vulnerability Information: CVE-2021-33195

## Vulnerability Description
Go before 1.15.13 and 1.16.x before 1.16.5 has functions for DNS lookups that do not validate replies from DNS servers, and thus a return value may contain an **unsafe injection** (e.g., XSS) that does not conform to the RFC1035 format.

### Vulnerability Description Key Phrases
- **weakness:** **unsafe injection**
- **impact:** cross-site scripting
- **product:** Go
- **version:** before 1.15.13 and 1.16.x before 1.16.5
- **component:** DNS lookup functions

## CVE Reference Links Content Summary
```json
[
  {
    "related_to_CVE": "CVE-2021-33195",
    "root_cause": "The `net.Lookup{Addr,CNAME,Host}` functions, when using the pure Go resolver, don't filter returned host name string types, allowing invalid names to be returned to the caller. These names, if used in an unsanitized context, could lead to injection of unexpected content.",
    "weaknesses": [
      "Lack of input sanitization",
      "Improper validation of hostnames"
    ],
    "impact": "Injection of unexpected content due to using invalid hostnames in unsanitized contexts which can lead to information disclosure, data modification, or denial of service.",
    "attack_vectors": [
      "Network"
    ],
    "attacker_capabilities": "An attacker can exploit this vulnerability by controlling the DNS responses received by a vulnerable application, which may be achieved by controlling the DNS server or via a man-in-the-middle attack.",
    "additional_information": "The vulnerability is present in Go versions before 1.15.12 and 1.16.x before 1.16.5. The vulnerability is triggered when the pure Go resolver is used. The cgo resolver may impose its own filtering, but this cannot be relied upon. The `isDomainName` function, which applies RFC 1035 LDH rules, can be used to validate returned names."
  },
  {
    "related_to_CVE": "CVE-2021-33195",
    "root_cause": "Go versions prior to 1.15.13 and 1.16.x prior to 1.16.5 are susceptible to a vulnerability which, when successfully exploited, could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS). This is due to the net.Lookup functions returning invalid hostnames.",
      "weaknesses": [
        "Improper input validation"
     ],
     "impact": "Disclosure of sensitive information, data modification, or denial of service (DoS).",
     "attack_vectors": [
      "Network"
    ],
    "attacker_capabilities": "An attacker may be able to manipulate DNS results returned to a vulnerable system.",
      "additional_information": "NetApp products are affected when they incorporate vulnerable versions of Golang. The provided link points to a Google Groups discussion related to Go 1.16.5 and 1.15.13 releases, which include security fixes."
  },
  {
     "related_to_CVE": "CVE-2021-33195",
    "root_cause": "The `net` package in Go does not properly validate hostnames returned by DNS lookups, allowing arbitrary values which do not follow RFC 1035 rules for domain names to be returned, leading to potential injection issues if used without sanitization.",
    "weaknesses": [
      "Improper input validation",
      "Lack of sanitization for DNS query responses"
    ],
    "impact": "The vulnerability can lead to injection of unexpected content if arbitrary values from DNS responses are used without proper sanitization, potentially resulting in data modification, information disclosure, or a denial of service.",
    "attack_vectors": [
      "Network"
    ],
     "attacker_capabilities": "An attacker capable of manipulating DNS responses can inject arbitrary data into the application using this vulnerability.",
     "additional_information": "This is issue #46241 in the golang/go repository, and it is also identified as CVE-2021-33195. The affected functions include `LookupCNAME`, `LookupSRV`, `LookupMX`, `LookupNS`, and `LookupAddr`. A possible fix involves checking returned names with the existing `isDomainName` function to ensure they conform to RFC 1035 LDH rules."
  },
    {
    "related_to_CVE": "CVE-2021-33195",
    "root_cause": "The vulnerability is caused by the use of the `net.Lookup{Addr,CNAME,Host}` functions with the pure Go resolver, which does not validate or filter returned host name strings, leading to the possibility of injecting unexpected content if not sanitized.",
    "weaknesses": [
      "Improper Input Validation",
      "Lack of output sanitization"
    ],
    "impact": "The impact is the injection of unexpected content. This could lead to a variety of consequences, including information disclosure, data modification, or denial of service, depending on the specific context where the unsanitized data is used.",
     "attack_vectors": [
       "Network"
      ],
    "attacker_capabilities": "An attacker would need to control DNS responses to inject arbitrary, invalid hostnames into the application that uses a vulnerable version of Go.",
     "additional_information": "The vulnerability is assigned CVE-2021-33195. The `net` package in Go, specifically when using the pure Go resolver, does not filter or validate host name string types. This can be mitigated by checking returned names with the existing `isDomainName` function."
  },
    {
    "related_to_CVE": "CVE-2021-33195",
    "root_cause": "The vulnerability arises from the fact that the `net.Lookup{Addr,CNAME,Host}` functions don't filter returned host name string types when using the pure Go resolver. This allows for invalid names to be returned, which, if used in unsanitized contexts, can lead to injection issues.",
    "weaknesses": [
      "Improper Input Validation",
     "Lack of Output Sanitization"
    ],
    "impact": "The impact is potential injection of unexpected content. This could lead to vulnerabilities such as Cross-Site Scripting (XSS), data modification, or denial of service, depending on how the invalid hostname string is used.",
    "attack_vectors": [
     "Network"
    ],
    "attacker_capabilities": "An attacker capable of manipulating DNS responses can exploit this vulnerability by injecting arbitrary, invalid hostnames.",
    "additional_information": "The affected functions are `net.Lookup{Addr, CNAME, Host}` when using the pure Go resolver. This issue is tracked as CVE-2021-33195. The recommended approach is to check the returned names using the `isDomainName` function, which applies RFC 1035 LDH rules."
  },
  {
    "related_to_CVE": "CVE-2021-33195",
    "root_cause": "The vulnerability stems from the way the `net.Lookup{Addr,CNAME,Host}` functions handle DNS responses when using the pure Go resolver. They do not validate or filter the returned host name strings, allowing for invalid names that can cause injection vulnerabilities.",
     "weaknesses": [
        "Improper Input Validation",
       "Lack of Output Sanitization"
      ],
    "impact": "The lack of validation allows for the injection of unexpected content, possibly leading to data modification, information disclosure, or denial of service (DoS) depending on how the application uses these names.",
    "attack_vectors": [
     "Network"
    ],
    "attacker_capabilities": "An attacker could exploit this by controlling the DNS server or performing a man-in-the-middle attack to provide responses containing invalid host names.",
     "additional_information": "The CVE ID for this vulnerability is CVE-2021-33195. The suggested remediation is to implement validation using the `isDomainName` function, which applies RFC 1035 LDH rules and filter out invalid names, or apply other sanitization techniques."
  },
  {
    "related_to_CVE": "CVE-2021-33195",
    "root_cause": "The net.Lookup functions return arbitrary values from DNS which do not follow the rules for domain names according to RFC 1035.",
    "weaknesses": [
      "Improper Input Validation",
      "Lack of Output Sanitization"
    ],
    "impact": "When the returned names are used without sanitization, for instance in HTML, they can allow injection of unexpected content.",
    "attack_vectors": [
     "Network"
    ],
     "attacker_capabilities": "An attacker with the ability to influence DNS responses can inject arbitrary content.",
     "additional_information": "This issue is identified as CVE-2021-33195, and it's noted that `LookupTXT` may still return arbitrary values that may require sanitization."
  },
    {
     "related_to_CVE": "CVE-2021-33195",
      "root_cause": "The `net.Lookup{Addr,CNAME,Host}` functions do not properly filter returned host names when using the pure Go resolver. This can allow for invalid names to be returned to the caller, which can lead to injection vulnerabilities if used in unsanitized contexts.",
      "weaknesses": [
        "Improper Input Validation",
       "Lack of Input Sanitization"
     ],
      "impact": "The use of invalid host names in an unsanitized context can lead to injection of unexpected content, potentially resulting in information disclosure, data modification, or denial of service.",
      "attack_vectors": [
      "Network"
      ],
      "attacker_capabilities": "An attacker capable of manipulating DNS responses can exploit this vulnerability.",
    "additional_information":"This vulnerability is identified as CVE-2021-33195. The issue occurs because returned names are not checked against the RFC 1035 LDH rules. The cgo resolver might do some filtering, but this is not consistent. The fix should involve checking the returned names using the `isDomainName` function."
  }
]
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-115 | Misinterpretation of Input | Base | Allowed | 0.5761 | dense, sparse, graph | dense: 0.521, sparse: 0.176, graph: 0.601 |
| 2 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.4574 | dense, sparse, graph | dense: 0.500, sparse: 0.181, graph: 0.397 |
| 3 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.4570 | sparse, graph | sparse: 0.279, graph: 0.832 |
| 4 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.4348 | sparse, graph | sparse: 0.177, graph: 0.932 |
| 5 | CWE-917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | 0.4044 | sparse, graph | sparse: 0.187, graph: 0.832 |
| 6 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.3822 | sparse, graph | sparse: 0.175, graph: 0.789 |
| 7 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.2907 | sparse, graph | sparse: 0.169, graph: 0.543 |
| 8 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | 0.2593 | sparse, graph | sparse: 0.180, graph: 0.498 |
| 9 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.1007 | sparse | sparse: 0.176 |
| 10 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.0999 | sparse | sparse: 0.175 |

