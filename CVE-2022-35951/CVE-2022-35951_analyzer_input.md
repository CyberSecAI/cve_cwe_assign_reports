# Vulnerability Information: CVE-2022-35951

## Vulnerability Description
Redis is an in-memory database that persists on disk. Versions 7.0.0 and above, prior to 7.0.5 are vulnerable to an Integer Overflow. Executing an `XAUTOCLAIM` command on a stream key in a specific state, with a specially crafted `COUNT` argument may cause an **integer overflow**, a subsequent heap overflow, and potentially lead to remote code execution. This has been patched in Redis version 7.0.5. No known workarounds exist.

### Vulnerability Description Key Phrases
- **rootcause:** **integer overflow**
- **impact:** heap overflow and remote code execution
- **vector:** executing XAUTOCLAIM command on stream key
- **product:** Redis
- **version:** 7.0.0 to 7.0.4
- **component:** stream key

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described in CVE-2022-35951:

**Root Cause of Vulnerability:**
- Integer overflow in the `XAUTOCLAIM` command's `COUNT` argument.

**Weaknesses/Vulnerabilities Present:**
- Integer overflow leading to a heap overflow.

**Impact of Exploitation:**
- Potential remote code execution.
- Disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

**Attack Vectors:**
- Executing a `XAUTOCLAIM` command with a specially crafted `COUNT` argument on a stream key in a specific state.
- The attack vector can be considered network-based (remote), given the nature of Redis server exposure, although the CVSS score from GitHub indicates an "Attack Vector" of "Local".

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send commands to the Redis server.
- The attacker must craft a malicious `COUNT` argument.
- The attacker should be able to reach a specific state of the stream key.
- Low privileges are required to exploit the vulnerability.

**Additional Notes:**

- The vulnerability affects Redis versions 7.0.0 and newer, but is fixed in 7.0.5.
- The Gentoo advisory also mentions that the vulnerability is remotely exploitable.
- NetApp states that none of their products are affected by this CVE.
- The vulnerability is considered high severity.
- The CVSS score is 9.8 (CRITICAL) according to NetApp, but is 7.0 according to github and uses local attack vector.
- The vulnerability is located in the XAUTOCLAIM command.
- The vulnerability is tracked by CWE-680.
- The vulnerability was identified by Xion (SeungHyun Lee) of KAIST GoN.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7731 | dense, sparse, graph | dense: 0.523, sparse: 0.494, graph: 0.641 |
| 2 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.7553 | dense, sparse, graph | dense: 0.476, sparse: 0.360, graph: 0.871 |
| 3 | CWE-197 | Numeric Truncation Error | Base | Allowed | 0.6619 | dense, sparse, graph | dense: 0.452, sparse: 0.366, graph: 0.632 |
| 4 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.6047 | dense, sparse, graph | dense: 0.466, sparse: 0.332, graph: 0.649 |
| 5 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5802 | sparse, graph | sparse: 0.389, graph: 1.000 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5236 | sparse, graph | sparse: 0.380, graph: 0.857 |
| 7 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.4854 | sparse, graph | sparse: 0.340, graph: 0.813 |
| 8 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.4489 | dense, sparse | dense: 0.482, sparse: 0.363 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4077 | dense, sparse | dense: 0.458, sparse: 0.372 |
| 10 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4017 | dense, sparse | dense: 0.443, sparse: 0.348 |

