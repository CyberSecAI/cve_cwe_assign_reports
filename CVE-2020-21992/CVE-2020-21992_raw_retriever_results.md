# Raw Retriever Results for CVE-2020-21992

# Raw Retriever Results for CVE-2020-21992

## Query
Inim Electronics SmartLiving SmartLAN/G/SI <=6.x suffers from an authenticated remote command injection vulnerability. The issue exist due to the par POST parameter not being sanitized when called with the testemail module through web.cgi binary. The vulnerable CGI binary (ELF 32-bit LSB executable, ARM) is calling the sh executable via the system() function to issue a command using the mailx service and its vulnerable string format parameter allowing for OS command injection with root privileges. An attacker can remotely execute system commands as the root user using default credentials and bypass access controls in place.

## Keyphrases
- **rootcause**: par POST parameter not being sanitized
- **weakness**: command injection

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5561 | 0.6401 | 0.5710 | 0.5622 | 20 |
| Sparse | 470.1229 | 950.7934 | 774.1915 | 786.5082 | 20 |
| Graph | 1.3676 | 2.8486 | 1.9237 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 2.8486 | Allowed |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 2.4225 | Allowed |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 2.3404 | Allowed-with-Review |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.3242 | Allowed |
| 5 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 6 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 2.0721 | Allowed |
| 8 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 11 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 12 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 13 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 14 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 15 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.6401 | 0.6401 | Allowed |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | 0.5935 | 0.5935 | Allowed-with-Review |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5924 | 0.5924 | Allowed-with-Review |
| 4 | 790 | Improper Filtering of Special Elements | Class | 0.5838 | 0.5838 | Allowed-with-Review |
| 5 | 306 | Missing Authentication for Critical Function | Base | 0.5802 | 0.5802 | Allowed |
| 6 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | 0.5723 | 0.5723 | Allowed |
| 7 | 912 | Hidden Functionality | Class | 0.5684 | 0.5684 | Allowed-with-Review |
| 8 | 250 | Execution with Unnecessary Privileges | Base | 0.5651 | 0.5651 | Allowed |
| 9 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.5631 | 0.5631 | Allowed |
| 10 | 134 | Use of Externally-Controlled Format String | Base | 0.5622 | 0.5622 | Allowed |
| 11 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 0.5621 | 0.5621 | Allowed |
| 12 | 553 | Command Shell in Externally Accessible Directory | Variant | 0.5619 | 0.5619 | Allowed |
| 13 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.5619 | 0.5619 | Allowed |
| 14 | 84 | Improper Neutralization of Encoded URI Schemes in a Web Page | Variant | 0.5614 | 0.5614 | Allowed |
| 15 | 259 | Use of Hard-coded Password | Variant | 0.5609 | 0.5609 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 950.7934 | 950.7934 | Allowed |
| 2 | CWE-138 | Improper Neutralization of Special Elements | 905.6875 | 905.6875 | Discouraged |
| 3 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 876.5056 | 876.5056 | Allowed |
| 4 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | 825.3553 | 825.3553 | Allowed |
| 5 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 825.0113 | 825.0113 | Allowed |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 821.3009 | 821.3009 | Allowed-with-Review |
| 7 | CWE-306 | Missing Authentication for Critical Function | 800.5028 | 800.5028 | Allowed |
| 8 | CWE-790 | Improper Filtering of Special Elements | 798.9376 | 798.9376 | Allowed-with-Review |
| 9 | CWE-20 | Improper Input Validation | 798.8194 | 798.8194 | Discouraged |
| 10 | CWE-93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 796.7749 | 796.7749 | Allowed |
| 11 | CWE-116 | Improper Encoding or Escaping of Output | 776.2415 | 776.2415 | Allowed-with-Review |
| 12 | CWE-121 | Stack-based Buffer Overflow | 774.5140 | 774.5140 | Allowed |
| 13 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 773.3462 | 773.3462 | Allowed |
| 14 | CWE-287 | Improper Authentication | 772.5110 | 772.5110 | Discouraged |
| 15 | CWE-321 | Use of Hard-coded Cryptographic Key | 772.4053 | 772.4053 | Allowed |
