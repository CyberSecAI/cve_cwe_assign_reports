# Vulnerability Information: CVE-2021-33443

## Vulnerability Description
An issue was discovered in mjs (mJS Restricted JavaScript engine), ES6 (JavaScript version 6). There is **stack buffer overflow** in mjs_execute() in mjs.c.

### Vulnerability Description Key Phrases
- **weakness:** **stack buffer overflow**
- **product:** mjs (mJS Restricted JavaScript engine)
- **component:** mjs_execute() in mjs.c

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-33443:

**Root cause of vulnerability:**
- Stack buffer overflow in the `mjs_execute()` function.

**Weaknesses/vulnerabilities present:**
- Stack buffer overflow.

**Impact of exploitation:**
- Denial of service (program crash/termination).

**Attack vectors:**
- Local, by opening a crafted file.

**Required attacker capabilities/position:**
- The attacker needs to be able to open a specially crafted file using the vulnerable `mjs` engine.

**Additional Details:**

- The vulnerability is located in `mjs.c` file, specifically within the `mjs_execute()` function.
- The vulnerability is present in mjs ES6 (JavaScript version 6).
- A proof of concept (POC) file is available at `<https://github.com/Clingto/POC/blob/master/MSA/mjs/mjs-9522-mjs_execute-stack-overflow>`.
- The vulnerability was reported in GitHub issue #167 `<https://github.com/cesanta/mjs/issues/167>`.

The provided text also lists 31 other CVEs affecting mjs, NASM, lrzip, and YASM, but those are unrelated to CVE-2021-33443.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6762 | dense, sparse, graph | dense: 0.532, sparse: 0.143, graph: 0.918 |
| 2 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.6039 | dense, sparse, graph | dense: 0.552, sparse: 0.107, graph: 0.746 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5087 | dense, sparse, graph | dense: 0.567, sparse: 0.114, graph: 0.566 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5023 | dense, sparse, graph | dense: 0.547, sparse: 0.120, graph: 0.447 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3472 | dense, sparse | dense: 0.552, sparse: 0.175 |
| 6 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3419 | sparse, graph | sparse: 0.122, graph: 0.807 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3362 | dense, sparse | dense: 0.567, sparse: 0.140 |
| 8 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3304 | dense, sparse | dense: 0.531, sparse: 0.113 |
| 9 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3282 | dense, sparse | dense: 0.538, sparse: 0.103 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3277 | dense, sparse | dense: 0.519, sparse: 0.119 |

