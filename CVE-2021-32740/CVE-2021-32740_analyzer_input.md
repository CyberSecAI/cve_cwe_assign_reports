# Vulnerability Information: CVE-2021-32740

## Vulnerability Description
Addressable is an alternative implementation to the URI implementation that is part of Rubys standard library. An **uncontrolled resource consumption** vulnerability exists after version 2.3.0 through version 2.7.0. Within the URI template implementation in Addressable, a maliciously crafted template may result in **uncontrolled resource consumption**, leading to denial of service when matched against a URI. In typical usage, templates would not normally be read from untrusted user input, but nonetheless, no previous security advisory for Addressable has cautioned against doing this. Users of the parsing capabilities in Addressable but not the URI template capabilities are unaffected. The vulnerability is patched in version 2.8.0. As a workaround, only create Template objects from trusted sources that have been validated not to produce catastrophic backtracking.

### Vulnerability Description Key Phrases
- **weakness:** **uncontrolled resource consumption**
- **impact:** denial of service
- **vector:** maliciously crafted template
- **product:** Addressable
- **version:** 2.3.0 through 2.7.0
- **component:** URI template implementation

## CVE Reference Links Content Summary
The provided content relates to CVE-2021-32740.

**Root cause of vulnerability:**
The vulnerability lies in the URI template implementation of the Addressable gem. A maliciously crafted template can cause uncontrolled resource consumption when matched against a URI, leading to a denial of service (DoS). This is due to catastrophic backtracking in the regular expression used for matching the template.

**Weaknesses/vulnerabilities present:**
- Regular Expression Denial of Service (ReDoS)

**Impact of exploitation:**
- Denial of Service (DoS) due to uncontrolled resource consumption.

**Attack vectors:**
- Network. A remote attacker can provide a maliciously crafted template to the Addressable library.

**Required attacker capabilities/position:**
- The attacker needs to be able to provide a crafted URI template to the `Addressable::Template#match` function. No specific privileges or user interaction are required. The attacker can be remote and does not need local access.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.8288 | dense, sparse, graph | dense: 0.473, sparse: 0.680, graph: 0.568 |
| 2 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.7363 | dense, sparse, graph | dense: 0.482, sparse: 0.491, graph: 0.600 |
| 3 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.7088 | dense, sparse, graph | dense: 0.471, sparse: 0.498, graph: 0.526 |
| 4 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.6902 | dense, sparse, graph | dense: 0.470, sparse: 0.486, graph: 0.657 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4639 | sparse, graph | sparse: 0.468, graph: 0.548 |
| 6 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.4544 | dense, sparse | dense: 0.465, sparse: 0.453 |
| 7 | CWE-277 | Insecure Inherited Permissions | Variant | Allowed | 0.4525 | dense, sparse | dense: 0.456, sparse: 0.458 |
| 8 | CWE-400 | Uncontrolled Resource Consumption | Class | Discouraged | 0.2983 | dense, sparse, graph | dense: 0.486, sparse: 0.507, graph: 0.373 |
| 9 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2982 | dense, sparse | dense: 0.459, sparse: 0.486 |
| 10 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2594 | sparse | sparse: 0.453 |

