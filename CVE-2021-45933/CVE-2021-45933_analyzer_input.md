# Vulnerability Information: CVE-2021-45933

## Vulnerability Description
wolfSSL wolfMQTT 1.9 has a **heap-based buffer overflow** (8 bytes) in MqttDecode_Publish (called from MqttClient_DecodePacket and MqttClient_HandlePacket).

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** wolfSSL wolfMQTT
- **version:** 1.9
- **component:** MqttDecode_Publish

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 20)

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "Heap-buffer-overflow in `MqttDecode_Publish` function.",
    "weaknesses": [
      "Heap-buffer-overflow"
    ],
    "impact": "The vulnerability allows for a write of 8 bytes beyond the allocated buffer. This could potentially lead to arbitrary code execution or denial of service.",
     "attack_vectors": [
        "The vulnerability is triggered when decoding a crafted MQTT publish packet.",
        "The `MqttDecode_Publish` function is vulnerable to a heap-buffer-overflow due to insufficient size validation when handling incoming packets."
    ],
    "required_capabilities": "An attacker can trigger the vulnerability by sending a specially crafted MQTT publish packet to a vulnerable device. They need to be able to send packets to the device."
  },
  "additional_information": {
     "fixed_version": "The issue was fixed in commit `84d4b53122e0fa0280c7872350b89d5777dabbb2`.",
     "vulnerable_version": "The vulnerability was introduced in commit `237f693c5731dcbd6adc9de69d9f575421c4414e` and affects `wolfMQTT` version `v1.9`."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6735 | dense, sparse, graph | dense: 0.560, sparse: 0.123, graph: 0.903 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6637 | dense, sparse, graph | dense: 0.542, sparse: 0.111, graph: 0.920 |
| 3 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5865 | dense, sparse, graph | dense: 0.515, sparse: 0.110, graph: 0.744 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5195 | dense, sparse, graph | dense: 0.572, sparse: 0.129, graph: 0.567 |
| 5 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4484 | dense, sparse, graph | dense: 0.501, sparse: 0.096, graph: 0.458 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3582 | dense, sparse | dense: 0.584, sparse: 0.167 |
| 7 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3383 | sparse, graph | sparse: 0.098, graph: 0.789 |
| 8 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3238 | dense, sparse | dense: 0.536, sparse: 0.097 |
| 9 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3212 | dense, sparse | dense: 0.524, sparse: 0.103 |
| 10 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3200 | dense, sparse | dense: 0.528, sparse: 0.097 |

