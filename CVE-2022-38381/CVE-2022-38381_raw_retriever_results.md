# Raw Retriever Results for CVE-2022-38381

# Raw Retriever Results for CVE-2022-38381

## Query
An improper handling of malformed request vulnerability [CWE-228] exists in FortiADC 5.0 all versions, 6.0.0 all versions, 6.1.0 all versions, 6.2.0 through 6.2.3, and 7.0.0 through 7.0.2. This may allow a remote attacker without privileges to bypass some Web Application Firewall (WAF) protection such as the SQL Injection and XSS filters via a malformed HTTP request.

## Keyphrases
- **rootcause**: improper handling of malformed request

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5767 | 0.6450 | 0.5954 | 0.5923 | 20 |
| Sparse | 330.8690 | 526.2942 | 349.9746 | 338.6732 | 20 |
| Graph | 1.6016 | 2.4700 | 1.9911 | 1.9040 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1286 | Improper Validation of Syntactic Correctness of Input | base | 2.4700 | Allowed |
| 2 | 280 | Improper Handling of Insufficient Permissions or Privileges  | Base | 2.4527 | Allowed |
| 3 | 274 | Improper Handling of Insufficient Privileges | Base | 2.4376 | Discouraged |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.4232 | Allowed-with-Review |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | base | 2.3998 | Allowed |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.2100 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.2100 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 11 | 494 | Download of Code Without Integrity Check | base | 1.7680 | Allowed |
| 12 | 73 | External Control of File Name or Path | base | 1.7550 | Allowed |
| 13 | 231 | Improper Handling of Extra Values | variant | 1.7117 | Allowed |
| 14 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 1.6957 | Allowed |
| 15 | 184 | Incomplete List of Disallowed Inputs | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 280 | Improper Handling of Insufficient Permissions or Privileges  | Base | 0.6450 | 0.6450 | Allowed |
| 2 | 228 | Improper Handling of Syntactically Invalid Structure | Class | 0.6286 | 0.6286 | Allowed-with-Review |
| 3 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.6133 | 0.6133 | Allowed |
| 4 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.6075 | 0.6075 | Allowed |
| 5 | 274 | Improper Handling of Insufficient Privileges | Base | 0.6059 | 0.6059 | Discouraged |
| 6 | 233 | Improper Handling of Parameters | Base | 0.6022 | 0.6022 | Allowed |
| 7 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | Class | 0.6017 | 0.6017 | Allowed-with-Review |
| 8 | 269 | Improper Privilege Management | Class | 0.5978 | 0.5978 | Discouraged |
| 9 | 807 | Reliance on Untrusted Inputs in a Security Decision | Base | 0.5975 | 0.5975 | Allowed |
| 10 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 0.5966 | 0.5966 | Allowed |
| 11 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.5879 | 0.5879 | Allowed |
| 12 | 940 | Improper Verification of Source of a Communication Channel | Base | 0.5846 | 0.5846 | Allowed |
| 13 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | 0.5830 | 0.5830 | Allowed |
| 14 | 177 | Improper Handling of URL Encoding (Hex Encoding) | Variant | 0.5823 | 0.5823 | Allowed |
| 15 | 284 | Improper Access Control | Pillar | 0.5823 | 0.5823 | Discouraged |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-228 | Improper Handling of Syntactically Invalid Structure | 526.2942 | 526.2942 | Allowed-with-Review |
| 2 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | 359.6894 | 359.6894 | Allowed |
| 3 | CWE-20 | Improper Input Validation | 351.0206 | 351.0206 | Discouraged |
| 4 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | 348.7994 | 348.7994 | Allowed |
| 5 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 348.5387 | 348.5387 | Allowed |
| 6 | CWE-287 | Improper Authentication | 346.8333 | 346.8333 | Discouraged |
| 7 | CWE-444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | 345.3991 | 345.3991 | Allowed |
| 8 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 344.3279 | 344.3279 | Allowed |
| 9 | CWE-74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 342.3346 | 342.3346 | Discouraged |
| 10 | CWE-209 | Generation of Error Message Containing Sensitive Information | 339.3866 | 339.3866 | Allowed |
| 11 | CWE-918 | Server-Side Request Forgery (SSRF) | 337.9597 | 337.9597 | Allowed |
| 12 | CWE-400 | Uncontrolled Resource Consumption | 336.6723 | 336.6723 | Discouraged |
| 13 | CWE-787 | Out-of-bounds Write | 336.4972 | 336.4972 | Allowed |
| 14 | CWE-23 | Relative Path Traversal | 336.1732 | 336.1732 | Allowed |
| 15 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 335.3785 | 335.3785 | Allowed-with-Review |
