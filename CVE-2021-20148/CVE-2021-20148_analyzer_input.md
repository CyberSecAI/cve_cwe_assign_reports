# Vulnerability Information: CVE-2021-20148

## Vulnerability Description
ManageEngine ADSelfService Plus below build 6116 stores the password policy file for each domain under the html/ web root with a predictable filename based on the domain name. When ADSSP is configured with multiple Windows domains, a user from one domain can obtain the password policy for another domain by authenticating to the service and then sending a request specifying the password policy file of the other domain.

### Vulnerability Description Key Phrases
- **impact:** obtain the password policy for another domain
- **vector:** authenticating to the service and then sending a request specifying the password policy file of the other domain
- **attacker:** user from one domain
- **product:** ManageEngine ADSelfService Plus
- **version:** below build 6116

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2021-20148",
      "root_cause": "The application fails to properly restrict access to password policy information across multiple configured Windows domains.",
      "weaknesses": [
        "Information Disclosure"
      ],
      "impact": "A user from one domain can obtain the password policy of another domain.",
       "attack_vectors": [
        "The attacker must be a logged in user of one of the domains"
      ],
      "attacker_capabilities": "A user from one domain can gain access to the password policy information of another domain by making requests to specific URLs.",
       "additional_information": "The attacker needs to be a logged-in user of the application and requires knowledge of the targeted domain name to exploit the vulnerability.  The domain name is used to access a specific HTML file."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | 0.4095 | dense, sparse, graph | dense: 0.382, sparse: 0.110, graph: 0.531 |
| 2 | CWE-204 | Observable Response Discrepancy | Base | Allowed | 0.3325 | sparse, graph | sparse: 0.108, graph: 0.757 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.3308 | sparse, graph | sparse: 0.105, graph: 0.757 |
| 4 | CWE-219 | Storage of File with Sensitive Data Under Web Root | Variant | Allowed | 0.3124 | dense, sparse | dense: 0.452, sparse: 0.197 |
| 5 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1298 | dense, sparse | dense: 0.335, sparse: 0.094 |
| 6 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.0549 | sparse | sparse: 0.096 |
| 7 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.0548 | sparse | sparse: 0.096 |
| 8 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.0540 | sparse | sparse: 0.094 |
| 9 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.0537 | sparse | sparse: 0.094 |
| 10 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.0537 | sparse | sparse: 0.094 |

