{
  "cve_id": "CVE-2021-20148",
  "description": "ManageEngine ADSelfService Plus below build 6116 stores the password policy file for each domain under the html/ web root with a predictable filename based on the domain name. When ADSSP is configured with multiple Windows domains, a user from one domain can obtain the password policy for another domain by authenticating to the service and then sending a request specifying the password policy file of the other domain.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "obtain the password policy for another domain",
    "vector": "authenticating to the service and then sending a request specifying the password policy file of the other domain",
    "attacker": "user from one domain",
    "product": "ManageEngine ADSelfService Plus",
    "version": "below build 6116",
    "component": ""
  },
  "reference_content": "```\n{\n  \"vulnerability_details\": [\n    {\n      \"cve_id\": \"CVE-2021-20148\",\n      \"root_cause\": \"The application fails to properly restrict access to password policy information across multiple configured Windows domains.\",\n      \"weaknesses\": [\n        \"Information Disclosure\"\n      ],\n      \"impact\": \"A user from one domain can obtain the password policy of another domain.\",\n       \"attack_vectors\": [\n        \"The attacker must be a logged in user of one of the domains\"\n      ],\n      \"attacker_capabilities\": \"A user from one domain can gain access to the password policy information of another domain by making requests to specific URLs.\",\n       \"additional_information\": \"The attacker needs to be a logged-in user of the application and requires knowledge of the targeted domain name to exploit the vulnerability.  The domain name is used to access a specific HTML file.\"\n    }\n  ]\n}\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-219 | Storage of File with Sensitive Data Under Web Root | 0.85 | Variant | Allowed | Primary CWE |\n| CWE-425 | Direct Request ('Forced Browsing') | 0.70 | Base | Allowed | Secondary Candidate |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.60 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.80\n*   **Evidence Strength:** HIGH\n\n- **Analysis and Justification:**  \n  - *Explanation:* The primary **weakness** is that the application stores sensitive password policy files under the web root with insufficient access control. The vulnerability description explicitly states that \"ManageEngine ADSelfService Plus below build 6116 stores the password policy file for each domain under the html/ web root with a predictable filename based on the domain name.\" This perfectly matches the description of CWE-219 (Storage of File with Sensitive Data Under Web Root), which is a Variant-level CWE and thus preferred. The CVE Reference Links Content Summary also reinforces this by stating that the application \"fails to properly restrict access to password policy information across multiple configured Windows domains\" leading to **Information Disclosure**. A secondary weakness exists because a user from one domain is able to directly request the password policy file of another domain, suggesting inadequate authorization checks which aligns with CWE-425 (Direct Request ('Forced Browsing')). Further, the fact that a user from one domain can access another domain's password policy file by modifying the request indicates a potential Authorization Bypass through a User-Controlled Key (CWE-639).\n\n  - *Relationship Analysis:* CWE-219 is a variant-level weakness, making it more specific than its potential parents. It doesn't have any direct relationships listed in the provided data, but its nature relates to improper file access control. CWE-425 and CWE-639 also don't have direct relationships listed, but they are both related to authorization issues.\n\n- **Confidence Score:**\n  - Confidence: 0.85 (High confidence due to direct evidence from the vulnerability description and CVE details supporting CWE-219 as the primary weakness, with secondary weaknesses CWE-425 and CWE-639 possible).",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-219 | Storage of File with Sensitive Data Under Web Root | 0.85 | Variant | Allowed | Primary CWE |\n| CWE-425 | Direct Request ('Forced Browsing') | 0.70 | Base | Allowed | Secondary Candidate |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.60 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.80\n*   **Evidence Strength:** HIGH\n\n- **Analysis and Justification:**  \n  - *Explanation:* The primary **weakness** is that the application stores sensitive password policy files under the web root with insufficient access control. The vulnerability description explicitly states that \"ManageEngine ADSelfService Plus below build 6116 stores the password policy file for each domain under the html/ web root with a predictable filename based on the domain name.\" This perfectly matches the description of CWE-219 (Storage of File with Sensitive Data Under Web Root), which is a Variant-level CWE and thus preferred. The CVE Reference Links Content Summary also reinforces this by stating that the application \"fails to properly restrict access to password policy information across multiple configured Windows domains\" leading to **Information Disclosure**. A secondary weakness exists because a user from one domain is able to directly request the password policy file of another domain, suggesting inadequate authorization checks which aligns with CWE-425 (Direct Request ('Forced Browsing')). Further, the fact that a user from one domain can access another domain's password policy file by modifying the request indicates a potential Authorization Bypass through a User-Controlled Key (CWE-639).\n\n  - *Relationship Analysis:* CWE-219 is a variant-level weakness, making it more specific than its potential parents. It doesn't have any direct relationships listed in the provided data, but its nature relates to improper file access control. CWE-425 and CWE-639 also don't have direct relationships listed, but they are both related to authorization issues.\n\n- **Confidence Score:**\n  - Confidence: 0.85 (High confidence due to direct evidence from the vulnerability description and CVE details supporting CWE-219 as the primary weakness, with secondary weaknesses CWE-425 and CWE-639 possible).",
  "criticism": "Okay, let's review the provided CWE analysis with the full CWE specifications.\n\n**Overall Assessment:**\n\nThe analysis is generally good and identifies the primary vulnerability well. The justifications provided for the chosen CWEs are well-reasoned and supported by the vulnerability description and CVE summary. The confidence scores are appropriate.  The inclusion of secondary CWE candidates is also valuable.\n\n**Detailed Review:**\n\n*   **CWE-219: Storage of File with Sensitive Data Under Web Root**\n\n    *   **Mapping Confidence:** 0.85 (Good)\n    *   **Justification:** The justification is strong and aligns perfectly with the CWE description. The core problem is storing sensitive password policy information directly under the web root without adequate access controls. The evidence provided is direct from the vulnerability description.\n    *   **CWE Specification Alignment:**  The full specification of CWE-219 reinforces this choice.  The extended description, potential mitigations (avoid storing under web root, access control permissions), and observed examples all fit the vulnerability scenario.\n    *   **Critique:** No issues. This is the most accurate primary CWE.\n\n*   **CWE-425: Direct Request ('Forced Browsing')**\n\n    *   **Mapping Confidence:** 0.70 (Reasonable)\n    *   **Justification:** The analysis argues that a user from one domain can directly request the password policy file of another domain, indicating missing authorization checks. This aligns with the description of CWE-425.\n    *   **CWE Specification Alignment:** The full specification of CWE-425 supports this. The extended description notes the false assumption that resources can only be reached through a given navigation path, which is relevant here.\n    *   **Critique:**  While valid, CWE-425 is somewhat general.  It's a consequence of the primary issue (CWE-219) rather than a completely independent flaw. The description doesn't directly state that the expected \"navigation path\" is being bypassed.\n\n*   **CWE-639: Authorization Bypass Through User-Controlled Key**\n\n    *   **Mapping Confidence:** 0.60 (Acceptable, but weakest of the three)\n    *   **Justification:**  The analysis suggests that modifying the request to access another domain's password policy file constitutes an authorization bypass through a user-controlled key (the domain name in the request).\n    *   **CWE Specification Alignment:**  The full specification describes how attackers can modify a key value to gain access to another user's data. The examples provided in the specification also discuss IDOR vulnerabilities.\n    *   **Critique:** This is the weakest fit. The \"key\" (domain name) is part of the request, and changing it allows access to another domain's resources. However, a better fit *might* be found among the children of CWE-863 (Incorrect Authorization).  The key here is that the *incorrect* authorization is happening because of how the application is *designed*: the file is accessible under the webroot.\n\n**Alternative CWE Considerations:**\n\n*   **CWE-522: Insufficiently Protected Credentials** While not the best fit, the retriever results included it as a high scoring option. However, this CWE is more about storing or transmitting credentials insecurely, which isn't the primary problem here. The vulnerability is about exposing policy files rather than credentials themselves.\n\n**Recommendations:**\n\n1.  **Confidence Levels:** The confidence levels are appropriate given the evidence and the nature of the vulnerability.\n\n2.  **Justification Refinement (CWE-639):** For CWE-639, re-evaluate if a more specific child of CWE-863 might be a better fit. Even if you stick with CWE-639, strengthen the justification by explicitly stating that the domain name in the request acts as a \"key\" that is being user-controlled to access unauthorized data.\n\n3.  **Mitigation Analysis:** While not explicitly requested, considering the mitigations suggested by each CWE would further strengthen the analysis.\n    *   For **CWE-219**, the obvious mitigation is to move the password policy files outside the web root and implement proper access controls.\n    *   For **CWE-425**, the mitigation is to apply stricter authorization checks to prevent direct access to the files.\n    *   For **CWE-639**, the mitigation would be to ensure that the \"key\" (domain name) cannot be directly modified by the user to access unauthorized data, perhaps by using session-based authentication or more robust access control mechanisms.\n\n**Revised Summary Table (with Minor Edits):**\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-219 | Storage of File with Sensitive Data Under Web Root | 0.85 | Variant | Allowed | Primary CWE |\n| CWE-425 | Direct Request ('Forced Browsing') | 0.70 | Base | Allowed | Secondary Candidate |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.60 | Base | Allowed | Secondary Candidate |\n\n**In conclusion, the analysis is sound and provides a good foundation for understanding and addressing this vulnerability.  The minor suggestions above would further refine the mapping and demonstrate a deeper understanding of the CWE specifications.**",
  "resolution": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-219 | Storage of File with Sensitive Data Under Web Root | 0.90 | Variant | Allowed | Primary CWE |\n| CWE-425 | Improper Access Control | 0.70 | Base | Allowed | Secondary Candidate |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.60 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship influencing the decision is the specificity of CWE-219 as a Variant, making it a more precise match than broader Class or Base CWEs. CWE-425 and CWE-639 are considered as contributing factors related to authorization, but they are less direct than the core issue of storing sensitive files under the web root. The abstraction levels guided the selection towards the most detailed and applicable CWE.\n\n```mermaid\ngraph TD\n    cwe219[\"CWE-219: Storage of File with Sensitive Data Under Web Root\"]\n    cwe425[\"CWE-425: Improper Access Control\"]\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe219 primary\n    class cwe425,cwe639 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **ROOTCAUSE** being the insecure storage of sensitive password policy files under the web root (CWE-219). This leads to an increased risk of unauthorized access because these files are directly accessible. A user from one domain can then directly request these files (CWE-425), potentially bypassing intended authorization controls. By manipulating the request (e.g., changing the domain name), a user can further bypass authorization and access another domain's password policy files (CWE-639). This results in **Information Disclosure**.\n\n## Summary of Analysis\nThe initial analysis and criticism were well-reasoned and largely accurate. The decision to classify the primary **weakness** as CWE-219 (Storage of File with Sensitive Data Under Web Root) is strongly supported by the vulnerability description: \"ManageEngine ADSelfService Plus below build 6116 stores the password policy file for each domain under the html/ web root with a predictable filename based on the domain name.\" This is a direct quote from the vulnerability description, which clearly indicates the insecure storage of sensitive data under the web root.\n\nThe graph relationships reinforced this decision, as CWE-219 is a Variant-level CWE, making it more specific and relevant than a broader Class or Base CWE. While CWE-425 and CWE-639 are valid secondary candidates, they are consequences of the primary **weakness** (CWE-219).\n\nThe selected CWEs are at the optimal level of specificity because they directly address the root cause of the vulnerability (CWE-219) and its contributing factors (CWE-425 and CWE-639).",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "CWE-942",
        "name": "Permissive Cross-domain Policy with Untrusted Domains",
        "type": "Variant",
        "original_content": "The product uses a cross-domain policy file that includes domains that should not be trusted.",
        "relationships": [],
        "original_sparse_score": 136.9716552470046,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.38155991093843,
            "sparse": 136.9716552470046,
            "graph": 1.48783076824619
          },
          "normalized_scores": {
            "dense": 0.38155991093843,
            "sparse": 0.10957732419760369,
            "graph": 0.5313681315164964
          },
          "weighted_scores": {
            "dense": 0.1335459688284505,
            "sparse": 0.04383092967904148,
            "graph": 0.1328420328791241
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.38155991093843,
              "query_max": 0.45156166447574086,
              "query_min": 0.33462968574408963,
              "normalized_score": 0.38155991093843,
              "weight": 0.35,
              "weighted_score": 0.1335459688284505
            },
            "sparse": {
              "raw_score": 136.9716552470046,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.10957732419760369,
              "weight": 0.4,
              "weighted_score": 0.04383092967904148
            },
            "graph": {
              "raw_score": 1.48783076824619,
              "query_max": 2.2100000000000004,
              "query_min": 1.4654626100755195,
              "normalized_score": 0.5313681315164964,
              "weight": 0.25,
              "weighted_score": 0.1328420328791241
            }
          },
          "contribution_percentages": {
            "dense": 43.04894231681057,
            "sparse": 14.129031224215128,
            "graph": 42.822026458974314
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.31021893138661605,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.37226271766393926
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.37226271766393926
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.40948898943033324
            }
          },
          "combined_score": 0.40948898943033324
        }
      },
      "similarity": 0.40948898943033324
    },
    {
      "metadata": {
        "doc_id": "CWE-204",
        "name": "Observable Response Discrepancy",
        "type": "Base",
        "original_content": "The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere.",
        "relationships": [],
        "original_sparse_score": 135.42436930923552,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 135.42436930923552,
            "graph": 2.1189999999999998
          },
          "normalized_scores": {
            "sparse": 0.10833949544738841,
            "graph": 0.7567857142857143
          },
          "weighted_scores": {
            "sparse": 0.043335798178955366,
            "graph": 0.18919642857142857
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 135.42436930923552,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.10833949544738841,
              "weight": 0.4,
              "weighted_score": 0.043335798178955366
            },
            "graph": {
              "raw_score": 2.1189999999999998,
              "query_max": 2.2100000000000004,
              "query_min": 1.4654626100755195,
              "normalized_score": 0.7567857142857143,
              "weight": 0.25,
              "weighted_score": 0.18919642857142857
            }
          },
          "contribution_percentages": {
            "sparse": 18.636469785099933,
            "graph": 81.36353021490007
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.23253222675038393,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.3022918947754991
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.3022918947754991
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.33252108425304905
            }
          },
          "combined_score": 0.33252108425304905
        }
      },
      "similarity": 0.33252108425304905
    },
    {
      "metadata": {
        "doc_id": "CWE-425",
        "name": "Direct Request ('Forced Browsing')",
        "type": "Base",
        "original_content": "The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",
        "relationships": [],
        "original_sparse_score": 131.65625039303438,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 131.65625039303438,
            "graph": 2.1189999999999998
          },
          "normalized_scores": {
            "sparse": 0.10532500031442751,
            "graph": 0.7567857142857143
          },
          "weighted_scores": {
            "sparse": 0.042130000125771006,
            "graph": 0.18919642857142857
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 131.65625039303438,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.10532500031442751,
              "weight": 0.4,
              "weighted_score": 0.042130000125771006
            },
            "graph": {
              "raw_score": 2.1189999999999998,
              "query_max": 2.2100000000000004,
              "query_min": 1.4654626100755195,
              "normalized_score": 0.7567857142857143,
              "weight": 0.25,
              "weighted_score": 0.18919642857142857
            }
          },
          "contribution_percentages": {
            "sparse": 18.212359202985017,
            "graph": 81.78764079701499
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.23132642869719958,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.30072435730635944
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.30072435730635944
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.3307967930369954
            }
          },
          "combined_score": 0.3307967930369954
        }
      },
      "similarity": 0.3307967930369954
    },
    {
      "metadata": {
        "doc_id": "CWE-219",
        "name": "Storage of File with Sensitive Data Under Web Root",
        "type": "Variant",
        "original_content": "The product stores sensitive data under the web document root with insufficient access control, which might make it accessible to untrusted parties.",
        "relationships": [],
        "original_sparse_score": 245.749495443328,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.45156166447574086,
            "sparse": 245.749495443328
          },
          "normalized_scores": {
            "dense": 0.45156166447574086,
            "sparse": 0.1965995963546624
          },
          "weighted_scores": {
            "dense": 0.1580465825665093,
            "sparse": 0.07863983854186496
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.45156166447574086,
              "query_max": 0.45156166447574086,
              "query_min": 0.33462968574408963,
              "normalized_score": 0.45156166447574086,
              "weight": 0.35,
              "weighted_score": 0.1580465825665093
            },
            "sparse": {
              "raw_score": 245.749495443328,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.1965995963546624,
              "weight": 0.4,
              "weighted_score": 0.07863983854186496
            }
          },
          "contribution_percentages": {
            "dense": 66.77467250820558,
            "sparse": 33.22532749179441
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.23668642110837426,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.2840237053300491
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.2840237053300491
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.31242607586305404
            }
          },
          "combined_score": 0.31242607586305404
        }
      },
      "similarity": 0.31242607586305404
    },
    {
      "metadata": {
        "doc_id": "CWE-522",
        "name": "Insufficiently Protected Credentials",
        "type": "Class",
        "original_content": "The product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.",
        "relationships": [],
        "original_sparse_score": 117.070561646343,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.33462968574408963,
            "sparse": 117.070561646343
          },
          "normalized_scores": {
            "dense": 0.33462968574408963,
            "sparse": 0.0936564493170744
          },
          "weighted_scores": {
            "dense": 0.11712039001043137,
            "sparse": 0.03746257972682976
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.33462968574408963,
              "query_max": 0.45156166447574086,
              "query_min": 0.33462968574408963,
              "normalized_score": 0.33462968574408963,
              "weight": 0.35,
              "weighted_score": 0.11712039001043137
            },
            "sparse": {
              "raw_score": 117.070561646343,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.0936564493170744,
              "weight": 0.4,
              "weighted_score": 0.03746257972682976
            }
          },
          "contribution_percentages": {
            "dense": 75.7653900746612,
            "sparse": 24.234609925338802
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.15458296973726113,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.12366637578980891
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.12366637578980891
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.12984969457929935
            }
          },
          "combined_score": 0.12984969457929935
        }
      },
      "similarity": 0.12984969457929935
    },
    {
      "metadata": {
        "doc_id": "CWE-639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "type": "Base",
        "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
        "relationships": [],
        "original_sparse_score": 119.91615815414198,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 119.91615815414198
          },
          "normalized_scores": {
            "sparse": 0.09593292652331359
          },
          "weighted_scores": {
            "sparse": 0.038373170609325435
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 119.91615815414198,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09593292652331359,
              "weight": 0.4,
              "weighted_score": 0.038373170609325435
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.038373170609325435,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.049885121792123066
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.049885121792123066
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05487363397133538
            }
          },
          "combined_score": 0.05487363397133538
        }
      },
      "similarity": 0.05487363397133538
    },
    {
      "metadata": {
        "doc_id": "CWE-78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 119.84208865418002,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 119.84208865418002
          },
          "normalized_scores": {
            "sparse": 0.09587367092334402
          },
          "weighted_scores": {
            "sparse": 0.038349468369337614
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 119.84208865418002,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09587367092334402,
              "weight": 0.4,
              "weighted_score": 0.038349468369337614
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.038349468369337614,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.0498543088801389
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.0498543088801389
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.0548397397681528
            }
          },
          "combined_score": 0.0548397397681528
        }
      },
      "similarity": 0.0548397397681528
    },
    {
      "metadata": {
        "doc_id": "CWE-288",
        "name": "Authentication Bypass Using an Alternate Path or Channel",
        "type": "Base",
        "original_content": "The product requires authentication, but the product has an alternate path or channel that does not require authentication.",
        "relationships": [],
        "original_sparse_score": 118.08517503470982,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 118.08517503470982
          },
          "normalized_scores": {
            "sparse": 0.09446814002776785
          },
          "weighted_scores": {
            "sparse": 0.03778725601110714
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 118.08517503470982,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09446814002776785,
              "weight": 0.4,
              "weighted_score": 0.03778725601110714
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.03778725601110714,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.04912343281443929
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04912343281443929
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05403577609588322
            }
          },
          "combined_score": 0.05403577609588322
        }
      },
      "similarity": 0.05403577609588322
    },
    {
      "metadata": {
        "doc_id": "CWE-79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "type": "Base",
        "original_content": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
        "relationships": [],
        "original_sparse_score": 117.43424942239085,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 117.43424942239085
          },
          "normalized_scores": {
            "sparse": 0.09394739953791267
          },
          "weighted_scores": {
            "sparse": 0.03757895981516507
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 117.43424942239085,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09394739953791267,
              "weight": 0.4,
              "weighted_score": 0.03757895981516507
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.03757895981516507,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.04885264775971459
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04885264775971459
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05373791253568605
            }
          },
          "combined_score": 0.05373791253568605
        }
      },
      "similarity": 0.05373791253568605
    },
    {
      "metadata": {
        "doc_id": "CWE-306",
        "name": "Missing Authentication for Critical Function",
        "type": "Base",
        "original_content": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.",
        "relationships": [],
        "original_sparse_score": 117.35986307527358,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 117.35986307527358
          },
          "normalized_scores": {
            "sparse": 0.09388789046021886
          },
          "weighted_scores": {
            "sparse": 0.03755515618408755
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 117.35986307527358,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09388789046021886,
              "weight": 0.4,
              "weighted_score": 0.03755515618408755
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.03755515618408755,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.04882170303931382
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04882170303931382
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.0537038733432452
            }
          },
          "combined_score": 0.0537038733432452
        }
      },
      "similarity": 0.0537038733432452
    },
    {
      "metadata": {
        "doc_id": "CWE-319",
        "name": "Cleartext Transmission of Sensitive Information",
        "type": "Base",
        "original_content": "The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.",
        "relationships": [],
        "original_sparse_score": 115.04373743463611,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 115.04373743463611
          },
          "normalized_scores": {
            "sparse": 0.0920349899477089
          },
          "weighted_scores": {
            "sparse": 0.03681399597908356
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 115.04373743463611,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.0920349899477089,
              "weight": 0.4,
              "weighted_score": 0.03681399597908356
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.03681399597908356,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.04785819477280863
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04785819477280863
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.052644014250089494
            }
          },
          "combined_score": 0.052644014250089494
        }
      },
      "similarity": 0.052644014250089494
    },
    {
      "metadata": {
        "doc_id": "CWE-183",
        "name": "Permissive List of Allowed Inputs",
        "type": "Base",
        "original_content": "The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are explicitly allowed by policy because the inputs are assumed to be safe, but the list is too permissive - that is, it allows an input that is unsafe, leading to resultant weaknesses.",
        "relationships": [],
        "original_sparse_score": 113.90507002063218,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 113.90507002063218
          },
          "normalized_scores": {
            "sparse": 0.09112405601650575
          },
          "weighted_scores": {
            "sparse": 0.0364496224066023
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 113.90507002063218,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09112405601650575,
              "weight": 0.4,
              "weighted_score": 0.0364496224066023
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.0364496224066023,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.047384509128583
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.047384509128583
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.0521229600414413
            }
          },
          "combined_score": 0.0521229600414413
        }
      },
      "similarity": 0.0521229600414413
    },
    {
      "metadata": {
        "doc_id": "CWE-321",
        "name": "Use of Hard-coded Cryptographic Key",
        "type": "Variant",
        "original_content": "The use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered.",
        "relationships": [],
        "original_sparse_score": 120.559315946684,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 120.559315946684
          },
          "normalized_scores": {
            "sparse": 0.0964474527573472
          },
          "weighted_scores": {
            "sparse": 0.038578981102938885
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 120.559315946684,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.0964474527573472,
              "weight": 0.4,
              "weighted_score": 0.038578981102938885
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.038578981102938885,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.04629477732352666
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04629477732352666
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05092425505587933
            }
          },
          "combined_score": 0.05092425505587933
        }
      },
      "similarity": 0.05092425505587933
    },
    {
      "metadata": {
        "doc_id": "CWE-923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "type": "Class",
        "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.",
        "relationships": [],
        "original_sparse_score": 132.75386137897576,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 132.75386137897576
          },
          "normalized_scores": {
            "sparse": 0.1062030891031806
          },
          "weighted_scores": {
            "sparse": 0.04248123564127224
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 132.75386137897576,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.1062030891031806,
              "weight": 0.4,
              "weighted_score": 0.04248123564127224
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.04248123564127224,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.033984988513017796
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.033984988513017796
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.035684237938668685
            }
          },
          "combined_score": 0.035684237938668685
        }
      },
      "similarity": 0.035684237938668685
    },
    {
      "metadata": {
        "doc_id": "CWE-451",
        "name": "User Interface (UI) Misrepresentation of Critical Information",
        "type": "Class",
        "original_content": "The user interface (UI) does not properly represent critical information to the user, allowing the information - or its source - to be obscured or spoofed. This is often a component in phishing attacks.",
        "relationships": [],
        "original_sparse_score": 126.93694555049007,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 126.93694555049007
          },
          "normalized_scores": {
            "sparse": 0.10154955644039206
          },
          "weighted_scores": {
            "sparse": 0.040619822576156824
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 126.93694555049007,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.10154955644039206,
              "weight": 0.4,
              "weighted_score": 0.040619822576156824
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.040619822576156824,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.03249585806092546
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.03249585806092546
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.03412065096397174
            }
          },
          "combined_score": 0.03412065096397174
        }
      },
      "similarity": 0.03412065096397174
    },
    {
      "metadata": {
        "doc_id": "CWE-863",
        "name": "Incorrect Authorization",
        "type": "Class",
        "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.",
        "relationships": [],
        "original_sparse_score": 118.9390664763469,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 118.9390664763469
          },
          "normalized_scores": {
            "sparse": 0.09515125318107752
          },
          "weighted_scores": {
            "sparse": 0.03806050127243101
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 118.9390664763469,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09515125318107752,
              "weight": 0.4,
              "weighted_score": 0.03806050127243101
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.03806050127243101,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.030448401017944812
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.030448401017944812
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.031970821068842054
            }
          },
          "combined_score": 0.031970821068842054
        }
      },
      "similarity": 0.031970821068842054
    },
    {
      "metadata": {
        "doc_id": "CWE-1390",
        "name": "Weak Authentication",
        "type": "Class",
        "original_content": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.",
        "relationships": [],
        "original_sparse_score": 118.0312962674748,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 118.0312962674748
          },
          "normalized_scores": {
            "sparse": 0.09442503701397983
          },
          "weighted_scores": {
            "sparse": 0.03777001480559194
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 118.0312962674748,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09442503701397983,
              "weight": 0.4,
              "weighted_score": 0.03777001480559194
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.03777001480559194,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.03021601184447355
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.03021601184447355
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.03172681243669723
            }
          },
          "combined_score": 0.03172681243669723
        }
      },
      "similarity": 0.03172681243669723
    },
    {
      "metadata": {
        "doc_id": "CWE-287",
        "name": "Improper Authentication",
        "type": "Class",
        "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
        "relationships": [],
        "original_sparse_score": 119.7260135538349,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.",
          "reasons": [
            "Frequent Misuse"
          ],
          "suggestions": [
            {
              "CweID": "1390",
              "Comment": "Weak Authentication"
            },
            {
              "CweID": "306",
              "Comment": "Missing Authentication for Critical Function"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 119.7260135538349
          },
          "normalized_scores": {
            "sparse": 0.09578081084306793
          },
          "weighted_scores": {
            "sparse": 0.03831232433722717
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 119.7260135538349,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09578081084306793,
              "weight": 0.4,
              "weighted_score": 0.03831232433722717
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.03831232433722717,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.03064985946978174
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.03064985946978174
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.",
                "reasons": [
                  "Frequent Misuse"
                ],
                "suggestions": [
                  {
                    "CweID": "1390",
                    "Comment": "Weak Authentication"
                  },
                  {
                    "CweID": "306",
                    "Comment": "Missing Authentication for Critical Function"
                  }
                ]
              },
              "score_after": 0.02451988757582539
            }
          },
          "combined_score": 0.02451988757582539
        }
      },
      "similarity": 0.02451988757582539
    },
    {
      "metadata": {
        "doc_id": "CWE-285",
        "name": "Improper Authorization",
        "type": "Class",
        "original_content": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.",
        "relationships": [],
        "original_sparse_score": 115.99090590443014,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.",
          "reasons": [
            "Abstraction"
          ],
          "suggestions": [
            {
              "CweID": "862",
              "Comment": "Missing Authorization"
            },
            {
              "CweID": "863",
              "Comment": "Incorrect Authorization"
            },
            {
              "CweID": "732",
              "Comment": "Incorrect Permission Assignment for Critical Resource"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 115.99090590443014
          },
          "normalized_scores": {
            "sparse": 0.0927927247235441
          },
          "weighted_scores": {
            "sparse": 0.03711708988941764
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 115.99090590443014,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.0927927247235441,
              "weight": 0.4,
              "weighted_score": 0.03711708988941764
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.03711708988941764,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.029693671911534117
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.029693671911534117
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.",
                "reasons": [
                  "Abstraction"
                ],
                "suggestions": [
                  {
                    "CweID": "862",
                    "Comment": "Missing Authorization"
                  },
                  {
                    "CweID": "863",
                    "Comment": "Incorrect Authorization"
                  },
                  {
                    "CweID": "732",
                    "Comment": "Incorrect Permission Assignment for Critical Resource"
                  }
                ]
              },
              "score_after": 0.023754937529227294
            }
          },
          "combined_score": 0.023754937529227294
        }
      },
      "similarity": 0.023754937529227294
    },
    {
      "metadata": {
        "doc_id": "CWE-657",
        "name": "Violation of Secure Design Principles",
        "type": "Class",
        "original_content": "The product violates well-established principles for secure design.",
        "relationships": [],
        "original_sparse_score": 113.7271267686861,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 113.7271267686861
          },
          "normalized_scores": {
            "sparse": 0.09098170141494888
          },
          "weighted_scores": {
            "sparse": 0.03639268056597955
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 113.7271267686861,
              "query_max": 245.749495443328,
              "query_min": 113.7271267686861,
              "normalized_score": 0.09098170141494888,
              "weight": 0.4,
              "weighted_score": 0.03639268056597955
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.03639268056597955,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.029114144452783642
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.029114144452783642
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.023291315562226914
            }
          },
          "combined_score": 0.023291315562226914
        }
      },
      "similarity": 0.023291315562226914
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-639",
      "CWE-219",
      "CWE-425"
    ],
    "critic_additional": [
      "CWE-522",
      "CWE-863"
    ]
  }
}