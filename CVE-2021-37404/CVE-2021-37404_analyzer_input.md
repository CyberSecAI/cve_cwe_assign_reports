# Vulnerability Information: CVE-2021-37404

## Vulnerability Description
There is a potential **heap buffer overflow** in Apache Hadoop libhdfs native code. Opening a file path provided by user without validation may result in a denial of service or arbitrary code execution. Users should upgrade to Apache Hadoop 2.10.2, 3.2.3, 3.3.2 or higher.

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **impact:** denial of service or arbitrary code execution
- **vector:** Opening a file path provided by user without validation
- **product:** Apache Hadoop
- **component:** libhdfs native code

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-37404:

**Root Cause of Vulnerability:**

- The vulnerability exists in Apache Hadoop versions prior to 2.10.2, 3.2.3, and 3.3.2.
- The specific nature of the vulnerability is not detailed in this advisory, but it's related to the core functionality of Apache Hadoop.

**Weaknesses/Vulnerabilities Present:**
- The vulnerability allows for potential sensitive information disclosure, data modification, or denial of service.
- This is a critical vulnerability with a CVSS score of 9.8.

**Impact of Exploitation:**
- **Disclosure of Sensitive Information:** An attacker may be able to gain access to sensitive data managed by the vulnerable Hadoop instance.
- **Addition or Modification of Data:** An attacker could potentially alter or insert data into the Hadoop system, leading to data integrity issues.
- **Denial of Service (DoS):** An attacker may be able to disrupt the normal functioning of the Hadoop service making it unavailable.

**Attack Vectors:**
- The attack vector is "Network", meaning the attacker can exploit this vulnerability remotely over a network.
- The attack complexity is "Low", indicating that the attack does not require specialized access or conditions.
- No special privileges are needed ("PR:N") for the attacker to perform the attack.
- No user interaction is required ("UI:N").
- Scope is Unchanged ("S:U") meaning the impact is only to the vulnerable component and not beyond.

**Required Attacker Capabilities/Position:**
- The attacker only needs network access to the vulnerable Hadoop instance.
- No special skills or privileges are necessary to exploit the vulnerability.

**Additional Information:**

- The advisory mentions that NetApp products incorporate Apache Hadoop and are therefore affected by this vulnerability.
- The advisory lists various NetApp products that are NOT affected, implying that the vulnerable versions are not present in those specific products.
- NetApp has published this advisory (NTAP-20220715-0007) to address this issue.
- No specific workarounds are available and users should apply the software patches once released by NetApp.
- NetApp is aware of public discussion of this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.6986 | dense, sparse, graph | dense: 0.513, sparse: 0.203, graph: 0.912 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6963 | dense, sparse, graph | dense: 0.500, sparse: 0.221, graph: 0.894 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6517 | dense, sparse, graph | dense: 0.505, sparse: 0.227, graph: 0.753 |
| 4 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.5374 | dense, sparse, graph | dense: 0.485, sparse: 0.186, graph: 0.652 |
| 5 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3992 | sparse, graph | sparse: 0.190, graph: 0.813 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3775 | dense, sparse | dense: 0.497, sparse: 0.225 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3716 | dense, sparse | dense: 0.544, sparse: 0.228 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3651 | sparse, graph | sparse: 0.213, graph: 0.680 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3480 | dense, sparse | dense: 0.521, sparse: 0.203 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3403 | dense, sparse | dense: 0.506, sparse: 0.202 |

