# Vulnerability Information: CVE-2020-35508

## Vulnerability Description
A flaw possibility of **race condition and incorrect initialization of the process id** was found in the Linux kernel child/parent process identification handling while filtering signal handlers. A local attacker is able to abuse this flaw to bypass checks to send any signal to a privileged process.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition and incorrect initialization of the process id**
- **impact:** bypass checks to send any signal to a privileged process
- **attacker:** local attacker
- **product:** Linux kernel
- **component:** child/parent process identification handling while filtering signal handlers

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2020-35508:

**1. Verification of CVE Relevance:**

The provided NetApp security advisory (NTAP-20210513-0006) directly references CVE-2020-35508 and describes a Linux kernel vulnerability. The advisory states, "Multiple NetApp products incorporate Linux Kernel. Linux Kernel versions through 5.12 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS)." This confirms the content's relevance to the specified CVE. The Red Hat Bugzilla entry also provides the CVE ID and details the vulnerability related to the Linux Kernel, further confirming the relation.

**2. Vulnerability Details:**

*   **Root Cause:** The root cause is a race condition during process creation when using `CLONE_PARENT` flag in the `copy_process` function. The parent's `exit_signal` value can be changed after being copied to the child process's `exit_signal`. Also, there is an issue of incorrect initialization of process ID.
*   **Weaknesses/Vulnerabilities:**
    *   A race condition exists during the cloning of a process with the `CLONE_PARENT` flag, specifically in how the `exit_signal` is handled, potentially leading to use of incorrect value.
    *   Incorrect initialization of the process ID (`self_exec_id` and `vtime_cpu`).
*   **Impact of Exploitation:**
    *   **Information Disclosure:** Sensitive information could be disclosed.
    *   **Data Modification:** Data could be added or modified.
    *   **Denial of Service (DoS):** Exploitation could lead to DoS.
    *   **Privilege Escalation:** A local attacker can bypass checks to send any signal to a privileged process.
*   **Attack Vectors:**
    *   Local access is required.
    *   The attacker needs to be able to trigger the vulnerable code path (fork with `CLONE_PARENT`).
*   **Required Attacker Capabilities/Position:**
    *   Local access to the system.
    *   Ability to execute code that spawns processes with the `CLONE_PARENT` flag set.

**3. Additional Details from the Content:**

*   The Red Hat Bugzilla entry indicates that the vulnerability related to incorrect initialization of the process ID is specific to Red Hat Enterprise Linux (starting from 8.3) and does not affect other upstream Linux distributions.
*   NetApp's advisory lists several affected products, including various Baseboard Management Controllers (BMCs), NetApp Cloud Backup, and NetApp SolidFire products, etc..
*   NetApp's advisory also specifies products that are not affected by this vulnerability.
*   The NetApp advisory provides a CVSS v3.1 score of 7.0 (HIGH) with the vector `CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H`.
*   The advisory mentions that NetApp is aware of public discussion surrounding the vulnerability.
*   The Red Hat Bugzilla entry also mentions that the patch from the upstream Linux kernel only fixes the "race condition" part of the vulnerability and that the patch for "incorrect initialization of the process id" was internal for RHEL.

**4. Summary:**

The content provides detailed information about CVE-2020-35508, showing the vulnerabilityâ€™s root cause being a race condition in the Linux kernel's `copy_process()` function and issues in process ID initialization, along with specific impact, attack vectors, and affected NetApp products. It also identifies that a complete fix requires both upstream and vendor-specific patches. The information goes beyond the basic CVE description by detailing the specific NetApp products affected, the nature of the vulnerability, and the type of access required for exploitation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-364 | Signal Handler Race Condition | Base | Allowed | 0.8327 | dense, sparse, graph | dense: 0.620, sparse: 0.288, graph: 1.000 |
| 2 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.6546 | dense, sparse, graph | dense: 0.513, sparse: 0.314, graph: 0.609 |
| 3 | CWE-366 | Race Condition within a Thread | Base | Allowed | 0.6278 | dense, sparse, graph | dense: 0.530, sparse: 0.251, graph: 0.613 |
| 4 | CWE-415 | Double Free | Variant | Allowed | 0.4824 | sparse, graph | sparse: 0.289, graph: 1.000 |
| 5 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4420 | sparse, graph | sparse: 0.279, graph: 0.789 |
| 6 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.3945 | dense, sparse, graph | dense: 0.552, sparse: 0.340, graph: 0.562 |
| 7 | CWE-828 | Signal Handler with Functionality that is not Asynchronous-Safe | Variant | Allowed | 0.3813 | dense, sparse | dense: 0.518, sparse: 0.269 |
| 8 | CWE-831 | Signal Handler Function Associated with Multiple Signals | Variant | Allowed | 0.3631 | dense, sparse | dense: 0.490, sparse: 0.259 |
| 9 | CWE-667 | Improper Locking | Class | Allowed-with-Review | 0.2534 | dense, sparse | dense: 0.521, sparse: 0.298 |
| 10 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.2494 | dense, sparse | dense: 0.530, sparse: 0.278 |

