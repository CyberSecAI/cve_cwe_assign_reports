# Raw Retriever Results for CVE-2020-8793

# Raw Retriever Results for CVE-2020-8793

## Query
OpenSMTPD before 6.6.4 allows local users to read arbitrary files (e.g., on some Linux distributions) because of a combination of an untrusted search path in makemap.c and race conditions in the offline functionality in smtpd.c.

## Keyphrases
- **rootcause**: untrusted search path in makemap.c and race conditions in offline functionality in smtpd.c

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4853 | 0.5182 | 0.4953 | 0.4928 | 20 |
| Sparse | 256.3564 | 354.7749 | 280.7663 | 270.9179 | 20 |
| Graph | 1.6153 | 2.4700 | 1.9599 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.4700 | Allowed |
| 2 | 426 | Untrusted Search Path | Base | 2.4072 | Allowed |
| 3 | 427 | Uncontrolled Search Path Element | Base | 2.3995 | Allowed |
| 4 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 5 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.2800 | Allowed |
| 6 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 7 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 8 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 1.9141 | Allowed |
| 10 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 11 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 12 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 13 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 14 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 15 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5182 | 0.5182 | Allowed |
| 2 | 426 | Untrusted Search Path | Base | 0.5110 | 0.5110 | Allowed |
| 3 | 250 | Execution with Unnecessary Privileges | Base | 0.5105 | 0.5105 | Allowed |
| 4 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.5055 | 0.5055 | Allowed |
| 5 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5008 | 0.5008 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4967 | 0.4967 | Allowed-with-Review |
| 7 | 306 | Missing Authentication for Critical Function | Base | 0.4961 | 0.4961 | Allowed |
| 8 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.4960 | 0.4960 | Allowed |
| 9 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.4953 | 0.4953 | Allowed |
| 10 | 606 | Unchecked Input for Loop Condition | Base | 0.4929 | 0.4929 | Allowed |
| 11 | 427 | Uncontrolled Search Path Element | Base | 0.4927 | 0.4927 | Allowed |
| 12 | 24 | Path Traversal: '../filedir' | Variant | 0.4902 | 0.4902 | Allowed |
| 13 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.4899 | 0.4899 | Allowed-with-Review |
| 14 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.4898 | 0.4898 | Allowed |
| 15 | 150 | Improper Neutralization of Escape, Meta, or Control Sequences | Variant | 0.4883 | 0.4883 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-427 | Uncontrolled Search Path Element | 354.7749 | 354.7749 | Allowed |
| 2 | CWE-250 | Execution with Unnecessary Privileges | 328.5630 | 328.5630 | Allowed |
| 3 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 320.6684 | 320.6684 | Allowed-with-Review |
| 4 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 290.0530 | 290.0530 | Allowed |
| 5 | CWE-426 | Untrusted Search Path | 286.3661 | 286.3661 | Allowed |
| 6 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 284.3644 | 284.3644 | Allowed |
| 7 | CWE-278 | Insecure Preserved Inherited Permissions | 284.1902 | 284.1902 | Allowed |
| 8 | CWE-667 | Improper Locking | 283.2269 | 283.2269 | Allowed-with-Review |
| 9 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 274.5951 | 274.5951 | Allowed |
| 10 | CWE-415 | Double Free | 271.4468 | 271.4468 | Allowed |
| 11 | CWE-476 | NULL Pointer Dereference | 270.3891 | 270.3891 | Allowed |
| 12 | CWE-190 | Integer Overflow or Wraparound | 267.7675 | 267.7675 | Allowed |
| 13 | CWE-23 | Relative Path Traversal | 265.9404 | 265.9404 | Allowed |
| 14 | CWE-121 | Stack-based Buffer Overflow | 264.9598 | 264.9598 | Allowed |
| 15 | CWE-328 | Use of Weak Hash | 264.9274 | 264.9274 | Allowed |
