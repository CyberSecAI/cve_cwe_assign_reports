# Vulnerability Information: CVE-2021-34394

## Vulnerability Description
Trusty contains a vulnerability in the NVIDIA OTE protocol that is present in all TAs. An **incorrect message stream deserialization** allows an attacker to use the malicious CA that is run by the user to cause the **buffer overflow**, which may lead to information disclosure and data modification.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect message stream deserialization**
- **weakness:** **buffer overflow**
- **impact:** ['information disclosure', 'data modification']
- **vector:** malicious CA
- **attacker:** attacker
- **product:** Trusty
- **component:** NVIDIA OTE protocol

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Incorrect message stream deserialization within the NVIDIA OTE protocol.
- **Weaknesses/vulnerabilities present**:  A buffer overflow due to improper deserialization of message streams.
- **Impact of exploitation**: Information disclosure and data modification.
- **Attack vectors**: A malicious client application (CA) run by a user can trigger the vulnerability in the TrustZone via an incorrect message deserialization.
- **Required attacker capabilities/position**: The attacker needs to have local access with user privileges and the ability to run a malicious client application.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.8589 | dense, sparse, graph | dense: 0.532, sparse: 0.411, graph: 1.000 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.7671 | dense, sparse, graph | dense: 0.530, sparse: 0.423, graph: 0.726 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.7350 | dense, sparse, graph | dense: 0.514, sparse: 0.398, graph: 0.698 |
| 4 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5856 | sparse, graph | sparse: 0.399, graph: 1.000 |
| 5 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.5553 | sparse, graph | sparse: 0.498, graph: 0.757 |
| 6 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4773 | dense, sparse | dense: 0.517, sparse: 0.382 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4769 | dense, sparse | dense: 0.509, sparse: 0.389 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4570 | dense, sparse | dense: 0.543, sparse: 0.391 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4545 | dense, sparse | dense: 0.525, sparse: 0.401 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4367 | dense, sparse | dense: 0.516, sparse: 0.376 |

