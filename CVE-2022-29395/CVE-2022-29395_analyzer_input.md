# Vulnerability Information: CVE-2022-29395

## Vulnerability Description
TOTOLINK N600R V4.3.0cu.7647_B20210106 was discovered to contain a **stack overflow** via the apcliKey parameter in the function FUN_0041bac4.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** TOTOLINK N600R
- **version:** V4.3.0cu.7647_B20210106
- **component:** function FUN_0041bac4

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability lies in the `FUN_0041bac4` function within the `/web_cste/cgi-bin/cstecgi.cgi` component of the router's web interface. This function retrieves the `apcliKey` parameter from a JSON request and copies it into a local stack variable without performing any length validation.
- **Weaknesses/vulnerabilities present:** Stack-based buffer overflow. The lack of a length check on the `apcliKey` parameter allows an attacker to provide an overly long input, overwriting data on the stack.
- **Impact of exploitation:** By overflowing the stack, an attacker can potentially overwrite the return address or other crucial stack data, potentially leading to arbitrary code execution on the device.
- **Attack vectors:** The vulnerability is triggered by sending a crafted JSON request to the `/web_cste/cgi-bin/cstecgi.cgi` endpoint, specifically targeting the `apcliKey` parameter with a string longer than the allocated buffer.
- **Required attacker capabilities/position:** The attacker must be able to send HTTP requests to the web interface of the vulnerable router. This typically implies the attacker needs to be on the same network as the router or have some form of remote network access.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5260 | dense, sparse, graph | dense: 0.545, sparse: 0.108, graph: 0.536 |
| 2 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.4454 | dense, sparse, graph | dense: 0.560, sparse: 0.114, graph: 0.384 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3693 | dense, sparse | dense: 0.611, sparse: 0.165 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3025 | dense, sparse | dense: 0.504, sparse: 0.088 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3021 | dense, sparse | dense: 0.504, sparse: 0.087 |
| 6 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.2935 | dense, sparse | dense: 0.490, sparse: 0.084 |
| 7 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2879 | dense, sparse | dense: 0.490, sparse: 0.098 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2826 | dense, sparse | dense: 0.506, sparse: 0.092 |
| 9 | CWE-790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | 0.1998 | dense, sparse | dense: 0.551, sparse: 0.113 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.1867 | dense, sparse | dense: 0.506, sparse: 0.113 |

