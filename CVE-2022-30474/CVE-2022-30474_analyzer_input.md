# Vulnerability Information: CVE-2022-30474

## Vulnerability Description
Tenda AC Series Router AC18_V15.03.05.19(6318) was discovered to contain a **heap overflow** in the httpd module when handling /goform/saveParentControlInfo request.

### Vulnerability Description Key Phrases
- **weakness:** **heap overflow**
- **product:** Tenda AC Series Router
- **version:** AC18_V15.03.05.19(6318)
- **component:** httpd module

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A heap overflow vulnerability exists in the `saveParentControlInfo` function due to the usage of `strcpy` without any length check when copying the user-provided `deviceId` parameter into a heap-based buffer.
- **Weaknesses/vulnerabilities present**: Heap overflow, specifically a buffer overflow due to the lack of length validation.
- **Impact of exploitation**: An attacker can cause a Denial of Service (DoS) or achieve Remote Code Execution (RCE) by sending a crafted `deviceId` parameter that overflows the buffer.
- **Attack vectors**: The vulnerability can be triggered by sending a GET request to the `/goform/saveParentControlInfo` page with a specially crafted `deviceId` parameter.
- **Required attacker capabilities/position**: An attacker needs to be able to send HTTP requests to the vulnerable Tenda router and specify an overly long `deviceId` parameter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5854 | dense, sparse, graph | dense: 0.556, sparse: 0.111, graph: 0.681 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3764 | dense, sparse | dense: 0.615, sparse: 0.175 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3610 | sparse, graph | sparse: 0.111, graph: 0.832 |
| 4 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3223 | dense, sparse | dense: 0.519, sparse: 0.109 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3126 | dense, sparse | dense: 0.527, sparse: 0.131 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2900 | dense, sparse | dense: 0.516, sparse: 0.098 |
| 7 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2742 | sparse, graph | sparse: 0.103, graph: 0.602 |
| 8 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.0639 | sparse | sparse: 0.121 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.0597 | sparse | sparse: 0.104 |
| 10 | CWE-193 | Off-by-one Error | Base | Allowed | 0.0582 | sparse | sparse: 0.102 |

