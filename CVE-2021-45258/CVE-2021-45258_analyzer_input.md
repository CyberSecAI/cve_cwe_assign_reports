# Vulnerability Information: CVE-2021-45258

## Vulnerability Description
A **stack overflow** vulnerability exists in gpac 1.1.0 via the gf_bifs_dec_proto_list function, which causes a segmentation fault and application crash.

### Vulnerability Description Key Phrases
- **rootcause:** **stack overflow**
- **impact:** segmentation fault and application crash
- **product:** gpac
- **version:** 1.1.0
- **component:** gf_bifs_dec_proto_list function

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability information:

**Root Cause:**
- A stack overflow vulnerability exists in the `gf_bifs_dec_proto_list()` function within the GPAC library.

**Weaknesses/Vulnerabilities:**
- Stack overflow due to improper handling of data within the `gf_bifs_dec_proto_list()` function.

**Impact of Exploitation:**
- Segmentation fault, causing the application to crash.
- Possible arbitrary code execution if the stack overflow is further exploited.

**Attack Vectors:**
- The vulnerability is triggered when parsing a crafted MP4 file with a specific structure, specifically when processing BIFS (Binary Interchange Format for Scenes) data.
- The `MP4Box` tool from GPAC is used to trigger the vulnerability through the `-lsr` option.

**Required Attacker Capabilities/Position:**
- The attacker needs to provide a specially crafted MP4 file to the vulnerable application (`MP4Box`).
- The attacker needs to have the ability to execute the application (`MP4Box`) with the crafted file.

**Additional Details:**
- The provided `gdb` output and backtrace clearly indicate a stack smashing detection, confirming the stack overflow.
- The vulnerability is triggered in the `gf_bifs_dec_proto_list` function, specifically when handling BIFS decoding, likely in the protocol list processing logic.
- The specific crafted MP4 file (`poc_8.zip`) is also provided.
- The issue was addressed and closed with commit `47a26a3`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.6222 | dense, sparse, graph | dense: 0.475, sparse: 0.127, graph: 0.872 |
| 2 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5776 | dense, sparse, graph | dense: 0.494, sparse: 0.150, graph: 0.685 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5690 | dense, sparse, graph | dense: 0.521, sparse: 0.139, graph: 0.640 |
| 4 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.3503 | sparse, graph | sparse: 0.119, graph: 0.789 |
| 5 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3457 | sparse, graph | sparse: 0.111, graph: 0.789 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3275 | dense, sparse | dense: 0.547, sparse: 0.142 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3123 | dense, sparse | dense: 0.490, sparse: 0.117 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3122 | dense, sparse | dense: 0.535, sparse: 0.123 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3118 | dense, sparse | dense: 0.485, sparse: 0.121 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3051 | dense, sparse | dense: 0.527, sparse: 0.117 |

