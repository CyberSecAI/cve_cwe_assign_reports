# Vulnerability Information: CVE-2021-41027

## Vulnerability Description
A **stack-based buffer overflow** in Fortinet FortiWeb version 6.4.1 and 6.4.0, allows an authenticated attacker to execute unauthorized code or commands via crafted certificates loaded into the device.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **impact:** execute unauthorized code or commands
- **vector:** crafted certificates
- **attacker:** authenticated attacker
- **product:** Fortinet FortiWeb
- **version:** version 6.4.1 and 6.4.0

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A type mismatch leads to a stack-based buffer overflow.
- **Weaknesses/vulnerabilities present:** Stack-based buffer overflow ([CWE-121]).
- **Impact of exploitation:** An authenticated attacker can execute unauthorized code or commands.
- **Attack vectors:** Crafted certificate during SAML login.
- **Required attacker capabilities/position:**  An attacker needs to be authenticated and needs to be able to perform SAML login using a crafted certificate.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7279 | dense, sparse, graph | dense: 0.553, sparse: 0.164, graph: 1.000 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4057 | dense, sparse | dense: 0.646, sparse: 0.203 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3919 | sparse, graph | sparse: 0.165, graph: 0.832 |
| 4 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3719 | dense, sparse | dense: 0.569, sparse: 0.153 |
| 5 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3610 | dense, sparse | dense: 0.563, sparse: 0.168 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3554 | dense, sparse | dense: 0.579, sparse: 0.167 |
| 7 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3402 | dense, sparse | dense: 0.562, sparse: 0.153 |
| 8 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.3155 | sparse, graph | sparse: 0.142, graph: 0.729 |
| 9 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3133 | sparse, graph | sparse: 0.153, graph: 0.631 |
| 10 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1639 | dense, sparse | dense: 0.557, sparse: 0.153 |

