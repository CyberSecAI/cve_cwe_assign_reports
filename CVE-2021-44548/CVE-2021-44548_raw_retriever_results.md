# Raw Retriever Results for CVE-2021-44548

# Raw Retriever Results for CVE-2021-44548

## Query
An Improper Input Validation vulnerability in DataImportHandler of Apache Solr allows an attacker to provide a Windows UNC path resulting in an SMB network call being made from the Solr host to another host on the network. If the attacker has wider access to the network, this may lead to SMB attacks, which may result in * The exfiltration of sensitive data such as OS user hashes (NTLM/LM hashes), * In case of misconfigured systems, SMB Relay Attacks which can lead to user impersonation on SMB Shares or, in a worse-case scenario, Remote Code Execution This issue affects all Apache Solr versions prior to 8.11.1. This issue only affects Windows.

## Keyphrases
- **rootcause**: Improper Input Validation

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4961 | 0.6216 | 0.5146 | 0.5071 | 20 |
| Sparse | 552.0768 | 1222.1729 | 604.0416 | 566.4281 | 20 |
| Graph | 1.3010 | 2.8652 | 1.7631 | 1.5606 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 73 | External Control of File Name or Path | base | 2.8652 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.8206 | Allowed |
| 3 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.2100 | Allowed |
| 5 | 322 | Key Exchange without Entity Authentication | base | 2.2100 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0856 | Allowed |
| 7 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 9 | 20 | Improper Input Validation | Class | 1.7427 | Discouraged |
| 10 | 427 | Uncontrolled Search Path Element | Base | 1.6189 | Allowed |
| 11 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.5024 | Allowed |
| 12 | 456 | Missing Initialization of a Variable | variant | 1.4170 | Allowed |
| 13 | 40 | Path Traversal: '\\UNC\share\name\' (Windows UNC Share) | Variant | 1.4052 | Allowed |
| 14 | 522 | Insufficiently Protected Credentials | class | 1.3648 | Allowed-with-Review |
| 15 | 172 | Encoding Error | class | 1.3600 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 40 | Path Traversal: '\\UNC\share\name\' (Windows UNC Share) | Variant | 0.6216 | 0.6216 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5304 | 0.5304 | Allowed |
| 3 | 67 | Improper Handling of Windows Device Names | Variant | 0.5219 | 0.5219 | Allowed |
| 4 | 427 | Uncontrolled Search Path Element | Base | 0.5193 | 0.5193 | Allowed |
| 5 | 24 | Path Traversal: '../filedir' | Variant | 0.5180 | 0.5180 | Allowed |
| 6 | 20 | Improper Input Validation | Class | 0.5162 | 0.5162 | Discouraged |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5158 | 0.5158 | Allowed |
| 8 | 426 | Untrusted Search Path | Base | 0.5157 | 0.5157 | Allowed |
| 9 | 115 | Misinterpretation of Input | Base | 0.5103 | 0.5103 | Allowed |
| 10 | 29 | Path Traversal: '\..\filename' | Variant | 0.5079 | 0.5079 | Allowed |
| 11 | 178 | Improper Handling of Case Sensitivity | Base | 0.5062 | 0.5062 | Allowed |
| 12 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | 0.5057 | 0.5057 | Allowed |
| 13 | 25 | Path Traversal: '/../filedir' | Variant | 0.5031 | 0.5031 | Allowed |
| 14 | 28 | Path Traversal: '..\filedir' | Variant | 0.5026 | 0.5026 | Allowed |
| 15 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.5020 | 0.5020 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-40 | Path Traversal: '\\UNC\share\name\' (Windows UNC Share) | 1222.1729 | 1222.1729 | Allowed |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 630.3082 | 630.3082 | Allowed |
| 3 | CWE-20 | Improper Input Validation | 602.3408 | 602.3408 | Discouraged |
| 4 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 594.2902 | 594.2902 | Allowed-with-Review |
| 5 | CWE-522 | Insufficiently Protected Credentials | 580.8673 | 580.8673 | Allowed-with-Review |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | 576.9197 | 576.9197 | Allowed |
| 7 | CWE-306 | Missing Authentication for Critical Function | 573.2687 | 573.2687 | Allowed |
| 8 | CWE-287 | Improper Authentication | 573.1345 | 573.1345 | Discouraged |
| 9 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 570.8615 | 570.8615 | Allowed |
| 10 | CWE-269 | Improper Privilege Management | 567.3832 | 567.3832 | Discouraged |
| 11 | CWE-347 | Improper Verification of Cryptographic Signature | 565.4730 | 565.4730 | Allowed |
| 12 | CWE-668 | Exposure of Resource to Wrong Sphere | 565.3067 | 565.3067 | Discouraged |
| 13 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | 565.2366 | 565.2366 | Allowed |
| 14 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 561.1751 | 561.1751 | Allowed-with-Review |
| 15 | CWE-863 | Incorrect Authorization | 560.4048 | 560.4048 | Allowed-with-Review |
