# Raw Retriever Results for CVE-2021-24122

# Raw Retriever Results for CVE-2021-24122

## Query
When serving resources from a network location using the NTFS file system, Apache Tomcat versions 10.0.0-M1 to 10.0.0-M9, 9.0.0.M1 to 9.0.39, 8.5.0 to 8.5.59 and 7.0.0 to 7.0.106 were susceptible to JSP source code disclosure in some configurations. The root cause was the unexpected behaviour of the JRE API File.getCanonicalPath() which in turn was caused by the inconsistent behaviour of the Windows API (FindFirstFileW) in some circumstances.

## Keyphrases
- **rootcause**: unexpected behaviour of the JRE API File.getCanonicalPath() and inconsistent behaviour of the Windows API (FindFirstFileW)

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5180 | 0.5856 | 0.5330 | 0.5290 | 20 |
| Sparse | 458.4119 | 852.0960 | 493.4651 | 475.1077 | 20 |
| Graph | 1.5210 | 2.5791 | 1.9855 | 2.0400 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 41 | Improper Resolution of Path Equivalence | Base | 2.5791 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.4700 | Allowed |
| 3 | 322 | Key Exchange without Entity Authentication | base | 2.2100 | Allowed |
| 4 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | base | 2.2100 | Allowed |
| 5 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 6 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.1806 | Allowed |
| 8 | 209 | Generation of Error Message Containing Sensitive Information | base | 2.1762 | Allowed |
| 9 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0856 | Allowed |
| 10 | 499 | Serializable Class Containing Sensitive Data | variant | 2.0400 | Allowed |
| 11 | 498 | Cloneable Class Containing Sensitive Information | variant | 2.0400 | Allowed |
| 12 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 13 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.8018 | Allowed |
| 14 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 15 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5856 | 0.5856 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5598 | 0.5598 | Allowed |
| 3 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.5570 | 0.5570 | Allowed |
| 4 | 41 | Improper Resolution of Path Equivalence | Base | 0.5465 | 0.5465 | Allowed |
| 5 | 427 | Uncontrolled Search Path Element | Base | 0.5362 | 0.5362 | Allowed |
| 6 | 24 | Path Traversal: '../filedir' | Variant | 0.5317 | 0.5317 | Allowed |
| 7 | 377 | Insecure Temporary File | Class | 0.5315 | 0.5315 | Allowed-with-Review |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.5312 | 0.5312 | Allowed-with-Review |
| 9 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | 0.5303 | 0.5303 | Allowed |
| 10 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | 0.5290 | 0.5290 | Allowed-with-Review |
| 11 | 40 | Path Traversal: '\\UNC\share\name\' (Windows UNC Share) | Variant | 0.5289 | 0.5289 | Allowed |
| 12 | 426 | Untrusted Search Path | Base | 0.5286 | 0.5286 | Allowed |
| 13 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.5283 | 0.5283 | Allowed |
| 14 | 49 | Path Equivalence: 'filename/' (Trailing Slash) | Variant | 0.5235 | 0.5235 | Allowed |
| 15 | 178 | Improper Handling of Case Sensitivity | Base | 0.5202 | 0.5202 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-41 | Improper Resolution of Path Equivalence | 852.0960 | 852.0960 | Allowed |
| 2 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 506.6314 | 506.6314 | Allowed-with-Review |
| 3 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 498.8141 | 498.8141 | Allowed |
| 4 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 490.6717 | 490.6717 | Discouraged |
| 5 | CWE-269 | Improper Privilege Management | 487.0400 | 487.0400 | Discouraged |
| 6 | CWE-863 | Incorrect Authorization | 483.3693 | 483.3693 | Allowed-with-Review |
| 7 | CWE-116 | Improper Encoding or Escaping of Output | 481.5558 | 481.5558 | Allowed-with-Review |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 477.1073 | 477.1073 | Allowed |
| 9 | CWE-306 | Missing Authentication for Critical Function | 476.0893 | 476.0893 | Allowed |
| 10 | CWE-73 | External Control of File Name or Path | 475.4504 | 475.4504 | Allowed |
| 11 | CWE-204 | Observable Response Discrepancy | 474.7649 | 474.7649 | Allowed |
| 12 | CWE-668 | Exposure of Resource to Wrong Sphere | 474.7063 | 474.7063 | Discouraged |
| 13 | CWE-532 | Insertion of Sensitive Information into Log File | 467.8321 | 467.8321 | Allowed |
| 14 | CWE-284 | Improper Access Control | 464.7446 | 464.7446 | Discouraged |
| 15 | CWE-522 | Insufficiently Protected Credentials | 460.7915 | 460.7915 | Allowed-with-Review |
