# Vulnerability Information: CVE-2022-32050

## Vulnerability Description
TOTOLINK T6 V4.1.9cu.5179_B20201015 was discovered to contain a **stack overflow** via the cloneMac parameter in the function FUN_0041af40.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** TOTOLINK T6
- **version:** V4.1.9cu.5179_B20201015
- **component:** function FUN_0041af40

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 156)
- CWE-120 (Count: 6)

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The vulnerability lies in the `/web_cste/cgi-bin/cstecgi.cgi` component where the `FUN_0041af40` function (at address 0x41af40) retrieves the `cloneMac` parameter from a JSON payload and copies it to stack-allocated local variables without verifying its length.",
  "Weaknesses/vulnerabilities present": "Stack buffer overflow due to unchecked copy of user-supplied data.",
  "Impact of exploitation": "The vulnerability allows for arbitrary code execution through a stack buffer overflow.",
  "Attack vectors": "The vulnerability can be exploited by sending a crafted JSON payload with an oversized `cloneMac` parameter to the `/web_cste/cgi-bin/cstecgi.cgi` endpoint.",
  "Required attacker capabilities/position": "The attacker must be able to send HTTP requests to the vulnerable router's web interface."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4956 | dense, sparse, graph | dense: 0.493, sparse: 0.103, graph: 0.532 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3652 | dense, sparse | dense: 0.586, sparse: 0.179 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3063 | dense, sparse | dense: 0.513, sparse: 0.087 |
| 4 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3007 | dense, sparse | dense: 0.495, sparse: 0.093 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.2964 | dense, sparse | dense: 0.494, sparse: 0.086 |
| 6 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.2950 | dense, sparse | dense: 0.491, sparse: 0.086 |
| 7 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.2917 | dense, sparse | dense: 0.519, sparse: 0.098 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2860 | dense, sparse | dense: 0.515, sparse: 0.091 |
| 9 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.2755 | dense, sparse | dense: 0.499, sparse: 0.085 |
| 10 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2687 | sparse, graph | sparse: 0.097, graph: 0.631 |

