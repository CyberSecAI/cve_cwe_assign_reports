# Vulnerability Information: CVE-2021-24020

## Vulnerability Description
A missing cryptographic step in the implementation of the hash digest algorithm in FortiMail 6.4.0 through 6.4.4, and 6.2.0 through 6.2.7 may allow an unauthenticated attacker to tamper with signed URLs by appending further data which allows bypass of signature verification.

### Vulnerability Description Key Phrases
- **rootcause:** **missing cryptographic step in the hash digest algorithm**
- **impact:** bypass signature verification
- **vector:** tamper with signed URLs
- **attacker:** unauthenticated attacker
- **product:** FortiMail
- **version:** 6.4.0 through 6.4.4, and 6.2.0 through 6.2.7

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A missing cryptographic step in the implementation of the hash digest algorithm.
- **Weaknesses/vulnerabilities present**: The hash digest algorithm used is vulnerable to extension attacks because of the missing cryptographic step. This allows tampering with signed URLs.
- **Impact of exploitation**: An unauthenticated attacker can bypass signature verification by appending data to the signed URL, leading to improper access control.
- **Attack vectors**: Tampering with signed URLs by appending extra data.
- **Required attacker capabilities/position**: The attacker does not need authentication and can be in a network position to intercept and modify signed URLs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-325 | Missing Cryptographic Step | Base | Allowed | 0.7938 | dense, sparse, graph | dense: 0.614, sparse: 0.442, graph: 0.654 |
| 2 | CWE-328 | Use of Weak Hash | Base | Allowed | 0.6602 | dense, sparse, graph | dense: 0.525, sparse: 0.312, graph: 0.612 |
| 3 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.6501 | dense, sparse, graph | dense: 0.535, sparse: 0.304, graph: 0.583 |
| 4 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.6441 | dense, sparse, graph | dense: 0.548, sparse: 0.263, graph: 0.614 |
| 5 | CWE-208 | Observable Timing Discrepancy | Base | Allowed | 0.4200 | sparse, graph | sparse: 0.241, graph: 0.789 |
| 6 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.3698 | dense, sparse | dense: 0.515, sparse: 0.250 |
| 7 | CWE-303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | 0.3695 | dense, sparse | dense: 0.483, sparse: 0.224 |
| 8 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.3217 | dense, sparse, graph | dense: 0.500, sparse: 0.284, graph: 0.378 |
| 9 | CWE-1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | 0.2312 | sparse, graph | sparse: 0.223, graph: 0.290 |
| 10 | CWE-345 | Insufficient Verification of Data Authenticity | Class | Discouraged | 0.2161 | dense, sparse, graph | dense: 0.483, sparse: 0.237, graph: 0.296 |

