# Vulnerability Information: CVE-2021-23138

## Vulnerability Description
WECON LeviStudioU Versions 2019-09-21 and prior are vulnerable to a **stack-based buffer overflow**, which may allow an attacker to remotely execute code.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **impact:** remotely execute code
- **attacker:** attacker
- **product:** LeviStudioU
- **version:** Versions 2019-09-21 and prior

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 8)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-23138:

**Root Cause of Vulnerability:**
*   The root cause is a **stack-based buffer overflow** vulnerability in WECON LeviStudioU software.

**Weaknesses/Vulnerabilities Present:**
*   **CWE-121: Stack-based Buffer Overflow**: The software does not properly validate the size of input data before copying it into a fixed-size buffer on the stack. This can cause data to be written beyond the buffer's boundaries, overwriting adjacent memory.

**Impact of Exploitation:**
*   Successful exploitation of the vulnerability may allow an attacker to achieve **remote code execution**. This means an attacker could potentially take full control of the system running the vulnerable software.

**Attack Vectors:**
*   The attack vector is through the HMI programming software, LeviStudioU. The advisory indicates that the exploitation is not remote, meaning the attacker needs some level of access to the target machine or network to trigger the overflow.

**Required Attacker Capabilities/Position:**
*   The attacker needs to be able to interact with the vulnerable software, likely through a malicious file or crafted network packet (the content does not specify exactly how the overflow is triggered). The CVSS vector string (AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H) indicates the attacker requires a "local" attack vector, "low" attack complexity, no privileges and user interaction.

**Additional Notes:**
* The document indicates that WECON has not responded to requests to work with CISA to mitigate the vulnerability.
* There is also a related vulnerability, CVE-2021-23157, which is a heap-based buffer overflow in the same software, which has the same impact.
*   No public exploits are known for this specific vulnerability.
*   The vulnerability affects versions of LeviStudioU from 2019-09-21 and prior.
*   The advisory lists the affected sectors as Critical Manufacturing, Energy, and Water and Wastewater Systems, indicating that this vulnerability could impact critical infrastructure.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4228 | sparse, graph | sparse: 0.149, graph: 1.000 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4125 | sparse, graph | sparse: 0.148, graph: 0.916 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3621 | dense, sparse | dense: 0.582, sparse: 0.176 |
| 4 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3600 | sparse, graph | sparse: 0.136, graph: 0.789 |
| 5 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3554 | dense, sparse | dense: 0.555, sparse: 0.135 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3249 | dense, sparse | dense: 0.554, sparse: 0.131 |
| 7 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3056 | sparse, graph | sparse: 0.130, graph: 0.647 |
| 8 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2094 | dense, sparse | dense: 0.551, sparse: 0.141 |
| 9 | CWE-676 | Use of Potentially Dangerous Function | Base | Allowed | 0.0884 | sparse | sparse: 0.155 |
| 10 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.0829 | sparse | sparse: 0.145 |

