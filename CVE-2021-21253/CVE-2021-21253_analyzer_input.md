# Vulnerability Information: CVE-2021-21253

## Vulnerability Description
OnlineVotingSystem is an open source project hosted on GitHub. OnlineVotingSystem before version 1.1.2 **hashes user passwords without a salt**, which is vulnerable to dictionary attacks. Therefore there is a threat of security breach in the voting system. Without a salt, it is much easier for attackers to pre-compute the hash value using dictionary attack techniques such as rainbow tables to crack passwords. This problem is fixed and published in version 1.1.2. A long randomly generated salt is added to the password hash function to better protect passwords stored in the voting system.

### Vulnerability Description Key Phrases
- **weakness:** **hashes user passwords without a salt**
- **impact:** crack passwords
- **vector:** dictionary attacks
- **attacker:** attackers
- **product:** OnlineVotingSystem
- **version:** before version 1.1.2

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**CVE ID:** CVE-2021-21253

**Root Cause of Vulnerability:**
The application was using a one-way hash (SHA-256) without a salt to store user passwords.

**Weaknesses/Vulnerabilities Present:**
- **Use of One-Way Hash without Salt (CWE-759):** The primary weakness was the absence of a salt when hashing passwords. This made the system vulnerable to dictionary attacks, rainbow tables, and other pre-computed hash techniques, increasing the likelihood of password compromise.

**Impact of Exploitation:**
- **Security Breach:** Successful exploitation could allow attackers to crack user passwords, leading to unauthorized access to accounts.
- **Compromise of the Voting System:**  With compromised accounts, an attacker could manipulate votes, alter system configurations or cause data loss within the online voting system.

**Attack Vectors:**
- **Dictionary Attacks:** Attackers could use pre-computed hash tables (rainbow tables) or dictionary attacks to match hashed passwords with potential plain-text passwords.
- **Pre-computed Hashes:** Due to the lack of a salt, the same password would always produce the same hash, making it easier to crack.

**Required Attacker Capabilities/Position:**
- **Access to password hashes:** The attacker would need access to the database containing the stored password hashes of users.

**Additional Information:**
- The vulnerability was present in OnlineVotingSystem versions prior to 1.1.2.
- The fix (in version 1.1.2) includes adding a long, randomly generated salt to the password hashing function.
- The commit `0181cb0272857696c8eb3e44fcf6cb014ff90f09` demonstrates a change that appears to add a salt to the SHA-256 hashing, though not yet correctly implemented (see the switch between `String password = sha.getSHA(request.getParameter("pass"));` and  `String password = request.getParameter("pass");` in `AdminLoginController.java` and `VoterLoginController.java`).
- The commit `bd4e6bc` mentioned in the references is the actual fix of this issue.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-759 | Use of a One-Way Hash without a Salt | Variant | Allowed | 0.9327 | dense, sparse, graph | dense: 0.645, sparse: 0.853, graph: 0.559 |
| 2 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.7803 | dense, sparse, graph | dense: 0.544, sparse: 0.506, graph: 0.612 |
| 3 | CWE-760 | Use of a One-Way Hash with a Predictable Salt | Variant | Allowed | 0.7366 | dense, sparse, graph | dense: 0.605, sparse: 0.519, graph: 0.554 |
| 4 | CWE-328 | Use of Weak Hash | Base | Allowed | 0.7188 | dense, sparse, graph | dense: 0.471, sparse: 0.468, graph: 0.602 |
| 5 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.4363 | dense, sparse | dense: 0.466, sparse: 0.355 |
| 6 | CWE-1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | 0.4316 | dense, sparse | dense: 0.457, sparse: 0.355 |
| 7 | CWE-1391 | Use of Weak Credentials | Class | Allowed-with-Review | 0.2524 | dense, sparse | dense: 0.450, sparse: 0.358 |
| 8 | CWE-1390 | Weak Authentication | Class | Allowed-with-Review | 0.2440 | sparse, graph | sparse: 0.412, graph: 0.503 |
| 9 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.2243 | sparse | sparse: 0.392 |
| 10 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.2145 | sparse | sparse: 0.375 |

