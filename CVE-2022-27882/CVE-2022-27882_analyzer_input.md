# Vulnerability Information: CVE-2022-27882

## Vulnerability Description
slaacd in OpenBSD 6.9 and 7.0 before 2022-03-22 has an **integer signedness error** and resultant heap-based buffer overflow triggerable by a crafted IPv6 router advertisement. NOTE privilege separation and pledge can prevent exploitation.

### Vulnerability Description Key Phrases
- **rootcause:** **integer signedness error**
- **impact:** heap-based buffer overflow
- **vector:** crafted IPv6 router advertisement
- **product:** OpenBSD
- **version:** 6.9 and 7.0 before 2022-03-22
- **component:** slaacd

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2022-27882:

**Root Cause of Vulnerability:**

The vulnerability stems from the mishandling of the length field within domain name labels inside a DNS Search List (DNSSL) option of a Router Advertisement (RA) message. The `parse_dnssl` function in OpenBSD's `slaacd` daemon uses a signed integer to store the length of a domain name label. This allows for a negative value when parsing the length field of a malformed DNSSL option.

**Weaknesses/Vulnerabilities Present:**

*   **Signed Integer Handling:** The core weakness is the use of a signed integer (`int len`) to read the length field of a domain label. This allows for a crafted negative length, which bypasses checks in the parsing logic.
*   **Heap Overflow:**  A crafted negative length value bypasses sanity checks and is then used in `memcpy`, leading to a heap buffer overflow because the `memcpy` interprets the negative length as a very large unsigned value.

**Impact of Exploitation:**

*   **Denial of Service (DoS):**  The heap overflow caused by the vulnerability leads to a crash of the `slaacd` daemon due to memory corruption, resulting in a denial of service. The service will no longer be able to configure IPv6 addresses on the machine.

**Attack Vectors:**

*   **Network-based:** The attack is network-based and exploits the IPv6 Neighbor Discovery protocol.
*   **Malicious Router Advertisement:** The attack involves sending a crafted Router Advertisement (RA) message with a malformed DNSSL option. The malicious RA can be sent to a target system via the network.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to be on the same network segment as the target machine to send crafted RA messages.
*   **Ability to Send IPv6 Packets:** The attacker needs to be able to send IPv6 packets, specifically ICMPv6 Router Advertisement messages.
*   **No Authentication Required:** The vulnerability can be triggered without any authentication.

**Additional Details:**

*   The vulnerability lies within the `parse_dnssl` function in `sbin/slaacd/engine.c`.
*   The blog post from Quarkslab provides detailed information and a proof-of-concept (PoC) using Scapy library.
*   Patches were released by OpenBSD to address the vulnerability in versions 6.9 and 7.0.
*   The vulnerability is considered unlikely to be exploited for remote code execution due to the nature of the heap overflow.
*   NetApp products incorporate OpenBSD, which made them vulnerable to this issue, as documented in their security advisory. However, the advisory states that none of the listed NetApp products are affected.
*   The provided patches removed the vulnerable `parse_dnssl` function, along with the associated data structures and code.

This information is more detailed than the typical CVE description, providing a clear understanding of the vulnerability, its impact, and how to exploit it.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.7472 | dense, sparse, graph | dense: 0.526, sparse: 0.389, graph: 0.905 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6722 | dense, sparse, graph | dense: 0.583, sparse: 0.187, graph: 0.764 |
| 3 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.6223 | dense, sparse, graph | dense: 0.587, sparse: 0.196, graph: 0.605 |
| 4 | CWE-194 | Unexpected Sign Extension | Variant | Allowed | 0.5813 | dense, sparse, graph | dense: 0.558, sparse: 0.171, graph: 0.707 |
| 5 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.4629 | sparse, graph | sparse: 0.184, graph: 1.000 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3656 | dense, sparse | dense: 0.545, sparse: 0.162 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3538 | dense, sparse | dense: 0.536, sparse: 0.149 |
| 8 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3522 | dense, sparse | dense: 0.530, sparse: 0.152 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3476 | dense, sparse | dense: 0.571, sparse: 0.159 |
| 10 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3459 | dense, sparse | dense: 0.557, sparse: 0.168 |

