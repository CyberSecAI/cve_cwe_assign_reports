# Raw Retriever Results for CVE-2022-39392

# Raw Retriever Results for CVE-2022-39392

## Query
Wasmtime is a standalone runtime for WebAssembly. Prior to version 2.0.2, there is a bug in Wasmtimes implementation of its pooling instance allocator when the allocator is configured to give WebAssembly instances a maximum of zero pages of memory. In this configuration, the virtual memory mapping for WebAssembly memories did not meet the compiler-required configuration requirements for safely executing WebAssembly modules. Wasmtimes default settings require virtual memory page faults to indicate that wasm reads/writes are out-of-bounds, but the pooling allocators configuration would not create an appropriate virtual memory mapping for this meaning out of bounds reads/writes can successfully read/write memory unrelated to the wasm sandbox within range of the base address of the memory mapping created by the pooling allocator. This bug is not applicable with the default settings of the `wasmtime` crate. This bug can only be triggered by setting `InstanceLimitsmemory_pages` to zero. This is expected to be a very rare configuration since this means that wasm modules cannot allocate any pages of linear memory. All wasm modules produced by all current toolchains are highly likely to use linear memory, so its expected to be unlikely that this configuration is set to zero by any production embedding of Wasmtime. This bug has been patched and users should upgrade to Wasmtime 2.0.2. This bug can be worked around by increasing the `memory_pages` allotment when configuring the pooling allocator to a value greater than zero. If an embedding wishes to still prevent memory from actually being used then the `Storelimiter` method can be used to dynamically disallow growth of memory beyond 0 bytes large. Note that the default `memory_pages` value is greater than zero.

## Keyphrases
- **rootcause**: incorrect virtual memory mapping for WebAssembly memories

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4242 | 0.5202 | 0.4461 | 0.4350 | 20 |
| Sparse | 1291.1802 | 2303.2102 | 1408.0960 | 1322.7935 | 20 |
| Graph | 1.6848 | 2.9988 | 2.0922 | 2.2025 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.9988 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | Base | 2.4624 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.2774 | Allowed |
| 6 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 2.2442 | Allowed |
| 7 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 8 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | Variant | 2.1951 | Allowed |
| 12 | 195 | Signed to Unsigned Conversion Error | variant | 2.0088 | Allowed |
| 13 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 1.9163 | Allowed |
| 14 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 194 | Unexpected Sign Extension | Variant | 0.5202 | 0.5202 | Allowed |
| 2 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.5133 | 0.5133 | Allowed |
| 3 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 0.4624 | 0.4624 | Allowed |
| 4 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4608 | 0.4608 | Allowed |
| 5 | 762 | Mismatched Memory Management Routines | Variant | 0.4591 | 0.4591 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4563 | 0.4563 | Allowed |
| 7 | 786 | Access of Memory Location Before Start of Buffer | Base | 0.4452 | 0.4452 | Discouraged |
| 8 | 1246 | Improper Write Handling in Limited-write Non-Volatile Memories | Base | 0.4423 | 0.4423 | Allowed |
| 9 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4372 | 0.4372 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4363 | 0.4363 | Allowed |
| 11 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4336 | 0.4336 | Allowed |
| 12 | 909 | Missing Initialization of Resource | Class | 0.4321 | 0.4321 | Allowed-with-Review |
| 13 | 404 | Improper Resource Shutdown or Release | Class | 0.4314 | 0.4314 | Allowed-with-Review |
| 14 | 590 | Free of Memory not on the Heap | Variant | 0.4313 | 0.4313 | Allowed |
| 15 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 0.4311 | 0.4311 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-125 | Out-of-bounds Read | 2303.2102 | 2303.2102 | Allowed |
| 2 | CWE-194 | Unexpected Sign Extension | 1786.4260 | 1786.4260 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1449.0482 | 1449.0482 | Allowed |
| 4 | CWE-770 | Allocation of Resources Without Limits or Throttling | 1417.9793 | 1417.9793 | Allowed |
| 5 | CWE-190 | Integer Overflow or Wraparound | 1416.8384 | 1416.8384 | Allowed |
| 6 | CWE-789 | Memory Allocation with Excessive Size Value | 1412.7059 | 1412.7059 | Allowed |
| 7 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 1345.9036 | 1345.9036 | Allowed |
| 8 | CWE-863 | Incorrect Authorization | 1342.0354 | 1342.0354 | Allowed-with-Review |
| 9 | CWE-400 | Uncontrolled Resource Consumption | 1327.8771 | 1327.8771 | Discouraged |
| 10 | CWE-909 | Missing Initialization of Resource | 1323.9240 | 1323.9240 | Allowed-with-Review |
| 11 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 1321.6629 | 1321.6629 | Allowed-with-Review |
| 12 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 1315.7616 | 1315.7616 | Allowed-with-Review |
| 13 | CWE-306 | Missing Authentication for Critical Function | 1311.4842 | 1311.4842 | Allowed |
| 14 | CWE-668 | Exposure of Resource to Wrong Sphere | 1303.7417 | 1303.7417 | Discouraged |
| 15 | CWE-754 | Improper Check for Unusual or Exceptional Conditions | 1303.6493 | 1303.6493 | Allowed-with-Review |
