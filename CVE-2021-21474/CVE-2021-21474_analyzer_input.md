# Vulnerability Information: CVE-2021-21474

## Vulnerability Description
SAP HANA Database, versions - 1.0, 2.0, accepts SAML tokens with MD5 digest, an attacker who manages to obtain an MD5-digest signed SAML Assertion issued for an SAP HANA instance might be able to tamper with it and alter it in a way that the digest continues to be the same and without invalidating the digital signature, this allows them to impersonate as user in HANA database and be able to read the contents in the database.

### Vulnerability Description Key Phrases
- **rootcause:** **use of MD5 digest**
- **weakness:** **signature spoofing**
- **impact:** impersonate user, read database contents
- **attacker:** attacker
- **product:** SAP HANA Database
- **version:** 1.0, 2.0
- **component:** SAML token authentication

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-328 | Use of Weak Hash | Base | Allowed | 1.0047 | dense, sparse, graph | dense: 0.438, sparse: 1.000, graph: 0.598 |
| 2 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.7756 | dense, sparse, graph | dense: 0.411, sparse: 0.643, graph: 0.565 |
| 3 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.7668 | dense, sparse, graph | dense: 0.443, sparse: 0.579, graph: 0.599 |
| 4 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.6454 | sparse, graph | sparse: 0.593, graph: 0.857 |
| 5 | CWE-760 | Use of a One-Way Hash with a Predictable Salt | Variant | Allowed | 0.3865 | dense, sparse | dense: 0.433, sparse: 0.353 |
| 6 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3185 | sparse | sparse: 0.557 |
| 7 | CWE-611 | Improper Restriction of XML External Entity Reference | Base | Allowed | 0.3172 | sparse | sparse: 0.555 |
| 8 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.3124 | sparse | sparse: 0.546 |
| 9 | CWE-325 | Missing Cryptographic Step | Base | Allowed | 0.3120 | sparse | sparse: 0.545 |
| 10 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.3043 | sparse, graph | sparse: 0.591, graph: 0.503 |

