# Raw Retriever Results for CVE-2021-21474

# Raw Retriever Results for CVE-2021-21474

## Query
SAP HANA Database, versions - 1.0, 2.0, accepts SAML tokens with MD5 digest, an attacker who manages to obtain an MD5-digest signed SAML Assertion issued for an SAP HANA instance might be able to tamper with it and alter it in a way that the digest continues to be the same and without invalidating the digital signature, this allows them to impersonate as user in HANA database and be able to read the contents in the database.

## Keyphrases
- **rootcause**: use of MD5 digest
- **weakness**: signature spoofing

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3910 | 0.4430 | 0.4129 | 0.4089 | 20 |
| Sparse | 426.2883 | 1291.0288 | 701.8925 | 695.8767 | 20 |
| Graph | 1.0062 | 2.3998 | 1.5489 | 1.5254 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 319 | Cleartext Transmission of Sensitive Information | base | 2.3998 | Allowed |
| 2 | 208 | Observable Timing Discrepancy | base | 2.2100 | Allowed |
| 3 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.0400 | Allowed |
| 4 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.8918 | Allowed |
| 5 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 6 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 1.7552 | Allowed |
| 7 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 1.6762 | Allowed |
| 8 | 328 | Use of Weak Hash | Base | 1.6734 | Allowed |
| 9 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 1.5975 | Allowed |
| 10 | 347 | Improper Verification of Cryptographic Signature | Base | 1.5818 | Allowed |
| 11 | 1270 | Generation of Incorrect Security Tokens | Base | 1.4691 | Allowed |
| 12 | 327 | Use of a Broken or Risky Cryptographic Algorithm | class | 1.4080 | Allowed-with-Review |
| 13 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | class | 1.3600 | Allowed-with-Review |
| 14 | 613 | Insufficient Session Expiration | base | 1.2974 | Allowed |
| 15 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.2880 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 0.4430 | 0.4430 | Allowed |
| 2 | 328 | Use of Weak Hash | Base | 0.4376 | 0.4376 | Allowed |
| 3 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 0.4360 | 0.4360 | Allowed |
| 4 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 0.4339 | 0.4339 | Allowed |
| 5 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4333 | 0.4333 | Allowed |
| 6 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 0.4331 | 0.4331 | Allowed |
| 7 | 304 | Missing Critical Step in Authentication | Base | 0.4136 | 0.4136 | Allowed |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | 0.4111 | 0.4111 | Allowed |
| 9 | 287 | Improper Authentication | Class | 0.4110 | 0.4110 | Discouraged |
| 10 | 640 | Weak Password Recovery Mechanism for Forgotten Password | Base | 0.4091 | 0.4091 | Allowed-with-Review |
| 11 | 759 | Use of a One-Way Hash without a Salt | Variant | 0.4088 | 0.4088 | Allowed |
| 12 | 305 | Authentication Bypass by Primary Weakness | Base | 0.4074 | 0.4074 | Allowed |
| 13 | 1230 | Exposure of Sensitive Information Through Metadata | Base | 0.4063 | 0.4063 | Allowed |
| 14 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.4033 | 0.4033 | Allowed |
| 15 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 0.4022 | 0.4022 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-328 | Use of Weak Hash | 1291.0288 | 1291.0288 | Allowed |
| 2 | CWE-347 | Improper Verification of Cryptographic Signature | 803.9072 | 803.9072 | Allowed |
| 3 | CWE-668 | Exposure of Resource to Wrong Sphere | 761.3699 | 761.3699 | Discouraged |
| 4 | CWE-319 | Cleartext Transmission of Sensitive Information | 740.8158 | 740.8158 | Allowed |
| 5 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 739.1992 | 739.1992 | Allowed-with-Review |
| 6 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | 723.5197 | 723.5197 | Allowed |
| 7 | CWE-522 | Insufficiently Protected Credentials | 719.4312 | 719.4312 | Allowed-with-Review |
| 8 | CWE-287 | Improper Authentication | 716.8245 | 716.8245 | Discouraged |
| 9 | CWE-345 | Insufficient Verification of Data Authenticity | 714.6967 | 714.6967 | Discouraged |
| 10 | CWE-306 | Missing Authentication for Critical Function | 695.9908 | 695.9908 | Allowed |
| 11 | CWE-1390 | Weak Authentication | 695.7625 | 695.7625 | Allowed-with-Review |
| 12 | CWE-74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 694.4184 | 694.4184 | Discouraged |
| 13 | CWE-611 | Improper Restriction of XML External Entity Reference | 693.2519 | 693.2519 | Allowed |
| 14 | CWE-259 | Use of Hard-coded Password | 691.5049 | 691.5049 | Allowed |
| 15 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 690.4253 | 690.4253 | Allowed-with-Review |
