# Vulnerability Information: CVE-2021-35324

## Vulnerability Description
A vulnerability in the Form_Login function of TOTOLINK A720R A720R_Firmware V4.1.5cu.470_B20200911 allows attackers to bypass authentication.

### Vulnerability Description Key Phrases
- **impact:** bypass authentication
- **attacker:** attackers
- **product:** TOTOLINK A720R
- **version:** A720R_Firmware V4.1.5cu.470_B20200911
- **component:** Form_Login function

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `Form_Login` function in the TOTOLINK A720R router firmware contains a login bypass vulnerability.
- **Weaknesses/vulnerabilities present**: The `getNthValueSafe` function loops through URL parameters. If a parameter named `authCode` is present and its value is `1`, a critical authentication check is bypassed.
- **Impact of exploitation**: A remote attacker can bypass the login authentication and gain access to the admin page without needing the correct password.
- **Attack vectors**: The vulnerability is triggered by sending a crafted GET request to the `/formLoginAuth.htm` endpoint. The request must contain the `authCode=1` parameter along with a `userName` parameter (e.g., `userName=admin`)
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the router's web interface. This usually means being on the same network or having network access to the device.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.5574 | dense, sparse, graph | dense: 0.587, sparse: 0.037, graph: 0.809 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5018 | dense, sparse, graph | dense: 0.529, sparse: 0.032, graph: 0.612 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.4560 | dense, sparse, graph | dense: 0.492, sparse: 0.022, graph: 0.551 |
| 4 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.2780 | sparse, graph | sparse: 0.042, graph: 0.711 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.2691 | dense, sparse | dense: 0.511, sparse: 0.024 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2428 | dense, sparse | dense: 0.493, sparse: 0.028 |
| 7 | CWE-790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | 0.1624 | dense, sparse | dense: 0.523, sparse: 0.026 |
| 8 | CWE-77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | 0.1571 | dense, sparse | dense: 0.502, sparse: 0.029 |
| 9 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1246 | dense, sparse | dense: 0.531, sparse: 0.022 |
| 10 | CWE-208 | Observable Timing Discrepancy | Base | Allowed | 0.0136 | sparse | sparse: 0.024 |

