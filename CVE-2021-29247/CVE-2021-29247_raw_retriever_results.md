# Raw Retriever Results for CVE-2021-29247

# Raw Retriever Results for CVE-2021-29247

## Query
BTCPay Server through 1.0.7.0 could allow a remote attacker to obtain sensitive information, caused by failure to set the HTTPOnly flag for a cookie.

## Keyphrases
- **rootcause**: failure to set the HTTPOnly flag for a cookie

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4479 | 0.5955 | 0.4867 | 0.4628 | 20 |
| Sparse | 180.8230 | 403.8733 | 209.5767 | 189.6206 | 20 |
| Graph | 0.9624 | 2.2100 | 1.3909 | 1.3338 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 4 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 1.7222 | Allowed |
| 5 | 319 | Cleartext Transmission of Sensitive Information | Base | 1.7015 | Allowed |
| 6 | 312 | Cleartext Storage of Sensitive Information | Base | 1.6484 | Allowed |
| 7 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 1.5552 | Allowed |
| 8 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 1.5348 | Allowed |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 10 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 11 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.1466 | Allowed |
| 12 | 523 | Unprotected Transport of Credentials | Base | 1.1192 | Allowed |
| 13 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.0584 | Allowed |
| 14 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.9754 | Allowed |
| 15 | 5 | J2EE Misconfiguration: Data Transmission Without Encryption | variant | 0.9624 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.5955 | 0.5955 | Allowed |
| 2 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.5860 | 0.5860 | Allowed |
| 3 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 0.5390 | 0.5390 | Allowed |
| 4 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.5309 | 0.5309 | Allowed |
| 5 | 539 | Use of Persistent Cookies Containing Sensitive Information | Variant | 0.5244 | 0.5244 | Allowed |
| 6 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | 0.5163 | 0.5163 | Allowed |
| 7 | 315 | Cleartext Storage of Sensitive Information in a Cookie | Variant | 0.5153 | 0.5153 | Allowed |
| 8 | 550 | Server-generated Error Message Containing Sensitive Information | Variant | 0.4668 | 0.4668 | Allowed |
| 9 | 488 | Exposure of Data Element to Wrong Session | Base | 0.4668 | 0.4668 | Allowed |
| 10 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.4666 | 0.4666 | Allowed |
| 11 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.4591 | 0.4591 | Allowed |
| 12 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | 0.4560 | 0.4560 | Allowed |
| 13 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.4550 | 0.4550 | Allowed |
| 14 | 603 | Use of Client-Side Authentication | Base | 0.4534 | 0.4534 | Allowed |
| 15 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4526 | 0.4526 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | 403.8733 | 403.8733 | Allowed |
| 2 | CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 322.2542 | 322.2542 | Allowed |
| 3 | CWE-319 | Cleartext Transmission of Sensitive Information | 227.1183 | 227.1183 | Allowed |
| 4 | CWE-312 | Cleartext Storage of Sensitive Information | 222.6366 | 222.6366 | Allowed |
| 5 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 198.0748 | 198.0748 | Allowed |
| 6 | CWE-784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | 195.4446 | 195.4446 | Allowed |
| 7 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 195.3723 | 195.3723 | Allowed |
| 8 | CWE-311 | Missing Encryption of Sensitive Data | 194.4166 | 194.4166 | Discouraged |
| 9 | CWE-287 | Improper Authentication | 192.8684 | 192.8684 | Discouraged |
| 10 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 189.8900 | 189.8900 | Allowed |
| 11 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 189.3512 | 189.3512 | Allowed-with-Review |
| 12 | CWE-1390 | Weak Authentication | 187.4768 | 187.4768 | Allowed-with-Review |
| 13 | CWE-214 | Invocation of Process Using Visible Sensitive Information | 187.3277 | 187.3277 | Allowed |
| 14 | CWE-522 | Insufficiently Protected Credentials | 187.0570 | 187.0570 | Allowed-with-Review |
| 15 | CWE-639 | Authorization Bypass Through User-Controlled Key | 185.6423 | 185.6423 | Allowed |
