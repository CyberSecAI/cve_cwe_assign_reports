# Vulnerability Information: CVE-2021-46483

## Vulnerability Description
Jsish v3.5.0 was discovered to contain a **heap buffer overflow** via BooleanConstructor at src/jsiBool.c.

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **product:** Jsish
- **version:** v3.5.0
- **component:** BooleanConstructor at src/jsiBool.c

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A heap-buffer-overflow occurs in the `BooleanConstructor` function in `src/jsiBool.c` at line 17. The vulnerability is triggered when calling `Boolean.bind(a)()` within the `JSEtest` function and later used in the `Array.prototype.unshift` function.
- **Weaknesses/vulnerabilities present**: Heap-buffer-overflow. Specifically, a write of size 4 occurs at a memory location 6 bytes beyond the allocated region.
- **Impact of exploitation**: The heap-buffer-overflow can lead to arbitrary code execution or denial of service, potentially compromising the integrity or availability of the application. The provided crash information from AddressSanitizer highlights that an out-of-bounds write occurred, which is a classic symptom of a buffer overflow.
- **Attack vectors**: The vulnerability can be triggered by executing JavaScript code that uses the `Boolean.bind()` method in combination with array operations (`Array.prototype.unshift`). The specific JavaScript test case is provided in the issue, detailing how the overflow is triggered.
- **Required attacker capabilities/position**: An attacker needs to be able to execute crafted JavaScript code within the context of the vulnerable jsish interpreter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6323 | dense, sparse, graph | dense: 0.485, sparse: 0.110, graph: 0.914 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5922 | dense, sparse, graph | dense: 0.506, sparse: 0.111, graph: 0.771 |
| 3 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.5678 | dense, sparse, graph | dense: 0.501, sparse: 0.091, graph: 0.741 |
| 4 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.5083 | dense, sparse, graph | dense: 0.467, sparse: 0.109, graph: 0.593 |
| 5 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4847 | dense, sparse, graph | dense: 0.528, sparse: 0.105, graph: 0.562 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3385 | sparse, graph | sparse: 0.098, graph: 0.789 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3205 | dense, sparse | dense: 0.521, sparse: 0.151 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.2989 | dense, sparse | dense: 0.494, sparse: 0.090 |
| 9 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.2960 | dense, sparse | dense: 0.468, sparse: 0.108 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2860 | dense, sparse | dense: 0.494, sparse: 0.110 |

