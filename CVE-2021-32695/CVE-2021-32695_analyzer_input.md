# Vulnerability Information: CVE-2021-32695

## Vulnerability Description
Nextcloud Android app is the Android client for Nextcloud. In versions prior to 3.16.1, a malicious app on the same device could have gotten access to the shared preferences of the Nextcloud Android application. This required user-interaction as a victim had to initiate the sharing flow and choose the malicious app. The shared preferences contain some limited private data such as push tokens and the account name. The vulnerability is patched in version 3.16.1.

### Vulnerability Description Key Phrases
- **impact:** access to shared preferences of Nextcloud Android application
- **attacker:** malicious app on the same device
- **product:** Nextcloud Android app
- **version:** prior to 3.16.1

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-32695:

**Root Cause of Vulnerability:**
The vulnerability stems from the Nextcloud Android client's shared preferences being accessible to other applications on the same device. This was due to insufficient protection of the shared preferences, allowing a malicious app to potentially read sensitive information.

**Weaknesses/Vulnerabilities Present:**
- **Information Exposure:** The primary weakness is the exposure of sensitive data stored within the application's shared preferences.
- **Insufficient Access Control:** The application lacks proper access control mechanisms to prevent other applications from accessing its shared preferences.

**Impact of Exploitation:**
- A malicious application, upon being selected by the user during the sharing flow, could gain access to the Nextcloud app's shared preferences.
- This could lead to the disclosure of limited private data, including:
  - Push tokens
  - Account names

**Attack Vectors:**
- **Malicious Application:** The attack requires a malicious Android application to be installed on the victim's device.
- **User Interaction:** The victim must initiate a sharing flow and choose the malicious application as the target.

**Required Attacker Capabilities/Position:**
- **On-device presence:** The attacker needs to have a malicious application installed on the same Android device as the vulnerable Nextcloud client.
- **User interaction:** The attacker needs the user to willingly select their malicious application during a sharing procedure initiated by the user within the Nextcloud app.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.4848 | dense, sparse, graph | dense: 0.407, sparse: 0.136, graph: 0.569 |
| 2 | CWE-209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | 0.4097 | dense, sparse, graph | dense: 0.405, sparse: 0.115, graph: 0.396 |
| 3 | CWE-226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | 0.3514 | sparse, graph | sparse: 0.121, graph: 0.789 |
| 4 | CWE-93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | 0.2872 | dense, sparse | dense: 0.440, sparse: 0.117 |
| 5 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.2842 | dense, sparse | dense: 0.427, sparse: 0.123 |
| 6 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.2766 | sparse, graph | sparse: 0.130, graph: 0.565 |
| 7 | CWE-459 | Incomplete Cleanup | Base | Allowed | 0.2726 | dense, sparse | dense: 0.411, sparse: 0.117 |
| 8 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.1732 | dense, sparse | dense: 0.445, sparse: 0.126 |
| 9 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1713 | dense, sparse | dense: 0.446, sparse: 0.119 |
| 10 | CWE-1390 | Weak Authentication | Class | Allowed-with-Review | 0.1443 | sparse, graph | sparse: 0.125, graph: 0.487 |

