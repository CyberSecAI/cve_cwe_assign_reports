# Vulnerability Information: CVE-2021-46480

## Vulnerability Description
Jsish v3.5.0 was discovered to contain a **heap buffer overflow** via jsiValueObjDelete in src/jsiEval.c. This vulnerability can lead to a Denial of Service (DoS).

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **impact:** Denial of Service (DoS)
- **product:** Jsish
- **version:** v3.5.0
- **component:** jsiValueObjDelete in src/jsiEval.c

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A heap-buffer-overflow occurs in the `jsiValueObjDelete` function within `src/jsiEval.c` at line 464 when deleting a property of an array after unshifting elements into the array.
- **Weaknesses/vulnerabilities present:** Heap-buffer-overflow, specifically a read of size 8 at a wild pointer location.
- **Impact of exploitation:** The heap-buffer-overflow can lead to program crashes and potentially allow for arbitrary code execution if exploited further.
- **Attack vectors:** The vulnerability is triggered by manipulating an array in JavaScript, specifically setting a property, deleting a property, and unshifting elements into the array, through the execution of the crafted JavaScript code in the `jsish` interpreter.
- **Required attacker capabilities/position:** An attacker needs the ability to execute arbitrary Javascript code through the `jsish` interpreter.

The provided information includes a detailed error log of the heap-buffer-overflow and a minimal test case that can trigger it, including a full stack trace of the error. It also mentions that the vulnerability was found by the OWL337 team. This is more detail than a typical CVE description provides.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6900 | dense, sparse, graph | dense: 0.530, sparse: 0.170, graph: 0.916 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6534 | dense, sparse, graph | dense: 0.539, sparse: 0.169, graph: 0.802 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5297 | dense, sparse, graph | dense: 0.556, sparse: 0.166, graph: 0.561 |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5027 | dense, sparse, graph | dense: 0.522, sparse: 0.146, graph: 0.443 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3703 | dense, sparse | dense: 0.555, sparse: 0.216 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3669 | sparse, graph | sparse: 0.148, graph: 0.789 |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3481 | dense, sparse | dense: 0.529, sparse: 0.146 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3461 | dense, sparse | dense: 0.551, sparse: 0.173 |
| 9 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3191 | dense, sparse | dense: 0.524, sparse: 0.146 |
| 10 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.2952 | sparse, graph | sparse: 0.140, graph: 0.602 |

