# Vulnerability Information: CVE-2020-7063

## Vulnerability Description
In PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3, when creating PHAR archive using PharDatabuildFromIterator() function, the **files are added with default permissions (0666, or all access)** even if the original files on the filesystem were with more restrictive permissions. This may result in files having more lax permissions than intended when such archive is extracted.

### Vulnerability Description Key Phrases
- **weakness:** **files are added with default permissions (0666, or all access)**
- **impact:** files having more lax permissions than intended
- **product:** PHP
- **version:** 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3
- **component:** PharDatabuildFromIterator() function

## CVE Reference Links Content Summary
```
{
  "CVE-2020-7063": {
    "description": "In PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3, when creating PHAR archive using PharData::buildFromIterator() function, the files are added with default permissions (0666, or all access) even if the original files on the filesystem were with more restrictive permissions. This may result in files having more lax permissions than intended when such archive is extracted.",
    "root_cause": "Incorrect handling of file permissions when creating PHAR archives using PharData::buildFromIterator(). Files are added with default permissions (0666), ignoring original file permissions.",
    "vulnerabilities": [
      "Incorrect file permissions"
    ],
    "impact": "Files within created PHAR archives may have overly permissive access rights (0666) when extracted, potentially leading to sensitive information disclosure or unintended modifications.",
    "attack_vectors": [
      "Creating a PHAR archive with PharData::buildFromIterator() using files with restrictive permissions"
    ],
   "required_capabilities": "An attacker needs the ability to create PHAR archive and potentially influence the content added to the archive."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-281 | Improper Preservation of Permissions | Base | Allowed | 0.7711 | dense, sparse, graph | dense: 0.448, sparse: 0.580, graph: 0.603 |
| 2 | CWE-379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | 0.5460 | dense, sparse, graph | dense: 0.371, sparse: 0.309, graph: 0.514 |
| 3 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.5064 | sparse, graph | sparse: 0.334, graph: 0.882 |
| 4 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.4965 | sparse, graph | sparse: 0.317, graph: 0.882 |
| 5 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | 0.4001 | sparse, graph | sparse: 0.305, graph: 0.631 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3343 | sparse, graph | sparse: 0.307, graph: 0.488 |
| 7 | CWE-277 | Insecure Inherited Permissions | Variant | Allowed | 0.3167 | dense, sparse | dense: 0.351, sparse: 0.293 |
| 8 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2973 | sparse, graph | sparse: 0.331, graph: 0.886 |
| 9 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.1693 | sparse | sparse: 0.296 |
| 10 | CWE-359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | 0.1656 | sparse | sparse: 0.289 |

