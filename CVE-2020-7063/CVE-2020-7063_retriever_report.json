{
  "cve_id": "CVE-2020-7063",
  "query": "In PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3, when creating PHAR archive using PharDatabuildFromIterator() function, the files are added with default permissions (0666, or all access) even if the original files on the filesystem were with more restrictive permissions. This may result in files having more lax permissions than intended when such archive is extracted.",
  "keyphrases": {
    "weakness": "files are added with default permissions (0666, or all access)"
  },
  "timestamp": "2025-03-16T22:46:06.236790",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 3,
      "average_score": 0.3896912266474848,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.33606683389346126,
      "unique_finds": 2
    },
    "graph": {
      "hit_count": 7,
      "average_score": 0.6980985607414507,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-281",
      "name": "Improper Preservation of Permissions",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7711,
      "retriever_count": 0,
      "dense_score": 0.4476,
      "sparse_score": 0.5795,
      "graph_score": 0.6031
    },
    {
      "cwe_id": "CWE-379",
      "name": "Creation of Temporary File in Directory with Insecure Permissions",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.546,
      "retriever_count": 0,
      "dense_score": 0.3708,
      "sparse_score": 0.3091,
      "graph_score": 0.5137
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5064,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.334,
      "graph_score": 0.8821
    },
    {
      "cwe_id": "CWE-23",
      "name": "Relative Path Traversal",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4965,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.3166,
      "graph_score": 0.8821
    },
    {
      "cwe_id": "CWE-59",
      "name": "Improper Link Resolution Before File Access ('Link Following')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4001,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.3049,
      "graph_score": 0.6314
    },
    {
      "cwe_id": "CWE-94",
      "name": "Improper Control of Generation of Code ('Code Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.3343,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.307,
      "graph_score": 0.4884
    },
    {
      "cwe_id": "CWE-277",
      "name": "Insecure Inherited Permissions",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.3167,
      "retriever_count": 0,
      "dense_score": 0.3507,
      "sparse_score": 0.293,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-732",
      "name": "Incorrect Permission Assignment for Critical Resource",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.2973,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.3313,
      "graph_score": 0.8857
    },
    {
      "cwe_id": "CWE-250",
      "name": "Execution with Unnecessary Privileges",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.1693,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.296,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-359",
      "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.1656,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.2894,
      "graph_score": "-"
    }
  ]
}