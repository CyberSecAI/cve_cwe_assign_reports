# Vulnerability Information: CVE-2021-27328

## Vulnerability Description
Yeastar NeoGate TG400 91.3.0.3 devices are affected by Directory Traversal. An authenticated user can decrypt firmware and can read sensitive information, such as a password or decryption key.

### Vulnerability Description Key Phrases
- **rootcause:** **directory traversal**
- **impact:** decrypt firmware and read sensitive information
- **attacker:** authenticated user
- **product:** Yeastar NeoGate TG400
- **version:** 91.3.0.3

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-27328:

**Root Cause of Vulnerability:**

*   The vulnerability is a **path traversal** issue. This means that an attacker can manipulate file paths to access files or directories outside of the intended scope.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure handling of user-supplied input:** The `WebCGI` parameter `1404` in the URL is vulnerable to path traversal. By manipulating the path value, an attacker can access sensitive files in the file system.

**Impact of Exploitation:**

*   **Information Disclosure:** An attacker can access sensitive files such as `/etc/passwd` and firmware decryption passwords.
*   **Potential for further attacks:** Access to configuration files and firmware decryption keys can expose the system to further compromise.

**Attack Vectors:**

*   **HTTP GET Request Manipulation:** An attacker can exploit the vulnerability by crafting a specially crafted HTTP GET request to the vulnerable web interface, manipulating the `1404` parameter in the query string.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to have network access to the vulnerable Yeastar device (e.g., Yeastar TG400 GSM Gateway).
*   **Basic HTTP Knowledge:**  The attacker needs to understand how to craft HTTP GET requests and manipulate query string parameters.
*  **No authentication required:** The provided examples show that the vulnerability can be exploited without prior authentication.

**Technical Details:**

*   The vulnerable parameter is `1404` in the `WebCGI` endpoint.
*   The attacker uses `../../` sequences to traverse directories upwards and access files outside of the intended web root, such as `/etc/passwd` and `/bin/firmware_detect`.

**Additional Notes:**

*   The provided content is a Proof of Concept (PoC).
*   The specific example URLs provided in the Github content demonstrates the vulnerability.

**Summary:**

The vulnerability in Yeastar TG400 GSM Gateway (CVE-2021-27328) is a path traversal flaw that allows an attacker to access sensitive files by manipulating the '1404' parameter in 'WebCGI'. This access to unauthorized files can lead to information disclosure and further compromise.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.5908 | dense, sparse, graph | dense: 0.542, sparse: 0.138, graph: 0.811 |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.5747 | dense, sparse, graph | dense: 0.511, sparse: 0.178, graph: 0.608 |
| 3 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.4007 | sparse, graph | sparse: 0.149, graph: 0.882 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3354 | dense, sparse | dense: 0.526, sparse: 0.126 |
| 5 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.3249 | dense, sparse | dense: 0.504, sparse: 0.127 |
| 6 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.3244 | dense, sparse | dense: 0.505, sparse: 0.125 |
| 7 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.3229 | dense, sparse | dense: 0.508, sparse: 0.120 |
| 8 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | 0.2977 | sparse, graph | sparse: 0.126, graph: 0.631 |
| 9 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.2918 | sparse, graph | sparse: 0.139, graph: 0.594 |
| 10 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1949 | dense, sparse | dense: 0.517, sparse: 0.128 |

