# Vulnerability Information: CVE-2021-45907

## Vulnerability Description
An issue was discovered in gif2apng 1.9. There is a **stack-based buffer overflow** involving a for loop. An attacker has little influence over the data written to the stack, making it unlikely that the flow of control can be subverted.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **impact:** unlikely that the flow of control can be subverted
- **attacker:** attacker
- **product:** gif2apng
- **version:** 1.9

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 6)

## CVE Reference Links Content Summary
The content relates to CVE-2021-45907.

- **Root cause of vulnerability**: Two stack-based buffer overflows exist in the `DecodeLZW` function of the gif2apng application.
- **Weaknesses/vulnerabilities present**: The `DecodeLZW` function has insufficient bounds checking when writing to the `suffix` and `str` buffers. Specifically, the for loop iterates based on a `clearcode` which can exceed the buffer size, and the while loop can infinitely write to the `str` buffer if `prefix[code]` results in the same `code` again.
- **Impact of exploitation**: The stack buffer overflows lead to a segmentation fault, crashing the application. While direct code execution is not stated, the report notes that no control over the data being written is possible, making direct code execution difficult.
- **Attack vectors**: By crafting a malicious GIF file with a large `mincodesize` or with repeating code values during the LZW decompression process.
- **Required attacker capabilities/position**: An attacker needs the ability to supply a crafted GIF file as input to the vulnerable `gif2apng` application.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6958 | dense, sparse, graph | dense: 0.482, sparse: 0.226, graph: 0.909 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6690 | dense, sparse, graph | dense: 0.515, sparse: 0.219, graph: 0.800 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6222 | dense, sparse, graph | dense: 0.497, sparse: 0.226, graph: 0.683 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5868 | dense, sparse, graph | dense: 0.514, sparse: 0.220, graph: 0.707 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5814 | dense, sparse, graph | dense: 0.484, sparse: 0.225, graph: 0.588 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3817 | dense, sparse | dense: 0.527, sparse: 0.262 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3681 | dense, sparse | dense: 0.546, sparse: 0.219 |
| 8 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.3625 | dense, sparse | dense: 0.472, sparse: 0.220 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3538 | dense, sparse | dense: 0.463, sparse: 0.213 |
| 10 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3525 | dense, sparse | dense: 0.480, sparse: 0.196 |

