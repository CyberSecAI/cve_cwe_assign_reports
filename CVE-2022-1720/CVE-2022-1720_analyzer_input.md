# Vulnerability Information: CVE-2022-1720

## Vulnerability Description
**Buffer Over-read** in function grab_file_name in GitHub repository vim/vim prior to 8.2.4956. This vulnerability is capable of crashing the software, memory modification, and possible remote execution.

### Vulnerability Description Key Phrases
- **rootcause:** **Buffer Over-read**
- **impact:** crash and memory modification and remote execution
- **product:** vim/vim
- **version:** prior to 8.2.4956
- **component:** grab_file_name function

## CVE Reference Links Content Summary
```
{
  "CVE-2022-1720": {
    "description": "PLACEHOLDER - Implement CVE description retrieval",
    "affected_products": [
      "Vim",
      "gVim"
    ],
    "vulnerability_details": [
      {
        "source": "security.gentoo.org_29854c9c_20250108_131402.html",
        "details": "Multiple vulnerabilities have been discovered in Vim and gVim, the worst of which could result in denial of service. This advisory does not provide specific details of CVE-2022-1720, it only lists the affected versions and provides general impact and resolution guidance."
      },
      {
        "source": "lists.fedoraproject.org_2b8e74fb_20250108_131402.html",
        "details": "This source provides specific vulnerability information: \"CVE-2022-1720 vim: buffer over-read in grab_file_name() in findfile.c\". It indicates an out-of-bounds read in the grab_file_name() function within findfile.c"
      },
       {
        "source": "seclists.org_95187276_20250108_131358.html",
        "details": "This source indicates the impact of CVE-2022-1720 as: \"Processing a maliciously crafted file may lead to a denial-of-service or potentially disclose memory contents\". It also specifies that the issue was addressed with improved checks."
      },
      {
        "source": "github.com_5a229097_20250108_131400.html",
        "details": "The commit log indicates that the vulnerability is related to \"reading past end of line with \\\"gf\\\" in Visual block mode\". The fix implemented is to not include the NUL in the length when using the \"gf\" command in visual block mode."
      },
      {
        "source": "security.gentoo.org_155d9add_20250108_131402.html",
         "details": "This source only mentions the existence of the vulnerability but does not provide details.  It's impact is general \"Multiple vulnerabilities have been found in Vim, the worst of which could result in denial of service\"."
      },
          {
        "source": "lists.debian.org_7dba5273_20250108_131400.html",
        "details": "This source lists CVE-2022-1720 as one of the vulnerabilities fixed.  It provides general information regarding the impact of multiple vulnerabilities in vim: \"Buffer overflows, out-of-bounds reads and use-after-free may lead to a denial-of-service (application crash) or other unspecified impact\"."
       },
      {
        "source":"support.apple.com_c9b470de_20250108_131402.html",
        "details":"This source indicates the impact of CVE-2022-1720 as: \"Processing a maliciously crafted file may lead to a denial-of-service or potentially disclose memory contents\" and that it was fixed with improved checks."
      },
     {
        "source":"seclists.org_9cc990e6_20250108_131358.html",
          "details":"This source indicates the impact of CVE-2022-1720 as: \"Processing a maliciously crafted file may lead to a denial-of-service or potentially disclose memory contents\" and that the issue was addressed with improved checks."
     },
     {
        "source":"support.apple.com_dda8084e_20250108_131403.html",
         "details": "This source provides a general overview of multiple vulnerabilities without any specific details to this particular vulnerability."
       },
     {
       "source": "lists.debian.org_35543192_20250108_131400.html",
       "details": "This source lists CVE-2022-1720 as one of the vulnerabilities fixed in vim. It provides a general impact: \"Buffer overflows, out-of-bounds reads and use-after-free may lead to a denial-of-service (application crash) or other unspecified impact\""
      },
      {
        "source": "seclists.org_c2ef64c5_20250108_131357.html",
        "details": "This source provides general information about various vulnerabilities and notes that CVE-2022-1720 is among the fixed issues for vim.  No specific details about the vulnerability are included."
      }
    ],
    "root_cause": "An out-of-bounds read occurs when processing a file with the 'gf' command in visual block mode. The vulnerability is due to incorrect calculation of the length when extracting text, specifically not accounting for the trailing NUL character.",
    "weaknesses": [
      "Out-of-bounds read",
       "Incorrect length calculation"
    ],
    "impact": "Denial of service (application crash) or potential memory disclosure.",
    "attack_vectors": [
      "Opening a maliciously crafted file.",
        "Using the \"gf\" command in visual block mode"
    ],
    "required_capabilities": "The attacker needs the ability to open or load a specially crafted file using vim and be able to use the \"gf\" command."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.6455 | dense, sparse, graph | dense: 0.556, sparse: 0.169, graph: 0.758 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5966 | dense, sparse, graph | dense: 0.531, sparse: 0.135, graph: 0.709 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5550 | dense, sparse, graph | dense: 0.504, sparse: 0.159, graph: 0.592 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4126 | dense, sparse | dense: 0.608, sparse: 0.249 |
| 5 | CWE-786 | Access of Memory Location Before Start of Buffer | Base | Discouraged | 0.4121 | dense, sparse, graph | dense: 0.527, sparse: 0.148, graph: 0.612 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3474 | dense, sparse | dense: 0.557, sparse: 0.171 |
| 7 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3378 | dense, sparse | dense: 0.519, sparse: 0.137 |
| 8 | CWE-805 | Buffer Access with Incorrect Length Value | Base | Allowed | 0.3362 | dense, sparse | dense: 0.522, sparse: 0.131 |
| 9 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3321 | dense, sparse | dense: 0.502, sparse: 0.141 |
| 10 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3308 | dense, sparse | dense: 0.504, sparse: 0.137 |

