# Vulnerability Information: CVE-2022-20106

## Vulnerability Description
In MM service, there is a possible out of bounds write due to a **heap-based buffer overflow**. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation. Patch ID DTV03330460 Issue ID DTV03330460.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **impact:** local escalation of privilege
- **vector:** out of bounds write

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 66)
- CWE-20 (Count: 19)
- CWE-416 (Count: 10)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Heap-based buffer overflow in MM service.
- **Weaknesses/vulnerabilities present:** A heap-based buffer overflow exists due to insufficient bounds checking when writing to a buffer in the MM service.
- **Impact of exploitation:** Successful exploitation leads to local elevation of privilege, allowing an attacker to gain higher privileges on the system.
- **Attack vectors:** The vulnerability is triggered through the MM service. The specific method of triggering is not given but it does not require user interaction.
- **Required attacker capabilities/position:** An attacker would need to have local access to the system where the vulnerable MediaTek chipset is being used to trigger the overflow. They need to execute code within the context of the affected MM service. No user interaction is required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.7805 | dense, sparse, graph | dense: 0.564, sparse: 0.307, graph: 0.903 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7680 | dense, sparse, graph | dense: 0.562, sparse: 0.287, graph: 0.901 |
| 3 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.6463 | dense, sparse, graph | dense: 0.547, sparse: 0.277, graph: 0.600 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4453 | sparse, graph | sparse: 0.258, graph: 0.832 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4097 | dense, sparse | dense: 0.555, sparse: 0.290 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3850 | dense, sparse | dense: 0.559, sparse: 0.240 |
| 7 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.3488 | sparse, graph | sparse: 0.234, graph: 0.602 |
| 8 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.3397 | sparse, graph | sparse: 0.236, graph: 0.572 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1852 | dense, sparse | dense: 0.541, sparse: 0.250 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1812 | dense, sparse | dense: 0.547, sparse: 0.229 |

