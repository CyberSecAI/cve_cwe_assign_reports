# Vulnerability Information: CVE-2021-26728

## Vulnerability Description
Command injection and **stack-based buffer overflow** vulnerabilities in the KillDupUsr_func function of spx_restservice allow an attacker to execute arbitrary code with the same privileges as the server user (root). This issue affects Lanner Inc IAC-AST2500A standard firmware version 1.10.0.

### Vulnerability Description Key Phrases
- **weakness:** **command injection and stack-based buffer overflow**
- **impact:** execute arbitrary code with the same privileges as the server user (root)
- **attacker:** attacker
- **product:** Lanner Inc IAC-AST2500A
- **version:** standard firmware version 1.10.0
- **component:** KillDupUsr_func function of spx_restservice

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-77

#### Top CWEs
- CWE-77 (Count: 12)
- CWE-787 (Count: 12)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability information related to CVE-2021-26728:

**Root Cause of Vulnerability:**
- The vulnerability lies within the `KillDupUsr_func` function of the `spx_restservice`.
- Specifically, a stack-based buffer overflow occurs due to the use of `strcat` to copy an externally controllable HTTP parameter `username` into a fixed-size buffer without proper length checks.
- Additionally, the `safe_system` function executes the content of the overflowed buffer, enabling command injection.

**Weaknesses/Vulnerabilities Present:**
- **Stack-based buffer overflow:** The `strcat` function allows writing beyond the bounds of the allocated buffer on the stack.
- **Command injection:** The `safe_system` executes the overflowed buffer content without proper sanitization, enabling execution of arbitrary OS commands.
- **Broken Access Control:** While not the core issue of the vulnerability, it's noted that the `KillDupUsr_func` function, which is meant to kill duplicate user sessions, lacks session verification, allowing unauthenticated access to this function which is a pre-requisite to trigger the vulnerability.

**Impact of Exploitation:**
- **Remote Code Execution (RCE):** Successful exploitation allows an unauthenticated attacker to execute arbitrary code on the BMC (Baseboard Management Controller).
- **Root Privileges:** The code is executed with root privileges, granting the attacker complete control over the BMC.
- **Compromised Managed Host:** Because the BMC has low-level access to the host system, successful exploitation allows the attacker to also gain control of the managed host.
- **Denial of Service (DoS)** Although not the main impact of this vulnerability (CVE-2021-26728), the lack of session verification (CVE-2021-44467) enables an unauthenticated attacker to arbitrarily terminate active user sessions, causing a DoS.

**Attack Vectors:**
- **Network:** The vulnerability is exploitable through network requests to the web interface of the Lanner IAC-AST2500A device.
- **Unauthenticated:** No prior authentication is required to trigger the vulnerability, making it easily exploitable.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs network access to the vulnerable device's web interface.
- **No Authentication:** No user credentials or prior authentication are required.
- **Basic Web Request:** The attacker needs to be able to send an HTTP POST request to the `/api/KillDupUsr` endpoint with a specially crafted username parameter in order to trigger the buffer overflow.

**Additional Notes**
- The blog post highlights that multiple vulnerabilities were found in the Lanner BMC firmware based on AMI MegaRAC SP-X.
- The provided CVSS v3.1 score for CVE-2021-26728 is 10 (Critical).
- The vulnerability affects Lanner IAC-AST2500A devices, specifically version 1.10.0 of its firmware.
- The article also mentions that the vendor has released patches to address the issues, and users should contact Lanner for the appropriate firmware updates.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6743 | dense, sparse, graph | dense: 0.574, sparse: 0.214, graph: 0.739 |
| 2 | CWE-170 | Improper Null Termination | Base | Allowed | 0.4612 | sparse, graph | sparse: 0.181, graph: 1.000 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4551 | dense, sparse | dense: 0.670, sparse: 0.276 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4375 | dense, sparse | dense: 0.639, sparse: 0.206 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4372 | sparse, graph | sparse: 0.213, graph: 0.882 |
| 6 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4087 | dense, sparse | dense: 0.600, sparse: 0.224 |
| 7 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.4049 | dense, sparse | dense: 0.596, sparse: 0.187 |
| 8 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4032 | dense, sparse | dense: 0.589, sparse: 0.189 |
| 9 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.3821 | sparse, graph | sparse: 0.182, graph: 0.777 |
| 10 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3287 | sparse, graph | sparse: 0.180, graph: 0.631 |

