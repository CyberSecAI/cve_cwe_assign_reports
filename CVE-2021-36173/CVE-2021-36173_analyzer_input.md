# Vulnerability Information: CVE-2021-36173

## Vulnerability Description
A **heap-based buffer overflow** in the firmware signature verification function of FortiOS versions 7.0.1, 7.0.0, 6.4.0 through 6.4.6, 6.2.0 through 6.2.9, and 6.0.0 through 6.0.13 may allow an attacker to execute arbitrary code via specially crafted installation images.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **impact:** execute arbitrary code
- **vector:** specially crafted installation images
- **attacker:** attacker
- **product:** FortiOS
- **version:** 7.0.1, 7.0.0, 6.4.0 through 6.4.6, 6.2.0 through 6.2.9, and 6.0.0 through 6.0.13
- **component:** firmware signature verification function

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Heap-based buffer overflow in the firmware signature verification function.
- **Weaknesses/vulnerabilities present**: A heap-based buffer overflow (CWE-122) exists in the firmware signature verification process.
- **Impact of exploitation**: An attacker can execute arbitrary code by exploiting this vulnerability.
- **Attack vectors**:  The vulnerability is exploited via specially crafted installation images.
- **Required attacker capabilities/position**: An attacker needs the ability to provide/install a specially crafted installation image to the target system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6601 | dense, sparse, graph | dense: 0.609, sparse: 0.254, graph: 0.589 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6446 | dense, sparse, graph | dense: 0.579, sparse: 0.245, graph: 0.599 |
| 3 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4365 | dense, sparse | dense: 0.636, sparse: 0.270 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4363 | dense, sparse | dense: 0.660, sparse: 0.248 |
| 5 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.4329 | dense, sparse | dense: 0.593, sparse: 0.238 |
| 6 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.4196 | dense, sparse | dense: 0.593, sparse: 0.214 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4161 | dense, sparse | dense: 0.591, sparse: 0.210 |
| 8 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4129 | dense, sparse | dense: 0.611, sparse: 0.248 |
| 9 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4126 | dense, sparse | dense: 0.589, sparse: 0.206 |
| 10 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3981 | dense, sparse | dense: 0.595, sparse: 0.209 |

