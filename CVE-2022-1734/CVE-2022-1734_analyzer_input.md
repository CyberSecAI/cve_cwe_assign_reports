# Vulnerability Information: CVE-2022-1734

## Vulnerability Description
A flaw in Linux Kernel found in nfcmrvl_nci_unregister_dev() in drivers/nfc/nfcmrvl/main.c can lead to **use after free** both read or write when non synchronized between cleanup routine and firmware download routine.

### Vulnerability Description Key Phrases
- **weakness:** **use after free**
- **product:** Linux Kernel
- **component:** nfcmrvl_nci_unregister_dev() in drivers/nfc/nfcmrvl/main.c

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "source": "security.netapp.com_0e40f2f9_20250108_120037.html",
      "root_cause": "Linux Kernel versions prior to 5.18:rc5 are susceptible to a vulnerability.",
      "weaknesses": [
        "Use-after-free",
        "Double-free",
	"Null pointer dereference"
      ],
      "impact": "Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).",
      "attack_vectors": "Local access to a vulnerable system",
      "attacker_capabilities": "Local access"
    },
    {
      "source": "github.com_7b0057b8_20250108_120037.html",
       "root_cause": "Destructive operations such as `nfcmrvl_fw_dnld_abort` and `gpio_free` in `nfcmrvl_nci_unregister_dev`. Resources such as firmware, gpio, etc. could be destructed while upper layer functions such as `nfcmrvl_fw_dnld_start` and `nfcmrvl_nci_recv_frame` are executing.",
      "weaknesses": [
        "Double-free",
        "Use-after-free",
        "Null-pointer-deref"
      ],
       "impact": "Crashes due to double-free, use-after-free and null-ptr-deref bugs",
      "attack_vectors": "NFC device simulation from user-space.",
      "attacker_capabilities": "Ability to simulate NFC device from user-space."
    },
    {
      "source": "www.openwall.com_64cb6486_20250108_120036.html",
      "root_cause": "Destructive operations such as `nfcmrvl_fw_dnld_abort` and `gpio_free` in `nfcmrvl_nci_unregister_dev`. The resources such as firmware, gpio and so on could be destructed while the upper layer functions such as `nfcmrvl_fw_dnld_start` and `nfcmrvl_nci_recv_frame` is executing.",
      "weaknesses": [
        "Double-free",
        "Use-after-free",
        "Null-ptr-deref"
      ],
      "impact": "Kernel crash",
     "attack_vectors": "Simulating NFC device from userspace",
      "attacker_capabilities": "Local user with ability to simulate an NFC device."
    },
    {
     "source": "www.debian.org_0b91a609_20250108_120038.html",
      "root_cause": "Race conditions in the nfcmrvl NFC driver",
      "weaknesses": [
        "Use-after-free",
        "Double-free",
        "Null pointer dereference"
      ],
       "impact": "Denial of service (crash or memory corruption) or possibly for privilege escalation.",
       "attack_vectors": "Local access to a vulnerable system",
      "attacker_capabilities": "Local user"
    },
    {
      "source": "www.openwall.com_a8283f6f_20250108_120036.html",
       "root_cause": "Destructive operations in `nfcmrvl_nci_unregister_dev` such as `nfcmrvl_fw_dnld_abort` and `gpio_free` can be executed concurrently with upper layer functions such as `nfcmrvl_fw_dnld_start` and `nfcmrvl_nci_recv_frame`.",
      "weaknesses": [
        "Double-free",
        "Use-after-free",
        "Null-ptr-deref"
      ],
      "impact": "Kernel crash",
       "attack_vectors": "Simulating NFC device from userspace",
       "attacker_capabilities":"Local user with ability to simulate an NFC device."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-416 | Use After Free | Variant | Allowed | 0.6352 | dense, sparse, graph | dense: 0.542, sparse: 0.158, graph: 0.915 |
| 2 | CWE-911 | Improper Update of Reference Count | Base | Allowed | 0.6169 | dense, sparse, graph | dense: 0.520, sparse: 0.164, graph: 0.736 |
| 3 | CWE-415 | Double Free | Variant | Allowed | 0.5993 | dense, sparse, graph | dense: 0.532, sparse: 0.167, graph: 0.804 |
| 4 | CWE-413 | Improper Resource Locking | Base | Allowed | 0.5643 | dense, sparse, graph | dense: 0.544, sparse: 0.127, graph: 0.614 |
| 5 | CWE-364 | Signal Handler Race Condition | Base | Allowed | 0.4311 | sparse, graph | sparse: 0.129, graph: 1.000 |
| 6 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.3462 | dense, sparse | dense: 0.522, sparse: 0.148 |
| 7 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.3389 | dense, sparse, graph | dense: 0.513, sparse: 0.169, graph: 0.626 |
| 8 | CWE-459 | Incomplete Cleanup | Base | Allowed | 0.3373 | dense, sparse | dense: 0.527, sparse: 0.128 |
| 9 | CWE-226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | 0.3297 | dense, sparse | dense: 0.514, sparse: 0.127 |
| 10 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3240 | dense, sparse | dense: 0.534, sparse: 0.146 |

