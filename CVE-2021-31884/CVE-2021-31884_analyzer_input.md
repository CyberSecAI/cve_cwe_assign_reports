# Vulnerability Information: CVE-2021-31884

## Vulnerability Description
A vulnerability has been identified in APOGEE MBC (PPC) (BACnet) (All versions), APOGEE MBC (PPC) (P2 Ethernet) (All versions), APOGEE MEC (PPC) (BACnet) (All versions), APOGEE MEC (PPC) (P2 Ethernet) (All versions), APOGEE PXC Compact (BACnet) (All versions = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and = V2.3 and < V6.30.016), Nucleus NET (All versions), Nucleus ReadyStart V3 (All versions < V2017.02.4), Nucleus Source Code (All versions), TALON TC Compact (BACnet) (All versions < V3.5.4), TALON TC Modular (BACnet) (All versions < V3.5.4). The DHCP client application assumes that the data supplied with the Hostname DHCP option is NULL terminated. In cases when global hostname variable is not defined, this may lead to **Out-of-bound reads, writes**, and Denial-of-service conditions. (FSMD-2021-0014)

### Vulnerability Description Key Phrases
- **weakness:** **Out-of-bound reads, writes**
- **impact:** Denial-of-service
- **product:** APOGEE MBC (PPC) (BACnet) and APOGEE MBC (PPC) (P2 Ethernet) and APOGEE MEC (PPC) (BACnet) and APOGEE MEC (PPC) (P2 Ethernet) and APOGEE PXC Compact (BACnet) and Nucleus NET and Nucleus ReadyStart V3 and Nucleus Source Code and TALON TC Compact (BACnet) and TALON TC Modular (BACnet)
- **version:** All versions and All versions and All versions and All versions and All versions < V6.30.016 and All versions and All versions < V2017.02.4 and All versions and All versions < V3.5.4 and All versions < V3.5.4
- **component:** DHCP client application

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "CVE-2021-31884": {
      "status": "relevant",
      "details": {
        "root_cause": "The DHCP client application assumes that the data supplied with the “Hostname” DHCP option is NULL terminated. In cases when global hostname variable is not defined, this may lead to out-of-bound reads and writes.",
        "weaknesses": [
          "CWE-170: Improper Null Termination"
        ],
        "impact": "Out-of-bound reads, writes, and Denial-of-service conditions.",
        "attack_vectors": "An attacker on the same network can send a malicious DHCP offer/ack message",
        "attacker_capabilities": "An attacker with the ability to send network packets on the same network segment as the vulnerable device is required."
      }
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-170 | Improper Null Termination | Base | Allowed | 1.1093 | dense, sparse, graph | dense: 0.579, sparse: 1.000, graph: 0.692 |
| 2 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.8226 | dense, sparse | dense: 0.653, sparse: 0.986 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.7824 | dense, sparse | dense: 0.635, sparse: 0.926 |
| 4 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.6653 | sparse, graph | sparse: 0.612, graph: 0.882 |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.5902 | sparse, graph | sparse: 0.538, graph: 0.789 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.5754 | dense, sparse | dense: 0.581, sparse: 0.545 |
| 7 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.5754 | dense, sparse | dense: 0.592, sparse: 0.488 |
| 8 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5687 | dense, sparse | dense: 0.578, sparse: 0.488 |
| 9 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5198 | sparse, graph | sparse: 0.514, graph: 0.631 |
| 10 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2939 | dense, sparse | dense: 0.579, sparse: 0.641 |

