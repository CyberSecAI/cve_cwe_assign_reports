# Vulnerability Information: CVE-2021-36793

## Vulnerability Description
The routes (aka Extbase Yaml Routes) extension before 2.1.1 for TYPO3, when CsrfTokenViewHelper is used, allows Sensitive Information Disclosure because a session identifier is unsafely present in HTML output.

### Vulnerability Description Key Phrases
- **rootcause:** **unsafely present session identifier**
- **impact:** sensitive information disclosure
- **product:** TYPO3 routes (aka Extbase Yaml Routes) extension
- **version:** before 2.1.1
- **component:** CsrfTokenViewHelper

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2021-36793:

**Root cause of vulnerability:**
The TYPO3 extension "Extbase Yaml Routes" (routes) uses the `CsrfTokenViewHelper` which discloses the user's session identifier directly to HTML output without proper cryptographic hashing.

**Weaknesses/vulnerabilities present:**
- Sensitive Information Disclosure: The user's session identifier is exposed in the HTML output.
- Inadequate Output Encoding: Lack of cryptographic hashing on the session identifier before output.

**Impact of exploitation:**
- The vulnerability itself cannot be exploited directly, but it can be chained with another attack, like Cross-Site Scripting (XSS) to gain access to sensitive user information.
- By extracting the user's session identifier an attacker could potentially impersonate the user.

**Attack vectors:**
-  Requires a chained attack like Cross-Site Scripting (XSS) in the frontend output. The session identifier is exposed but an attacker would need a separate vector to inject malicious code that extracts this identifier

**Required attacker capabilities/position:**
-  The attacker needs to be able to perform Cross-Site Scripting attack on the frontend of the application.
-  Low privileged access is sufficient for the initial XSS injection point.

**Additional Information:**
- The affected versions are 2.1.0 and below.
- The vulnerability severity is rated as medium.
- The fixed version is 2.1.1.
- The vulnerability is located in a third-party extension not part of the default TYPO3 installation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-540 | Inclusion of Sensitive Information in Source Code | Base | Allowed | 0.6125 | dense, sparse, graph | dense: 0.527, sparse: 0.271, graph: 0.541 |
| 2 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.5580 | dense, sparse, graph | dense: 0.492, sparse: 0.126, graph: 0.671 |
| 3 | CWE-36 | Absolute Path Traversal | Base | Allowed | 0.3732 | sparse, graph | sparse: 0.132, graph: 0.832 |
| 4 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.2878 | sparse, graph | sparse: 0.108, graph: 0.631 |
| 5 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.2740 | sparse, graph | sparse: 0.120, graph: 0.575 |
| 6 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.0685 | sparse | sparse: 0.120 |
| 7 | CWE-941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | 0.0635 | sparse | sparse: 0.111 |
| 8 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.0635 | sparse | sparse: 0.111 |
| 9 | CWE-1289 | Improper Validation of Unsafe Equivalence in Input | Base | Allowed | 0.0630 | sparse | sparse: 0.110 |
| 10 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | 0.0626 | sparse | sparse: 0.119 |

