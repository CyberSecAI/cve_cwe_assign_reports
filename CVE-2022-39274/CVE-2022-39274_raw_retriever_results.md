# Raw Retriever Results for CVE-2022-39274

# Raw Retriever Results for CVE-2022-39274

## Query
LoRaMac-node is a reference implementation and documentation of a LoRa network node. Versions of LoRaMac-node prior to 4.7.0 are vulnerable to a buffer overflow. Improper size validation of the incoming radio frames can lead to an 65280-byte out-of-bounds write. The function `ProcessRadioRxDone` implicitly expects incoming radio frames to have at least a payload of one byte or more. An empty payload leads to a 1-byte out-of-bounds read of user controlled content when the payload buffer is reused. This allows an attacker to craft a FRAME_TYPE_PROPRIETARY frame with size -1 which results in an 65280-byte out-of-bounds memcopy likely with partially controlled attacker data. Corrupting a large part if the data section is likely to cause a DoS. If the large out-of-bounds write does not immediately crash the attacker may gain control over the execution due to now controlling large parts of the data section. Users are advised to upgrade either by updating their package or by manually applying the patch commit `e851b079`.

## Keyphrases
- **rootcause**: Improper size validation of the incoming radio frames
- **weakness**: buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4352 | 0.4878 | 0.4580 | 0.4566 | 20 |
| Sparse | 921.7438 | 2787.5037 | 1625.6069 | 1581.4015 | 20 |
| Graph | 1.6848 | 2.5343 | 2.0197 | 2.0228 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 193 | Off-by-one Error | Base | 2.5343 | Allowed |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.4223 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 5 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 8 | 617 | Reachable Assertion | base | 2.2100 | Allowed |
| 9 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 10 | 190 | Integer Overflow or Wraparound | Base | 2.0853 | Allowed |
| 11 | 126 | Buffer Over-read | Variant | 1.9603 | Allowed |
| 12 | 125 | Out-of-bounds Read | Base | 1.8695 | Allowed |
| 13 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.8061 | Allowed |
| 14 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 126 | Buffer Over-read | Variant | 0.4878 | 0.4878 | Allowed |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4847 | 0.4847 | Allowed |
| 3 | 193 | Off-by-one Error | Base | 0.4822 | 0.4822 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | Base | 0.4752 | 0.4752 | Allowed |
| 5 | 121 | Stack-based Buffer Overflow | Variant | 0.4725 | 0.4725 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4714 | 0.4714 | Allowed |
| 7 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4705 | 0.4705 | Allowed |
| 8 | 122 | Heap-based Buffer Overflow | Variant | 0.4618 | 0.4618 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4607 | 0.4607 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4605 | 0.4605 | Allowed |
| 11 | 606 | Unchecked Input for Loop Condition | Base | 0.4528 | 0.4528 | Allowed |
| 12 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.4512 | 0.4512 | Allowed |
| 13 | 674 | Uncontrolled Recursion | Class | 0.4511 | 0.4511 | Allowed-with-Review |
| 14 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4453 | 0.4453 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4443 | 0.4443 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-193 | Off-by-one Error | 2787.5037 | 2787.5037 | Allowed |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1760.8350 | 1760.8350 | Allowed |
| 3 | CWE-125 | Out-of-bounds Read | 1759.6258 | 1759.6258 | Allowed |
| 4 | CWE-190 | Integer Overflow or Wraparound | 1738.7236 | 1738.7236 | Allowed |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | 1655.9654 | 1655.9654 | Allowed |
| 6 | CWE-126 | Buffer Over-read | 1621.5125 | 1621.5125 | Allowed |
| 7 | CWE-197 | Numeric Truncation Error | 1619.8417 | 1619.8417 | Allowed |
| 8 | CWE-20 | Improper Input Validation | 1618.5591 | 1618.5591 | Discouraged |
| 9 | CWE-476 | NULL Pointer Dereference | 1593.6747 | 1593.6747 | Allowed |
| 10 | CWE-122 | Heap-based Buffer Overflow | 1582.3158 | 1582.3158 | Allowed |
| 11 | CWE-789 | Memory Allocation with Excessive Size Value | 1580.4872 | 1580.4872 | Allowed |
| 12 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 1572.4635 | 1572.4635 | Discouraged |
| 13 | CWE-131 | Incorrect Calculation of Buffer Size | 1569.1271 | 1569.1271 | Allowed |
| 14 | CWE-121 | Stack-based Buffer Overflow | 1555.6973 | 1555.6973 | Allowed |
| 15 | CWE-787 | Out-of-bounds Write | 1533.5440 | 1533.5440 | Allowed |
