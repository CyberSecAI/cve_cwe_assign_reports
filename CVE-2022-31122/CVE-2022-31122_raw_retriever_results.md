# Raw Retriever Results for CVE-2022-31122

# Raw Retriever Results for CVE-2022-31122

## Query
Wire is an encrypted communication and collaboration platform. Versions prior to 2022-07-12/Chart 4.19.0 are subject to Token Recipient Confusion. If an attacker has certain details of SAML IdP metadata, and configures their own SAML on the same backend, the attacker can delete all SAML authenticated accounts of a targeted team, Authenticate as a user of the attacked team and create arbitrary accounts in the context of the team if it is not managed by SCIM. This issue is fixed in wire-server 2022-07-12 and is already deployed on all Wire managed services. On-premise instances of wire-server need to be updated to 2022-07-12/Chart 4.19.0, so that their backends are no longer affected. As a workaround, the risk of an attack can be reduced by disabling SAML configuration for teams (galley.config.settings.featureFlags.sso). Helm overrides are located in `values/wire-server/values.yaml` Note that the ability to configure SAML SSO as a team is disabled by default for on-premise installations.

## Keyphrases
- **rootcause**: Token Recipient Confusion

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4174 | 0.5926 | 0.4370 | 0.4261 | 20 |
| Sparse | 870.4526 | 2155.6789 | 979.4971 | 898.1456 | 20 |
| Graph | 1.0062 | 2.2100 | 1.3882 | 1.3914 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 2 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 1.8807 | Allowed |
| 3 | 1270 | Generation of Incorrect Security Tokens | Base | 1.6798 | Allowed |
| 4 | 294 | Authentication Bypass by Capture-replay | Base | 1.6695 | Allowed |
| 5 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 6 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 7 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.4979 | Allowed |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 1.4655 | Allowed |
| 9 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.4585 | Allowed |
| 10 | 1390 | Weak Authentication | class | 1.4080 | Allowed-with-Review |
| 11 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |
| 12 | 406 | Insufficient Control of Network Message Volume (Network Amplification) | class | 1.3600 | Allowed-with-Review |
| 13 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.2864 | Allowed |
| 14 | 407 | Inefficient Algorithmic Complexity | class | 1.1920 | Allowed-with-Review |
| 15 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.1466 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1270 | Generation of Incorrect Security Tokens | Base | 0.5926 | 0.5926 | Allowed |
| 2 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4530 | 0.4530 | Allowed |
| 3 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4488 | 0.4488 | Allowed |
| 4 | 294 | Authentication Bypass by Capture-replay | Base | 0.4394 | 0.4394 | Allowed |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.4389 | 0.4389 | Allowed |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4380 | 0.4380 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | Base | 0.4325 | 0.4325 | Allowed |
| 8 | 290 | Authentication Bypass by Spoofing | Base | 0.4315 | 0.4315 | Allowed |
| 9 | 863 | Incorrect Authorization | Class | 0.4284 | 0.4284 | Allowed-with-Review |
| 10 | 1385 | Missing Origin Validation in WebSockets | Variant | 0.4267 | 0.4267 | Allowed |
| 11 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.4254 | 0.4254 | Allowed |
| 12 | 285 | Improper Authorization | Class | 0.4251 | 0.4251 | Discouraged |
| 13 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.4241 | 0.4241 | Allowed |
| 14 | 287 | Improper Authentication | Class | 0.4231 | 0.4231 | Discouraged |
| 15 | 204 | Observable Response Discrepancy | Base | 0.4210 | 0.4210 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-1270 | Generation of Incorrect Security Tokens | 2155.6789 | 2155.6789 | Allowed |
| 2 | CWE-1390 | Weak Authentication | 1015.4319 | 1015.4319 | Allowed-with-Review |
| 3 | CWE-407 | Inefficient Algorithmic Complexity | 1005.0053 | 1005.0053 | Allowed-with-Review |
| 4 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 999.5324 | 999.5324 | Allowed |
| 5 | CWE-863 | Incorrect Authorization | 964.9302 | 964.9302 | Allowed-with-Review |
| 6 | CWE-347 | Improper Verification of Cryptographic Signature | 946.9033 | 946.9033 | Allowed |
| 7 | CWE-287 | Improper Authentication | 941.0860 | 941.0860 | Discouraged |
| 8 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 915.4250 | 915.4250 | Allowed-with-Review |
| 9 | CWE-306 | Missing Authentication for Critical Function | 907.4643 | 907.4643 | Allowed |
| 10 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 899.3065 | 899.3065 | Allowed |
| 11 | CWE-290 | Authentication Bypass by Spoofing | 896.9846 | 896.9846 | Allowed |
| 12 | CWE-303 | Incorrect Implementation of Authentication Algorithm | 895.9823 | 895.9823 | Allowed |
| 13 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 889.4042 | 889.4042 | Discouraged |
| 14 | CWE-285 | Improper Authorization | 888.2888 | 888.2888 | Discouraged |
| 15 | CWE-259 | Use of Hard-coded Password | 886.2926 | 886.2926 | Allowed |
