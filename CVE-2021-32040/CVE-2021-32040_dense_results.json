{
  "query": "It may be possible to have an extremely long aggregation pipeline in conjunction with a specific stage/operator and cause a stack overflow due to the size of the stack frames used by that stage. If an attacker could cause such an aggregation to occur, they could maliciously crash MongoDB in a DoS attack. This vulnerability affects MongoDB Server v4.4 versions prior to and including 4.4.28, MongoDB Server v5.0 versions prior to 5.0.4 and MongoDB Server v4.2 versions prior to 4.2.16. Workaround >= v4.2.16 users and all v4.4 users can add the --setParameter internalPipelineLengthLimit=50 instead of the default 1000 to mongod at startup to prevent a crash.",
  "count": 20,
  "results": [
    {
      "cwe_id": "409",
      "name": "Improper Handling of Highly Compressed Data (Data Amplification)",
      "abstraction": "Base",
      "score": 0.4212977363173316,
      "original_score": 0.4212977363173316,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1325",
      "name": "Improperly Controlled Sequential Memory Allocation",
      "abstraction": "Base",
      "score": 0.4030292124283721,
      "original_score": 0.4030292124283721,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "774",
      "name": "Allocation of File Descriptors or Handles Without Limits or Throttling",
      "abstraction": "Variant",
      "score": 0.3926854545696609,
      "original_score": 0.3926854545696609,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.3898340881545821,
      "original_score": 0.3898340881545821,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1049",
      "name": "Excessive Data Query Operations in a Large Data Table",
      "abstraction": "Base",
      "score": 0.38969266787498547,
      "original_score": 0.38969266787498547,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "abstraction": "Class",
      "score": 0.38148775893701015,
      "original_score": 0.38148775893701015,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "410",
      "name": "Insufficient Resource Pool",
      "abstraction": "Base",
      "score": 0.38018267481035345,
      "original_score": 0.38018267481035345,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1089",
      "name": "Large Data Table with Excessive Number of Indices",
      "abstraction": "Base",
      "score": 0.379506896077811,
      "original_score": 0.379506896077811,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "789",
      "name": "Memory Allocation with Excessive Size Value",
      "abstraction": "Variant",
      "score": 0.37015376679677975,
      "original_score": 0.37015376679677975,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "779",
      "name": "Logging of Excessive Data",
      "abstraction": "Base",
      "score": 0.36973500992160874,
      "original_score": 0.36973500992160874,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1176",
      "name": "Inefficient CPU Computation",
      "abstraction": "Class",
      "score": 0.36776179857178937,
      "original_score": 0.36776179857178937,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "834",
      "name": "Excessive Iteration",
      "abstraction": "Class",
      "score": 0.3646192291195429,
      "original_score": 0.3646192291195429,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "121",
      "name": "Stack-based Buffer Overflow",
      "abstraction": "Variant",
      "score": 0.35956548411568556,
      "original_score": 0.35956548411568556,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "406",
      "name": "Insufficient Control of Network Message Volume (Network Amplification)",
      "abstraction": "Class",
      "score": 0.3576482703221083,
      "original_score": 0.3576482703221083,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1050",
      "name": "Excessive Platform Resource Consumption within a Loop",
      "abstraction": "Base",
      "score": 0.35077302486751516,
      "original_score": 0.35077302486751516,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "130",
      "name": "Improper Handling of Length Parameter Inconsistency",
      "abstraction": "Base",
      "score": 0.3496354746774052,
      "original_score": 0.3496354746774052,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "408",
      "name": "Incorrect Behavior Order: Early Amplification",
      "abstraction": "Base",
      "score": 0.34882602203561125,
      "original_score": 0.34882602203561125,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 0.3477909146535239,
      "original_score": 0.3477909146535239,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "120",
      "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
      "abstraction": "Base",
      "score": 0.3451833943017293,
      "original_score": 0.3451833943017293,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "182",
      "name": "Collapse of Data into Unsafe Value",
      "abstraction": "Base",
      "score": 0.3442603663533771,
      "original_score": 0.3442603663533771,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.3442603663533771,
    "max": 0.4212977363173316,
    "mean": 0.3706834622453392,
    "median": 0.3687484042466991,
    "count": 20
  }
}