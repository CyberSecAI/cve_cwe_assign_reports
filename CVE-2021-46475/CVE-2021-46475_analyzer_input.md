# Vulnerability Information: CVE-2021-46475

## Vulnerability Description
Jsish v3.5.0 was discovered to contain a **heap buffer overflow** via jsi_ArraySliceCmd in src/jsiArray.c. This vulnerability can lead to a Denial of Service (DoS).

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **impact:** Denial of Service (DoS)
- **product:** componentJsish
- **version:** v3.5.0
- **component:** jsi_ArraySliceCmd in src/jsiArray.c

## CVE Reference Links Content Summary
The provided content contains a detailed report of a heap-buffer-overflow vulnerability in the jsish project, specifically in the `jsi_ArraySliceCmd` function within `src/jsiArray.c` at line 912.

**Root cause of vulnerability:**
- The vulnerability is a heap-buffer-overflow occurring in the `jsi_ArraySliceCmd` function when processing array slicing operations.

**Weaknesses/vulnerabilities present:**
- Heap-buffer-overflow: A memory safety violation where the program writes beyond the allocated buffer on the heap.

**Impact of exploitation:**
- The vulnerability could lead to a crash due to memory corruption and can potentially be exploited for arbitrary code execution.
- In this case, the program crashes with an AddressSanitizer error, indicating a read beyond the allocated buffer.

**Attack vectors:**
- The attack vector is by crafting a specific sequence of Javascript array operations that manipulate the array size and call the slice method, which triggers the heap-buffer-overflow.
- The provided test case demonstrates this vulnerability using the `findIndex` and `slice` methods within the javascript code.

**Required attacker capabilities/position:**
- The attacker needs to be able to execute arbitrary JavaScript code within the vulnerable jsish environment.
- The attacker would need to control the input to trigger the specific sequence of array operations that cause the buffer overflow.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6893 | dense, sparse, graph | dense: 0.529, sparse: 0.170, graph: 0.916 |
| 2 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.6709 | dense, sparse, graph | dense: 0.544, sparse: 0.146, graph: 0.882 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6557 | dense, sparse, graph | dense: 0.543, sparse: 0.169, graph: 0.803 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5309 | dense, sparse, graph | dense: 0.557, sparse: 0.166, graph: 0.562 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3715 | dense, sparse | dense: 0.561, sparse: 0.213 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3669 | sparse, graph | sparse: 0.148, graph: 0.789 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3516 | dense, sparse | dense: 0.518, sparse: 0.161 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3503 | dense, sparse | dense: 0.560, sparse: 0.173 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3432 | dense, sparse | dense: 0.519, sparse: 0.146 |
| 10 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3418 | dense, sparse | dense: 0.513, sparse: 0.149 |

