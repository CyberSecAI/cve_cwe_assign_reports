# Raw Retriever Results for CVE-2021-31154

# Raw Retriever Results for CVE-2021-31154

## Query
pleaseedit in please before 0.4 uses predictable temporary filenames in /tmp and the target directory. This allows a local attacker to gain full root privileges by staging a symlink attack.

## Keyphrases
- **rootcause**: predictable temporary filenames

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4085 | 0.5116 | 0.4338 | 0.4217 | 20 |
| Sparse | 167.9546 | 348.9883 | 200.5379 | 187.9174 | 20 |
| Graph | 1.3648 | 2.2100 | 1.6599 | 1.6320 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 2 | 804 | Guessable CAPTCHA | base | 2.2100 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 6 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 7 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 1.7189 | Allowed |
| 8 | 378 | Creation of Temporary File With Insecure Permissions | Base | 1.7150 | Allowed |
| 9 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 1.6886 | Allowed |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 11 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 12 | 340 | Generation of Predictable Numbers or Identifiers | class | 1.6016 | Allowed-with-Review |
| 13 | 73 | External Control of File Name or Path | Base | 1.5411 | Allowed |
| 14 | 62 | UNIX Hard Link | Variant | 1.5153 | Allowed |
| 15 | 65 | Windows Hard Link | Variant | 1.5014 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5116 | 0.5116 | Allowed |
| 2 | 377 | Insecure Temporary File | Class | 0.5019 | 0.5019 | Allowed-with-Review |
| 3 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.4872 | 0.4872 | Allowed |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 0.4440 | 0.4440 | Allowed |
| 5 | 62 | UNIX Hard Link | Variant | 0.4417 | 0.4417 | Allowed |
| 6 | 24 | Path Traversal: '../filedir' | Variant | 0.4376 | 0.4376 | Allowed |
| 7 | 277 | Insecure Inherited Permissions | Variant | 0.4310 | 0.4310 | Allowed |
| 8 | 27 | Path Traversal: 'dir/../../filename' | Variant | 0.4265 | 0.4265 | Allowed |
| 9 | 530 | Exposure of Backup File to an Unauthorized Control Sphere | Variant | 0.4251 | 0.4251 | Allowed |
| 10 | 57 | Path Equivalence: 'fakedir/../realdir/filename' | Variant | 0.4240 | 0.4240 | Allowed |
| 11 | 250 | Execution with Unnecessary Privileges | Base | 0.4193 | 0.4193 | Allowed |
| 12 | 641 | Improper Restriction of Names for Files and Other Resources | Base | 0.4186 | 0.4186 | Allowed |
| 13 | 34 | Path Traversal: '....//' | Variant | 0.4180 | 0.4180 | Allowed |
| 14 | 31 | Path Traversal: 'dir\..\..\filename' | Variant | 0.4177 | 0.4177 | Allowed |
| 15 | 26 | Path Traversal: '/dir/../filename' | Variant | 0.4156 | 0.4156 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-377 | Insecure Temporary File | 348.9883 | 348.9883 | Allowed-with-Review |
| 2 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 246.7161 | 246.7161 | Allowed |
| 3 | CWE-330 | Use of Insufficiently Random Values | 225.1606 | 225.1606 | Discouraged |
| 4 | CWE-65 | Windows Hard Link | 224.6599 | 224.6599 | Allowed |
| 5 | CWE-379 | Creation of Temporary File in Directory with Insecure Permissions | 206.3069 | 206.3069 | Allowed |
| 6 | CWE-61 | UNIX Symbolic Link (Symlink) Following | 204.9255 | 204.9255 | Allowed |
| 7 | CWE-732 | Incorrect Permission Assignment for Critical Resource | 200.9313 | 200.9313 | Allowed-with-Review |
| 8 | CWE-41 | Improper Resolution of Path Equivalence | 199.2365 | 199.2365 | Allowed |
| 9 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 194.7491 | 194.7491 | Allowed |
| 10 | CWE-341 | Predictable from Observable State | 193.1614 | 193.1614 | Allowed |
| 11 | CWE-552 | Files or Directories Accessible to External Parties | 182.6734 | 182.6734 | Allowed |
| 12 | CWE-250 | Execution with Unnecessary Privileges | 182.3939 | 182.3939 | Allowed |
| 13 | CWE-277 | Insecure Inherited Permissions | 180.9540 | 180.9540 | Allowed |
| 14 | CWE-23 | Relative Path Traversal | 180.3956 | 180.3956 | Allowed |
| 15 | CWE-427 | Uncontrolled Search Path Element | 179.2327 | 179.2327 | Allowed |
