# Vulnerability Information: CVE-2020-35633

## Vulnerability Description
A code execution vulnerability exists in the Nef polygon-parsing functionality of CGAL libcgal CGAL-5.1.1. An oob read vulnerability exists in Nef_S2/SNC_io_parser.h SNC_io_parserread_sface() store_sm_boundary_item() Edge_of.A specially crafted malformed file can lead to an **out-of-bounds read** and **type confusion**, which could lead to code execution. An attacker can provide malicious input to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **out-of-bounds read and type confusion**
- **impact:** code execution
- **attacker:** attacker
- **product:** CGAL libcgal
- **version:** CGAL-5.1.1
- **component:** Nef polygon-parsing functionality

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from a lack of proper bounds checking when reading indices from a file that is used to access vectors of objects within the CGAL library's Nef polygon parsing code. This occurs in various functions when parsing vertex, halfedge, facet, volume, sedge, sloop and sface data, specifically in the `Nef_2/PM_io_parser.h` and `Nef_S2/SNC_io_parser.h` files.",
    "weaknesses": [
      "Improper Validation of Array Index (CWE-129)",
      "Out-of-bounds read",
      "Type confusion"
    ],
    "impact": "The lack of bounds checking allows an attacker to supply a crafted file with arbitrary indices. This can lead to out-of-bounds reads, memory corruption, type confusion and ultimately arbitrary code execution.",
    "attack_vectors": "The attack vector is a malformed `.nef`, `.nef2`, or `.nef3` file. The vulnerability is triggered when parsing this file.",
      "required_capabilities": "The attacker needs to provide a malicious file to an application that uses the CGAL library to parse Nef polygon data."
  },
    "affected_files": [
    "CGAL/include/CGAL/Nef_2/PM_io_parser.h",
    "CGAL/include/CGAL/Nef_S2/SM_io_parser.h",
    "CGAL/include/CGAL/Nef_S2/SNC_io_parser.h"
    ],
  "additional_notes": "The vulnerability is present across multiple functions and object types within the CGAL library when handling Nef polygons. The provided example file format in the Talos report helps to understand how the parsing process works and how out-of-bounds access is triggered. The issues were found in versions up to and including CGAL-5.1.1 and have been fixed in later versions."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.8916 | dense, sparse, graph | dense: 0.565, sparse: 0.490, graph: 0.918 |
| 2 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.8900 | dense, sparse, graph | dense: 0.622, sparse: 0.704, graph: 0.700 |
| 3 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7810 | dense, sparse, graph | dense: 0.552, sparse: 0.310, graph: 0.916 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7787 | dense, sparse, graph | dense: 0.545, sparse: 0.325, graph: 0.896 |
| 5 | CWE-197 | Numeric Truncation Error | Base | Allowed | 0.6756 | dense, sparse, graph | dense: 0.527, sparse: 0.320, graph: 0.639 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6313 | dense, sparse, graph | dense: 0.547, sparse: 0.274, graph: 0.709 |
| 7 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5402 | sparse, graph | sparse: 0.319, graph: 1.000 |
| 8 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.4544 | dense, sparse | dense: 0.544, sparse: 0.318 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4389 | dense, sparse | dense: 0.539, sparse: 0.296 |
| 10 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4383 | dense, sparse | dense: 0.541, sparse: 0.293 |

