# Vulnerability Information: CVE-2022-35463

## Vulnerability Description
OTFCC v0.10.4 was discovered to contain a **heap-buffer overflow** via /release-x64/otfccdump+0x6b0478.

### Vulnerability Description Key Phrases
- **weakness:** **heap-buffer overflow**
- **product:** OTFCC
- **version:** v0.10.4
- **component:** /release-x64/otfccdump+0x6b0478

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 240)
- CWE-NVD-noinfo (Count: 29)
- CWE-120 (Count: 3)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability information:

**CVE ID:** CVE-2022-33047

**Vulnerability Type:** Use-after-free

**Root Cause:** The vulnerability is caused by a use-after-free error in `otfccbuild`. A memory region is freed and then accessed again later by a vsnprintf function call.

**Weaknesses:**
   - Use-after-free
   - Improper memory management
   
**Impact of Exploitation:**
   - Program crash due to memory corruption
   - Potential for more severe exploits (e.g., code execution) by a sophisticated attacker.

**Attack Vectors:**
   - By processing a crafted malicious font file with the vulnerable `otfccbuild` tool.

**Required Attacker Capabilities/Position:**
  - The attacker needs to provide a malicious font file to the vulnerable `otfccbuild` tool.
  - No special privileges are needed other than the ability to execute the otfccbuild tool.

**Technical Details:**
The provided crash log from AddressSanitizer gives the following key information:
- The crash occurs at `0x44cfbe` within the `otfccbuild` binary.
- A READ of size 1 happens at address `0x603000000011`.
- The memory region `[0x603000000010, 0x603000000024)` was freed prior to the crash.
- The call stack shows the `vsnprintf` is involved.

This information reveals that the vulnerability lies in the way memory is being handled in the context of the vsnprintf function.

This content provides more details than the official CVE description by providing specific crash information and sample files.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6015 | dense, sparse, graph | dense: 0.524, sparse: 0.162, graph: 0.690 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5514 | dense, sparse, graph | dense: 0.562, sparse: 0.105, graph: 0.587 |
| 3 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3629 | dense, sparse | dense: 0.578, sparse: 0.181 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3182 | dense, sparse | dense: 0.547, sparse: 0.124 |
| 5 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3157 | dense, sparse | dense: 0.515, sparse: 0.101 |
| 6 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3144 | dense, sparse | dense: 0.519, sparse: 0.096 |
| 7 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3129 | dense, sparse | dense: 0.521, sparse: 0.091 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3055 | dense, sparse | dense: 0.506, sparse: 0.091 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3054 | dense, sparse | dense: 0.554, sparse: 0.093 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3045 | dense, sparse | dense: 0.495, sparse: 0.099 |

