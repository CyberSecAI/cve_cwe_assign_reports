# Vulnerability Information: CVE-2022-30473

## Vulnerability Description
Tenda AC Series Router AC18_V15.03.05.19(6318) has a **stack-based buffer overflow** vulnerability in function form_fast_setting_wifi_set

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **product:** Tenda AC Series Router
- **version:** AC18_V15.03.05.19(6318)
- **component:** function form_fast_setting_wifi_set

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The root cause is a stack-based buffer overflow vulnerability present in the `form_fast_setting_wifi_set` function of the Tenda AC18 router firmware.

**Weaknesses/Vulnerabilities:**
- **Stack-Based Buffer Overflow:** The code reads user-provided input for the `ssid` parameter into a buffer (`src`) and then copies this data to a smaller stack-based buffer (`s`) using `strcpy` without performing any length check. This can lead to a buffer overflow if the `ssid` parameter is longer than the buffer `s`, overwriting other data on the stack.

**Impact of Exploitation:**
- **Denial of Service (DoS):** By providing an overly long string for the `ssid` parameter, an attacker can trigger the buffer overflow and cause the router to crash. This effectively leads to a DoS attack, disrupting the router's functionality.

**Attack Vectors:**
- **HTTP GET Request:** The attack vector is an HTTP GET request to the `/goform/fast_setting_wifi_set` page of the router. The malicious payload is sent within the `ssid` parameter.
- **Network Access:** The attacker would need network access to the router. This could be either local access or remote access if the router's administration interface is exposed to the internet.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be on the same network as the router or have the ability to send HTTP requests to the router.
- **Basic HTTP Knowledge:** Knowledge of how to send HTTP GET requests is required.
- **No Authentication Required (Inferred):** The document does not mention any authentication being required for this specific attack vector. This suggests that the vulnerability is accessible to anyone who can reach the `/goform/fast_setting_wifi_set` endpoint.
- **Vulnerable Router Model:** The attacker needs a Tenda AC18 router running the vulnerable firmware version.

**Additional Details:**
- The vulnerability affects the latest version of the Tenda AC18 Router, specifically [AC18\_V15.03.05.19(6318)](https://www.tenda.com.cn/download/detail-2683.html).
- A Proof-of-Concept (PoC) script is provided in Python, which demonstrates how to send a malicious request to cause the DoS.
- The issue was reported to both CVE and CNVD, and CVE-2022-30473 and CNVD-2022-43197 were assigned respectively.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.5438 | dense, sparse, graph | dense: 0.471, sparse: 0.104, graph: 0.767 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4118 | sparse, graph | sparse: 0.095, graph: 1.000 |
| 3 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.3760 | sparse, graph | sparse: 0.097, graph: 0.984 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3673 | dense, sparse | dense: 0.600, sparse: 0.171 |
| 5 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3300 | sparse, graph | sparse: 0.084, graph: 0.789 |
| 6 | CWE-676 | Use of Potentially Dangerous Function | Base | Allowed | 0.2871 | dense, sparse | dense: 0.463, sparse: 0.096 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2689 | dense, sparse | dense: 0.474, sparse: 0.094 |
| 8 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2649 | sparse, graph | sparse: 0.087, graph: 0.602 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2619 | dense, sparse | dense: 0.473, sparse: 0.083 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.0522 | sparse | sparse: 0.091 |

