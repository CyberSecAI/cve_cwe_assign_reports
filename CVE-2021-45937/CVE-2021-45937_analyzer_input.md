# Vulnerability Information: CVE-2021-45937

## Vulnerability Description
wolfSSL wolfMQTT 1.9 has a **heap-based buffer overflow** in MqttClient_DecodePacket (called from MqttClient_WaitType and MqttClient_Connect).

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** wolfSSL wolfMQTT
- **version:** 1.9
- **component:** MqttClient_DecodePacket

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 24)

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "Heap-buffer-overflow in MqttClient_DecodePacket",
    "weaknesses": [
      "Heap-buffer-overflow"
    ],
    "impact": "Crash (WRITE)",
    "attack_vectors": "MQTT packet processing",
    "required_capabilities": "Malformed MQTT packet"
  },
  "additional_details": {
    "vulnerable_function": "MqttClient_DecodePacket",
     "crash_state": "MqttClient_WaitType, MqttClient_Connect",
     "fix_commit": "84d4b53122e0fa0280c7872350b89d5777dabbb2",
     "introduced_commit": "237f693c5731dcbd6adc9de69d9f575421c4414e"
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6746 | dense, sparse, graph | dense: 0.566, sparse: 0.108, graph: 0.923 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6205 | dense, sparse, graph | dense: 0.564, sparse: 0.115, graph: 0.762 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5431 | dense, sparse, graph | dense: 0.579, sparse: 0.116, graph: 0.650 |
| 4 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.3744 | sparse, graph | sparse: 0.106, graph: 0.878 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3610 | dense, sparse | dense: 0.598, sparse: 0.160 |
| 6 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3270 | dense, sparse | dense: 0.545, sparse: 0.095 |
| 7 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3268 | dense, sparse | dense: 0.542, sparse: 0.097 |
| 8 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3244 | dense, sparse | dense: 0.534, sparse: 0.100 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3235 | dense, sparse | dense: 0.530, sparse: 0.102 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3163 | dense, sparse | dense: 0.515, sparse: 0.103 |

