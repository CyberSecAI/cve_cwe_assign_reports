# Vulnerability Information: CVE-2022-35877

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the XCMD testWifiAP functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9X and 6.9Z. Specially-crafted configuration values can lead to memory corruption, information disclosure and denial of service. An attacker can modify a configuration value and then execute an XCMD to trigger these vulnerabilities.This vulnerability arises from **format string injection** via the `default_key_id` configuration parameter, as used within the `testWifiAP` XCMD handler

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **vector:** specially-crafted configuration values
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9X and 6.9Z
- **component:** XCMD testWifiAP functionality

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `log` function uses `vsnprintf` to format log messages, and attacker-controlled configuration values are directly injected into the format string parameter of `log` without proper sanitization or validation in multiple instances within the `testWifiAP` XCMD handler.",
  "Weaknesses/vulnerabilities present": [
    "Format string injection vulnerability",
    "Lack of input sanitization/validation",
    "Use of attacker-controlled data in format strings"
  ],
  "Impact of exploitation": "Memory corruption, information disclosure, and denial of service. The format string injection allows attackers to potentially leak stack memory and write arbitrary memory.",
  "Attack vectors": "An attacker can exploit this vulnerability by modifying the Wi-Fi configuration values (e.g., SSID, WPA password, WEP key) via the mobile app, web app, or by using the setWifiAP XCMD or local web interface, then triggering the vulnerable testWifiAP XCMD.",
  "Required attacker capabilities/position": "An attacker needs to be able to modify the Wi-Fi configuration parameters and send the crafted testWifiAP XCMD, which can be achieved through an unauthenticated UDP service on port 55050.",
   "Additional Details": "The vulnerability exists in multiple locations inside the `do_test_wifiap` function when handling various Wi-Fi configuration settings. The output of the format string injections is only visible to an attacker with physical access to the device's UART console."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.1114 | dense, sparse, graph | dense: 0.693, sparse: 0.893, graph: 0.709 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7111 | dense, sparse, graph | dense: 0.610, sparse: 0.332, graph: 0.604 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5404 | sparse, graph | sparse: 0.320, graph: 1.000 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5071 | sparse, graph | sparse: 0.335, graph: 0.882 |
| 5 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4558 | dense, sparse | dense: 0.561, sparse: 0.306 |
| 6 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4501 | sparse, graph | sparse: 0.294, graph: 0.789 |
| 7 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4347 | dense, sparse | dense: 0.567, sparse: 0.300 |
| 8 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.4176 | dense, sparse | dense: 0.558, sparse: 0.303 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2069 | dense, sparse | dense: 0.567, sparse: 0.312 |
| 10 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.1783 | sparse | sparse: 0.312 |

