# Vulnerability Information: CVE-2022-40992

## Vulnerability Description
Several **stack-based buffer overflow** vulnerabilities exist in the DetranCLI command parsing functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. A specially-crafted network packet can lead to arbitrary command execution. An attacker can send a sequence of requests to trigger these vulnerabilities.This buffer overflow is in the function that manages the no firmwall domain WORD description (WORD|null) command template.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** arbitrary command execution
- **vector:** specially-crafted network packet
- **attacker:** attacker
- **product:** Siretta QUARTZ-GOLD
- **version:** G5.0.1.5-210720-141020
- **component:** DetranCLI command parsing functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-120

#### Top CWEs
- CWE-120 (Count: 131)
- CWE-787 (Count: 40)
- CWE-78 (Count: 4)

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `DetranCLI` binary uses `sprintf` with format strings and command parameters without checking the size of the input parameters against the size of the stack buffer, leading to stack-based buffer overflows.",
  "Weaknesses/vulnerabilities present": "Stack-based buffer overflow.",
  "Impact of exploitation": "Arbitrary command execution.",
  "Attack vectors": "Sending specially crafted network packets.",
  "Required attacker capabilities/position": "The attacker needs to be able to send network packets to the device. The specific capabilities required are not explicitly mentioned but are implied to include access to the network where the device is connected.",
  "CVE ID": "CVE-2022-40992",
  "Additional Details": "This specific vulnerability (CVE-2022-40992) is triggered by the command `no firmwall domain WORD description (WORD|null)`. The vulnerable code is `sprintf(stack_0x80,\"%d<%s<%s\",1,*argv,argv[1]);` where `stack_0x80` is a stack buffer of size 0x80 and the `WORD` parameter is not size checked before being copied into the buffer via `sprintf`."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 1.0667 | dense, sparse, graph | dense: 0.706, sparse: 0.838, graph: 0.797 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.8100 | dense, sparse, graph | dense: 0.574, sparse: 0.350, graph: 0.901 |
| 3 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7991 | dense, sparse, graph | dense: 0.569, sparse: 0.324, graph: 0.921 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6560 | dense, sparse, graph | dense: 0.587, sparse: 0.294, graph: 0.696 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4882 | dense, sparse | dense: 0.664, sparse: 0.344 |
| 6 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4628 | dense, sparse | dense: 0.580, sparse: 0.301 |
| 7 | CWE-170 | Improper Null Termination | Base | Allowed | 0.4472 | sparse, graph | sparse: 0.288, graph: 0.789 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4419 | dense, sparse | dense: 0.594, sparse: 0.317 |
| 9 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2672 | dense, sparse | dense: 0.581, sparse: 0.287 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.2061 | dense, sparse | dense: 0.574, sparse: 0.303 |

