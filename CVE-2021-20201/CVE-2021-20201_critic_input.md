# Critic Input for CVE-2021-20201



# Original Analyzer Input
## Vulnerability Description
A flaw was found in spice in versions before 0.14.92. A DoS tool might make it easier for remote attackers to cause a denial of service (CPU consumption) by performing many renegotiations within a single connection.

### Vulnerability Description Key Phrases
- **impact:** denial of service
- **vector:** many renegotiations within a single connection
- **attacker:** remote attackers
- **product:** spice
- **version:** before 0.14.92

## CVE Reference Links Content Summary
Based on the provided documents, here's an analysis of CVE-2021-20201:

**1. Verification of CVE Relevance:**

The content explicitly mentions CVE-2021-20201 in multiple locations:

*   The commit messages on gitlab.freedesktop.org reference the fix for issue #49 related to "OpenSSL(TLS/SSL) Security DoS Vulnerability - enables client-initiated renegotiation," and "Fixes BZ#1904459". BZ#1904459 is associated with CVE-2021-20201.
*   The Red Hat Security Advisory RHSA-2021:1924 specifically lists "spice: Client initiated renegotiation denial of service (CVE-2021-20201)" as a security fix.
*   The bugzilla entries for bugs 1904459 and 1921846 are both linked to CVE-2021-20201, and their summaries mention the vulnerability.
*   Gentoo security advisory GLSA 202208-10 lists CVE-2021-20201 as one of the fixed vulnerabilities in Spice Server.

Therefore, the content is highly relevant to CVE-2021-20201.

**2. Vulnerability Details:**

*   **Root Cause:** The vulnerability stems from the improper handling of client-initiated renegotiation in the SPICE (Simple Protocol for Independent Computing Environments) server when using TLS. The SPICE server was allowing clients to initiate TLS renegotiation which is a resource intensive process for the server and can cause a denial of service.
*   **Weaknesses:** The main weakness is the lack of proper restrictions on client-initiated renegotiation, which allows an attacker to repeatedly trigger this process and consume excessive CPU resources on the server leading to a denial of service.
*   **Impact of Exploitation:** Successful exploitation leads to a denial-of-service condition, causing the SPICE server to become unresponsive or crash. This impacts the availability of virtual machines that rely on the SPICE display system and prevents users from accessing their virtualized desktops remotely.
*  **Attack Vectors:** The attack vector is network-based. A malicious client can send a stream of requests that trigger TLS renegotiation, exploiting the server's handling of the process.
*  **Required Attacker Capabilities/Position:** The attacker needs to be able to establish a TLS connection with the SPICE server. The attacker does not require any special privileges or authentication to trigger the vulnerability.

**3. Technical Details:**

*   **OpenSSL:** The vulnerability is related to how SPICE uses the OpenSSL library.  The issue arises because OpenSSL, by default, allows client-initiated renegotiation.
*   **Mitigation:** The fix involves disabling client-initiated renegotiation using OpenSSL API calls.
    *   For OpenSSL versions 1.0.2 and earlier, the fix uses the `SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS` flag.
    *   For OpenSSL versions 1.1.0 and later, the fix uses the `SSL_OP_NO_RENEGOTIATION` option.
*   **testssl.sh:** The `testssl.sh` tool was used to detect the vulnerability. The output shows that a server was "VULNERABLE (NOT ok)" to "Secure Client-Initiated Renegotiation," indicating a potential DoS threat.

**4. Additional Details from Content:**

*   The Qualys blog mentions that the issue isn't new but there is a well publicized working exploit, which is a DoS tool developed by THC called "thc-ssl-dos". The tool uses renegotiation to force many expensive cryptographic operations over a single TCP connection.
*   The vulnerability is also known as the TLS Renegotiation DoS attack which has been seen in other products like Apache and Lighttpd.
*  Red Hat's severity rating for this vulnerability was Low.
*  The vulnerability affects various Red Hat products.

**5. Summary:**

CVE-2021-20201 is a denial-of-service vulnerability in SPICE server that arises from allowing client-initiated TLS renegotiation. An attacker can exploit this vulnerability to exhaust the server's CPU resources, making it unavailable. The vulnerability is mitigated by disabling client-initiated renegotiation using specific OpenSSL flags and options.

The provided documents offer a comprehensive view of the vulnerability including its root cause, exploitation mechanism, impact, and mitigation, and therefore provide more detail than a typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.5250 | dense, sparse, graph | dense: 0.542, sparse: 0.060, graph: 0.614 |
| 2 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.4892 | dense, sparse, graph | dense: 0.530, sparse: 0.054, graph: 0.539 |
| 3 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.2810 | dense, sparse | dense: 0.496, sparse: 0.057 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.2779 | dense, sparse | dense: 0.498, sparse: 0.050 |
| 5 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.2697 | dense, sparse | dense: 0.523, sparse: 0.053 |
| 6 | CWE-405 | Asymmetric Resource Consumption (Amplification) | Class | Allowed-with-Review | 0.2689 | dense, sparse, graph | dense: 0.531, sparse: 0.092, graph: 0.390 |
| 7 | CWE-407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | 0.2518 | dense, sparse, graph | dense: 0.511, sparse: 0.061, graph: 0.386 |
| 8 | CWE-400 | Uncontrolled Resource Consumption | Class | Discouraged | 0.1985 | dense, sparse, graph | dense: 0.539, sparse: 0.062, graph: 0.387 |
| 9 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.1568 | sparse, graph | sparse: 0.049, graph: 0.359 |
| 10 | CWE-1176 | Inefficient CPU Computation | Class | Allowed-with-Review | 0.1007 | sparse, graph | sparse: 0.060, graph: 0.383 |



# Analysis to Review
# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.85 | Base | Allowed | Primary CWE |
| CWE-400 | Uncontrolled Resource Consumption | 0.6 | Class | Discouraged | Secondary Candidate |
| CWE-405 | Asymmetric Resource Consumption (Amplification) | 0.5 | Class | Allowed-with-Review | Secondary Candidate |
| CWE-407 | Inefficient Algorithmic Complexity | 0.4 | Class | Allowed-with-Review | Secondary Candidate |

## Evidence and Confidence

*   **Confidence Score:** 0.85
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**
  - *Explanation:* The vulnerability description and CVE reference summary clearly point to a **lack of resource control** as the root cause of the denial-of-service. The SPICE server allows client-initiated TLS renegotiation without proper restrictions, enabling an attacker to exhaust server resources by repeatedly triggering this process. This aligns directly with CWE-770, "Allocation of Resources Without Limits or Throttling." The "CVE Reference Links Content Summary" states that the "**main weakness is the lack of proper restrictions on client-initiated renegotiation, which allows an attacker to repeatedly trigger this process and consume excessive CPU resources on the server leading to a denial of service**". The MITRE mapping guidance for CWE-770 indicates this is ALLOWED.

  - *Relationship Analysis:* CWE-770 is a base-level CWE. While CWE-400 (Uncontrolled Resource Consumption) is a more general class, CWE-770 provides a more precise characterization of the vulnerability by focusing on the lack of limits or throttling during resource allocation. CWE-770 is the primary CWE because it directly addresses the **unrestricted allocation** aspect of the vulnerability. CWE-789 (Memory Allocation with Untrusted Size Argument) is a child of CWE-770, but doesn't fit because it focuses on memory allocation based on size.

- **Confidence Score:**
  - Confidence: 0.85 (High evidence from technical description and CVE reference materials)

---
- **Analysis and Justification:**
  - *Explanation:* CWE-400 (Uncontrolled Resource Consumption) is a broader class that encompasses the denial-of-service impact resulting from the **uncontrolled resource allocation**. The "CVE Reference Links Content Summary" identifies the **impact** of the vulnerability as "**Successful exploitation leads to a denial-of-service condition, causing the SPICE server to become unresponsive or crash**". However, CWE-770 more accurately captures the root cause by focusing on the allocation itself. While CWE-400 is a valid concern, it's more of a consequence than the primary weakness. Per MITRE guidance, CWE-400 is DISCOURAGED and should not be used, if there are better options.

  - *Relationship Analysis:* CWE-400 is a Class-level CWE, and CWE-770 is a more specific Base-level CWE. CWE-410 (Insufficient Resource Pool) is a child of CWE-400, but is less relevant as the issue isn't about the size of the pool itself, but rather the lack of control over resource allocation.

- **Confidence Score:**
  - Confidence: 0.6 (Sufficient evidence to show impact, but root cause is better described by CWE-770)

---
- **Analysis and Justification:**
  - *Explanation:* CWE-405 (Asymmetric Resource Consumption (Amplification)) could also be considered as the attacker is able to cause much more resource consumption by the server than the effort put in by the attacker. The "CVE Reference Links Content Summary" states that the Qualys blog mentions that the issue isn't new, but there is a well publicized working exploit, which is a DoS tool developed by THC called "thc-ssl-dos". The tool uses renegotiation to force many expensive cryptographic operations over a single TCP connection.

  - *Relationship Analysis:* CWE-405 is a Class-level CWE, and CWE-770 is a more specific Base-level CWE.

- **Confidence Score:**
  - Confidence: 0.5 (The concept of amplification is in play, but it may be too general)

---
- **Analysis and Justification:**
  - *Explanation:* CWE-407 (Inefficient Algorithmic Complexity) - The client-initiated TLS renegotiation is resource-intensive. The "CVE Reference Links Content Summary" states that the **SPICE server was allowing clients to initiate TLS renegotiation which is a resource intensive process for the server and can cause a denial of service**.

  - *Relationship Analysis:* CWE-407 is a Class-level CWE, and CWE-770 is a more specific Base-level CWE.

- **Confidence Score:**
  - Confidence: 0.4 (The algorithmic complexity is a factor, but it may be too general)

# CWE Examples from Database


## Known Examples for CWE-400: Uncontrolled Resource Consumption
### Observed Examples
- **CVE-2022-21668** [https://www.cve.org/CVERecord?id=CVE-2022-21668](https://www.cve.org/CVERecord?id=CVE-2022-21668): Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2020-7218** [https://www.cve.org/CVERecord?id=CVE-2020-7218](https://www.cve.org/CVERecord?id=CVE-2020-7218): Go-based workload orchestrator does not limit resource usage with unauthenticated connections, allowing a DoS by flooding the service
- **CVE-2020-3566** [https://www.cve.org/CVERecord?id=CVE-2020-3566](https://www.cve.org/CVERecord?id=CVE-2020-3566): Resource exhaustion in distributed OS because of "insufficient" IGMP queue management, as exploited in the wild per CISA KEV.
- **CVE-2009-2874** [https://www.cve.org/CVERecord?id=CVE-2009-2874](https://www.cve.org/CVERecord?id=CVE-2009-2874): Product allows attackers to cause a crash via a large number of connections.
- **CVE-2009-1928** [https://www.cve.org/CVERecord?id=CVE-2009-1928](https://www.cve.org/CVERecord?id=CVE-2009-1928): Malformed request triggers uncontrolled recursion, leading to stack exhaustion.
- **CVE-2009-2858** [https://www.cve.org/CVERecord?id=CVE-2009-2858](https://www.cve.org/CVERecord?id=CVE-2009-2858): Chain: memory leak (CWE-404) leads to resource exhaustion.
- **CVE-2009-2726** [https://www.cve.org/CVERecord?id=CVE-2009-2726](https://www.cve.org/CVERecord?id=CVE-2009-2726): Driver does not use a maximum width when invoking sscanf style functions, causing stack consumption.
- **CVE-2009-2540** [https://www.cve.org/CVERecord?id=CVE-2009-2540](https://www.cve.org/CVERecord?id=CVE-2009-2540): Large integer value for a length property in an object causes a large amount of memory allocation.
- **CVE-2009-2299** [https://www.cve.org/CVERecord?id=CVE-2009-2299](https://www.cve.org/CVERecord?id=CVE-2009-2299): Web application firewall consumes excessive memory when an HTTP request contains a large Content-Length value but no POST data.
- **CVE-2009-2054** [https://www.cve.org/CVERecord?id=CVE-2009-2054](https://www.cve.org/CVERecord?id=CVE-2009-2054): Product allows exhaustion of file descriptors when processing a large number of TCP packets.


# Relevant CWE Specifications

## CWE-400: Uncontrolled Resource Consumption
**Abstraction:** Class
**Status:** Draft

### Description
The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.

### Extended Description


Limited resources include memory, file system storage, database connection pool entries, and CPU. If an attacker can trigger the allocation of these limited resources, but the number or size of the resources is not controlled, then the attacker could cause a denial of service that consumes all available resources. This would prevent valid users from accessing the product, and it could potentially have an impact on the surrounding environment. For example, a memory exhaustion attack against an application could slow down the application as well as its host operating system.


There are at least three distinct scenarios which can commonly lead to resource exhaustion:


  - Lack of throttling for the number of allocated resources

  - Losing all references to a resource before reaching the shutdown stage

  - Not closing/returning a resource after processing

Resource exhaustion problems are often result due to an incorrect implementation of the following situations:

  - Error conditions and other exceptional circumstances.

  - Confusion over which part of the program is responsible for releasing the resource.



### Alternative Terms
Resource Exhaustion

### Relationships
ChildOf -> CWE-664
ParentOf -> CWE-1235
ParentOf -> CWE-1246
ParentOf -> CWE-405
CanFollow -> CWE-410
ParentOf -> CWE-770
ParentOf -> CWE-771
ParentOf -> CWE-779
ParentOf -> CWE-920

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the "technical impact" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).
**Comments:** Closely analyze the specific mistake that is causing resource consumption, and perform a CWE mapping for that mistake. Consider children/descendants such as CWE-770: Allocation of Resources Without Limits or Throttling, CWE-771: Missing Reference to Active Allocated Resource, CWE-410: Insufficient Resource Pool, CWE-772: Missing Release of Resource after Effective Lifetime, CWE-834: Excessive Iteration, CWE-405: Asymmetric Resource Consumption (Amplification), and others.
**Reasons:**
- Frequent Misuse


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** Design throttling mechanisms into the system architecture. The best protection is to limit the amount of resources that an unauthorized user can cause to be expended. A strong authentication and access control model will help prevent such attacks from occurring in the first place. The login application should be protected against DoS attacks as much as possible. Limiting the database access, perhaps by caching result sets, can help minimize the resources expended. To further limit the potential for a DoS attack, consider tracking the rate of requests received from users and blocking requests that exceed a defined rate threshold.

**Mitigation 2:**
- **Phase:** Architecture and Design
- **Description:** 

Mitigation of resource exhaustion attacks requires that the target system either:


  - recognizes the attack and denies that user further access for a given amount of time, or

  - uniformly throttles all requests in order to make it more difficult to consume resources more quickly than they can again be freed.

The first of these solutions is an issue in itself though, since it may allow attackers to prevent the use of the system by a particular valid user. If the attacker impersonates the valid user, they may be able to prevent the user from accessing the server in question.

The second solution is simply difficult to effectively institute -- and even when properly done, it does not provide a full solution. It simply makes the attack require more resources on the part of the attacker.


**Mitigation 3:**
- **Phase:** Architecture and Design
- **Description:** Ensure that protocols have specific limits of scale placed on them.



### Additional Notes
**[Maintenance]** "Resource consumption" could be interpreted as a consequence instead of an insecure behavior, so this entry is being considered for modification. It appears to be referenced too frequently when more precise mappings are available. Some of its children, such as CWE-771, might be better considered as a chain.

**[Theoretical]** Vulnerability theory is largely about how behaviors and resources interact. "Resource exhaustion" can be regarded as either a consequence or an attack, depending on the perspective. This entry is an attempt to reflect the underlying weaknesses that enable these attacks (or consequences) to take place.

**[Other]** 

Database queries that take a long time to process are good DoS targets. An attacker would have to write a few lines of Perl code to generate enough traffic to exceed the site's ability to keep up. This would effectively prevent authorized users from using the site at all. Resources can be exploited simply by ensuring that the target machine must do much more work and consume more resources in order to service a request than the attacker must do to initiate a request.


A prime example of this can be found in old switches that were vulnerable to "macof" attacks (so named for a tool developed by Dugsong). These attacks flooded a switch with random IP and MAC address combinations, therefore exhausting the switch's cache, which held the information of which port corresponded to which MAC addresses. Once this cache was exhausted, the switch would fail in an insecure way and would begin to act simply as a hub, broadcasting all traffic on all ports and allowing for basic sniffing attacks.


**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2020-7218:** Go-based workload orchestrator does not limit resource usage with unauthenticated connections, allowing a DoS by flooding the service
- **CVE-2020-3566:** Resource exhaustion in distributed OS because of "insufficient" IGMP queue management, as exploited in the wild per CISA KEV.



## CWE-410: Insufficient Resource Pool
**Abstraction:** Base
**Status:** Incomplete

### Description
The product's resource pool is not large enough to handle peak demand, which allows an attacker to prevent others from accessing the resource by using a (relatively) large number of requests for resources.

### Extended Description
Frequently the consequence is a "flood" of connection or sessions.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-664
CanPrecede -> CWE-400

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** Do not perform resource-intensive transactions for unauthenticated users and/or invalid requests.

**Mitigation 2:**
- **Phase:** Architecture and Design
- **Description:** Consider implementing a velocity check mechanism which would detect abusive behavior.

**Mitigation 3:**
- **Phase:** Operation
- **Description:** Consider load balancing as an option to handle heavy loads.




### Observed Examples
- **CVE-1999-1363:** Large number of locks on file exhausts the pool and causes crash.
- **CVE-2001-1340:** Product supports only one connection and does not disconnect a user who does not provide credentials.
- **CVE-2002-0406:** Large number of connections without providing credentials allows connection exhaustion.



## CWE-789: Memory Allocation with Excessive Size Value
**Abstraction:** Variant
**Status:** Draft

### Description
The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated.

### Extended Description
Not provided

### Alternative Terms
Stack Exhaustion: When a weakness allocates excessive memory on the stack, it is often described as "stack exhaustion," which is a technical impact of the weakness. This technical impact is often encountered as a consequence of CWE-789 and/or CWE-1325.

### Relationships
ChildOf -> CWE-770
CanPrecede -> CWE-476
CanFollow -> CWE-1284
CanFollow -> CWE-129

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Implementation, Architecture and Design
- **Description:** Perform adequate input validation against any value that influences the amount of memory that is allocated. Define an appropriate strategy for handling requests that exceed the limit, and consider supporting a configuration option so that the administrator can extend the amount of memory to be used if necessary.

**Mitigation 2:**
- **Phase:** Operation
- **Description:** Run your program using system-provided resource limits for memory. This might still cause the program to crash or exit, but the impact to the rest of the system will be minimized.



### Additional Notes
**[Relationship]** This weakness can be closely associated with integer overflows (CWE-190). Integer overflow attacks would concentrate on providing an extremely large number that triggers an overflow that causes less memory to be allocated than expected. By providing a large value that does not trigger an integer overflow, the attacker could still cause excessive amounts of memory to be allocated.

**[Applicable Platform]** 

Uncontrolled memory allocation is possible in many languages, such as dynamic array allocation in perl or initial size parameters in Collections in Java. However, languages like C and C++ where programmers have the power to more directly control memory management will be more susceptible.




### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2010-3701:** program uses ::alloca() for encoding messages, but large messages trigger segfault
- **CVE-2008-1708:** memory consumption and daemon exit by specifying a large value in a length field



## CWE-405: Asymmetric Resource Consumption (Amplification)
**Abstraction:** Class
**Status:** Incomplete

### Description
The product does not properly control situations in which an adversary can cause the product to consume or produce excessive resources without requiring the adversary to invest equivalent work or otherwise prove authorization, i.e., the adversary's influence is "asymmetric."

### Extended Description
This can lead to poor performance due to "amplification" of resource consumption, typically in a non-linear fashion. This situation is worsened if the product allows malicious users or attackers to consume more resources than their access level permits.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-400
ParentOf -> CWE-1050
ParentOf -> CWE-1089
ParentOf -> CWE-1176
ParentOf -> CWE-406
ParentOf -> CWE-407
ParentOf -> CWE-408
ParentOf -> CWE-409
ParentOf -> CWE-776

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** An application must make resources available to a client commensurate with the client's access level.

**Mitigation 2:**
- **Phase:** Architecture and Design
- **Description:** An application must, at all times, keep track of allocated resources and meter their usage appropriately.

**Mitigation 3:**
- **Phase:** System Configuration
- **Effectiveness:** High
- **Description:** Consider disabling resource-intensive algorithms on the server side, such as Diffie-Hellman key exchange.




### Observed Examples
- **CVE-1999-0513:** Classic "Smurf" attack, using spoofed ICMP packets to broadcast addresses.
- **CVE-2003-1564:** Parsing library allows XML bomb
- **CVE-2004-2458:** Tool creates directories before authenticating user.



## CWE-770: Allocation of Resources Without Limits or Throttling
**Abstraction:** Base
**Status:** Incomplete

### Description
The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.

### Extended Description


Code frequently has to work with limited resources, so programmers must be careful to ensure that resources are not consumed too quickly, or too easily. Without use of quotas, resource limits, or other protection mechanisms, it can be easy for an attacker to consume many resources by rapidly making many requests, or causing larger resources to be used than is needed. When too many resources are allocated, or if a single resource is too large, then it can prevent the code from working correctly, possibly leading to a denial of service.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-400
ChildOf -> CWE-665
ChildOf -> CWE-400
ParentOf -> CWE-1325
CanFollow -> CWE-20
ParentOf -> CWE-774
ParentOf -> CWE-789

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Requirements
- **Description:** Clearly specify the minimum and maximum expectations for capabilities, and dictate which behaviors are acceptable when resource allocation reaches limits.

**Mitigation 2:**
- **Phase:** Architecture and Design
- **Description:** Limit the amount of resources that are accessible to unprivileged users. Set per-user limits for resources. Allow the system administrator to define these limits. Be careful to avoid CWE-410.

**Mitigation 3:**
- **Phase:** Architecture and Design
- **Description:** Design throttling mechanisms into the system architecture. The best protection is to limit the amount of resources that an unauthorized user can cause to be expended. A strong authentication and access control model will help prevent such attacks from occurring in the first place, and it will help the administrator to identify who is committing the abuse. The login application should be protected against DoS attacks as much as possible. Limiting the database access, perhaps by caching result sets, can help minimize the resources expended. To further limit the potential for a DoS attack, consider tracking the rate of requests received from users and blocking requests that exceed a defined rate threshold.



### Additional Notes
**[Relationship]** This entry is different from uncontrolled resource consumption (CWE-400) in that there are other weaknesses that are related to inability to control resource consumption, such as holding on to a resource too long after use, or not correctly keeping track of active resources so that they can be managed and released when they are finished (CWE-771).

**[Theoretical]** Vulnerability theory is largely about how behaviors and resources interact. "Resource exhaustion" can be regarded as either a consequence or an attack, depending on the perspective. This entry is an attempt to reflect one of the underlying weaknesses that enable these attacks (or consequences) to take place.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2009-4017:** Language interpreter does not restrict the number of temporary files being created when handling a MIME request with a large number of parts..
- **CVE-2009-2726:** Driver does not use a maximum width when invoking sscanf style functions, causing stack consumption.



## CWE-407: Inefficient Algorithmic Complexity
**Abstraction:** Class
**Status:** Incomplete

### Description
An algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.

### Extended Description
Not provided

### Alternative Terms
Quadratic Complexity: Used when the algorithmic complexity is related to the square of the number of inputs (N^2)

### Relationships
ChildOf -> CWE-405
ParentOf -> CWE-1333

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction




### Observed Examples
- **CVE-2021-32617:** C++ library for image metadata has "quadratic complexity" issue with unnecessarily repetitive parsing each time an invalid character is encountered
- **CVE-2020-10735:** Python has "quadratic complexity" issue when converting string to int with many digits in unexpected bases
- **CVE-2020-5243:** server allows ReDOS with crafted User-Agent strings, due to overlapping capture groups that cause excessive backtracking.

