# Vulnerability Information: CVE-2021-26731

## Vulnerability Description
Command injection and multiple **stack-based buffer overflows** vulnerabilities in the modifyUserb_func function of spx_restservice allow an attacker to execute arbitrary code with the same privileges as the server user (root). This issue affects Lanner Inc IAC-AST2500A standard firmware version 1.10.0.

### Vulnerability Description Key Phrases
- **rootcause:** **off-by-null dereference**
- **weakness:** **command injection and stack-based buffer overflows**
- **impact:** execute arbitrary code with the same privileges as the server user (root)
- **attacker:** attacker
- **product:** Lanner Inc IAC-AST2500A
- **version:** standard firmware version 1.10.0
- **component:** modifyUserb_func function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-77

#### Top CWEs
- CWE-77 (Count: 12)
- CWE-787 (Count: 12)

## CVE Reference Links Content Summary
The provided content is related to CVE-2021-26731.

**Root Cause of the Vulnerability:**
The vulnerability is located in the `modifyUserb_func` function within the `spx_restservice`. This function is susceptible to a command injection and multiple stack-based buffer overflows. Specifically, the vulnerability arises due to insufficient input validation of the username parameter, which is then used in `strcat` operation and `safe_system` call, without proper bounds checking.

**Weaknesses/Vulnerabilities Present:**
*   **Command Injection:** The `safe_system` function allows the injection of arbitrary OS commands, which are then executed on the device.
*   **Stack-based Buffer Overflows:** The use of `strcat` to copy user-controlled input into a fixed-size buffer without length checks leads to stack-based buffer overflows.

**Impact of Exploitation:**
*   **Remote Code Execution (RCE):** An attacker can achieve RCE on the BMC with root privileges.
*   **Complete Compromise:** Successful exploitation leads to the complete compromise of the BMC.
*   **Control of Managed Host:** The attacker gains control of the managed host due to the BMC's access to low-level system operations.

**Attack Vectors:**
*   **Network:** The vulnerability is accessible through the web interface of the BMC.
*   **HTTP Parameter:** The `username` parameter in the HTTP request is the attack vector.

**Required Attacker Capabilities/Position:**
*   **Network Access:** The attacker needs network access to the vulnerable BMC.
*   **Authenticated Access:** The attacker needs authenticated access to trigger the vulnerability. The CVE description indicates a *high* privilege requirement.
*   **No user interaction** is required to trigger this vulnerability.

**Additional Notes**
*   The affected Lanner IAC-AST2500A expansion card uses AMI MegaRAC SP-X firmware.
*   The vulnerability is present in version 1.10.0 of the standard firmware of Lanner IAC-AST2500.
*   The content provides additional context to CVE-2021-26731, describing the vulnerable function `modifyUserb_func`, the command injection and multiple stack-based buffer overflow weaknesses.
*   The content details an attack chain example with CVE-2021-44467 and CVE-2021-26728, whereas CVE-2021-26731 is only mentioned in the list of vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7528 | dense, sparse, graph | dense: 0.649, sparse: 0.359, graph: 0.622 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7447 | dense, sparse, graph | dense: 0.584, sparse: 0.357, graph: 0.792 |
| 3 | CWE-193 | Off-by-one Error | Base | Allowed | 0.5592 | sparse, graph | sparse: 0.353, graph: 1.000 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.5536 | dense, sparse | dense: 0.671, sparse: 0.461 |
| 5 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.4809 | dense, sparse | dense: 0.604, sparse: 0.312 |
| 6 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.4565 | sparse, graph | sparse: 0.312, graph: 0.777 |
| 7 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3842 | dense, sparse | dense: 0.597, sparse: 0.181 |
| 8 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2285 | dense, sparse | dense: 0.609, sparse: 0.360 |
| 9 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2010 | sparse | sparse: 0.351 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.1970 | sparse | sparse: 0.344 |

