# Critic Input for CVE-2020-36476



# Original Analyzer Input
## Vulnerability Description
An issue was discovered in Mbed TLS before 2.24.0 (and before 2.16.8 LTS and before 2.7.17 LTS). There is **missing zeroization of plaintext buffers** in mbedtls_ssl_read to erase unused application data from memory.

### Vulnerability Description Key Phrases
- **rootcause:** **missing zeroization of plaintext buffers**
- **product:** Mbed TLS
- **version:** before 2.24.0, 2.16.8 LTS, and 2.7.17 LTS
- **component:** mbedtls_ssl_read

## CVE Reference Links Content Summary
```text
- Root cause of vulnerability:
  - When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available.
  - On builds without MBEDTLS_HAVE_TIME_DATE, certificates were never considered as revoked.
  - On builds with MBEDTLS_HAVE_TIME_DATE, an attacker able to control the local clock could prevent revocation of certificates via CRLs.

- Weaknesses/vulnerabilities present:
  - Incorrect handling of revocationDate field in X.509 CRLs.
  - Vulnerability to time-based attacks where the attacker manipulates the local clock.
  - Inconsistency in certificate revocation checks based on MBEDTLS_HAVE_TIME_DATE configuration.

- Impact of exploitation:
  - An attacker can bypass certificate revocation checks.
  - Allows for the use of revoked certificates, potentially leading to unauthorized access.

- Attack vectors:
  - Manipulation of the local system clock to bypass revocation checks (when MBEDTLS_HAVE_TIME_DATE is enabled).
  - Exploiting the lack of revocation checks when MBEDTLS_HAVE_TIME_DATE is disabled.

- Required attacker capabilities/position:
  - The attacker needs to be in a position to manipulate the local clock (when MBEDTLS_HAVE_TIME_DATE is enabled).
  - The attacker can also exploit the vulnerability if MBEDTLS_HAVE_TIME_DATE is disabled, requiring no special capabilities.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | 0.6658 | dense, sparse, graph | dense: 0.535, sparse: 0.329, graph: 0.587 |
| 2 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.5712 | dense, sparse, graph | dense: 0.513, sparse: 0.176, graph: 0.598 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5565 | dense, sparse, graph | dense: 0.574, sparse: 0.166, graph: 0.618 |
| 4 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4489 | sparse, graph | sparse: 0.160, graph: 1.000 |
| 5 | CWE-208 | Observable Timing Discrepancy | Base | Allowed | 0.3701 | sparse, graph | sparse: 0.154, graph: 0.789 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3472 | dense, sparse | dense: 0.518, sparse: 0.154 |
| 7 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3352 | dense, sparse | dense: 0.551, sparse: 0.153 |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3110 | sparse, graph | sparse: 0.149, graph: 0.631 |
| 9 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.2125 | dense, sparse | dense: 0.542, sparse: 0.159 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.0875 | sparse | sparse: 0.153 |



# Analysis to Review
# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-226 | Sensitive Information in Resource Not Removed Before Reuse | 0.85 | Base | Allowed | Primary CWE |

## Evidence and Confidence

*   **Confidence Score:** 0.85
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**  
  - *Explanation:* The vulnerability description states "**missing zeroization of plaintext buffers** in mbedtls_ssl_read to erase unused application data from memory". This aligns with CWE-226 [Sensitive Information in Resource Not Removed Before Reuse], where a resource (in this case, plaintext buffers) is not cleared or zeroized after use, potentially exposing sensitive information. The vulnerability lies in the failure to remove sensitive data from a resource before it is reallocated, which aligns directly with the CWE description.
  
  - *Relationship Analysis:* No direct relationships are listed for CWE-226 in the provided data. However, it can be inferred that a failure to zeroize memory might lead to information leakage or exposure of sensitive data, potentially leading to vulnerabilities like CWE-200 [Exposure of Sensitive Information to an Unauthorized Actor].

- **Confidence Score:**  
  - *Example:* Confidence: 0.85 (High evidence from vulnerability description and alignment with CWE-226 description)

# CWE Examples from Database


## Known Examples for CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
### Observed Examples
- **CVE-2022-31162** [https://www.cve.org/CVERecord?id=CVE-2022-31162](https://www.cve.org/CVERecord?id=CVE-2022-31162): Rust library leaks Oauth client details in application debug logs
- **CVE-2021-25476** [https://www.cve.org/CVERecord?id=CVE-2021-25476](https://www.cve.org/CVERecord?id=CVE-2021-25476): Digital Rights Management (DRM) capability for mobile platform leaks pointer information, simplifying ASLR bypass
- **CVE-2001-1483** [https://www.cve.org/CVERecord?id=CVE-2001-1483](https://www.cve.org/CVERecord?id=CVE-2001-1483): Enumeration of valid usernames based on inconsistent responses
- **CVE-2001-1528** [https://www.cve.org/CVERecord?id=CVE-2001-1528](https://www.cve.org/CVERecord?id=CVE-2001-1528): Account number enumeration via inconsistent responses.
- **CVE-2004-2150** [https://www.cve.org/CVERecord?id=CVE-2004-2150](https://www.cve.org/CVERecord?id=CVE-2004-2150): User enumeration via discrepancies in error messages.
- **CVE-2005-1205** [https://www.cve.org/CVERecord?id=CVE-2005-1205](https://www.cve.org/CVERecord?id=CVE-2005-1205): Telnet protocol allows servers to obtain sensitive environment information from clients.
- **CVE-2002-1725** [https://www.cve.org/CVERecord?id=CVE-2002-1725](https://www.cve.org/CVERecord?id=CVE-2002-1725): Script calls phpinfo(), revealing system configuration to web user
- **CVE-2002-0515** [https://www.cve.org/CVERecord?id=CVE-2002-0515](https://www.cve.org/CVERecord?id=CVE-2002-0515): Product sets a different TTL when a port is being filtered than when it is not being filtered, which allows remote attackers to identify filtered ports by comparing TTLs.
- **CVE-2004-0778** [https://www.cve.org/CVERecord?id=CVE-2004-0778](https://www.cve.org/CVERecord?id=CVE-2004-0778): Version control system allows remote attackers to determine the existence of arbitrary files and directories via the -X command for an alternate history file, which causes different error messages to be returned.
- **CVE-2000-1117** [https://www.cve.org/CVERecord?id=CVE-2000-1117](https://www.cve.org/CVERecord?id=CVE-2000-1117): Virtual machine allows malicious web site operators to determine the existence of files on the client by measuring delays in the execution of the getSystemResource method.


# Relevant CWE Specifications

## CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
**Abstraction:** Class
**Status:** Draft

### Description
The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.

### Extended Description


There are many different kinds of mistakes that introduce information exposures. The severity of the error can range widely, depending on the context in which the product operates, the type of sensitive information that is revealed, and the benefits it may provide to an attacker. Some kinds of sensitive information include:


  - private, personal information, such as personal messages, financial data, health records, geographic location, or contact details

  - system status and environment, such as the operating system and installed packages

  - business secrets and intellectual property

  - network status and configuration

  - the product's own code or internal state

  - metadata, e.g. logging of connections or message headers

  - indirect information, such as a discrepancy between two internal operations that can be observed by an outsider

Information might be sensitive to different parties, each of which may have their own expectations for whether the information should be protected. These parties include:

  - the product's own users

  - people or organizations whose information is created or used by the product, even if they are not direct product users

  - the product's administrators, including the admins of the system(s) and/or networks on which the product operates

  - the developer

Information exposures can occur in different ways:

  - the code  **explicitly inserts**  sensitive information into resources or messages that are intentionally made accessible to unauthorized actors, but should not contain the information - i.e., the information should have been "scrubbed" or "sanitized"

  - a different weakness or mistake  **indirectly inserts**  the sensitive information into resources, such as a web script error revealing the full system path of the program.

  - the code manages resources that intentionally contain sensitive information, but the resources are  **unintentionally made accessible**  to unauthorized actors. In this case, the information exposure is resultant - i.e., a different weakness enabled the access to the information in the first place.

It is common practice to describe any loss of confidentiality as an "information exposure," but this can lead to overuse of CWE-200 in CWE mapping. From the CWE perspective, loss of confidentiality is a technical impact that can arise from dozens of different weaknesses, such as insecure file permissions or out-of-bounds read. CWE-200 and its lower-level descendants are intended to cover the mistakes that occur in behaviors that explicitly manage, store, transfer, or cleanse sensitive information.

### Alternative Terms
Information Disclosure: This term is frequently used in vulnerability advisories to describe a consequence or technical impact, for any vulnerability that has a loss of confidentiality. Often, CWE-200 can be misused to represent the loss of confidentiality, even when the mistake - i.e., the weakness - is not directly related to the mishandling of the information itself, such as an out-of-bounds read that accesses sensitive memory contents; here, the out-of-bounds read is the primary weakness, not the disclosure of the memory. In addition, this phrase is also used frequently in policies and legal documents, but it does not refer to any disclosure of security-relevant information.
Information Leak: This is a frequently used term, however the "leak" term has multiple uses within security. In some cases it deals with the accidental exposure of information from a different weakness, but in other cases (such as "memory leak"), this deals with improper tracking of resources, which can lead to exhaustion. As a result, CWE is actively avoiding usage of the "leak" term.

### Relationships
ChildOf -> CWE-668
ParentOf -> CWE-1258
CanFollow -> CWE-1272
ParentOf -> CWE-1273
ParentOf -> CWE-1295
ParentOf -> CWE-201
ParentOf -> CWE-203
ParentOf -> CWE-209
ParentOf -> CWE-213
ParentOf -> CWE-215
ParentOf -> CWE-359
ParentOf -> CWE-497
CanFollow -> CWE-498
CanFollow -> CWE-499
ParentOf -> CWE-532
ParentOf -> CWE-538

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-200 is commonly misused to represent the loss of confidentiality in a vulnerability, but confidentiality loss is a technical impact - not a root cause error. As of CWE 4.9, over 400 CWE entries can lead to a loss of confidentiality. Other options are often available. [REF-1287].
**Comments:** If an error or mistake causes information to be disclosed, then use the CWE ID for that error. Consider starting with improper authorization (CWE-285), insecure permissions (CWE-732), improper authentication (CWE-287), etc. Also consider children such as Insertion of Sensitive Information Into Sent Data (CWE-201), Observable Discrepancy (CWE-203), Insertion of Sensitive Information into Externally-Accessible File or Directory (CWE-538), or others.
**Reasons:**
- Frequent Misuse


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Strategy:** Separation of Privilege
- **Description:** 

Compartmentalize the system to have "safe" areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area.


Ensure that appropriate compartmentalization is built into the system design, and the compartmentalization allows for and reinforces privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges.




### Additional Notes
**[Maintenance]** As a result of mapping analysis in the 2020 Top 25 and more recent versions, this weakness is under review, since it is frequently misused in mapping to cover many problems that lead to loss of confidentiality. See Mapping Notes, Extended Description, and Alternate Terms.



### Observed Examples
- **CVE-2022-31162:** Rust library leaks Oauth client details in application debug logs
- **CVE-2021-25476:** Digital Rights Management (DRM) capability for mobile platform leaks pointer information, simplifying ASLR bypass
- **CVE-2001-1483:** Enumeration of valid usernames based on inconsistent responses



## CWE-226: Sensitive Information in Resource Not Removed Before Reuse
**Abstraction:** Base
**Status:** Draft

### Description
The product releases a resource such as memory or a file so that it can be made available for reuse, but it does not clear or "zeroize" the information contained in the resource before the product performs a critical state transition or makes the resource available for reuse by other entities.

### Extended Description


When resources are released, they can be made available for reuse. For example, after memory is de-allocated, an operating system may make the memory available to another process, or disk space may be reallocated when a file is deleted. As removing information requires time and additional resources, operating systems do not usually clear the previously written information.


Even when the resource is reused by the same process, this weakness can arise when new data is not as large as the old data, which leaves portions of the old data still available. Equivalent errors can occur in other situations where the length of data is variable but the associated data structure is not. If memory is not cleared after use, the information may be read by less trustworthy parties when the memory is reallocated.


This weakness can apply in hardware, such as when a device or system switches between power, sleep, or debug states during normal operation, or when execution changes to different users or privilege levels.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-459
ChildOf -> CWE-212
CanPrecede -> CWE-201
ParentOf -> CWE-1239
ParentOf -> CWE-1272
ParentOf -> CWE-1301
ParentOf -> CWE-1342
ParentOf -> CWE-244

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design, Implementation
- **Effectiveness:** High
- **Description:** During critical state transitions, information not needed in the next state should be removed or overwritten with fixed patterns (such as all 0's) or random data, before the transition to the next state.

**Mitigation 2:**
- **Phase:** Architecture and Design, Implementation
- **Effectiveness:** High
- **Description:** When releasing, de-allocating, or deleting a resource, overwrite its data and relevant metadata with fixed patterns or random data. Be cautious about complex resource types whose underlying representation might be non-contiguous or change at a low level, such as how a file might be split into different chunks on a file system, even though "logical" file positions are contiguous at the application layer. Such resource types might require invocation of special modes or APIs to tell the underlying operating system to perform the necessary clearing, such as SDelete (Secure Delete) on Windows, although the appropriate functionality might not be available at the application layer.



### Additional Notes
**[Relationship]** There is a close association between CWE-226 and CWE-212. The difference is partially that of perspective. CWE-226 is geared towards the final stage of the resource lifecycle, in which the resource is deleted, eliminated, expired, or otherwise released for reuse. Technically, this involves a transfer to a different control sphere, in which the original contents of the resource are no longer relevant. CWE-212, however, is intended for sensitive data in resources that are intentionally shared with others, so they are still active. This distinction is useful from the perspective of the CWE research view (CWE-1000).

**[Maintenance]** This entry needs modification to clarify the differences with CWE-212. The description also combines two problems that are distinct from the CWE research perspective: the inadvertent transfer of information to another sphere, and improper initialization/shutdown. Some of the associated taxonomy mappings reflect these different uses.

**[Research Gap]** This is frequently found for network packets, but it can also exist in local memory allocation, files, etc.



### Observed Examples
- **CVE-2019-3733:** Cryptography library does not clear heap memory before release
- **CVE-2003-0001:** Ethernet NIC drivers do not pad frames with null bytes, leading to infoleak from malformed packets.
- **CVE-2003-0291:** router does not clear information from DHCP packets that have been previously used

