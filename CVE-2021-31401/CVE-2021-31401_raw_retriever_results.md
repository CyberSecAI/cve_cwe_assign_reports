# Raw Retriever Results for CVE-2021-31401

# Raw Retriever Results for CVE-2021-31401

## Query
An issue was discovered in tcp_rcv() in nptcp.c in HCC embedded InterNiche 4.0.1. The TCP header processing code doesnt sanitize the value of the IP total length field (header length + data length). With a crafted IP packet, an integer overflow occurs whenever the value of the IP data length is calculated by subtracting the length of the header from the total length of the IP packet.

## Keyphrases
- **weakness**: integer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4857 | 0.5603 | 0.5061 | 0.4952 | 20 |
| Sparse | 371.9149 | 531.3240 | 409.0471 | 392.6158 | 20 |
| Graph | 1.6736 | 2.8384 | 2.0480 | 2.0520 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 2.8384 | Allowed |
| 2 | 805 | Buffer Access with Incorrect Length Value | Base | 2.8291 | Allowed |
| 3 | 125 | Out-of-bounds Read | base | 2.3998 | Allowed |
| 4 | 787 | Out-of-bounds Write | base | 2.2776 | Allowed |
| 5 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 6 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 839 | Numeric Range Comparison Without Minimum Check | base | 2.2100 | Allowed |
| 10 | 195 | Signed to Unsigned Conversion Error | variant | 2.0640 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 12 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 13 | 124 | Buffer Underwrite ('Buffer Underflow') | base | 1.7680 | Allowed |
| 14 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 15 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.5603 | 0.5603 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5402 | 0.5402 | Allowed |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5359 | 0.5359 | Allowed |
| 4 | 121 | Stack-based Buffer Overflow | Variant | 0.5269 | 0.5269 | Allowed |
| 5 | 1389 | Incorrect Parsing of Numbers with Different Radices | Base | 0.5186 | 0.5186 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5157 | 0.5157 | Allowed |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.5136 | 0.5136 | Allowed |
| 8 | 626 | Null Byte Interaction Error (Poison Null Byte) | Variant | 0.5095 | 0.5095 | Allowed |
| 9 | 394 | Unexpected Status Code or Return Value | Base | 0.5080 | 0.5080 | Allowed |
| 10 | 606 | Unchecked Input for Loop Condition | Base | 0.4967 | 0.4967 | Allowed |
| 11 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4938 | 0.4938 | Allowed |
| 12 | 170 | Improper Null Termination | Base | 0.4927 | 0.4927 | Allowed |
| 13 | 406 | Insufficient Control of Network Message Volume (Network Amplification) | Class | 0.4922 | 0.4922 | Allowed-with-Review |
| 14 | 126 | Buffer Over-read | Variant | 0.4919 | 0.4919 | Allowed |
| 15 | 1288 | Improper Validation of Consistency within Input | Base | 0.4901 | 0.4901 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-1284 | Improper Validation of Specified Quantity in Input | 531.3240 | 531.3240 | Allowed |
| 2 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 481.7490 | 481.7490 | Allowed |
| 3 | CWE-125 | Out-of-bounds Read | 447.5141 | 447.5141 | Allowed |
| 4 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | 436.2447 | 436.2447 | Allowed |
| 5 | CWE-195 | Signed to Unsigned Conversion Error | 434.9796 | 434.9796 | Allowed |
| 6 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 431.8980 | 431.8980 | Allowed |
| 7 | CWE-190 | Integer Overflow or Wraparound | 407.4842 | 407.4842 | Allowed |
| 8 | CWE-789 | Memory Allocation with Excessive Size Value | 407.2060 | 407.2060 | Allowed |
| 9 | CWE-805 | Buffer Access with Incorrect Length Value | 396.6283 | 396.6283 | Allowed |
| 10 | CWE-681 | Incorrect Conversion between Numeric Types | 394.5252 | 394.5252 | Allowed |
| 11 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 390.7065 | 390.7065 | Allowed |
| 12 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | 389.2504 | 389.2504 | Allowed-with-Review |
| 13 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | 384.0784 | 384.0784 | Allowed |
| 14 | CWE-126 | Buffer Over-read | 383.2252 | 383.2252 | Allowed |
| 15 | CWE-122 | Heap-based Buffer Overflow | 382.0091 | 382.0091 | Allowed |
