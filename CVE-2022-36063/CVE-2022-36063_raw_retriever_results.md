# Raw Retriever Results for CVE-2022-36063

# Raw Retriever Results for CVE-2022-36063

## Query
Azure RTOS USBx is a USB host, device, and on-the-go (OTG) embedded stack, fully integrated with Azure RTOS ThreadX and available for all Azure RTOS ThreadXsupported processors. Azure RTOS USBX implementation of host support for USB CDC ECM includes an integer underflow and a buffer overflow in the `_ux_host_class_cdc_ecm_mac_address_get` function which may be potentially exploited to achieve remote code execution or denial of service. Setting mac address string descriptor length to a `0` or `1` allows an attacker to introduce an integer underflow followed (string_length) by a buffer overflow of the `cdc_ecm -> ux_host_class_cdc_ecm_node_id` array. This may allow one to redirect the code execution flow or introduce a denial of service. The fix has been included in USBX release [6.1.12](https//github.com/azure-rtos/usbx/releases/tag/v6.1.12_rel). Improved mac address string descriptor length validation to check for unexpectedly small values may be used as a workaround.

## Keyphrases
- **rootcause**: integer underflow and buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4747 | 0.6122 | 0.4979 | 0.4922 | 20 |
| Sparse | 726.1864 | 1419.0529 | 826.2323 | 770.3096 | 20 |
| Graph | 1.5223 | 2.3868 | 1.8003 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 2 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 3 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 4 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 5 | 190 | Integer Overflow or Wraparound | Base | 2.0484 | Allowed |
| 6 | 125 | Out-of-bounds Read | Base | 1.8818 | Allowed |
| 7 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 8 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 9 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 1.6880 | Allowed |
| 10 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 11 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 12 | 805 | Buffer Access with Incorrect Length Value | Base | 1.6528 | Allowed |
| 13 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 14 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 1.6320 | Allowed |
| 15 | 170 | Improper Null Termination | base | 1.6016 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.6122 | 0.6122 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | Base | 0.5286 | 0.5286 | Allowed |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5094 | 0.5094 | Allowed |
| 4 | 122 | Heap-based Buffer Overflow | Variant | 0.5072 | 0.5072 | Allowed |
| 5 | 121 | Stack-based Buffer Overflow | Variant | 0.5070 | 0.5070 | Allowed |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5031 | 0.5031 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4971 | 0.4971 | Allowed |
| 8 | 126 | Buffer Over-read | Variant | 0.4964 | 0.4964 | Allowed |
| 9 | 416 | Use After Free | Variant | 0.4923 | 0.4923 | Allowed |
| 10 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4923 | 0.4923 | Discouraged |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4921 | 0.4921 | Allowed |
| 12 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4883 | 0.4883 | Allowed-with-Review |
| 13 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4868 | 0.4868 | Allowed |
| 14 | 680 | Integer Overflow to Buffer Overflow | Compound | 0.4823 | 0.4823 | Discouraged |
| 15 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4816 | 0.4816 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 1419.0529 | 1419.0529 | Allowed |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1172.5708 | 1172.5708 | Allowed |
| 3 | CWE-190 | Integer Overflow or Wraparound | 899.2920 | 899.2920 | Allowed |
| 4 | CWE-125 | Out-of-bounds Read | 828.0973 | 828.0973 | Allowed |
| 5 | CWE-122 | Heap-based Buffer Overflow | 805.2751 | 805.2751 | Allowed |
| 6 | CWE-193 | Off-by-one Error | 803.0745 | 803.0745 | Allowed |
| 7 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | 795.6445 | 795.6445 | Allowed |
| 8 | CWE-126 | Buffer Over-read | 782.5322 | 782.5322 | Allowed |
| 9 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 779.7971 | 779.7971 | Allowed |
| 10 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | 773.0192 | 773.0192 | Allowed |
| 11 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 767.6000 | 767.6000 | Discouraged |
| 12 | CWE-787 | Out-of-bounds Write | 764.0009 | 764.0009 | Allowed |
| 13 | CWE-121 | Stack-based Buffer Overflow | 755.1074 | 755.1074 | Allowed |
| 14 | CWE-20 | Improper Input Validation | 754.3322 | 754.3322 | Discouraged |
| 15 | CWE-295 | Improper Certificate Validation | 748.6389 | 748.6389 | Allowed |
