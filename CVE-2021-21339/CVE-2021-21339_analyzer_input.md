# Vulnerability Information: CVE-2021-21339

## Vulnerability Description
TYPO3 is an open source PHP based web content management system. In TYPO3 before versions 6.2.57, 7.6.51, 8.7.40, 9.5.25, 10.4.14, 11.1.1 user session identifiers were stored in cleartext - without processing of additional cryptographic hashing algorithms. This vulnerability cannot be exploited directly and occurs in combination with a chained attack - like for instance SQL injection in any other component of the system. This is fixed in versions 6.2.57, 7.6.51, 8.7.40, 9.5.25, 10.4.14, 11.1.1.

### Vulnerability Description Key Phrases
- **weakness:** **cleartext storage of user session identifiers**
- **product:** TYPO3
- **version:** before versions 6.2.57, 7.6.51, 8.7.40, 9.5.25, 10.4.14, 11.1.1

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-21339

**Root Cause of Vulnerability:**
The root cause of this vulnerability is the storage of user session identifiers in cleartext within TYPO3 CMS. These session identifiers were not processed with any additional cryptographic hashing algorithms before storage.

**Weaknesses/Vulnerabilities Present:**
The primary weakness is the **sensitive data exposure** due to the lack of cryptographic protection for session identifiers. This corresponds to **CWE-312** (Cleartext Storage of Sensitive Information).

**Impact of Exploitation:**
The direct impact of this vulnerability is limited. It can't be exploited on its own. However, if combined with a chained attack, such as a SQL injection vulnerability in another part of the system, an attacker could potentially gain access to sensitive session data. This could lead to session hijacking and further compromise of the system. The severity is rated as **high**, due to the potential for high impact in the presence of a chained attack

**Attack Vectors:**
The attack vector is indirect. An attacker would first need to exploit another vulnerability (like SQL injection) in the system to gain access to the cleartext session identifiers.

**Required Attacker Capabilities/Position:**
The attacker needs to be able to:
1. Exploit an existing vulnerability in the TYPO3 CMS (e.g. SQL Injection) or other system components.
2. Have the ability to read the cleartext stored session identifiers after exploiting the other vulnerability.

**Affected Versions:**
- 6.2.0-6.2.56
- 7.0.0-7.6.50
- 8.0.0-8.7.39
- 9.0.0-9.5.24
- 10.0.0-10.4.13
- 11.0.0-11.1.0

**Patched Versions:**
- 6.2.57
- 7.6.51
- 8.7.40
- 9.5.25
- 10.4.14
- 11.1.1

**Additional Information:**
- The vulnerability is located in the core session storage component of TYPO3.
- The advisory highlights that the issue was reported by Oliver Hader, and fixed by Benni Mack and Oliver Hader.
- The advisory provides a CVSS score of 7.5 (High).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.8295 | dense, sparse, graph | dense: 0.536, sparse: 0.582, graph: 0.639 |
| 2 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.7109 | dense, sparse, graph | dense: 0.530, sparse: 0.359, graph: 0.673 |
| 3 | CWE-209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | 0.6602 | dense, sparse, graph | dense: 0.511, sparse: 0.375, graph: 0.532 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4170 | sparse, graph | sparse: 0.334, graph: 0.631 |
| 5 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2370 | sparse, graph | sparse: 0.356, graph: 0.911 |
| 6 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.2010 | sparse | sparse: 0.351 |
| 7 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.1964 | sparse | sparse: 0.343 |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.1943 | sparse | sparse: 0.340 |
| 9 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.1937 | sparse | sparse: 0.339 |
| 10 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.1817 | sparse | sparse: 0.333 |

