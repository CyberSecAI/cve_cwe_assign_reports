# Vulnerability Information: CVE-2021-46507

## Vulnerability Description
Jsish v3.5.0 was discovered to contain a **stack overflow** via Jsi_LogMsg at src/jsiUtils.c.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** Jsish
- **version:** v3.5.0
- **component:** src/jsiUtils.c

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The root cause is a stack overflow within the `Jsi_LogMsg` function, specifically triggered during the conversion of a value to a string via `Jsi_ValueToString`. The issue is caused by a recursive call chain involving `Jsi_LogMsg` and `Jsi_ValueToString` when processing certain crafted input, leading to excessive stack usage.

**Weaknesses/vulnerabilities present:**
- Stack overflow due to unbounded recursion.
- Improper handling of specific input data, causing infinite recursion when converting values to strings.

**Impact of exploitation:**
- The program crashes due to a stack overflow, leading to a denial-of-service (DoS).

**Attack vectors:**
- Crafted JavaScript code provided as input. Specifically, using `WebSocket` function with specially crafted object or using `times` with `WebSocket` and an expression that evaluates to NaN or undefined.

**Required attacker capabilities/position:**
- Ability to provide the vulnerable software with malicious Javascript input.

**Technical Details:**

- The vulnerability occurs in `src/jsiUtils.c:151` within the `Jsi_LogMsg` function.
- The call stack shows recursive calls between `Jsi_LogMsg` (at `src/jsiUtils.c:229`) and `Jsi_ValueToString` (at `src/jsiValue.c:526`).
- The vulnerability is triggered by a crafted WebSocket call within a `times` function with the problematic expression `null % null`.
- AddressSanitizer output shows a stack overflow with specific addresses and the call stack leading to the overflow.

This information is more detailed than a simple CVE description would provide.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5242 | dense, sparse, graph | dense: 0.507, sparse: 0.072, graph: 0.641 |
| 2 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.4973 | dense, sparse, graph | dense: 0.472, sparse: 0.085, graph: 0.594 |
| 3 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3267 | sparse, graph | sparse: 0.078, graph: 0.789 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3037 | dense, sparse | dense: 0.530, sparse: 0.111 |
| 5 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.2931 | sparse, graph | sparse: 0.086, graph: 0.682 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2916 | dense, sparse | dense: 0.518, sparse: 0.100 |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.2878 | dense, sparse | dense: 0.490, sparse: 0.074 |
| 8 | CWE-193 | Off-by-one Error | Base | Allowed | 0.2869 | dense, sparse | dense: 0.484, sparse: 0.078 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2753 | dense, sparse | dense: 0.518, sparse: 0.068 |
| 10 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2747 | dense, sparse | dense: 0.483, sparse: 0.080 |

