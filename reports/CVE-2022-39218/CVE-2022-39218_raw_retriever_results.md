# Raw Retriever Results for CVE-2022-39218

# Raw Retriever Results for CVE-2022-39218

## Query
The JS Compute Runtime for Fastlys Compute@Edge platform provides the environment JavaScript is executed in when using the Compute@Edge JavaScript SDK. In versions prior to 0.5.3, the `Math.random` and `crypto.getRandomValues` methods fail to use sufficiently random values. The initial value to seed the PRNG (pseudorandom number generator) is baked-in to the final WebAssembly module, making the sequence of random values for that specific WebAssembly module predictable. An attacker can use the fixed seed to predict random numbers generated by these functions and bypass cryptographic security controls, for example to disclose sensitive data encrypted by functions that use these generators. The problem has been patched in version 0.5.3. No known workarounds exist.

## Keyphrases
- **rootcause**: fixed seed for PRNG

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4263 | 0.6178 | 0.4860 | 0.4524 | 20 |
| Sparse | 557.5454 | 1438.2550 | 664.2306 | 588.7976 | 20 |
| Graph | 0.7200 | 2.2100 | 1.0890 | 0.8324 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 804 | Guessable CAPTCHA | base | 2.2100 | Allowed |
| 2 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 1.7313 | Allowed |
| 3 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | 1.7219 | Allowed |
| 4 | 336 | Same Seed in Pseudo-Random Number Generator (PRNG) | Variant | 1.5538 | Allowed |
| 5 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 1.5350 | Allowed |
| 6 | 332 | Insufficient Entropy in PRNG | Variant | 1.3766 | Allowed |
| 7 | 330 | Use of Insufficiently Random Values | Class | 1.0549 | Discouraged |
| 8 | 344 | Use of Invariant Value in Dynamically Changing Context | base | 1.0062 | Allowed |
| 9 | 341 | Predictable from Observable State | Base | 0.8923 | Allowed |
| 10 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | 0.8367 | Allowed |
| 11 | 334 | Small Space of Random Values | Base | 0.8281 | Allowed |
| 12 | 331 | Insufficient Entropy | Base | 0.8063 | Allowed |
| 13 | 798 | Use of Hard-coded Credentials | base | 0.8050 | Allowed |
| 14 | 323 | Reusing a Nonce, Key Pair in Encryption | base | 0.8050 | Allowed |
| 15 | 1204 | Generation of Weak Initialization Vector (IV) | Base | 0.7965 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 336 | Same Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.6178 | 0.6178 | Allowed |
| 2 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 0.5859 | 0.5859 | Allowed |
| 3 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.5615 | 0.5615 | Allowed |
| 4 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | 0.5518 | 0.5518 | Allowed |
| 5 | 332 | Insufficient Entropy in PRNG | Variant | 0.5439 | 0.5439 | Allowed |
| 6 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | 0.5374 | 0.5374 | Allowed |
| 7 | 339 | Small Seed Space in PRNG | Variant | 0.5049 | 0.5049 | Allowed |
| 8 | 334 | Small Space of Random Values | Base | 0.5038 | 0.5038 | Allowed |
| 9 | 330 | Use of Insufficiently Random Values | Class | 0.4631 | 0.4631 | Discouraged |
| 10 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.4566 | 0.4566 | Allowed-with-Review |
| 11 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.4482 | 0.4482 | Allowed |
| 12 | 343 | Predictable Value Range from Previous Values | Base | 0.4461 | 0.4461 | Allowed |
| 13 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | 0.4457 | 0.4457 | Allowed |
| 14 | 331 | Insufficient Entropy | Base | 0.4455 | 0.4455 | Allowed |
| 15 | 194 | Unexpected Sign Extension | Variant | 0.4448 | 0.4448 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-336 | Same Seed in Pseudo-Random Number Generator (PRNG) | 1438.2550 | 1438.2550 | Allowed |
| 2 | CWE-335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 824.1681 | 824.1681 | Allowed |
| 3 | CWE-338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | 757.5942 | 757.5942 | Allowed |
| 4 | CWE-337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | 746.4880 | 746.4880 | Allowed |
| 5 | CWE-330 | Use of Insufficiently Random Values | 713.3589 | 713.3589 | Discouraged |
| 6 | CWE-1204 | Generation of Weak Initialization Vector (IV) | 694.9097 | 694.9097 | Allowed |
| 7 | CWE-347 | Improper Verification of Cryptographic Signature | 624.0767 | 624.0767 | Allowed |
| 8 | CWE-340 | Generation of Predictable Numbers or Identifiers | 610.0622 | 610.0622 | Allowed-with-Review |
| 9 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | 600.5341 | 600.5341 | Allowed |
| 10 | CWE-770 | Allocation of Resources Without Limits or Throttling | 593.2428 | 593.2428 | Allowed |
| 11 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 584.3525 | 584.3525 | Allowed-with-Review |
| 12 | CWE-1391 | Use of Weak Credentials | 583.9867 | 583.9867 | Allowed-with-Review |
| 13 | CWE-287 | Improper Authentication | 582.1221 | 582.1221 | Discouraged |
| 14 | CWE-341 | Predictable from Observable State | 566.2400 | 566.2400 | Allowed |
| 15 | CWE-345 | Insufficient Verification of Data Authenticity | 564.9398 | 564.9398 | Discouraged |
