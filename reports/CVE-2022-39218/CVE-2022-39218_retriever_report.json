{
  "cve_id": "CVE-2022-39218",
  "query": "The JS Compute Runtime for Fastlys Compute@Edge platform provides the environment JavaScript is executed in when using the Compute@Edge JavaScript SDK. In versions prior to 0.5.3, the `Math.random` and `crypto.getRandomValues` methods fail to use sufficiently random values. The initial value to seed the PRNG (pseudorandom number generator) is baked-in to the final WebAssembly module, making the sequence of random values for that specific WebAssembly module predictable. An attacker can use the fixed seed to predict random numbers generated by these functions and bypass cryptographic security controls, for example to disclose sensitive data encrypted by functions that use these generators. The problem has been patched in version 0.5.3. No known workarounds exist.",
  "keyphrases": {
    "rootcause": "fixed seed for PRNG"
  },
  "timestamp": "2025-03-17T03:56:37.233154",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 9,
      "average_score": 0.5121053020436149,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.5845587285758285,
      "unique_finds": 0
    },
    "graph": {
      "hit_count": 8,
      "average_score": 0.4515092376543799,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-336",
      "name": "Same Seed in Pseudo-Random Number Generator (PRNG)",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.9965,
      "retriever_count": 0,
      "dense_score": 0.6178,
      "sparse_score": 1.0,
      "graph_score": 0.5549
    },
    {
      "cwe_id": "CWE-335",
      "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.8915,
      "retriever_count": 0,
      "dense_score": 0.5859,
      "sparse_score": 0.6593,
      "graph_score": 0.6183
    },
    {
      "cwe_id": "CWE-338",
      "name": "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.8427,
      "retriever_count": 0,
      "dense_score": 0.5518,
      "sparse_score": 0.6061,
      "graph_score": 0.615
    },
    {
      "cwe_id": "CWE-337",
      "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.7556,
      "retriever_count": 0,
      "dense_score": 0.5615,
      "sparse_score": 0.5972,
      "graph_score": 0.5482
    },
    {
      "cwe_id": "CWE-1204",
      "name": "Generation of Weak Initialization Vector (IV)",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6331,
      "retriever_count": 0,
      "dense_score": 0.4263,
      "sparse_score": 0.5559,
      "graph_score": 0.2845
    },
    {
      "cwe_id": "CWE-334",
      "name": "Small Space of Random Values",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6141,
      "retriever_count": 0,
      "dense_score": 0.5038,
      "sparse_score": 0.4478,
      "graph_score": 0.2958
    },
    {
      "cwe_id": "CWE-341",
      "name": "Predictable from Observable State",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.373,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.453,
      "graph_score": 0.3187
    },
    {
      "cwe_id": "CWE-330",
      "name": "Use of Insufficiently Random Values",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.3101,
      "retriever_count": 0,
      "dense_score": 0.4631,
      "sparse_score": 0.5707,
      "graph_score": 0.3768
    },
    {
      "cwe_id": "CWE-340",
      "name": "Generation of Predictable Numbers or Identifiers",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.294,
      "retriever_count": 0,
      "dense_score": 0.4422,
      "sparse_score": 0.488,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-327",
      "name": "Use of a Broken or Risky Cryptographic Algorithm",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.2913,
      "retriever_count": 0,
      "dense_score": 0.4566,
      "sparse_score": 0.4675,
      "graph_score": "-"
    }
  ]
}