# Vulnerability Information: CVE-2020-36239

## Vulnerability Description
Jira Data Center, Jira Core Data Center, Jira Software Data Center from version 6.3.0 before 8.5.16, from 8.6.0 before 8.13.8, from 8.14.0 before 8.17.0 and Jira Service Management Data Center from version 2.0.2 before 4.5.16, from version 4.6.0 before 4.13.8, and from version 4.14.0 before 4.17.0 exposed a Ehcache RMI network service which attackers, who can connect to the service, on port 40001 and potentially 40011[0][1], could execute arbitrary code of their choice in Jira through deserialization due to a **missing authentication vulnerability**. While Atlassian strongly suggests restricting access to the Ehcache ports to only Data Center instances, fixed versions of Jira will now require a shared secret in order to allow access to the Ehcache service. [0] In Jira Data Center, Jira Core Data Center, and Jira Software Data Center versions prior to 7.13.1, the Ehcache object port can be randomly allocated. [1] In Jira Service Management Data Center versions prior to 3.16.1, the Ehcache object port can be randomly allocated.

### Vulnerability Description Key Phrases
- **rootcause:** **missing authentication vulnerability**
- **impact:** execute arbitrary code
- **vector:** deserialization
- **attacker:** attackers
- **product:** ['Jira Data Center', 'Jira Core Data Center', 'Jira Software Data Center', 'Jira Service Management Data Center']
- **version:** ['6.3.0 before 8.5.16', '8.6.0 before 8.13.8', '8.14.0 before 8.17.0', '2.0.2 before 4.5.16', '4.6.0 before 4.13.8', '4.14.0 before 4.17.0']
- **component:** Ehcache RMI network service

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a missing authentication check for the Ehcache RMI network service in Jira Data Center, Jira Core Data Center, Jira Software Data Center, and Jira Service Management Data Center. This allows attackers to connect to the service without proper authorization.

**Weaknesses/Vulnerabilities Present:**

*   **Missing Authentication:** The core issue is the lack of authentication for the Ehcache RMI service, which exposes it to unauthorized access.
*   **Unprotected RMI Service:** The RMI service is exposed without access controls on ports 40001 and potentially 40011. These ports can also be configured to be different.
*   **Java Deserialization Vulnerability:** The missing authentication allows for exploitation of Java deserialization vulnerabilities, allowing arbitrary code execution.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation allows attackers to execute arbitrary code on the affected Jira server.
*   **Complete System Compromise:** This could potentially lead to full compromise of the Jira server and the data it manages.

**Attack Vectors:**

*   **Network Access:** Attackers need network access to the exposed Ehcache RMI service ports (40001, 40011 or configured custom ports). This includes attackers able to connect to the service from within the internal network.

**Required Attacker Capabilities/Position:**

*   **Network Connectivity:** The attacker needs network connectivity to the affected Jira Data Center instance.
*   **Understanding of Java Deserialization:**  The attacker would need to craft a malicious payload to exploit the deserialization vulnerability.
*   **No authentication required:** Attackers can connect to the Ehcache RMI service without authentication.

**Additional Information:**

*   The vulnerability affects various versions of Jira Data Center, Jira Core Data Center, Jira Software Data Center, and Jira Service Management Data Center.
*   Jira Cloud, Jira Service Management Cloud, and non-Data Center instances of Jira Server are not affected.
*   The fix involves requiring a shared secret for access to the Ehcache service.
*   Mitigation involves restricting access to the Ehcache RMI ports to only cluster instances using firewalls or similar technologies.
*   The issue is tracked under JRASERVER-72566 and JSDSERVER-8454.
*   The vulnerability is rated as "critical" with a CVSS score of 9.8.

The provided information gives a good understanding of the vulnerability, its impact, and how to remediate it, and aligns with the CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.8735 | sparse, graph | sparse: 0.976, graph: 0.882 |
| 2 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.7938 | dense, sparse, graph | dense: 0.460, sparse: 0.659, graph: 0.521 |
| 3 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.7876 | sparse, graph | sparse: 0.904, graph: 0.757 |
| 4 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.6761 | sparse, graph | sparse: 0.811, graph: 0.593 |
| 5 | CWE-917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | 0.6352 | dense, sparse | dense: 0.446, sparse: 0.720 |
| 6 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.6116 | dense, sparse | dense: 0.449, sparse: 0.676 |
| 7 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.6074 | dense, sparse | dense: 0.458, sparse: 0.661 |
| 8 | CWE-290 | Authentication Bypass by Spoofing | Base | Allowed | 0.4331 | sparse | sparse: 0.757 |
| 9 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.4000 | sparse | sparse: 0.699 |
| 10 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.3771 | sparse | sparse: 0.659 |

