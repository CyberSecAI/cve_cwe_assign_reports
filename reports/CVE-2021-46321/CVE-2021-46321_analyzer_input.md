# Vulnerability Information: CVE-2021-46321

## Vulnerability Description
Tenda AC Series Router AC11_V02.03.01.104_CN was discovered to contain a **stack buffer overflow** in the wifiBasicCfg module. This vulnerability allows attackers to cause a Denial of Service (DoS) via crafted overflow data.

### Vulnerability Description Key Phrases
- **weakness:** **stack buffer overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted overflow data
- **attacker:** attackers
- **product:** Tenda AC Series Router
- **version:** AC11_V02.03.01.104_CN
- **component:** wifiBasicCfg module

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 165)
- CWE-120 (Count: 17)

## CVE Reference Links Content Summary
The content is related to CVE-2021-46321.

- **Root cause of vulnerability:** A stack buffer overflow vulnerability exists in the `wifiBasicCfg` module of the Tenda router's firmware. The program reads user input from the `wifiSSID` parameter of a POST request to `/goform/setWifi` without checking its length. This unchecked input is then used in `sprintf` or `strcpy` functions, leading to a buffer overflow.

- **Weaknesses/vulnerabilities present:** Stack-based buffer overflow due to missing input validation. Specifically, the `wifiSSID` parameter is not length-checked before being used in string manipulation functions.

- **Impact of exploitation:**  Exploitation can lead to a denial of service (DoS) attack. Furthermore, with carefully crafted overflow data, remote code execution (RCE) could also be possible.

- **Attack vectors:** A malicious user sends a crafted POST request to `/goform/setWifi` containing an overly long `wifiSSID` value.

- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the vulnerable endpoint. This likely implies the attacker needs network access to the router, possibly as a user on the local network, or potentially through a vulnerable external facing service.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-805 | Buffer Access with Incorrect Length Value | Base | Allowed | 0.6017 | dense, sparse, graph | dense: 0.521, sparse: 0.160, graph: 0.697 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4326 | dense, sparse | dense: 0.636, sparse: 0.263 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3735 | sparse, graph | sparse: 0.160, graph: 0.789 |
| 4 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3303 | dense, sparse | dense: 0.512, sparse: 0.178 |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3237 | sparse, graph | sparse: 0.171, graph: 0.631 |
| 6 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.3209 | sparse, graph | sparse: 0.152, graph: 0.729 |
| 7 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3187 | dense, sparse | dense: 0.509, sparse: 0.158 |
| 8 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1577 | dense, sparse | dense: 0.503, sparse: 0.176 |
| 9 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.0980 | sparse | sparse: 0.171 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.0977 | sparse | sparse: 0.171 |

