# Vulnerability Information: CVE-2022-35878

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the UPnP logging functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9Z and 6.9X. A specially-crafted UPnP negotiation can lead to memory corruption, information disclosure, and denial of service. An attacker can host a malicious UPnP service to trigger these vulnerabilities.This vulnerability arises from **format string injection** via `ST` and `Location` HTTP response headers, as used within the `DoEnumUPnPService` action handler.

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9Z and 6.9X
- **component:** UPnP logging functionality

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `log` function uses `vsnprintf` to format log messages, and the format string parameter is derived from network inputs.",
  "Weaknesses/vulnerabilities": [
    "Format string injection vulnerability in the UPnP logging functionality of the Abode Systems, Inc. iota All-In-One Security Kit."
  ],
  "Impact of exploitation": "Memory corruption, information disclosure, and denial of service. The vulnerability can leak stack memory and write arbitrary memory.",
  "Attack vectors": "An attacker can host a malicious UPnP service to trigger these vulnerabilities by sending crafted M-SEARCH replies. The attacker needs to be on the same network as the vulnerable device to send these packets",
  "Required attacker capabilities/position": "The attacker needs to be on the same network as the vulnerable device. They must be capable of listening for and replying to M-SEARCH packets with a malicious response to trigger the vulnerability. This includes setting up a malicious UPnP service."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.0739 | dense, sparse, graph | dense: 0.696, sparse: 0.825, graph: 0.709 |
| 2 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.4832 | sparse, graph | sparse: 0.309, graph: 0.857 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4768 | sparse, graph | sparse: 0.314, graph: 0.832 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4742 | dense, sparse | dense: 0.592, sparse: 0.311 |
| 5 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.4734 | sparse, graph | sparse: 0.308, graph: 0.832 |
| 6 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4334 | dense, sparse | dense: 0.543, sparse: 0.283 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4240 | dense, sparse | dense: 0.596, sparse: 0.282 |
| 8 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4140 | dense, sparse | dense: 0.541, sparse: 0.285 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2016 | dense, sparse | dense: 0.549, sparse: 0.307 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.1703 | sparse | sparse: 0.298 |

