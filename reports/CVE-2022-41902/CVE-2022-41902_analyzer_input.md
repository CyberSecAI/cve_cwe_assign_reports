# Vulnerability Information: CVE-2022-41902

## Vulnerability Description
TensorFlow is an open source platform for machine learning. The function MakeGrapplerFunctionItem takes arguments that determine the sizes of inputs and outputs. If the inputs given are greater than or equal to the sizes of the outputs, an **out-of-bounds memory read** or a crash is triggered. We have patched the issue in GitHub commit a65411a1d69edfb16b25907ffb8f73556ce36bb7. The fix will be included in TensorFlow 2.11.0. We will also cherrypick this commit on TensorFlow 2.8.4, 2.9.3, and 2.10.1.

### Vulnerability Description Key Phrases
- **weakness:** **out-of-bounds memory read**
- **impact:** crash
- **product:** TensorFlow
- **version:** before 2.11.0
- **component:** MakeGrapplerFunctionItem function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-617

#### Top CWEs
- CWE-617 (Count: 2)
- CWE-476 (Count: 1)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2022-41902

**Root Cause:** The vulnerability lies within the `MakeGrapplerFunctionItem` function in `tensorflow/core/grappler/utils/functions.cc`. This function takes input and output sizes as arguments.

**Weakness:** An out-of-bounds memory read or a crash occurs if the provided input sizes are greater than or equal to the sizes of the outputs. This implies that there is a lack of proper bounds checking on input sizes in relation to output sizes.

**Impact:** Exploitation can lead to an out-of-bounds memory read or a crash. This could result in denial of service, and potentially other undefined behaviors if memory read is controllable.

**Attack Vectors:**  The vulnerability can be triggered by providing crafted input arguments to the `MakeGrapplerFunctionItem` function that define larger input sizes compared to the output sizes. This could happen through manipulation of tensorflow models or input data that uses this function.

**Required Attacker Capabilities/Position:** The attacker needs the ability to control the sizes of inputs and outputs provided to the `MakeGrapplerFunctionItem` function, which are arguments to it. This would likely require either a malicious model, or the ability to manipulate how function calls to this method are created.

**Additional Notes:**
- The issue was discovered through internal fuzzing.
- The fix was implemented in commit `a65411a1d69edfb16b25907ffb8f73556ce36bb7`, which added a check to ensure that the attribute index is within the range of the input size.
- Patched versions are 2.8.4, 2.9.3, 2.10.1 and 2.11.0
- The advisory states that no CWEs are associated with this vulnerability, however it can be generally categorized under CWE-125: Out-of-bounds Read or CWE-787: Out-of-bounds Write

This information provides more detail than the original CVE description, giving insight into the root cause, impact and mitigation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-824 | Access of Uninitialized Pointer | Base | Allowed | 0.8442 | dense, sparse, graph | dense: 0.369, sparse: 0.535, graph: 0.990 |
| 2 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.8302 | dense, sparse, graph | dense: 0.357, sparse: 0.522, graph: 0.986 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6892 | dense, sparse, graph | dense: 0.395, sparse: 0.508, graph: 0.563 |
| 4 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.6546 | dense, sparse, graph | dense: 0.363, sparse: 0.476, graph: 0.562 |
| 5 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5807 | sparse, graph | sparse: 0.408, graph: 0.971 |
| 6 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4708 | sparse, graph | sparse: 0.428, graph: 0.631 |
| 7 | CWE-617 | Reachable Assertion | Base | Allowed | 0.4243 | dense, sparse | dense: 0.329, sparse: 0.454 |
| 8 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.4152 | dense, sparse | dense: 0.334, sparse: 0.434 |
| 9 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4086 | dense, sparse | dense: 0.344, sparse: 0.414 |
| 10 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3993 | dense, sparse | dense: 0.332, sparse: 0.466 |

