# Vulnerability Information: CVE-2021-43563

## Vulnerability Description
An issue was discovered in the pixxio (aka pixx.io integration or DAM) extension before 1.0.6 for TYPO3. The Access Control in the bundled media browser is broken, which allows an unauthenticated attacker to perform requests to the pixx.io API for the configured API user. This allows an attacker to download various media files from the DAM system.

### Vulnerability Description Key Phrases
- **rootcause:** **broken access control**
- **impact:** download media files
- **attacker:** unauthenticated attacker
- **product:** pixxio TYPO3 extension
- **version:** before 1.0.6
- **component:** bundled media browser

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The extension `pixx.io integration for TYPO3 (DAM)` fails to restrict image downloads to the configured `pixx.io DAM` URL, which leads to Server-Side Request Forgery (SSRF). Broken access control in the bundled media browser allows unauthenticated requests to the `pixx.io API`. The extension also bundles a vulnerable version of jQuery.
- **Weaknesses/vulnerabilities present**:
    - Server-Side Request Forgery (SSRF)
    - Remote Code Execution (RCE)
    - Broken Access Control
    - Use of vulnerable 3rd Party Component (jQuery 3.3.1)
- **Impact of exploitation**:
    - SSRF can allow an attacker to download content from remote locations and save it to a user-controlled filename, leading to potential Remote Code Execution.
    - Broken Access Control allows an unauthenticated attacker to download media files from the DAM system via the `pixx.io API`.
    - Vulnerable jQuery version can be exploited through known vulnerabilities.
- **Attack vectors**:
    - SSRF and RCE: Requires a TYPO3 backend user account.
    - Broken Access Control: Can be exploited by an unauthenticated attacker.
- **Required attacker capabilities/position**:
    - For SSRF and RCE, the attacker needs a TYPO3 backend user account.
    - For Broken Access Control, no authentication is required.

This content provides more detail than the official CVE description, by describing the specific vulnerabilities present in the `pixxio` extension, how each can be exploited, and the specific impact. It also provides detailed remediation steps including a link to the updated extension.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.6300 | dense, sparse, graph | dense: 0.499, sparse: 0.284, graph: 0.610 |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4069 | dense, sparse | dense: 0.495, sparse: 0.278 |
| 3 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3993 | dense, sparse | dense: 0.482, sparse: 0.276 |
| 4 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2457 | dense, sparse | dense: 0.510, sparse: 0.285 |
| 5 | CWE-1357 | Reliance on Insufficiently Trustworthy Component | Class | Allowed-with-Review | 0.1777 | sparse | sparse: 0.529 |
| 6 | CWE-285 | Improper Authorization | Class | Discouraged | 0.1777 | dense, sparse | dense: 0.478, sparse: 0.276 |
| 7 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.1582 | sparse | sparse: 0.277 |
| 8 | CWE-209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | 0.1529 | sparse | sparse: 0.267 |
| 9 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.1516 | sparse | sparse: 0.265 |
| 10 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.1514 | sparse | sparse: 0.265 |

