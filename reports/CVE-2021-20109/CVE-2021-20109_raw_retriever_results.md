# Raw Retriever Results for CVE-2021-20109

# Raw Retriever Results for CVE-2021-20109

## Query
Due to the Asset Explorer agent not validating HTTPS certificates, an attacker on the network can statically configure their IP address to match the Asset Explorers Server IP address. This will allow an attacker to send a NEWSCAN request to a listening agent on the network as well as receive the agents HTTP request verifying its authtoken. In AEAgent.cpp, the agent responding back over HTTP is vulnerable to a Heap Overflow if the POST payload response is too large. The POST payload response is converted to Unicode using vswprintf. This is written to a buffer only 0x2000 bytes big. If POST payload is larger, then heap overflow will occur.

## Keyphrases
- **weakness**: heap overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4668 | 0.5307 | 0.4813 | 0.4764 | 20 |
| Sparse | 515.8278 | 996.6589 | 563.8441 | 540.0150 | 20 |
| Graph | 1.6848 | 3.5698 | 2.2074 | 2.0597 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 193 | Off-by-one Error | base | 3.5698 | Allowed |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | base | 3.0654 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | base | 3.0550 | Allowed |
| 4 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 2.8089 | Allowed |
| 5 | 190 | Integer Overflow or Wraparound | Base | 2.4789 | Allowed |
| 6 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 7 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 8 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 10 | 617 | Reachable Assertion | base | 2.2100 | Allowed |
| 11 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.9094 | Allowed |
| 12 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.8129 | Allowed |
| 13 | 295 | Improper Certificate Validation | Base | 1.7722 | Allowed |
| 14 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.5307 | 0.5307 | Allowed |
| 2 | 1244 | Internal Asset Exposed to Unsafe Debug Access Level or State | Base | 0.5157 | 0.5157 | Allowed |
| 3 | 406 | Insufficient Control of Network Message Volume (Network Amplification) | Class | 0.5001 | 0.5001 | Allowed-with-Review |
| 4 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4948 | 0.4948 | Allowed |
| 5 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4878 | 0.4878 | Allowed |
| 6 | 121 | Stack-based Buffer Overflow | Variant | 0.4803 | 0.4803 | Allowed |
| 7 | 295 | Improper Certificate Validation | Base | 0.4789 | 0.4789 | Allowed |
| 8 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 0.4773 | 0.4773 | Allowed |
| 9 | 611 | Improper Restriction of XML External Entity Reference | Base | 0.4768 | 0.4768 | Allowed |
| 10 | 348 | Use of Less Trusted Source | Base | 0.4764 | 0.4764 | Allowed |
| 11 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4763 | 0.4763 | Allowed |
| 12 | 405 | Asymmetric Resource Consumption (Amplification) | Class | 0.4730 | 0.4730 | Allowed-with-Review |
| 13 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4724 | 0.4724 | Allowed |
| 14 | 644 | Improper Neutralization of HTTP Headers for Scripting Syntax | Variant | 0.4718 | 0.4718 | Allowed |
| 15 | 300 | Channel Accessible by Non-Endpoint | Class | 0.4707 | 0.4707 | Discouraged |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-295 | Improper Certificate Validation | 996.6589 | 996.6589 | Allowed |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | 585.5408 | 585.5408 | Allowed |
| 3 | CWE-193 | Off-by-one Error | 568.9459 | 568.9459 | Allowed |
| 4 | CWE-190 | Integer Overflow or Wraparound | 566.3228 | 566.3228 | Allowed |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | 564.3458 | 564.3458 | Allowed |
| 6 | CWE-121 | Stack-based Buffer Overflow | 560.0421 | 560.0421 | Allowed |
| 7 | CWE-122 | Heap-based Buffer Overflow | 557.7484 | 557.7484 | Allowed |
| 8 | CWE-126 | Buffer Over-read | 554.5303 | 554.5303 | Allowed |
| 9 | CWE-195 | Signed to Unsigned Conversion Error | 543.0685 | 543.0685 | Allowed |
| 10 | CWE-125 | Out-of-bounds Read | 540.9433 | 540.9433 | Allowed |
| 11 | CWE-918 | Server-Side Request Forgery (SSRF) | 539.0868 | 539.0868 | Allowed |
| 12 | CWE-20 | Improper Input Validation | 536.2422 | 536.2422 | Discouraged |
| 13 | CWE-789 | Memory Allocation with Excessive Size Value | 526.2069 | 526.2069 | Allowed |
| 14 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 523.6604 | 523.6604 | Allowed |
| 15 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 523.2758 | 523.2758 | Allowed |
