# Vulnerability Information: CVE-2021-43301

## Vulnerability Description
Stack overflow in PJSUA API when calling pjsua_playlist_create. An attacker-controlled file_names argument may cause a buffer overflow since it is copied to a fixed-size stack buffer without any size validation.

### Vulnerability Description Key Phrases
- **rootcause:** **stack overflow**
- **attacker:** attacker
- **product:** PJSUA
- **component:** pjsua_playlist_create API

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-43301:

**Vulnerability:**

*   **Root Cause:** Stack overflow due to insufficient size validation when handling the `file_names` argument in the `pjsua_playlist_create` function within the PJSUA API.
*   **Weakness:**  The `file_names` argument, controlled by an attacker, is copied to a fixed-size stack buffer without any size checks, leading to a buffer overflow if the provided filenames are too long.
*   **Impact:** Exploitation could lead to arbitrary code execution, denial of service due to program crash, or other undefined behavior.
*   **Attack Vector:**  An attacker provides a crafted `file_names` argument with excessively long file names to the `pjsua_playlist_create` function.
*   **Required Attacker Capabilities:** The attacker needs the ability to control the `file_names` parameter passed to the vulnerable function.

**Summary:**

The vulnerability is a classic stack-based buffer overflow. The lack of proper validation of the input filename length when creating a playlist makes it possible for an attacker to overwrite the stack, potentially leading to a variety of impacts, including code execution.

**Additional Details:**

*   The issue is present in pjproject versions 2.11.1 and below, patched in version 2.12 and later.
*   The issue affects applications that use the `pjsua_playlist_create` API.
*   A workaround involves applications performing input length validation on the filenames before calling the API.

This analysis aligns with the details provided in the Debian security advisories and the GitHub security advisory.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6527 | dense, sparse, graph | dense: 0.490, sparse: 0.186, graph: 0.843 |
| 2 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.6412 | dense, sparse, graph | dense: 0.501, sparse: 0.179, graph: 0.805 |
| 3 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.5952 | dense, sparse, graph | dense: 0.454, sparse: 0.215, graph: 0.766 |
| 4 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.5253 | dense, sparse, graph | dense: 0.458, sparse: 0.185, graph: 0.653 |
| 5 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4402 | sparse, graph | sparse: 0.203, graph: 0.907 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3713 | sparse, graph | sparse: 0.202, graph: 0.715 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3503 | dense, sparse | dense: 0.501, sparse: 0.225 |
| 8 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3386 | dense, sparse | dense: 0.480, sparse: 0.172 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3357 | dense, sparse | dense: 0.467, sparse: 0.178 |
| 10 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3229 | dense, sparse | dense: 0.455, sparse: 0.166 |

