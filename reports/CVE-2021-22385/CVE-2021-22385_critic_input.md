# Critic Input for CVE-2021-22385



# Original Analyzer Input
## Vulnerability Description
A component of the Huawei smartphone has a **External Control of System or Configuration Setting vulnerability**. Local attackers may exploit this vulnerability to cause Kernel Code Execution.

### Vulnerability Description Key Phrases
- **weakness:** **External Control of System or Configuration Setting vulnerability**
- **impact:** Kernel Code Execution
- **attacker:** Local attackers
- **product:** Huawei smartphone

## CVE Reference Links Content Summary
The provided content is a security bulletin from Huawei, which includes information about CVE-2021-22385.

**Root cause of vulnerability:**
The vulnerability lies in the NFC-based connection authentication process.

**Weaknesses/vulnerabilities present:**
The primary weakness is an issue in how NFC-based connections are authenticated, leading to a bypass.

**Impact of exploitation:**
Successful exploitation of this vulnerability may lead to authentication bypass.

**Attack vectors:**
The attack vector involves exploiting the NFC connection authentication mechanism.

**Required attacker capabilities/position:**
The attacker needs to be in a position to interact with the device's NFC capabilities during the connection authentication process.

**Affected Versions:**
EMUI 11.0.0, EMUI 10.1.1, EMUI 10.1.0, Magic UI 4.0.0, Magic UI 3.1.1, Magic UI 3.1.0

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-15 | External Control of System or Configuration Setting | Base | Allowed | 0.6864 | dense, sparse, graph | dense: 0.678, sparse: 0.212, graph: 0.631 |
| 2 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.5636 | dense, sparse, graph | dense: 0.523, sparse: 0.144, graph: 0.613 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4429 | sparse, graph | sparse: 0.149, graph: 1.000 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3598 | sparse, graph | sparse: 0.136, graph: 0.789 |
| 5 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3196 | dense, sparse | dense: 0.514, sparse: 0.135 |
| 6 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.3089 | dense, sparse | dense: 0.519, sparse: 0.131 |
| 7 | CWE-642 | External Control of Critical State Data | Class | Allowed-with-Review | 0.2015 | dense, sparse | dense: 0.524, sparse: 0.141 |
| 8 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1541 | dense, sparse | dense: 0.534, sparse: 0.135 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1506 | dense, sparse | dense: 0.516, sparse: 0.136 |
| 10 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.1183 | dense, sparse | dense: 0.537, sparse: 0.146 |



# Analysis to Review
```markdown
# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-15 | External Control of System or Configuration Setting | 0.85 | Base | Allowed | Primary CWE |

## Evidence and Confidence

*   **Confidence Score:** 0.85
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**  
  - *Explanation:* The vulnerability description explicitly states "External Control of System or Configuration Setting vulnerability". This directly aligns with the definition of CWE-15, which describes a weakness where the product allows external control over system or configuration settings. The "CVE Reference Links Content Summary" mentions that the vulnerability lies in the NFC-based connection authentication process, leading to a bypass when exploited. This indicates that an attacker can potentially manipulate system configurations related to NFC authentication. The fact that this leads to Kernel Code Execution indicates a critical configuration is being controlled externally. This confirms the relevance of CWE-15. The MITRE mapping guidance for CWE-15 allows its use as it is a Base level CWE.
  
  - *Relationship Analysis:* While CWE-15 is a base level CWE, exploring its relationships reveals that it can be a root cause for other weaknesses, such as privilege escalation or information disclosure. No specific relationship is highlighted as essential in this case, but CWE-15 is a good fit as the root cause.

- **Confidence Score:**  
  - *Example:* Confidence: 0.85 (High evidence from technical description and CVE reference materials)
```

# CWE Examples from Database


## Known Examples for CWE-15: External Control of System or Configuration Setting
### Top 25 Examples
- **CVE-2021-22385**: A component of the Huawei smartphone has a External Control of System or Configuration Setting vulnerability. Local attackers may exploit this vulnerability to cause Kernel Code Execution.
- **CVE-2021-22420**: A component of the HarmonyOS has a External Control of System or Configuration Setting vulnerability. Local attackers may exploit this vulnerability to cause the underlying trust of the application trustlist mechanism is missing..
- **CVE-2021-22454**: A component of the HarmonyOS has a External Control of System or Configuration Setting vulnerability. Local attackers may exploit this vulnerability to cause core dump.
- **CVE-2021-22468**: A component of the HarmonyOS has a Exposure of Sensitive Information to an Unauthorized Actor vulnerability. Local attackers may exploit this vulnerability to cause kernel address leakage.
- **CVE-2021-20461**: IBM Cognos Analytics 10.0 and 11.1 is susceptible to a weakness in the implementation of the System Appearance configuration setting. An attacker could potentially bypass business logic to modify the appearance and behavior of the application. IBM X-Force ID: 196770.
- **CVE-2021-37112**: Hisuite module has a External Control of System or Configuration Setting vulnerability.Successful exploitation of this vulnerability may lead to Firmware leak.
- **CVE-2021-39971**: Password vault has a External Control of System or Configuration Setting vulnerability.Successful exploitation of this vulnerability could compromise confidentiality.
- **CVE-2022-48198**: The ntpd_driver component before 1.3.0 and 2.x before 2.2.0 for Robot Operating System (ROS) allows attackers, who control the source code of a different node in the same ROS application, to change a robot's behavior. This occurs because a topic name depends on the attacker-controlled time_ref_topic parameter.
- **CVE-2022-29850**: Various Lexmark products through 2022-04-27 allow an attacker who has already compromised an affected Lexmark device to maintain persistence across reboots.


# Relevant CWE Specifications

## CWE-15: External Control of System or Configuration Setting
**Abstraction:** Base
**Status:** Incomplete

### Description
One or more system settings or configuration elements can be externally controlled by a user.

### Extended Description
Allowing external control of system settings can disrupt service or cause an application to behave in unexpected, and potentially malicious ways.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-642
ChildOf -> CWE-610
ChildOf -> CWE-20

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Strategy:** Separation of Privilege
- **Description:** 

Compartmentalize the system to have "safe" areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area.


Ensure that appropriate compartmentalization is built into the system design, and the compartmentalization allows for and reinforces privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges.


**Mitigation 2:**
- **Phase:** Implementation, Architecture and Design
- **Description:** Because setting manipulation covers a diverse set of functions, any attempt at illustrating it will inevitably be incomplete. Rather than searching for a tight-knit relationship between the functions addressed in the setting manipulation category, take a step back and consider the sorts of system values that an attacker should not be allowed to control.

**Mitigation 3:**
- **Phase:** Implementation, Architecture and Design
- **Description:** In general, do not allow user-provided or otherwise untrusted data to control sensitive values. The leverage that an attacker gains by controlling these values is not always immediately obvious, but do not underestimate the creativity of the attacker.




