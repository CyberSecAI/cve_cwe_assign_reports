# Vulnerability Information: CVE-2021-22385

## Vulnerability Description
A component of the Huawei smartphone has a **External Control of System or Configuration Setting vulnerability**. Local attackers may exploit this vulnerability to cause Kernel Code Execution.

### Vulnerability Description Key Phrases
- **weakness:** **External Control of System or Configuration Setting vulnerability**
- **impact:** Kernel Code Execution
- **attacker:** Local attackers
- **product:** Huawei smartphone

## CVE Reference Links Content Summary
The provided content is a security bulletin from Huawei, which includes information about CVE-2021-22385.

**Root cause of vulnerability:**
The vulnerability lies in the NFC-based connection authentication process.

**Weaknesses/vulnerabilities present:**
The primary weakness is an issue in how NFC-based connections are authenticated, leading to a bypass.

**Impact of exploitation:**
Successful exploitation of this vulnerability may lead to authentication bypass.

**Attack vectors:**
The attack vector involves exploiting the NFC connection authentication mechanism.

**Required attacker capabilities/position:**
The attacker needs to be in a position to interact with the device's NFC capabilities during the connection authentication process.

**Affected Versions:**
EMUI 11.0.0, EMUI 10.1.1, EMUI 10.1.0, Magic UI 4.0.0, Magic UI 3.1.1, Magic UI 3.1.0

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-15 | External Control of System or Configuration Setting | Base | Allowed | 0.6864 | dense, sparse, graph | dense: 0.678, sparse: 0.212, graph: 0.631 |
| 2 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.5636 | dense, sparse, graph | dense: 0.523, sparse: 0.144, graph: 0.613 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4429 | sparse, graph | sparse: 0.149, graph: 1.000 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3598 | sparse, graph | sparse: 0.136, graph: 0.789 |
| 5 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3196 | dense, sparse | dense: 0.514, sparse: 0.135 |
| 6 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.3089 | dense, sparse | dense: 0.519, sparse: 0.131 |
| 7 | CWE-642 | External Control of Critical State Data | Class | Allowed-with-Review | 0.2015 | dense, sparse | dense: 0.524, sparse: 0.141 |
| 8 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1541 | dense, sparse | dense: 0.534, sparse: 0.135 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1506 | dense, sparse | dense: 0.516, sparse: 0.136 |
| 10 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.1183 | dense, sparse | dense: 0.537, sparse: 0.146 |

