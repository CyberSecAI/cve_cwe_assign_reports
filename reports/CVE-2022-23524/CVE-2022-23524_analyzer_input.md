# Vulnerability Information: CVE-2022-23524

## Vulnerability Description
Helm is a tool for managing Charts, pre-configured Kubernetes resources. Versions prior to 3.10.3 are subject to Uncontrolled Resource Consumption, resulting in Denial of Service. **Input to functions in the _strvals_ package can cause a **stack overflow****. In Go, a **stack overflow** cannot be recovered from. Applications that use functions from the _strvals_ package in the Helm SDK can have a Denial of Service attack when they use this package and it panics. This issue has been patched in 3.10.3. SDK users can validate strings supplied by users wont create large arrays causing significant memory usage before passing them to the _strvals_ functions.

### Vulnerability Description Key Phrases
- **rootcause:** **Input to functions in the _strvals_ package can cause a stack overflow**
- **weakness:** **stack overflow**
- **impact:** Denial of Service
- **product:** Helm
- **version:** prior to 3.10.3

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Fuzz testing identified that certain inputs to functions in the `strvals` package can cause a stack overflow.
- **Weaknesses/vulnerabilities present:** Stack overflow due to parsing of string inputs into array data structures.
- **Impact of exploitation:** Denial of service (DoS). Applications using the `strvals` package in the Helm SDK to parse user-supplied input can crash due to a non-recoverable panic.
- **Attack vectors:** User-supplied string inputs passed to functions in the `strvals` package, such as through command-line flags like `--set` and `--set-string` in the Helm client.
- **Required attacker capabilities/position:** The attacker needs to be able to provide input strings that trigger the stack overflow vulnerability in the `strvals` package through user-facing interfaces, such as command-line flags, that utilize the package.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 1.0757 | dense, sparse, graph | dense: 0.471, sparse: 1.000, graph: 1.000 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 1.0701 | dense, sparse, graph | dense: 0.424, sparse: 0.880, graph: 0.991 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.9758 | dense, sparse, graph | dense: 0.476, sparse: 0.915, graph: 0.600 |
| 4 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.9081 | dense, sparse, graph | dense: 0.412, sparse: 0.905, graph: 0.515 |
| 5 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6786 | dense, sparse | dense: 0.432, sparse: 0.809 |
| 6 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6658 | sparse, graph | sparse: 0.859, graph: 0.488 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6483 | dense, sparse | dense: 0.428, sparse: 0.759 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.6300 | dense, sparse | dense: 0.424, sparse: 0.822 |
| 9 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.4611 | sparse | sparse: 0.806 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.4555 | dense, sparse | dense: 0.478, sparse: 0.938 |

