# Vulnerability Information: CVE-2021-42756

## Vulnerability Description
Multiple **stack-based buffer overflow** vulnerabilities [**CWE-121**] in the proxy daemon of FortiWeb 5.x all versions, 6.0.7 and below, 6.1.2 and below, 6.2.6 and below, 6.3.16 and below, 6.4 all versions may allow an unauthenticated remote attacker to achieve arbitrary code execution via specifically crafted HTTP requests.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **weakness:** **CWE-121**
- **impact:** arbitrary code execution
- **vector:** specifically crafted HTTP requests
- **attacker:** unauthenticated remote attacker
- **product:** FortiWeb
- **version:** 5.x all versions, 6.0.7 and below, 6.1.2 and below, 6.2.6 and below, 6.3.16 and below, 6.4 all versions
- **component:** proxy daemon

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Stack-based buffer overflows in FortiWeb's proxy daemon (proxyd).
- **Weaknesses/vulnerabilities present**: Multiple stack-based buffer overflow vulnerabilities ([CWE-121]).
- **Impact of exploitation**: Arbitrary code execution by an unauthenticated remote attacker.
- **Attack vectors**: Specifically crafted HTTP requests.
- **Required attacker capabilities/position**: Remote, unauthenticated attacker.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.8321 | dense, sparse, graph | dense: 0.590, sparse: 0.447, graph: 0.787 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7837 | dense, sparse, graph | dense: 0.561, sparse: 0.450, graph: 0.791 |
| 3 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7755 | dense, sparse, graph | dense: 0.572, sparse: 0.431, graph: 0.680 |
| 4 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.6848 | dense, sparse, graph | dense: 0.599, sparse: 0.396, graph: 0.602 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.5737 | dense, sparse | dense: 0.628, sparse: 0.537 |
| 6 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.5194 | sparse, graph | sparse: 0.435, graph: 0.757 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4856 | dense, sparse | dense: 0.565, sparse: 0.426 |
| 8 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3920 | dense, sparse | dense: 0.560, sparse: 0.253 |
| 9 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.2399 | sparse | sparse: 0.419 |
| 10 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.2357 | sparse | sparse: 0.412 |

