# Vulnerability Information: CVE-2022-22250

## Vulnerability Description
An **Improper Control of a Resource Through its Lifetime** vulnerability in Packet Forwarding Engine (PFE) of Juniper Networks Junos OS and Junos OS Evolved allows unauthenticated adjacent attacker to cause a Denial of Service (DoS). In an EVPN-MPLS scenario, if MAC is learned locally on an access interface but later a request to delete is received indicating that the MAC was learnt remotely, this can lead to **memory corruption** which can result in line card crash and reload. This issue affects Juniper Networks Junos OS All versions 17.3R1 and later versions prior to 19.2R3-S5 19.3 versions prior to 19.3R3-S5 19.4 versions prior to 19.4R2-S6, 19.4R3-S8 20.1 version 20.1R1 and later versions 20.2 versions prior to 20.2R3-S4 20.3 versions prior to 20.3R3-S3 20.4 versions prior to 20.4R3-S3 21.1 versions prior to 21.1R3-S1 21.2 versions prior to 21.2R3 21.3 versions prior to 21.3R2 21.4 versions prior to 21.4R1-S1, 21.4R2. Juniper Networks Junos OS Evolved All versions prior to 20.4R3-S3-EVO 21.1-EVO version 21.1R1-EVO and later versions 21.2-EVO versions prior to 21.2R3-EVO 21.3-EVO versions prior to 21.3R2-EVO 21.4-EVO versions prior to 21.4R1-S1-EVO, 21.4R2-EVO. This issue does not affect Juniper Networks Junos OS versions prior to 17.3R1.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Control of a Resource Through its Lifetime**
- **weakness:** **memory corruption**
- **impact:** Denial of Service (DoS)
- **vector:** accessing uninitialized memory
- **attacker:** unauthenticated adjacent attacker
- **product:** Juniper Networks Junos OS and Junos OS Evolved
- **version:** All versions 17.3R1 and later versions prior to 19.2R3-S5, 19.3 versions prior to 19.3R3-S5, 19.4 versions prior to 19.4R2-S6, 19.4R3-S8, 20.1, 20.1R1 and later versions, 20.2 versions prior to 20.2R3-S4, 20.3 versions prior to 20.3R3-S3, 20.4 versions prior to 20.4R3-S3, 21.1 versions prior to 21.1R3-S1, 21.2 versions prior to 21.2R3, 21.3 versions prior to 21.3R2, 21.4 versions prior to 21.4R1-S1, 21.4R2
- **component:** Packet Forwarding Engine (PFE)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-410 | Insufficient Resource Pool | Base | Allowed | 1.2450 | dense, sparse, graph | dense: 0.630, sparse: 1.000, graph: 1.000 |
| 2 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 1.1016 | dense, sparse, graph | dense: 0.635, sparse: 1.000, graph: 0.593 |
| 3 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 1.0369 | dense, sparse, graph | dense: 0.640, sparse: 1.000, graph: 0.646 |
| 4 | CWE-775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | Allowed | 0.9645 | dense, sparse, graph | dense: 0.590, sparse: 1.000, graph: 0.497 |
| 5 | CWE-1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | Allowed | 0.8772 | dense, sparse | dense: 0.610, sparse: 1.000 |
| 6 | CWE-606 | Unchecked Input for Loop Condition | Base | Allowed | 0.8652 | dense, sparse | dense: 0.586, sparse: 1.000 |
| 7 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.7801 | sparse, graph | sparse: 1.000, graph: 0.582 |
| 8 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |
| 9 | CWE-252 | Unchecked Return Value | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |
| 10 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |

