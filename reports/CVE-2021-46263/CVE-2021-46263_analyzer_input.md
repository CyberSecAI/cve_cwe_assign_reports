# Vulnerability Information: CVE-2021-46263

## Vulnerability Description
Tenda AC Series Router AC11_V02.03.01.104_CN was discovered to contain a **stack buffer overflow** in the wifiTime module. This vulnerability allows attackers to cause a Denial of Service (DoS) via crafted overflow data.

### Vulnerability Description Key Phrases
- **weakness:** **stack buffer overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted overflow data
- **attacker:** attackers
- **product:** Tenda AC Series Router
- **version:** AC11_V02.03.01.104_CN
- **component:** wifiTime module

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 165)
- CWE-120 (Count: 17)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
- The vulnerability is a stack buffer overflow located in the `/goform/setPowerSave` page of the Tenda Router AC series, specifically affecting the `wifiTime` module.

**Weaknesses/Vulnerabilities:**
- **Insufficient Input Validation:** The program does not check the length of the user-provided `wifiTimeClose` input before storing it in the `wl_wifictl_time_interval` nvram variable using `nvram_set`.
- **Uncontrolled Copy:** The program later retrieves the value from the nvram variable using `nvram_get` and copies it to a stack-allocated buffer without proper bounds checking, leading to the overflow.

**Impact of Exploitation:**
- **Denial of Service (DoS):** The buffer overflow can cause the device to crash, leading to a DoS condition.
- **Remote Code Execution (RCE):** With carefully crafted overflow data, an attacker could potentially overwrite parts of the stack and achieve remote code execution on the router.

**Attack Vectors:**
- **HTTP POST Request:** The vulnerability is triggered by sending a crafted POST request to the `/goform/setPowerSave` page.
- **`wifiTimeClose` Parameter:** The malicious input is provided through the `wifiTimeClose` parameter in the POST request.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs network access to the router's web interface. This likely means being on the same local network or having access to the router's WAN interface if it's exposed to the internet.
- **Ability to Craft HTTP Requests:** The attacker needs to be able to create and send HTTP POST requests with a specific payload for the `wifiTimeClose` parameter.

**Additional Notes:**

- The vulnerability was found in Tenda Router AC11, specifically firmware version `AC11_V02.03.01.104_CN`.
- The content includes references to images that demonstrate the vulnerability but are not directly included in the text.
- The timeline indicates that the vulnerability was reported in January 2022 and assigned CVE-2021-46263 in February 2022.
- The content suggests that the user input for `wifiTimeClose` is initially stored in the variable `v10` before being set with `nvram_set`, then later retrieved with `nvram_get` into `v9` which is copied into `a2` which is where the overflow happens

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-805 | Buffer Access with Incorrect Length Value | Base | Allowed | 0.5945 | dense, sparse, graph | dense: 0.508, sparse: 0.160, graph: 0.695 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4321 | dense, sparse | dense: 0.635, sparse: 0.263 |
| 3 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3285 | dense, sparse | dense: 0.508, sparse: 0.178 |
| 4 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3237 | sparse, graph | sparse: 0.171, graph: 0.631 |
| 5 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.3209 | sparse, graph | sparse: 0.152, graph: 0.729 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3134 | dense, sparse | dense: 0.498, sparse: 0.158 |
| 7 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1572 | dense, sparse | dense: 0.501, sparse: 0.176 |
| 8 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.0980 | sparse | sparse: 0.171 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.0977 | sparse | sparse: 0.171 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.0960 | sparse | sparse: 0.168 |

