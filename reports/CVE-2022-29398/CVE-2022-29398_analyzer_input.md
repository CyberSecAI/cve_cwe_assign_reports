# Vulnerability Information: CVE-2022-29398

## Vulnerability Description
TOTOLINK N600R V4.3.0cu.7647_B20210106 was discovered to contain a **stack overflow** via the File parameter in the function FUN_0041309c.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** TOTOLINK N600R
- **version:** V4.3.0cu.7647_B20210106
- **component:** function FUN_0041309c

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 155)
- CWE-120 (Count: 6)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A stack-based buffer overflow vulnerability exists in the `/web_cste/cgi-bin/cstecgi.cgi` binary. The `FUN_0041309c` function retrieves the `File` parameter from a JSON input and copies it directly to a local stack buffer without checking the length of the input, allowing an attacker to overwrite parts of the stack.
- **Weaknesses/vulnerabilities**: Stack-based buffer overflow due to lack of input validation.
- **Impact of exploitation**: By overflowing the stack, an attacker could overwrite return addresses, control the program flow, and potentially achieve remote code execution.
- **Attack vectors**: Sending a crafted JSON POST request to the `/web_cste/cgi-bin/cstecgi.cgi` endpoint with a large value for the `File` parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable device. This likely means being on the same network as the device, or having access through a port-forward.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5204 | dense, sparse, graph | dense: 0.532, sparse: 0.110, graph: 0.536 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3744 | dense, sparse | dense: 0.621, sparse: 0.166 |
| 3 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.3163 | dense, sparse | dense: 0.553, sparse: 0.115 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3133 | dense, sparse | dense: 0.523, sparse: 0.090 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3120 | dense, sparse | dense: 0.522, sparse: 0.089 |
| 6 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.2992 | dense, sparse | dense: 0.499, sparse: 0.086 |
| 7 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.2974 | dense, sparse | dense: 0.495, sparse: 0.087 |
| 8 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2941 | dense, sparse | dense: 0.502, sparse: 0.099 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2924 | dense, sparse | dense: 0.525, sparse: 0.095 |
| 10 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.2766 | dense, sparse | dense: 0.498, sparse: 0.088 |

