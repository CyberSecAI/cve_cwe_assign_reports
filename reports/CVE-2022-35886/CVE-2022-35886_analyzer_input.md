# Vulnerability Information: CVE-2022-35886

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the web interface /action/wirelessConnect functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9Z and 6.9X. A specially-crafted HTTP request can lead to memory corruption, information disclosure and denial of service. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.This vulnerability arises from **format string injection** via the `default_key_id` and `key` HTTP parameters, as used within the `/action/wirelessConnect` handler.

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9Z and 6.9X
- **component:** /action/wirelessConnect functionality

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `log` function, which is a wrapper to `vsnprintf` and `puts`, is misused in the `/action/wirelessConnect` HTTP handler. Specifically, the `format` parameter of `vsnprintf` within the `log` function is populated with attacker-controlled data from HTTP parameters, leading to a format string vulnerability.",
  "Weaknesses/vulnerabilities present": [
    "Format string injection vulnerability in the `log` function.",
     "Lack of proper sanitization of HTTP parameters `default_key_id` and `key` before being used in a format string within the `log` function."
  ],
  "Impact of exploitation": "An attacker can cause memory corruption, information disclosure, and denial of service by sending a specially-crafted HTTP request that exploits format string vulnerabilities. The attacker can potentially leak stack memory and write arbitrary memory.",
  "Attack vectors": "An attacker can exploit the vulnerabilities by sending an authenticated HTTP request to the `/action/wirelessConnect` endpoint with crafted `default_key_id` and `key` HTTP parameters when the `auth_mode` parameter is either `WEP` or `SHARED`.",
  "Required attacker capabilities/position": "The attacker needs to be authenticated to the web interface. The web interface is disabled by default, but can be re-enabled using previously discovered vulnerabilities. Additionally, a physically present attacker with UART access can observe the output of the format string vulnerabilities."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.0810 | dense, sparse, graph | dense: 0.694, sparse: 0.839, graph: 0.709 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7135 | dense, sparse, graph | dense: 0.595, sparse: 0.351, graph: 0.602 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5688 | sparse, graph | sparse: 0.369, graph: 1.000 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5035 | sparse, graph | sparse: 0.329, graph: 0.882 |
| 5 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4652 | dense, sparse | dense: 0.558, sparse: 0.325 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4425 | dense, sparse | dense: 0.564, sparse: 0.317 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4248 | dense, sparse | dense: 0.569, sparse: 0.306 |
| 8 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2099 | dense, sparse | dense: 0.550, sparse: 0.339 |
| 9 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1847 | sparse | sparse: 0.323 |
| 10 | CWE-1287 | Improper Validation of Specified Type of Input | Base | Allowed | 0.1833 | sparse | sparse: 0.320 |

