# Raw Retriever Results for CVE-2021-3406

# Raw Retriever Results for CVE-2021-3406

## Query
A flaw was found in keylime 5.8.1 and older. The issue in the Keylime agent and registrar code invalidates the cryptographic chain of trust from the Endorsement Key certificate to agent attestations.

## Keyphrases
- **rootcause**: invalid cryptographic chain of trust

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4271 | 0.5634 | 0.4642 | 0.4615 | 20 |
| Sparse | 195.3598 | 445.0019 | 219.4950 | 200.8667 | 20 |
| Graph | 1.0666 | 2.1720 | 1.5058 | 1.5212 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 259 | Use of Hard-coded Password | variant | 2.1720 | Allowed |
| 2 | 370 | Missing Check for Certificate Revocation after Initial Check | variant | 1.9147 | Allowed |
| 3 | 290 | Authentication Bypass by Spoofing | base | 1.8018 | Allowed |
| 4 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.7680 | Allowed |
| 5 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 1.7261 | Allowed |
| 6 | 295 | Improper Certificate Validation | Base | 1.7094 | Allowed |
| 7 | 325 | Missing Cryptographic Step | Base | 1.6748 | Allowed |
| 8 | 257 | Storing Passwords in a Recoverable Format | base | 1.6708 | Allowed |
| 9 | 347 | Improper Verification of Cryptographic Signature | Base | 1.6215 | Allowed |
| 10 | 599 | Missing Validation of OpenSSL Certificate | Variant | 1.5214 | Allowed |
| 11 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | base | 1.5210 | Allowed |
| 12 | 1394 | Use of Default Cryptographic Key | Base | 1.4946 | Allowed |
| 13 | 656 | Reliance on Security Through Obscurity | class | 1.3600 | Allowed-with-Review |
| 14 | 262 | Not Using Password Aging | base | 1.3104 | Allowed |
| 15 | 603 | Use of Client-Side Authentication | base | 1.3104 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 0.5634 | 0.5634 | Allowed |
| 2 | 325 | Missing Cryptographic Step | Base | 0.5109 | 0.5109 | Allowed |
| 3 | 1394 | Use of Default Cryptographic Key | Base | 0.4907 | 0.4907 | Allowed |
| 4 | 599 | Missing Validation of OpenSSL Certificate | Variant | 0.4841 | 0.4841 | Allowed |
| 5 | 295 | Improper Certificate Validation | Base | 0.4839 | 0.4839 | Allowed |
| 6 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4839 | 0.4839 | Allowed |
| 7 | 347 | Improper Verification of Cryptographic Signature | Base | 0.4811 | 0.4811 | Allowed |
| 8 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.4687 | 0.4687 | Allowed |
| 9 | 298 | Improper Validation of Certificate Expiration | Variant | 0.4671 | 0.4671 | Allowed |
| 10 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.4626 | 0.4626 | Allowed |
| 11 | 324 | Use of a Key Past its Expiration Date | Base | 0.4604 | 0.4604 | Allowed |
| 12 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.4582 | 0.4582 | Allowed-with-Review |
| 13 | 299 | Improper Check for Certificate Revocation | Base | 0.4553 | 0.4553 | Allowed |
| 14 | 1326 | Missing Immutable Root of Trust in Hardware | Base | 0.4359 | 0.4359 | Allowed |
| 15 | 322 | Key Exchange without Entity Authentication | Base | 0.4330 | 0.4330 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-296 | Improper Following of a Certificate's Chain of Trust | 445.0019 | 445.0019 | Allowed |
| 2 | CWE-295 | Improper Certificate Validation | 264.1198 | 264.1198 | Allowed |
| 3 | CWE-1390 | Weak Authentication | 234.6597 | 234.6597 | Allowed-with-Review |
| 4 | CWE-321 | Use of Hard-coded Cryptographic Key | 221.9250 | 221.9250 | Allowed |
| 5 | CWE-347 | Improper Verification of Cryptographic Signature | 216.0983 | 216.0983 | Allowed |
| 6 | CWE-325 | Missing Cryptographic Step | 215.6524 | 215.6524 | Allowed |
| 7 | CWE-345 | Insufficient Verification of Data Authenticity | 209.7801 | 209.7801 | Discouraged |
| 8 | CWE-300 | Channel Accessible by Non-Endpoint | 206.6743 | 206.6743 | Discouraged |
| 9 | CWE-392 | Missing Report of Error Condition | 201.9062 | 201.9062 | Allowed |
| 10 | CWE-755 | Improper Handling of Exceptional Conditions | 201.2484 | 201.2484 | Discouraged |
| 11 | CWE-276 | Incorrect Default Permissions | 200.4851 | 200.4851 | Allowed |
| 12 | CWE-331 | Insufficient Entropy | 200.2353 | 200.2353 | Allowed |
| 13 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 199.3307 | 199.3307 | Allowed-with-Review |
| 14 | CWE-125 | Out-of-bounds Read | 197.2969 | 197.2969 | Allowed |
| 15 | CWE-287 | Improper Authentication | 197.0715 | 197.0715 | Discouraged |
