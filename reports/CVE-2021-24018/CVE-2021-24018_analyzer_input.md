# Vulnerability Information: CVE-2021-24018

## Vulnerability Description
A **buffer underwrite** vulnerability in the firmware verification routine of FortiOS before 7.0.1 may allow an attacker located in the adjacent network to potentially execute arbitrary code via a specifically crafted firmware image.

### Vulnerability Description Key Phrases
- **rootcause:** **buffer underwrite**
- **impact:** execute arbitrary code
- **vector:** specifically crafted firmware image
- **attacker:** attacker in adjacent network
- **product:** FortiOS
- **version:** before 7.0.1
- **component:** firmware verification routine

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A buffer underwrite vulnerability exists in the firmware verification routine.
- **Weaknesses/vulnerabilities present**: Buffer underwrite (CWE-124)
- **Impact of exploitation**: An attacker can potentially execute arbitrary code.
- **Attack vectors**: Specifically crafted firmware image.
- **Required attacker capabilities/position**: The attacker needs to be located in the adjacent network and be able to provide a crafted firmware image to the vulnerable device. The attacker also needs to have high privileges for exploitation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.7888 | dense, sparse, graph | dense: 0.673, sparse: 0.294, graph: 0.794 |
| 2 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5720 | dense, sparse, graph | dense: 0.595, sparse: 0.160, graph: 0.645 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4433 | sparse, graph | sparse: 0.150, graph: 1.000 |
| 4 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.3891 | dense, sparse | dense: 0.602, sparse: 0.153 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3747 | dense, sparse | dense: 0.607, sparse: 0.179 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3746 | dense, sparse | dense: 0.565, sparse: 0.161 |
| 7 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.3712 | dense, sparse | dense: 0.565, sparse: 0.154 |
| 8 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3706 | dense, sparse | dense: 0.568, sparse: 0.150 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3491 | dense, sparse | dense: 0.564, sparse: 0.168 |
| 10 | CWE-912 | Hidden Functionality | Class | Allowed-with-Review | 0.2251 | dense, sparse | dense: 0.583, sparse: 0.160 |

