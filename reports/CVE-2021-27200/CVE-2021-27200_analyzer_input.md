# Vulnerability Information: CVE-2021-27200

## Vulnerability Description
In WoWonder 3.0.4, remote attackers can take over any account due to the **weak cryptographic algorithm** in recover.php. The code parameter is easily predicted from the time of day.

### Vulnerability Description Key Phrases
- **rootcause:** **weak cryptographic algorithm**
- **impact:** take over any account
- **vector:** predicting code parameter
- **attacker:** remote attackers
- **product:** WoWonder
- **version:** 3.0.4
- **component:** recover.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a weak cryptographic algorithm used in the `recover.php` file of the WoWonder Social Network Platform. Specifically, the "code" parameter in the password reset link is predictable.

**Weaknesses/Vulnerabilities:**
- **Weak Cryptography:** The password reset code is not generated using a secure random process. It is derived by combining the password reset link time with a random number between 111 and 999. The time component is predictable, and the random value has a small range, making the code guessable.
- **Authentication Bypass:** By predicting the password reset code, an attacker can bypass the intended authentication mechanism for resetting passwords and gain unauthorized access to accounts.

**Impact of Exploitation:**
- **Account Takeover:** An attacker can take over any user account on the WoWonder platform.
- **Complete System Compromise:** If successful, an attacker could potentially access and control all accounts, potentially leading to a complete compromise of the WoWonder application and its data.

**Attack Vectors:**
- **Network Access:** The attack is performed over the network by sending crafted HTTP requests.
- **Password Reset Functionality:** The vulnerability is triggered through the password reset functionality of the application.

**Required Attacker Capabilities/Position:**
- **Network Access:**  The attacker needs network access to the target WoWonder instance.
- **Email Address:** The attacker must know a valid email address registered on the WoWonder platform to initiate the password reset process.
- **Code Execution:** The provided exploit code utilizes Python, requiring the attacker to be capable of executing such code to generate valid reset codes.
- **Timing:** While not explicitly stated, the effectiveness of the attack may rely on generating the reset code near the time the password reset link was generated.

**Additional Information:**
- The vulnerability was discovered by the "Security For Everyone Team".
- The vulnerability is present in WoWonder versions prior to 3.1.
- The vendor has released a fix in version 3.1, and users are advised to update.
- The exploit code demonstrates how to predict the password reset code using a combination of the server response date and a range of numbers.

The provided content gives a more detailed explanation than the placeholder CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.6019 | dense, sparse, graph | dense: 0.540, sparse: 0.193, graph: 0.618 |
| 2 | CWE-341 | Predictable from Observable State | Base | Allowed | 0.5998 | dense, sparse, graph | dense: 0.507, sparse: 0.267, graph: 0.541 |
| 3 | CWE-338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | Allowed | 0.5929 | dense, sparse, graph | dense: 0.521, sparse: 0.197, graph: 0.613 |
| 4 | CWE-328 | Use of Weak Hash | Base | Allowed | 0.3612 | dense, sparse | dense: 0.505, sparse: 0.190 |
| 5 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.3260 | dense, sparse | dense: 0.513, sparse: 0.168 |
| 6 | CWE-1391 | Use of Weak Credentials | Class | Allowed-with-Review | 0.2936 | dense, sparse, graph | dense: 0.539, sparse: 0.162, graph: 0.384 |
| 7 | CWE-208 | Observable Timing Discrepancy | Base | Allowed | 0.2803 | sparse, graph | sparse: 0.141, graph: 0.558 |
| 8 | CWE-1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | 0.2369 | sparse, graph | sparse: 0.190, graph: 0.359 |
| 9 | CWE-335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | 0.2150 | sparse, graph | sparse: 0.151, graph: 0.359 |
| 10 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.1764 | sparse, graph | sparse: 0.192, graph: 0.534 |

