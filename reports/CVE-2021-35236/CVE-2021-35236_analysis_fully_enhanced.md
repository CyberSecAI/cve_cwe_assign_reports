# Fully Enhanced Analysis for Critic Review - CVE-2021-35236

```markdown
# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 1.0 | Variant | Allowed | Primary CWE: Matches the specific weakness of missing Secure attribute in SSL cookie. |
| CWE-319 | Cleartext Transmission of Sensitive Information | 0.7 | Base | Allowed | Secondary Candidate: Represents the broader risk of transmitting sensitive data in cleartext due to the missing Secure flag. |

## Evidence and Confidence

*   **Confidence Score:** 0.9
*   **Evidence Strength:** HIGH


- **Analysis and Justification:**  
  - *Explanation:* "The vulnerability description clearly states the **rootcause** is the **lack of Secure flag in SSL Cookie**. This maps directly to CWE-614 (Sensitive Cookie in HTTPS Session Without 'Secure' Attribute), which is a Variant-level CWE and is ALLOWED according to MITRE mapping guidance. The vulnerability occurs because the Secure attribute, which instructs the browser to only send the cookie over a secure HTTPS channel, is not set. Consequently, the cookie can be transmitted in cleartext over HTTP, as indicated by the description's **impact**: 'cookie can be sent in clear text'. CWE-319 (Cleartext Transmission of Sensitive Information) is considered as a secondary candidate because it describes the broader issue of transmitting sensitive information without encryption, which is a consequence of the missing Secure flag. However, CWE-614 is more specific to the cookie issue."
  
  - *Relationship Analysis:* "CWE-614 does not have any direct relationships mentioned in the provided information. However, CWE-319, a secondary candidate, is a parent of CWE-614. This means that CWE-614 is a specific instance of the more general weakness described by CWE-319. The fact that the vulnerability specifically involves a cookie lacking the Secure attribute makes CWE-614 the more appropriate choice."

- **Confidence Score:**  
  - Confidence: 1.0 (High confidence due to a clear match between the vulnerability description, CWE description, and MITRE mapping guidance)
```



## Known Examples for CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute
### Observed Examples
- **CVE-2004-0462** [https://www.cve.org/CVERecord?id=CVE-2004-0462](https://www.cve.org/CVERecord?id=CVE-2004-0462): A product does not set the Secure attribute for sensitive cookies in HTTPS sessions, which could cause the user agent to send those cookies in plaintext over an HTTP session with the product.
- **CVE-2008-3663** [https://www.cve.org/CVERecord?id=CVE-2008-3663](https://www.cve.org/CVERecord?id=CVE-2008-3663): A product does not set the secure flag for the session cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
- **CVE-2008-3662** [https://www.cve.org/CVERecord?id=CVE-2008-3662](https://www.cve.org/CVERecord?id=CVE-2008-3662): A product does not set the secure flag for the session cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
- **CVE-2008-0128** [https://www.cve.org/CVERecord?id=CVE-2008-0128](https://www.cve.org/CVERecord?id=CVE-2008-0128): A product does not set the secure flag for a cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
### Top 25 Examples
- **CVE-2021-35236**: The Secure flag is not set in the SSL Cookie of Kiwi Syslog Server 9.7.2 and previous versions. The Secure attribute tells the browser to only send the cookie if the request is being sent over a secure channel such as HTTPS. This will help protect the cookie from being passed over unencrypted requests. If the application can be accessed over both HTTP, there is a potential for the cookie can be sent in clear text.
- **CVE-2021-29883**: IBM Standards Processing Engine (IBM Transformation Extender Advanced 9.0 and 10.0) does not set the secure attribute on authorization tokens or session cookies. Attackers may be able to get the cookie values by sending a http:// link to a user or by planting this link in a site the user goes to. The cookie will be sent to the insecure link and the attacker can then obtain the cookie value by snooping the traffic. IBM X-Force ID: 207090.
- **CVE-2021-38977**: IBM Tivoli Key Lifecycle Manager 3.0, 3.0.1, 4.0, and 4.1 does not set the secure attribute on authorization tokens or session cookies. Attackers may be able to get the cookie values by sending a http:// link to a user or by planting this link in a site the user goes to. The cookie will be sent to the insecure link and the attacker can then obtain the cookie value by snooping the traffic. IBM X-Force ID: 212782.
- **CVE-2021-3882**: LedgerSMB does not set the 'Secure' attribute on the session authorization cookie when the client uses HTTPS and the LedgerSMB server is behind a reverse proxy. By tricking a user to use an unencrypted connection (HTTP), an attacker may be able to obtain the authentication data by capturing network traffic. LedgerSMB 1.8 and newer switched from Basic authentication to using cookie authentication with encrypted cookies. Although an attacker can't access the information inside the cookie, nor the password of the user, possession of the cookie is enough to access the application as the user from which the cookie has been obtained. In order for the attacker to obtain the cookie, first of all the server must be configured to respond to unencrypted requests, the attacker must be suitably positioned to eavesdrop on the network traffic between the client and the server *and* the user must be tricked into using unencrypted HTTP traffic. Proper audit control and separation of duties limit Integrity impact of the attack vector. Users of LedgerSMB 1.8 are urged to upgrade to known-fixed versions. Users of LedgerSMB 1.7 or 1.9 are unaffected by this vulnerability and don't need to take action. As a workaround, users may configure their Apache or Nginx reverse proxy to add the Secure attribute at the network boundary instead of relying on LedgerSMB. For Apache, please refer to the 'Header always edit' configuration command in the mod_headers module. For Nginx, please refer to the 'proxy_cookie_flags' configuration command.
- **CVE-2021-29248**: BTCPay Server through 1.0.7.0 could allow a remote attacker to obtain sensitive information, caused by failure to set the Secure flag for a cookie.
- **CVE-2022-24045**: A vulnerability has been identified in Desigo DXR2 (All versions < V01.21.142.5-22), Desigo PXC3 (All versions < V01.21.142.4-18), Desigo PXC4 (All versions < V02.20.142.10-10884), Desigo PXC5 (All versions < V02.20.142.10-10884). The application, after a successful login, sets the session cookie on the browser via client-side JavaScript code, without applying any security attributes (such as “Secure”, “HttpOnly”, or “SameSite”). Any attempts to browse the application via unencrypted HTTP protocol would lead to the transmission of all his/her session cookies in plaintext through the network. An attacker could then be able to sniff the network and capture sensitive information.
