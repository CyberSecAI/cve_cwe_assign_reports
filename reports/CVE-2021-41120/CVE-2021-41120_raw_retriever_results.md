# Raw Retriever Results for CVE-2021-41120

# Raw Retriever Results for CVE-2021-41120

## Query
sylius/paypal-plugin is a paypal plugin for the Sylius development platform. In affected versions the URL to the payment page done after checkout was created with autoincremented payment id (/pay-with-paypal/{id}) and therefore it was easy to predict. The problem is that the Credit card form has prefilled credit card holder field with the Customers first and last name and hence this can lead to personally identifiable information exposure. Additionally, the mentioned form did not require authentication. The problem has been patched in Sylius/PayPalPlugin 1.2.4 and 1.3.1. If users are unable to update they can override a sylius_paypal_plugin_pay_with_paypal_form route and change its URL parameters to (for example) {orderToken}/{paymentId}, then override the Sylius\PayPalPlugin\Controller\PayWithPayPalFormAction service, to operate on the payment taken from the repository by these 2 values. It would also require usage of custom repository method. Additionally, one could override the @SyliusPayPalPlugin/payWithPaypal.html.twig template, to add contingencies [SCA_ALWAYS] line in hostedFields.submit(...) function call (line 421). It would then have to be handled in the function callback.

## Keyphrases
- **rootcause**: URL to the payment page done after checkout was created with autoincremented payment id (/pay-with-paypal/{id})
- **weakness**: sensitive information exposure

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3927 | 0.4554 | 0.4107 | 0.4091 | 20 |
| Sparse | 818.8977 | 1899.4721 | 1362.6332 | 1381.7119 | 20 |
| Graph | 1.4456 | 2.3503 | 1.7660 | 1.6392 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 2.3503 | Allowed |
| 2 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 3 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.0400 | Allowed |
| 4 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 5 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 6 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 2.0083 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 1.7596 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6464 | Allowed |
| 11 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 12 | 457 | Use of Uninitialized Variable | variant | 1.6320 | Allowed |
| 13 | 321 | Use of Hard-coded Cryptographic Key | variant | 1.6320 | Allowed |
| 14 | 259 | Use of Hard-coded Password | variant | 1.6320 | Allowed |
| 15 | 384 | Session Fixation | compound | 1.6100 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.4554 | 0.4554 | Allowed |
| 2 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4337 | 0.4337 | Allowed |
| 3 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.4237 | 0.4237 | Allowed |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.4231 | 0.4231 | Allowed |
| 5 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.4212 | 0.4212 | Allowed |
| 6 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | 0.4187 | 0.4187 | Allowed |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.4170 | 0.4170 | Allowed |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4112 | 0.4112 | Allowed |
| 9 | 922 | Insecure Storage of Sensitive Information | Class | 0.4109 | 0.4109 | Allowed-with-Review |
| 10 | 862 | Missing Authorization | Class | 0.4102 | 0.4102 | Allowed-with-Review |
| 11 | 256 | Plaintext Storage of a Password | Base | 0.4079 | 0.4079 | Allowed |
| 12 | 863 | Incorrect Authorization | Class | 0.4038 | 0.4038 | Allowed-with-Review |
| 13 | 549 | Missing Password Field Masking | Base | 0.4027 | 0.4027 | Allowed |
| 14 | 620 | Unverified Password Change | Base | 0.4012 | 0.4012 | Allowed |
| 15 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.4001 | 0.4001 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | 1899.4721 | 1899.4721 | Allowed |
| 2 | CWE-639 | Authorization Bypass Through User-Controlled Key | 1521.4327 | 1521.4327 | Allowed |
| 3 | CWE-863 | Incorrect Authorization | 1477.0635 | 1477.0635 | Allowed-with-Review |
| 4 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1470.1492 | 1470.1492 | Allowed |
| 5 | CWE-862 | Missing Authorization | 1454.1245 | 1454.1245 | Allowed-with-Review |
| 6 | CWE-352 | Cross-Site Request Forgery (CSRF) | 1452.8009 | 1452.8009 | Allowed |
| 7 | CWE-116 | Improper Encoding or Escaping of Output | 1432.7177 | 1432.7177 | Allowed-with-Review |
| 8 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 1429.8604 | 1429.8604 | Allowed |
| 9 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 1394.0939 | 1394.0939 | Discouraged |
| 10 | CWE-1390 | Weak Authentication | 1392.1837 | 1392.1837 | Allowed-with-Review |
| 11 | CWE-285 | Improper Authorization | 1371.2401 | 1371.2401 | Discouraged |
| 12 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 1361.6006 | 1361.6006 | Allowed |
| 13 | CWE-434 | Unrestricted Upload of File with Dangerous Type | 1344.6279 | 1344.6279 | Allowed |
| 14 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 1325.7535 | 1325.7535 | Allowed-with-Review |
| 15 | CWE-256 | Plaintext Storage of a Password | 1323.2586 | 1323.2586 | Allowed |
