# Vulnerability Information: CVE-2020-19150

## Vulnerability Description
Improper Access Control in Jfinal CMS v4.7.1 and earlier allows remote attackers to obtain sensitive information or cause a denial of service via the FileManager.delete() function in the component modules/filemanager/FileManagerController.java.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access control**
- **impact:** obtain sensitive information and cause denial of service
- **attacker:** remote attackers
- **product:** Jfinal CMS
- **version:** v4.7.1 and earlier
- **component:** FileManager.delete() function in modules/filemanager/FileManagerController.java

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The application does not filter the path parameter passed by the user in the file management functionality, allowing for traversal outside the intended directories.",
  "Weaknesses/vulnerabilities present": "Arbitrary file deletion due to lack of path sanitization/validation.",
  "Impact of exploitation": "An attacker can delete any file on the server that the web application has access to, leading to potential data loss and disruption of service.",
  "Attack vectors": "By sending a crafted HTTP request with the 'mode' parameter set to 'delete' and the 'path' parameter pointing to the file they want to delete, an attacker can trigger the vulnerability.",
  "Required attacker capabilities/position": "The attacker must have access to the web application's admin panel and knowledge of the file system structure on the server."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.7663 | dense, sparse, graph | dense: 0.526, sparse: 0.254, graph: 1.000 |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.7336 | dense, sparse, graph | dense: 0.537, sparse: 0.188, graph: 1.000 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.6789 | dense, sparse, graph | dense: 0.560, sparse: 0.163, graph: 0.855 |
| 4 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.5765 | dense, sparse, graph | dense: 0.539, sparse: 0.151, graph: 0.616 |
| 5 | CWE-29 | Path Traversal: '\..\filename' | Variant | Allowed | 0.3972 | sparse, graph | sparse: 0.313, graph: 0.704 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3041 | sparse, graph | sparse: 0.162, graph: 0.631 |
| 7 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2099 | dense, sparse | dense: 0.537, sparse: 0.154 |
| 8 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2049 | dense, sparse | dense: 0.522, sparse: 0.153 |
| 9 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1583 | dense, sparse | dense: 0.535, sparse: 0.150 |
| 10 | CWE-285 | Improper Authorization | Class | Discouraged | 0.1582 | dense, sparse | dense: 0.525, sparse: 0.159 |

