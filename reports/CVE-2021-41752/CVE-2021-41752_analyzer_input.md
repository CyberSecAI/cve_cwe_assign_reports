# Vulnerability Information: CVE-2021-41752

## Vulnerability Description
Stack overflow vulnerability in Jerryscript before commit e1ce7dd7271288be8c0c8136eea9107df73a8ce2 on Oct 20, 2021 due to an **unbounded recursive call** to the new opt() function.

### Vulnerability Description Key Phrases
- **rootcause:** **unbounded recursive call**
- **weakness:** **stack overflow**
- **product:** Jerryscript
- **version:** before commit e1ce7dd7271288be8c0c8136eea9107df73a8ce2
- **component:** new opt() function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

The root cause is an infinite recursion within the JavaScript code due to the line `let obj = new opt();` inside the `opt` function. Each call to `new opt()` creates a new instance of the `opt` function, triggering a recursive call, which eventually leads to a stack overflow.

**Weaknesses/Vulnerabilities Present:**

*   **Infinite Recursion:** The core weakness is the uncontrolled recursive function call, which does not have a base case to terminate the recursion, causing the stack to grow indefinitely until it overflows.
*   **Lack of Stack Overflow Protection:** While a `--stack-limit` build option was used, it was not effective in preventing the crash, which suggests that stack limit checks were not functioning as intended or not properly implemented for this type of recursive call.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** The stack overflow crash leads to the termination of the program execution, resulting in a denial-of-service condition. The program becomes unusable and crashes due to stack exhaustion.

**Attack Vectors:**

*   **Malicious JavaScript Code:** The attack vector is the execution of crafted JavaScript code containing the recursive function call. An attacker would need to inject or have a program execute the malicious code.

**Required Attacker Capabilities/Position:**

*   **Code Execution:** The attacker needs the capability to execute arbitrary JavaScript code within the context of the vulnerable JerryScript engine. This could be achieved by providing the malicious code to be executed as input to the engine, or by using other means of injecting/executing code in the application using JerryScript engine.

**Additional Notes:**
* The issue was resolved by implementing proper stack limit checks, as mentioned in the last comment.
* The provided stack trace shows the sequence of function calls leading to the overflow, highlighting the recursive nature of the issue.
* The `--stack-limit` flag was not effective until the fix was applied, indicating that previous attempts to limit the stack growth did not work correctly with recursive calls.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | Base | Allowed | 0.6183 | dense, sparse, graph | dense: 0.498, sparse: 0.108, graph: 0.860 |
| 2 | CWE-663 | Use of a Non-reentrant Function in a Concurrent Context | Base | Allowed | 0.4715 | sparse, graph | sparse: 0.199, graph: 1.000 |
| 3 | CWE-776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | Allowed | 0.4240 | sparse, graph | sparse: 0.190, graph: 0.882 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3400 | dense, sparse | dense: 0.470, sparse: 0.184 |
| 5 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3316 | dense, sparse | dense: 0.459, sparse: 0.178 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3216 | dense, sparse | dense: 0.465, sparse: 0.202 |
| 7 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3159 | sparse, graph | sparse: 0.184, graph: 0.631 |
| 8 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.2968 | dense, sparse | dense: 0.483, sparse: 0.097 |
| 9 | CWE-194 | Unexpected Sign Extension | Variant | Allowed | 0.2867 | dense, sparse | dense: 0.512, sparse: 0.095 |
| 10 | CWE-252 | Unchecked Return Value | Base | Allowed | 0.2851 | dense, sparse | dense: 0.466, sparse: 0.091 |

