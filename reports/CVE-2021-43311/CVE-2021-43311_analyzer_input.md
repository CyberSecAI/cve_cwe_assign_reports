# Vulnerability Information: CVE-2021-43311

## Vulnerability Description
A **heap-based buffer overflow** was discovered in upx, during the generic pointer p points to an inaccessible address in func get_le32(). The problem is essentially caused in PackLinuxElf32elf_lookup() at p_lx_elf.cpp5382.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-based buffer overflow**
- **vector:** access inaccessible address in func get_le32()
- **product:** upx
- **component:** PackLinuxElf32elf_lookup() at p_lx_elf.cpp5382

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 21)

## CVE Reference Links Content Summary
The content is related to CVE-2021-43311.

**Root cause of vulnerability:**
The vulnerability is caused by multiple heap-based buffer overflows within the `get_le32()` function in UPX (Ultimate Packer for eXecutables). Specifically, a generic pointer 'p' points to an inaccessible memory address when dereferenced, leading to an out-of-bounds read.

**Weaknesses/vulnerabilities present:**
- Heap-based buffer overflows in `get_le32()` function
- Dereferencing a generic pointer 'p' pointing to an inaccessible address.
- Vulnerable code locations within `p_lx_elf.cpp`:
    - Line 5382 in `PackLinuxElf32::elf_lookup()`
    - Line 5368 in `PackLinuxElf32::elf_lookup()`
    - Line 5404 in `PackLinuxElf64::elf_lookup()`
    - Line 5349 in `PackLinuxElf32::elf_lookup()`
- Insufficient bounds checking when accessing memory via pointers.

**Impact of exploitation:**
- Denial of service (DoS) due to crashes from out-of-bounds reads.

**Attack vectors:**
- Maliciously crafted input files.
- Specifically crafted ELF files.

**Required attacker capabilities/position:**
- Ability to provide a crafted input file to be processed by UPX.
- No special privileges required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6965 | dense, sparse, graph | dense: 0.526, sparse: 0.184, graph: 0.919 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6671 | dense, sparse, graph | dense: 0.582, sparse: 0.188, graph: 0.751 |
| 3 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.5931 | dense, sparse, graph | dense: 0.572, sparse: 0.158, graph: 0.606 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5445 | dense, sparse, graph | dense: 0.562, sparse: 0.186, graph: 0.566 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4068 | sparse, graph | sparse: 0.175, graph: 0.857 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4006 | dense, sparse | dense: 0.586, sparse: 0.246 |
| 7 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3670 | sparse, graph | sparse: 0.148, graph: 0.789 |
| 8 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3614 | dense, sparse | dense: 0.537, sparse: 0.162 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3525 | dense, sparse | dense: 0.519, sparse: 0.162 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3425 | dense, sparse | dense: 0.548, sparse: 0.169 |

