# Raw Retriever Results for CVE-2021-33913

# Raw Retriever Results for CVE-2021-33913

## Query
libspf2 before 1.2.11 has a heap-based buffer overflow that might allow remote attackers to execute arbitrary code (via an unauthenticated e-mail message from anywhere on the Internet) with a crafted SPF DNS record, because of SPF_record_expand_data in spf_expand.c. The amount of overflowed data depends on the relationship between the length of an entire domain name and the length of its leftmost label. The vulnerable code may be part of the supply chain of a sites e-mail infrastructure (e.g., with additional configuration, Exim can use libspf2 the Postfix web site links to unofficial patches for use of libspf2 with Postfix older versions of spfquery relied on libspf2) but most often is not.

## Keyphrases
- **rootcause**: heap-based buffer overflow in SPF_record_expand_data in spf_expand.c

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5247 | 0.5815 | 0.5460 | 0.5459 | 20 |
| Sparse | 572.8760 | 789.2349 | 618.5605 | 600.5070 | 20 |
| Graph | 1.6320 | 2.3998 | 1.9585 | 1.8450 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.3998 | Allowed |
| 2 | 787 | Out-of-bounds Write | base | 2.2776 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 5 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 10 | 125 | Out-of-bounds Read | Base | 1.9220 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 13 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 14 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 15 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 122 | Heap-based Buffer Overflow | Variant | 0.5815 | 0.5815 | Allowed |
| 2 | 121 | Stack-based Buffer Overflow | Variant | 0.5692 | 0.5692 | Allowed |
| 3 | 126 | Buffer Over-read | Variant | 0.5661 | 0.5661 | Allowed |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5640 | 0.5640 | Allowed |
| 5 | 190 | Integer Overflow or Wraparound | Base | 0.5634 | 0.5634 | Allowed |
| 6 | 193 | Off-by-one Error | Base | 0.5542 | 0.5542 | Allowed |
| 7 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.5506 | 0.5506 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5503 | 0.5503 | Allowed |
| 9 | 346 | Origin Validation Error | Class | 0.5482 | 0.5482 | Allowed-with-Review |
| 10 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5477 | 0.5477 | Allowed |
| 11 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.5441 | 0.5441 | Allowed |
| 12 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5395 | 0.5395 | Allowed |
| 13 | 125 | Out-of-bounds Read | Base | 0.5365 | 0.5365 | Allowed |
| 14 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5338 | 0.5338 | Allowed |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5321 | 0.5321 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-122 | Heap-based Buffer Overflow | 789.2349 | 789.2349 | Allowed |
| 2 | CWE-190 | Integer Overflow or Wraparound | 671.5323 | 671.5323 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 664.3937 | 664.3937 | Allowed |
| 4 | CWE-126 | Buffer Over-read | 652.5112 | 652.5112 | Allowed |
| 5 | CWE-125 | Out-of-bounds Read | 641.1743 | 641.1743 | Allowed |
| 6 | CWE-295 | Improper Certificate Validation | 640.3138 | 640.3138 | Allowed |
| 7 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 628.1533 | 628.1533 | Allowed |
| 8 | CWE-193 | Off-by-one Error | 617.3594 | 617.3594 | Allowed |
| 9 | CWE-121 | Stack-based Buffer Overflow | 616.4454 | 616.4454 | Allowed |
| 10 | CWE-20 | Improper Input Validation | 605.8882 | 605.8882 | Discouraged |
| 11 | CWE-770 | Allocation of Resources Without Limits or Throttling | 595.1257 | 595.1257 | Allowed |
| 12 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 595.0765 | 595.0765 | Discouraged |
| 13 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 593.5520 | 593.5520 | Allowed |
| 14 | CWE-789 | Memory Allocation with Excessive Size Value | 584.9648 | 584.9648 | Allowed |
| 15 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 584.9603 | 584.9603 | Allowed-with-Review |
