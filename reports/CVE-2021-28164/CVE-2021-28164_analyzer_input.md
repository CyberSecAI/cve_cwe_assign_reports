# Vulnerability Information: CVE-2021-28164

## Vulnerability Description
In Eclipse Jetty 9.4.37.v20210219 to 9.4.38.v20210224, the **default compliance mode** allows requests with URIs that contain %2e or %2e%2e segments to access protected resources within the WEB-INF directory. For example a request to /context/%2e/WEB-INF/web.xml can retrieve the web.xml file. This can reveal sensitive information regarding the implementation of a web application.

### Vulnerability Description Key Phrases
- **rootcause:** **default compliance mode**
- **impact:** access protected resources within the WEB-INF directory
- **vector:** requests with URIs that contain %2e or %2e%2e segments
- **product:** Eclipse Jetty
- **version:** 9.4.37.v20210219 to 9.4.38.v20210224

## CVE Reference Links Content Summary
```
{
  "cve": "CVE-2021-28164",
  "description": "The default compliance mode allows requests with URIs that contain `%2e` or `%2e%2e` segments to access protected resources within the `WEB-INF` directory. For example a request to `/context/%2e/WEB-INF/web.xml` can retrieve the `web.xml` file. This can reveal sensitive information regarding the implementation of a web application.",
  "affected_versions": [
    "9.4.37.v20210219",
    "9.4.38.v20210224"
  ],
  "fixed_versions": [
    "9.4.39"
  ],
  "vulnerability": {
    "root_cause": "A more precise implementation of RFC3986 with regards to URI decoding, together with some new compliance modes, allowed `%2e` or `%2e%2e` characters, which were not assumed by common Servlet implementations, to be excluded for URI normalization. This enabled accessing resources within the WEB-INF directory.",
    "weakness": [
      "CWE-200",
      "CWE-551"
    ],
    "impact": "Disclosure of sensitive information regarding the implementation of a web application by accessing protected resources within the `WEB-INF` directory, for example, retrieving the `web.xml` file.",
    "attack_vector": "Network",
     "attacker_capabilities": "None",
     "cvss_score":"5.3"
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-173 | Improper Handling of Alternate Encoding | Variant | Allowed | 0.6899 | dense, sparse, graph | dense: 0.489, sparse: 0.634, graph: 0.391 |
| 2 | CWE-611 | Improper Restriction of XML External Entity Reference | Base | Allowed | 0.5973 | dense, sparse, graph | dense: 0.490, sparse: 0.282, graph: 0.534 |
| 3 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.4497 | sparse, graph | sparse: 0.266, graph: 0.832 |
| 4 | CWE-177 | Improper Handling of URL Encoding (Hex Encoding) | Variant | Allowed | 0.3578 | dense, sparse | dense: 0.475, sparse: 0.262 |
| 5 | CWE-174 | Double Decoding of the Same Data | Variant | Allowed | 0.3232 | sparse, graph | sparse: 0.371, graph: 0.386 |
| 6 | CWE-176 | Improper Handling of Unicode Encoding | Variant | Allowed | 0.2890 | sparse, graph | sparse: 0.279, graph: 0.429 |
| 7 | CWE-552 | Files or Directories Accessible to External Parties | Base | Allowed | 0.1404 | sparse | sparse: 0.245 |
| 8 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.1396 | sparse | sparse: 0.244 |
| 9 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.1391 | sparse | sparse: 0.243 |
| 10 | CWE-1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | 0.1378 | sparse | sparse: 0.241 |

