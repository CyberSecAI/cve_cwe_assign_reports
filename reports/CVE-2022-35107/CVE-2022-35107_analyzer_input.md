# Vulnerability Information: CVE-2022-35107

## Vulnerability Description
SWFTools commit 772e55a2 was discovered to contain a **stack overflow** via vfprintf at /stdio-common/vfprintf.c.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** SWFTools
- **version:** commit 772e55a2
- **component:** /stdio-common/vfprintf.c

## CVE Reference Links Content Summary
The provided content describes multiple vulnerabilities in swftools, specifically within the `pdf2swf` utility, reported in issue #184. These include a heap buffer overflow, several stack buffer overflows, a memory leak, and a segmentation fault (SEGV).

**1. Heap Buffer Overflow**

*   **Root Cause:** A heap buffer overflow occurs in the `draw_stroke` function within `stroke.c`.
*   **Vulnerability:** A write operation of size 8 bytes attempts to write outside the allocated buffer of size 80 bytes.
*   **Impact:** This results in a crash due to memory corruption.
*   **Attack Vector:** The vulnerability is triggered when processing a specially crafted PDF file with the `pdf2swf` utility using the command `./pdf2swf -G -f -t [sample file] -o /dev/null`.
*   **Attacker Capabilities:** The attacker needs to provide a malicious PDF file.

**2. Stack Buffer Overflows**

Multiple stack buffer overflows are reported with varying call stacks.

*   **Vulnerability 1:** Stack overflow in `__sanitizer::StackDepotNode::hash` called from `__asan::Allocator::Allocate`, triggered in `copyString` called by `Lexer::getObj`.
    *   **Impact:** Crash due to stack overflow.
    *   **Attack Vector:** Triggered via a crafted PDF file.
    *   **Attacker Capabilities:** The attacker needs to provide a malicious PDF file that causes deep recursion in object parsing.
*  **Vulnerability 2:** Stack overflow in `vfprintf`, triggered by an error message call in `Parser::getObj`.
    *  **Impact:** Crash due to stack overflow.
    *  **Attack Vector:** Triggered via a crafted PDF file.
    *  **Attacker Capabilities:** The attacker needs to provide a malicious PDF file that causes a deep call stack in the parser and error handling.
*   **Vulnerability 3:** Stack overflow in `__sanitizer::StackDepotNode::hash` called from `__asan::Allocator::QuarantineChunk`, triggered by freeing an object in the parser.
    *   **Impact:** Crash due to stack overflow.
    *   **Attack Vector:** Triggered via a crafted PDF file.
    *   **Attacker Capabilities:** The attacker needs to provide a malicious PDF file that causes a deep call stack during object handling.

**3. Memory Leak**

*   **Root Cause:** Memory is allocated via `rfx_alloc` but not freed, leading to a memory leak.
*   **Vulnerability:** Improper memory management within the `rfx_alloc` function.
*   **Impact:** Memory exhaustion if the program processes many files with this vulnerability
*    **Attack Vector**: Triggered by specific PDF files.
*   **Attacker Capabilities:** The attacker needs to provide a malicious PDF file that triggers the memory leak.

**4. Segmentation Fault (SEGV)**

*   **Root Cause:** A segmentation fault occurs in the `DCTStream::getChar()` function.
*   **Vulnerability:**  The function attempts to access memory at an invalid address (0x0).
*   **Impact:** The program crashes due to an invalid memory access.
*   **Attack Vector:**  The vulnerability is triggered when processing a specially crafted PDF file.
*   **Attacker Capabilities:** The attacker needs to provide a malicious PDF file that triggers the invalid memory access.

**Summary**

The provided content details multiple memory corruption vulnerabilities, including heap and stack buffer overflows, a memory leak, and a SEGV. These can be triggered by providing specifically crafted PDF files to the `pdf2swf` utility, resulting in crashes and potential denial-of-service.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5836 | dense, sparse, graph | dense: 0.553, sparse: 0.104, graph: 0.692 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5335 | dense, sparse, graph | dense: 0.529, sparse: 0.069, graph: 0.641 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4199 | sparse, graph | sparse: 0.109, graph: 1.000 |
| 4 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3010 | dense, sparse | dense: 0.511, sparse: 0.079 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3009 | dense, sparse | dense: 0.549, sparse: 0.089 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2968 | dense, sparse | dense: 0.535, sparse: 0.094 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.2952 | dense, sparse | dense: 0.498, sparse: 0.080 |
| 8 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.2950 | dense, sparse | dense: 0.517, sparse: 0.063 |
| 9 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.2924 | dense, sparse | dense: 0.497, sparse: 0.076 |
| 10 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.2841 | dense, sparse | dense: 0.491, sparse: 0.067 |

