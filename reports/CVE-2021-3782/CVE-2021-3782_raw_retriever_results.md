# Raw Retriever Results for CVE-2021-3782

# Raw Retriever Results for CVE-2021-3782

## Query
An internal reference count is held on the buffer pool, incremented every time a new buffer is created from the pool. The reference count is maintained as an int on LP64 systems this can cause the reference count to overflow if the client creates a large number of wl_shm buffer objects, or if it can coerce the server to create a large number of external references to the buffer storage. With the reference count overflowing, a use-after-free can be constructed on the wl_shm_pool tracking structure, where values may be incremented or decremented it may also be possible to construct a limited oracle to leak 4 bytes of server-side memory to the attacking client at a time.

## Keyphrases
- **rootcause**: reference count overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4380 | 0.5375 | 0.4662 | 0.4585 | 20 |
| Sparse | 647.8456 | 886.2297 | 696.1626 | 668.5328 | 20 |
| Graph | 1.6736 | 3.7206 | 2.0397 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 3.7206 | Allowed |
| 2 | 789 | Memory Allocation with Excessive Size Value | variant | 2.6784 | Allowed |
| 3 | 125 | Out-of-bounds Read | base | 2.3998 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.3998 | Allowed |
| 5 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 6 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 9 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 11 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 12 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 13 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 14 | 763 | Release of Invalid Pointer or Reference | Base | 1.7043 | Allowed |
| 15 | 193 | Off-by-one Error | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 911 | Improper Update of Reference Count | Base | 0.5375 | 0.5375 | Allowed |
| 2 | 761 | Free of Pointer not at Start of Buffer | Variant | 0.4907 | 0.4907 | Allowed |
| 3 | 680 | Integer Overflow to Buffer Overflow | Compound | 0.4872 | 0.4872 | Discouraged |
| 4 | 763 | Release of Invalid Pointer or Reference | Base | 0.4863 | 0.4863 | Allowed |
| 5 | 771 | Missing Reference to Active Allocated Resource | Base | 0.4852 | 0.4852 | Allowed |
| 6 | 786 | Access of Memory Location Before Start of Buffer | Base | 0.4819 | 0.4819 | Discouraged |
| 7 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.4815 | 0.4815 | Allowed |
| 8 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4782 | 0.4782 | Allowed |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4685 | 0.4685 | Allowed |
| 10 | 466 | Return of Pointer Value Outside of Expected Range | Base | 0.4588 | 0.4588 | Allowed |
| 11 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4581 | 0.4581 | Allowed |
| 12 | 127 | Buffer Under-read | Variant | 0.4573 | 0.4573 | Allowed |
| 13 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4525 | 0.4525 | Allowed |
| 14 | 1341 | Multiple Releases of Same Resource or Handle | Base | 0.4494 | 0.4494 | Allowed |
| 15 | 190 | Integer Overflow or Wraparound | Base | 0.4465 | 0.4465 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | 886.2297 | 886.2297 | Allowed |
| 2 | CWE-911 | Improper Update of Reference Count | 877.6256 | 877.6256 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 729.1254 | 729.1254 | Allowed |
| 4 | CWE-125 | Out-of-bounds Read | 728.1444 | 728.1444 | Allowed |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | 708.2369 | 708.2369 | Allowed |
| 6 | CWE-401 | Missing Release of Memory after Effective Lifetime | 696.5563 | 696.5563 | Allowed |
| 7 | CWE-193 | Off-by-one Error | 682.3701 | 682.3701 | Allowed |
| 8 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 681.7372 | 681.7372 | Allowed-with-Review |
| 9 | CWE-789 | Memory Allocation with Excessive Size Value | 680.6352 | 680.6352 | Allowed |
| 10 | CWE-909 | Missing Initialization of Resource | 671.6434 | 671.6434 | Allowed-with-Review |
| 11 | CWE-834 | Excessive Iteration | 665.4222 | 665.4222 | Discouraged |
| 12 | CWE-476 | NULL Pointer Dereference | 662.7186 | 662.7186 | Allowed |
| 13 | CWE-131 | Incorrect Calculation of Buffer Size | 662.5384 | 662.5384 | Allowed |
| 14 | CWE-639 | Authorization Bypass Through User-Controlled Key | 661.4699 | 661.4699 | Allowed |
| 15 | CWE-824 | Access of Uninitialized Pointer | 659.0700 | 659.0700 | Allowed |
