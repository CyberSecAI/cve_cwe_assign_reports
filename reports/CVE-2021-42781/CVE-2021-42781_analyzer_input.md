# Vulnerability Information: CVE-2021-42781

## Vulnerability Description
Heap **buffer overflow** issues were found in Opensc before version 0.22.0 in pkcs15-oberthur.c that could potentially crash programs using the library.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **impact:** crash
- **product:** Opensc
- **version:** before version 0.22.0
- **component:** pkcs15-oberthur.c

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "Multiple heap buffer overflows exist within the `pkcs15-oberthur.c` file in OpenSC.",
  "Weaknesses/vulnerabilities present": [
    "Heap buffer overflow due to insufficient bounds checking when handling data structures related to Oberthur smart cards.",
    "Specifically, when adding public keys, certificates, private keys and other data objects, the code fails to validate the length of the data read from the card, leading to overflows when copying data into fixed-size buffers.",
        "Inconsistent length validation: Sometimes the code uses `offs > info_len` and sometimes `offs + 2 > info_len` leading to missing checks.",
        "Missing check on length before copying data",
        "Missing allocation of memory when needed"
  ],
  "Impact of exploitation": "Exploitation can lead to program crashes. Arbitrary code execution might be possible but is not explicitly stated.",
  "Attack vectors": "The vulnerability is triggered when processing data read from Oberthur smart cards. Specifically, when adding public keys, certificates, private keys, or data objects.",
  "Required attacker capabilities/position": "An attacker would need to be able to provide a crafted smart card or card data that exploits the insufficient bounds checking. This likely requires physical access or the ability to simulate/emulate a card."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6732 | dense, sparse, graph | dense: 0.556, sparse: 0.116, graph: 0.918 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6397 | dense, sparse, graph | dense: 0.587, sparse: 0.137, graph: 0.748 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5776 | dense, sparse, graph | dense: 0.532, sparse: 0.115, graph: 0.687 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5697 | dense, sparse, graph | dense: 0.592, sparse: 0.113, graph: 0.717 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3525 | dense, sparse | dense: 0.602, sparse: 0.141 |
| 6 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3474 | sparse, graph | sparse: 0.099, graph: 0.813 |
| 7 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3342 | dense, sparse | dense: 0.552, sparse: 0.102 |
| 8 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3282 | dense, sparse | dense: 0.537, sparse: 0.104 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3226 | dense, sparse | dense: 0.556, sparse: 0.125 |
| 10 | CWE-676 | Use of Potentially Dangerous Function | Base | Allowed | 0.3164 | dense, sparse | dense: 0.519, sparse: 0.099 |

