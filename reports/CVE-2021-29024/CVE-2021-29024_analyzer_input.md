# Vulnerability Information: CVE-2021-29024

## Vulnerability Description
In InvoicePlane 1.5.11 a **misconfigured web server** allows unauthenticated directory listing and file download. Allowing an attacker to directory traversal and download files suppose to be private without authentication.

### Vulnerability Description Key Phrases
- **rootcause:** **misconfigured web server**
- **impact:** unauthenticated directory listing and file download
- **vector:** directory traversal
- **attacker:** attacker
- **product:** InvoicePlane
- **version:** 1.5.11

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-29024:

**1. Verification:**

The provided content directly references CVE-2021-29024 and discusses a vulnerability in InvoicePlane 1.5.11 related to misconfigured web servers allowing unauthenticated directory listing and file downloads. This aligns with the vulnerability described.

**2. Root Cause of Vulnerability:**

*   **Misconfigured Web Server:** The core issue is that a web server (like Apache) hosting InvoicePlane is not configured to prevent directory listing. Specifically, the server is not preventing direct access to directories.

**3. Weaknesses/Vulnerabilities Present:**

*   **CWE-552: Files or Directories Accessible to External Parties:** This is the specific CWE associated with this vulnerability.
*   **Unauthenticated Directory Listing:** The web server allows listing the contents of directories without requiring any authentication.
*   **Unauthenticated File Download:**  Users can directly download files located within the web server's directories without authentication.
*   **Lack of Proper Server-Side Protection:** The application attempted to use `.htaccess` files and authenticated URLs for downloads, but these mechanisms are ineffective if the server is not configured to enforce these rules, which is not the case in a default Apache setup.

**4. Impact of Exploitation:**

*   **Information Disclosure:** Attackers can list directories and download sensitive files meant to be private, such as configuration files, database backups, or source code.
*   **Directory Traversal:** Attackers can use directory traversal techniques to access files outside the intended web root.

**5. Attack Vectors:**

*   **Direct HTTP Requests:** Attackers send direct HTTP requests to the web server for specific directories.
*   **Directory Traversal Sequences:** Attackers may use "../" sequences in URLs to access files in parent directories.

**6. Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker must be able to reach the web server hosting the vulnerable InvoicePlane instance over the network.
*   **No Authentication Required:** The attacker does not need any credentials or authentication to exploit this vulnerability. They can exploit the vulnerability with direct access to the server.

**Additional Details from Content:**

*   **Mitigation Attempt:** The InvoicePlane developers had attempted to prevent this with `.htaccess` files and by using authenticated download URLs, but a server misconfiguration negates these protections.
*   **Patch:** The fix was to add `index.html` files to directories to prevent directory listing when the server is not properly configured, and this fix was delivered via pull request #754.
*   **CVSS Score:** The vulnerability is rated as HIGH with a CVSS score of 7.5.
*  **EPSS Score**: The Exploit Prediction Scoring System score is 0.691% which means that there is a 0.691% chance of this vulnerability being exploited within the next 30 days.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.6450 | dense, sparse, graph | dense: 0.510, sparse: 0.165, graph: 0.827 |
| 2 | CWE-552 | Files or Directories Accessible to External Parties | Base | Allowed | 0.6223 | dense, sparse, graph | dense: 0.536, sparse: 0.241, graph: 0.605 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.5809 | dense, sparse, graph | dense: 0.508, sparse: 0.154, graph: 0.667 |
| 4 | CWE-36 | Absolute Path Traversal | Base | Allowed | 0.5491 | dense, sparse, graph | dense: 0.485, sparse: 0.155, graph: 0.609 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5438 | dense, sparse, graph | dense: 0.509, sparse: 0.134, graph: 0.595 |
| 6 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3205 | dense, sparse | dense: 0.489, sparse: 0.133 |
| 7 | CWE-548 | Exposure of Information Through Directory Listing | Variant | Allowed | 0.3177 | dense, sparse | dense: 0.529, sparse: 0.138 |
| 8 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.3145 | sparse, graph | sparse: 0.171, graph: 0.607 |
| 9 | CWE-98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | 0.3140 | sparse, graph | sparse: 0.139, graph: 0.729 |
| 10 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1863 | dense, sparse | dense: 0.479, sparse: 0.136 |

