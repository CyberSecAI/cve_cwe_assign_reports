{
  "cve_id": "CVE-2021-38691",
  "query": "A stack buffer overflow vulnerability has been reported to affect QNAP device running QVR Elite, QVR Pro, QVR Guard. If exploited, this vulnerability allows attackers to execute arbitrary code. We have already fixed this vulnerability in the following versions of QVR Elite, QVR Pro, QVR Guard QuTS hero h5.0.0 QVR Elite 2.1.4.0 (2021/12/06) and later QuTS hero h4.5.4 QVR Elite 2.1.4.0 (2021/12/06) and later QTS 5.0.0 QVR Elite 2.1.4.0 (2021/12/06) and later QTS 4.5.4 QVR Elite 2.1.4.0 (2021/12/06) and later QTS 4.5.4 QVR Pro 2.1.3.0 (2021/12/06) and later QTS 5.0.0 QVR Pro 2.1.3.0 (2021/12/06) and later QTS 4.5.4 QVR Guard 2.1.3.0 (2021/12/06) and later QTS 5.0.0 QVR Guard 2.1.3.0 (2021/12/06) and later",
  "keyphrases": {
    "weakness": "stack buffer overflow"
  },
  "timestamp": "2025-03-18T00:58:30.250994",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 7,
      "average_score": 0.5701000857661166,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.5911685857064233,
      "unique_finds": 0
    },
    "graph": {
      "hit_count": 4,
      "average_score": 0.6801486812341702,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-120",
      "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 1.0377,
      "retriever_count": 0,
      "dense_score": 0.588,
      "sparse_score": 1.0,
      "graph_score": 0.6175
    },
    {
      "cwe_id": "CWE-121",
      "name": "Stack-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.8147,
      "retriever_count": 0,
      "dense_score": 0.6206,
      "sparse_score": 1.0,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-23",
      "name": "Relative Path Traversal",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6123,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.5348,
      "graph_score": 0.8571
    },
    {
      "cwe_id": "CWE-78",
      "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5473,
      "retriever_count": 0,
      "dense_score": 0.553,
      "sparse_score": 0.473,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5157,
      "retriever_count": 0,
      "dense_score": 0.5545,
      "sparse_score": 0.4163,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5138,
      "retriever_count": 0,
      "dense_score": 0.5456,
      "sparse_score": 0.4209,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.501,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4614,
      "graph_score": 0.6631
    },
    {
      "cwe_id": "CWE-122",
      "name": "Heap-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.4857,
      "retriever_count": 0,
      "dense_score": 0.5543,
      "sparse_score": 0.4349,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-77",
      "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.4227,
      "retriever_count": 0,
      "dense_score": 0.5747,
      "sparse_score": 0.7552,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.4116,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4153,
      "graph_score": 0.5829
    }
  ]
}