# Vulnerability Information: CVE-2021-46408

## Vulnerability Description
Tenda AX12 v22.03.01.21 was discovered to contain a **stack buffer overflow** in the function sub_422CE4. This vulnerability allows attackers to cause a Denial of Service (DoS) via the strcpy parameter.

### Vulnerability Description Key Phrases
- **weakness:** **stack buffer overflow**
- **impact:** Denial of Service
- **vector:** strcpy parameter
- **attacker:** attackers
- **product:** Tenda AX12
- **version:** v22.03.01.21
- **component:** sub_422CE4 function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 162)
- CWE-120 (Count: 6)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a stack buffer overflow in the `sub_422CE4` function within the Tenda AX12 router firmware.

**Weaknesses/Vulnerabilities:**
- **Stack Buffer Overflow:** The `strcpy` function is used to copy data from a user-controlled parameter (`prefixDelegate`) into a fixed-size stack buffer without any bounds checking. This allows an attacker to write beyond the buffer's boundaries.

**Impact of Exploitation:**
- **Denial of Service (DoS):** By overflowing the stack buffer, an attacker can overwrite critical data, leading to a crash or malfunction of the router.

**Attack Vectors:**
- **HTTP POST Request:** The vulnerability is triggered by sending a crafted HTTP POST request to the `/goform/setIPv6Status` endpoint.
- **`prefixDelegate` Parameter:** The attack payload is embedded within the `prefixDelegate` parameter in the POST request's body.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send HTTP requests to the router's web interface. This could be achieved by being on the same local network or, in some cases, via remote access if the router is exposed.
- **No Authentication Required** The provided exploit doesn't indicate any authentication requirements to exploit the vulnerability.

**Additional Notes:**
- The vulnerability affects the Tenda AX12 router with the latest firmware version V22.03.01.21_CN at the time of discovery.
- The provided Proof-of-Concept (PoC) demonstrates how to trigger the overflow with a long string in the `prefixDelegate` parameter.

This information is more detailed than a typical CVE description, providing the vulnerable function, the specific vulnerability type, and a detailed method of exploitation with a provided Proof of Concept.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.6145 | dense, sparse, graph | dense: 0.543, sparse: 0.162, graph: 0.699 |
| 2 | CWE-805 | Buffer Access with Incorrect Length Value | Base | Allowed | 0.6020 | dense, sparse, graph | dense: 0.579, sparse: 0.158, graph: 0.620 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4342 | dense, sparse | dense: 0.667, sparse: 0.239 |
| 4 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3650 | dense, sparse | dense: 0.543, sparse: 0.163 |
| 5 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3634 | dense, sparse | dense: 0.549, sparse: 0.155 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3520 | dense, sparse | dense: 0.568, sparse: 0.170 |
| 7 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3500 | dense, sparse | dense: 0.551, sparse: 0.159 |
| 8 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3443 | dense, sparse | dense: 0.563, sparse: 0.159 |
| 9 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.3350 | dense, sparse | dense: 0.552, sparse: 0.152 |
| 10 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.3169 | sparse, graph | sparse: 0.145, graph: 0.729 |

