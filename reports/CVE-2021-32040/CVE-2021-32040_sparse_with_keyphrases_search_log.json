{
  "method": "sparse_with_keyphrases",
  "query": "It may be possible to have an extremely long aggregation pipeline in conjunction with a specific stage/operator and cause a stack overflow due to the size of the stack frames used by that stage. If an attacker could cause such an aggregation to occur, they could maliciously crash MongoDB in a DoS attack. This vulnerability affects MongoDB Server v4.4 versions prior to and including 4.4.28, MongoDB Server v5.0 versions prior to 5.0.4 and MongoDB Server v4.2 versions prior to 4.2.16. Workaround >= v4.2.16 users and all v4.4 users can add the --setParameter internalPipelineLengthLimit=50 instead of the default 1000 to mongod at startup to prevent a crash.",
  "keyphrases": {
    "rootcause": "extremely long aggregation pipeline, stack overflow"
  },
  "timestamp": "2025-03-17T23:45:44.610607",
  "results_count": 20,
  "results_summary": [
    {
      "doc_id": "CWE-400",
      "name": "Uncontrolled Resource Consumption",
      "score": 689.3242531147437
    },
    {
      "doc_id": "CWE-121",
      "name": "Stack-based Buffer Overflow",
      "score": 682.2444120328335
    },
    {
      "doc_id": "CWE-674",
      "name": "Uncontrolled Recursion",
      "score": 664.2503807849422
    },
    {
      "doc_id": "CWE-755",
      "name": "Improper Handling of Exceptional Conditions",
      "score": 654.7361416104269
    },
    {
      "doc_id": "CWE-789",
      "name": "Memory Allocation with Excessive Size Value",
      "score": 653.4656459443435
    }
  ]
}