{
  "cve_id": "CVE-2022-1148",
  "description": "Improper authorization in GitLab Pages included with GitLab CE/EE affecting all versions from 11.5 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allowed an attacker to steal a users access token on an attacker-controlled private GitLab Pages website and reuse that token on the victims other private websites",
  "key_phrases": {
    "rootcause": "Improper authorization",
    "weakness": "",
    "impact": "steal a users access token",
    "vector": "",
    "attacker": "attacker",
    "product": "GitLab Pages",
    "version": [
      "all versions from 11.5 prior to 14.7.7",
      "14.8 prior to 14.8.5",
      "14.9 prior to 14.9.2"
    ],
    "component": ""
  },
  "reference_content": "```json\n{\n  \"vulnerability\": {\n    \"root_cause\": \"The gitlab-pages session cookies are not properly validated to ensure that the requested subdomain is the same as the subdomain to which the session cookie was issued for.\",\n    \"weaknesses\": [\n      \"Improper validation of session cookies\",\n      \"Cross-subdomain usage of session cookies\"\n    ],\n    \"impact\": \"An attacker can steal Gitlab Pages session tokens and access every private Gitlab Pages site that the victim has access to.\",\n    \"attack_vectors\": [\n      \"Service worker interception of requests to the `/auth` endpoint on a Pages site\",\n      \"Bypassing CSRF protection (OAuth2 `state` parameter) by obtaining a valid session cookie and redirection URL from an attacker-controlled website\",\n       \"Interception of the OAuth2 response containing the code and state by an attacker's service worker.\"\n    ],\n    \"required_capabilities\": \"The attacker needs to create a private Gitlab Pages site, invite the victim to collaborate on the project, and host an attacker-controlled server to intercept and store the session token.\"\n  }\n}\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :-------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-565 | Reliance on Cookies without Validation and Integrity Checking | 0.85       | Base                  | Allowed                       | Primary CWE                     |\n| CWE-639 | Authorization Bypass Through User-Controlled Key              | 0.75       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-425 | Direct Request ('Forced Browsing')                             | 0.60       | Base                  | Allowed                       | Secondary Candidate             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.80\n*   **Evidence Strength:** HIGH\n\n- **Analysis and Justification:**\n  - *Explanation:* The vulnerability lies in the **improper authorization** within GitLab Pages, where session cookies are not adequately validated. This allows an attacker to steal a user's access token by exploiting the lack of subdomain validation for session cookies. The core weakness is the reliance on cookies without proper validation and integrity checking, which aligns directly with CWE-565. The \"CVE Reference Links Content Summary\" section explicitly mentions \"**Improper validation of session cookies**\" as a weakness, strengthening the mapping to CWE-565. CWE-639 (Authorization Bypass Through User-Controlled Key) is also a candidate, as the attacker effectively bypasses authorization by manipulating the session token. CWE-425 (Direct Request ('Forced Browsing')) could also be considered, since the attacker is leveraging a direct request to the `/auth` endpoint. However, CWE-565 is the most direct representation of the root cause.\n  - *Relationship Analysis:* CWE-565 is related to CWE-602 (Authentication Bypass Using Cookies) and CWE-669 (Incorrect Comparison). It highlights the risks associated with relying on cookies for security-critical operations without proper validation. CWE-639 is a parent of CWE-863 and describes authorization issues. CWE-425 is a parent of CWE-862 and describes missing authorization checks.\n\n- **Confidence Score:**\n  - Confidence: 0.85 (High confidence due to explicit mention of cookie validation issues in the CVE details)\n\n---",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :-------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-565 | Reliance on Cookies without Validation and Integrity Checking | 0.85       | Base                  | Allowed                       | Primary CWE                     |\n| CWE-639 | Authorization Bypass Through User-Controlled Key              | 0.75       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-425 | Direct Request ('Forced Browsing')                             | 0.60       | Base                  | Allowed                       | Secondary Candidate             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.80\n*   **Evidence Strength:** HIGH\n\n- **Analysis and Justification:**\n  - *Explanation:* The vulnerability lies in the **improper authorization** within GitLab Pages, where session cookies are not adequately validated. This allows an attacker to steal a user's access token by exploiting the lack of subdomain validation for session cookies. The core weakness is the reliance on cookies without proper validation and integrity checking, which aligns directly with CWE-565. The \"CVE Reference Links Content Summary\" section explicitly mentions \"**Improper validation of session cookies**\" as a weakness, strengthening the mapping to CWE-565. CWE-639 (Authorization Bypass Through User-Controlled Key) is also a candidate, as the attacker effectively bypasses authorization by manipulating the session token. CWE-425 (Direct Request ('Forced Browsing')) could also be considered, since the attacker is leveraging a direct request to the `/auth` endpoint. However, CWE-565 is the most direct representation of the root cause.\n  - *Relationship Analysis:* CWE-565 is related to CWE-602 (Authentication Bypass Using Cookies) and CWE-669 (Incorrect Comparison). It highlights the risks associated with relying on cookies for security-critical operations without proper validation. CWE-639 is a parent of CWE-863 and describes authorization issues. CWE-425 is a parent of CWE-862 and describes missing authorization checks.\n\n- **Confidence Score:**\n  - Confidence: 0.85 (High confidence due to explicit mention of cookie validation issues in the CVE details)\n\n---",
  "criticism": "Okay, I have reviewed the provided analysis and the full CWE specifications. Here's a detailed critique, focusing on the accuracy, confidence, and abstraction level of the CWE mappings.\n\n**Overall Assessment:**\n\nThe analysis is generally sound and well-reasoned. The primary CWE mapping of `CWE-565: Reliance on Cookies without Validation and Integrity Checking` is strong and well-supported by the evidence. The secondary candidates, `CWE-639: Authorization Bypass Through User-Controlled Key` and `CWE-425: Direct Request ('Forced Browsing')`, are plausible but less directly representative of the root cause than CWE-565. The confidence scores are appropriate.\n\n**Detailed Critique of Each CWE Mapping:**\n\n1.  **`CWE-565: Reliance on Cookies without Validation and Integrity Checking` (Primary CWE)**\n\n    *   **Assessment:** Excellent choice as the primary CWE. The vulnerability stems directly from the lack of proper validation of session cookies, which aligns perfectly with the description of CWE-565.\n    *   **Justification:** The explanation clearly articulates how the attacker exploits the lack of subdomain validation for session cookies. The reference to \"**Improper validation of session cookies**\" from the CVE details further strengthens this mapping. The connection to the attack vectors (service worker interception, CSRF bypass) is also well-made.\n    *   **Confidence:** 0.85 is a justified level of confidence. The CVE content summary directly supports this CWE.\n    *   **Abstraction Level:** `Base` - Correct. CWE-565 is a base-level CWE and represents the root cause effectively.\n    *   **Mitigations Alignment:** The potential mitigations listed in the CWE specification are relevant and applicable to this vulnerability. Specifically adding integrity checks to detect tampering.\n    *   **Relationships Consideration:** The analysis mentions related CWEs like CWE-602 and CWE-669, showing a good understanding of the broader context.\n\n2.  **`CWE-639: Authorization Bypass Through User-Controlled Key` (Secondary Candidate)**\n\n    *   **Assessment:** A reasonable secondary candidate. The attacker *is* effectively bypassing authorization by manipulating the session token (the \"key\").\n    *   **Justification:** The analysis correctly points out that the attacker bypasses authorization by manipulating the session token. The attacker is gaining access to resources they should not have access to by controlling an identifier (the session cookie value) used in the authorization process.\n    *   **Confidence:** 0.75 is a suitable level of confidence. While applicable, it's not as direct as CWE-565. The core issue is the lack of cookie validation, and CWE-639 describes the *result* of this lack of validation.\n    *   **Abstraction Level:** `Base` - Correct. CWE-639 is a base-level CWE.\n    *   **Mitigations Alignment:** Mitigation 2, \"Make sure that the key that is used in the lookup of a specific user's record is not controllable externally by the user or that any tampering can be detected,\" is particularly relevant.\n    *   **Relationships Consideration:** The relationship with CWE-863 is important. CWE-639 is a child of CWE-863, making it a more specific type of authorization bypass.\n\n3.  **`CWE-425: Direct Request ('Forced Browsing')` (Secondary Candidate)**\n\n    *   **Assessment:** The weakest of the three choices. While there is a direct request to the `/auth` endpoint, the core problem isn't necessarily that the endpoint *lacks* authorization (CWE-862 - Missing Authorization, parent of CWE-425), but that the existing authorization is *bypassed* due to improper cookie handling.\n    *   **Justification:** The attacker *is* making a direct request to the `/auth` endpoint, but the primary exploit isn't directly forcing access to a URL without authorization. It's about leveraging a compromised session to gain unauthorized access.\n    *   **Confidence:** 0.60 is appropriate. This CWE is more of a tangential concern rather than a direct cause.\n    *   **Abstraction Level:** `Base` - Correct. CWE-425 is a base-level CWE.\n    *   **Mitigations Alignment:** Mitigation 1, \"Apply appropriate access control authorizations for each access to all restricted URLs, scripts or files,\" *could* be interpreted as relevant, but the focus is misplaced. The real solution lies in proper cookie validation.\n     *  **Relationships Consideration:** ChildOf -> CWE-862. It would be applicable if the endpoint lacked Authorization entirely.\n\n**Suggestions for Improvement:**\n\n*   **Consider CWE-602: Client-Side Enforcement of Server-Side Security.** It has a child of CWE-565, it might be useful to include since the problem exists because the server does not properly validate something that is related to the client (the cookies).\n\n*   **Minor Wording:** In the justification for CWE-425, consider rephrasing to highlight why it's a less ideal fit. For example: \"While a direct request is involved, the primary issue is the *bypass* of existing authorization mechanisms, making CWE-425 a less direct representation of the root cause.\"\n\n*   **Explicitly exclude:** Consider explicitly excluding CWE-862 and CWE-863 in the justification. This would help clarify why the analysis selected the mappings that it did.\n\n**Revised Summary Table**\n\n| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :-------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-565 | Reliance on Cookies without Validation and Integrity Checking | 0.85       | Base                  | Allowed                       | Primary CWE                     |\n| CWE-639 | Authorization Bypass Through User-Controlled Key              | 0.75       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-425 | Direct Request ('Forced Browsing')                             | 0.60       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-602 | Client-Side Enforcement of Server-Side Security             | 0.50       | Class                   | Allowed-with-Review               | Additional Consideration             |\n\n**Conclusion:**\n\nThe analysis is well-performed. The primary CWE selection is excellent, and the secondary candidates are reasonable. The suggestions above are primarily for further clarity and precision in the reasoning.",
  "resolution": "# Summary\n| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :-------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| **CWE-565** | **Reliance on Cookies without Validation and Integrity Checking** | 0.90       | Base                  | Allowed                       | Primary CWE                     |\n| CWE-639 | Authorization Bypass Through User-Controlled Key              | 0.70       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-602 | Client-Side Enforcement of Server-Side Security               | 0.60       | Class                   | Allowed-with-Review              | Secondary Candidate             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **improper validation** of session cookies, which directly aligns with CWE-565. While CWE-639 (Authorization Bypass Through User-Controlled Key) is applicable as the attacker bypasses authorization by manipulating the session token, it is a consequence of the cookie validation issue. CWE-602 (Client-Side Enforcement of Server-Side Security) is a reasonable consideration since the server is not properly validating client-provided cookies, but it's a higher-level abstraction than CWE-565. The relationships between these CWEs are important. CWE-565 is a child of CWE-602, indicating that the lack of cookie validation is a specific instance of client-side enforcement problems.\n\n```mermaid\ngraph TD\n    cwe565[\"CWE-565: Reliance on Cookies without Validation and Integrity Checking\"]\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    cwe602[\"CWE-602: Client-Side Enforcement of Server-Side Security\"]\n    \n    cwe565 -->|CHILDOF| cwe602\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe565 primary\n    class cwe639,cwe602 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **root cause**: the lack of proper cookie validation (CWE-565). This allows an attacker to manipulate the session token, leading to an authorization bypass (CWE-639). The consequence is that the attacker can steal a user's access token and reuse it on other private websites.\n\n## Summary of Analysis\nThe initial analysis is strong, particularly in identifying CWE-565 as the primary **weakness**. The criticism correctly points out the nuances and relationships between the candidate CWEs. My assessment builds upon this by emphasizing the directness of CWE-565 in representing the **root cause**. The \"CVE Reference Links Content Summary\" mentioning \"**Improper validation of session cookies**\" provides strong evidence for this classification. The relationship analysis further supports this decision, as CWE-565 is a specific instance of the broader client-side enforcement issue represented by CWE-602. Therefore, I am increasing the confidence score for CWE-565 to 0.90. I am reducing the confidence score for CWE-639 to 0.70, and I am including CWE-602 with a confidence of 0.60.\n\nThe selected CWEs are at the optimal level of specificity. CWE-565 is a base-level CWE that directly addresses the **root cause**. CWE-639 and CWE-602 provide additional context but are less directly representative of the core issue.",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "CWE-565",
        "name": "Reliance on Cookies without Validation and Integrity Checking",
        "type": "Base",
        "original_content": "The product relies on the existence or values of cookies when performing security-critical operations, but it does not properly ensure that the setting is valid for the associated user.",
        "relationships": [],
        "original_sparse_score": 612.6659517452371,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5395398005270722,
            "sparse": 612.6659517452371,
            "graph": 1.512554900253909
          },
          "normalized_scores": {
            "dense": 0.5395398005270722,
            "sparse": 0.49013276139618966,
            "graph": 0.5401981786621104
          },
          "weighted_scores": {
            "dense": 0.18883893018447526,
            "sparse": 0.19605310455847588,
            "graph": 0.1350495446655276
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5395398005270722,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5395398005270722,
              "weight": 0.35,
              "weighted_score": 0.18883893018447526
            },
            "sparse": {
              "raw_score": 612.6659517452371,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.49013276139618966,
              "weight": 0.4,
              "weighted_score": 0.19605310455847588
            },
            "graph": {
              "raw_score": 1.512554900253909,
              "query_max": 1.7306904119915272,
              "query_min": 1.0062,
              "normalized_score": 0.5401981786621104,
              "weight": 0.25,
              "weighted_score": 0.1350495446655276
            }
          },
          "contribution_percentages": {
            "dense": 36.319259252032005,
            "sparse": 37.706756359343174,
            "graph": 25.97398438862482
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.5199415794084787,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.6759240532310223
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.6759240532310223
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.7435164585541246
            }
          },
          "combined_score": 0.7435164585541246
        }
      },
      "similarity": 0.7435164585541246
    },
    {
      "metadata": {
        "doc_id": "CWE-639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "type": "Base",
        "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
        "relationships": [],
        "original_sparse_score": 452.14330508253875,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5603516760853712,
            "sparse": 452.14330508253875,
            "graph": 1.7306904119915272
          },
          "normalized_scores": {
            "dense": 0.5603516760853712,
            "sparse": 0.361714644066031,
            "graph": 0.6181037185684026
          },
          "weighted_scores": {
            "dense": 0.1961230866298799,
            "sparse": 0.1446858576264124,
            "graph": 0.15452592964210066
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5603516760853712,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5603516760853712,
              "weight": 0.35,
              "weighted_score": 0.1961230866298799
            },
            "sparse": {
              "raw_score": 452.14330508253875,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.361714644066031,
              "weight": 0.4,
              "weighted_score": 0.1446858576264124
            },
            "graph": {
              "raw_score": 1.7306904119915272,
              "query_max": 1.7306904119915272,
              "query_min": 1.0062,
              "normalized_score": 0.6181037185684026,
              "weight": 0.25,
              "weighted_score": 0.15452592964210066
            }
          },
          "contribution_percentages": {
            "dense": 39.59403970214103,
            "sparse": 29.209705443855245,
            "graph": 31.19625485400373
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.4953348738983929,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.6439353360679109
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.6439353360679109
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.708328869674702
            }
          },
          "combined_score": 0.708328869674702
        }
      },
      "similarity": 0.708328869674702
    },
    {
      "metadata": {
        "doc_id": "CWE-1286",
        "name": "Improper Validation of Syntactic Correctness of Input",
        "type": "Base",
        "original_content": "The product receives input that is expected to be well-formed - i.e., to comply with a certain syntax - but it does not validate or incorrectly validates that the input complies with the syntax.",
        "relationships": [],
        "original_sparse_score": 375.8022733402917,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5358968049486919,
            "sparse": 375.8022733402917,
            "graph": 1.5126593610083916
          },
          "normalized_scores": {
            "dense": 0.5358968049486919,
            "sparse": 0.3006418186722334,
            "graph": 0.5402354860744256
          },
          "weighted_scores": {
            "dense": 0.18756388173204214,
            "sparse": 0.12025672746889336,
            "graph": 0.1350588715186064
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5358968049486919,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5358968049486919,
              "weight": 0.35,
              "weighted_score": 0.18756388173204214
            },
            "sparse": {
              "raw_score": 375.8022733402917,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3006418186722334,
              "weight": 0.4,
              "weighted_score": 0.12025672746889336
            },
            "graph": {
              "raw_score": 1.5126593610083916,
              "query_max": 1.7306904119915272,
              "query_min": 1.0062,
              "normalized_score": 0.5402354860744256,
              "weight": 0.25,
              "weighted_score": 0.1350588715186064
            }
          },
          "contribution_percentages": {
            "dense": 42.35099838613181,
            "sparse": 27.153375286999847,
            "graph": 30.495626326868337
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.4428794807195419,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.5757433249354045
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.5757433249354045
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.633317657428945
            }
          },
          "combined_score": 0.633317657428945
        }
      },
      "similarity": 0.633317657428945
    },
    {
      "metadata": {
        "doc_id": "CWE-425",
        "name": "Direct Request ('Forced Browsing')",
        "type": "Base",
        "original_content": "The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",
        "relationships": [],
        "original_sparse_score": 420.12659778125413,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.49640183132262833,
            "sparse": 420.12659778125413
          },
          "normalized_scores": {
            "dense": 0.49640183132262833,
            "sparse": 0.3361012782250033
          },
          "weighted_scores": {
            "dense": 0.1737406409629199,
            "sparse": 0.1344405112900013
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.49640183132262833,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.49640183132262833,
              "weight": 0.35,
              "weighted_score": 0.1737406409629199
            },
            "sparse": {
              "raw_score": 420.12659778125413,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3361012782250033,
              "weight": 0.4,
              "weighted_score": 0.1344405112900013
            }
          },
          "contribution_percentages": {
            "dense": 56.37614101083401,
            "sparse": 43.623858989165996
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.3081811522529212,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.40063549792879755
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.40063549792879755
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.44069904772167734
            }
          },
          "combined_score": 0.44069904772167734
        }
      },
      "similarity": 0.44069904772167734
    },
    {
      "metadata": {
        "doc_id": "CWE-267",
        "name": "Privilege Defined With Unsafe Actions",
        "type": "Base",
        "original_content": "A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.",
        "relationships": [],
        "original_sparse_score": 380.85128535928413,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5223858846215733,
            "sparse": 380.85128535928413
          },
          "normalized_scores": {
            "dense": 0.5223858846215733,
            "sparse": 0.3046810282874273
          },
          "weighted_scores": {
            "dense": 0.18283505961755064,
            "sparse": 0.12187241131497094
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5223858846215733,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5223858846215733,
              "weight": 0.35,
              "weighted_score": 0.18283505961755064
            },
            "sparse": {
              "raw_score": 380.85128535928413,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3046810282874273,
              "weight": 0.4,
              "weighted_score": 0.12187241131497094
            }
          },
          "contribution_percentages": {
            "dense": 60.003471217166194,
            "sparse": 39.9965287828338
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.3047074709325216,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.3961197122122781
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.3961197122122781
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.43573168343350593
            }
          },
          "combined_score": 0.43573168343350593
        }
      },
      "similarity": 0.43573168343350593
    },
    {
      "metadata": {
        "doc_id": "CWE-532",
        "name": "Insertion of Sensitive Information into Log File",
        "type": "Base",
        "original_content": "The product writes sensitive information to a log file.",
        "relationships": [],
        "original_sparse_score": 388.59675703118774,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5020077004314079,
            "sparse": 388.59675703118774
          },
          "normalized_scores": {
            "dense": 0.5020077004314079,
            "sparse": 0.3108774056249502
          },
          "weighted_scores": {
            "dense": 0.17570269515099274,
            "sparse": 0.12435096224998009
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5020077004314079,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5020077004314079,
              "weight": 0.35,
              "weighted_score": 0.17570269515099274
            },
            "sparse": {
              "raw_score": 388.59675703118774,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3108774056249502,
              "weight": 0.4,
              "weighted_score": 0.12435096224998009
            }
          },
          "contribution_percentages": {
            "dense": 58.55709164584343,
            "sparse": 41.442908354156565
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.30005365740097284,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.3900697546212647
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.3900697546212647
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.4290767300833912
            }
          },
          "combined_score": 0.4290767300833912
        }
      },
      "similarity": 0.4290767300833912
    },
    {
      "metadata": {
        "doc_id": "CWE-863",
        "name": "Incorrect Authorization",
        "type": "Class",
        "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.",
        "relationships": [],
        "original_sparse_score": 481.85166506622875,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5539128253189409,
            "sparse": 481.85166506622875,
            "graph": 1.080708183034527
          },
          "normalized_scores": {
            "dense": 0.5539128253189409,
            "sparse": 0.385481332052983,
            "graph": 0.38596720822661684
          },
          "weighted_scores": {
            "dense": 0.1938694888616293,
            "sparse": 0.15419253282119322,
            "graph": 0.09649180205665421
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5539128253189409,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5539128253189409,
              "weight": 0.35,
              "weighted_score": 0.1938694888616293
            },
            "sparse": {
              "raw_score": 481.85166506622875,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.385481332052983,
              "weight": 0.4,
              "weighted_score": 0.15419253282119322
            },
            "graph": {
              "raw_score": 1.080708183034527,
              "query_max": 1.7306904119915272,
              "query_min": 1.0062,
              "normalized_score": 0.38596720822661684,
              "weight": 0.25,
              "weighted_score": 0.09649180205665421
            }
          },
          "contribution_percentages": {
            "dense": 43.60990244799767,
            "sparse": 34.684783841057495,
            "graph": 21.705313710944843
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.4445538237394767,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.3556430589915814
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.3556430589915814
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.37342521194116046
            }
          },
          "combined_score": 0.37342521194116046
        }
      },
      "similarity": 0.37342521194116046
    },
    {
      "metadata": {
        "doc_id": "CWE-285",
        "name": "Improper Authorization",
        "type": "Class",
        "original_content": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.",
        "relationships": [],
        "original_sparse_score": 469.9984410119017,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.",
          "reasons": [
            "Abstraction"
          ],
          "suggestions": [
            {
              "CweID": "862",
              "Comment": "Missing Authorization"
            },
            {
              "CweID": "863",
              "Comment": "Incorrect Authorization"
            },
            {
              "CweID": "732",
              "Comment": "Incorrect Permission Assignment for Critical Resource"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5589547697811894,
            "sparse": 469.9984410119017,
            "graph": 1.0826994290453729
          },
          "normalized_scores": {
            "dense": 0.5589547697811894,
            "sparse": 0.3759987528095214,
            "graph": 0.3866783675162046
          },
          "weighted_scores": {
            "dense": 0.19563416942341627,
            "sparse": 0.15039950112380857,
            "graph": 0.09666959187905115
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5589547697811894,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5589547697811894,
              "weight": 0.35,
              "weighted_score": 0.19563416942341627
            },
            "sparse": {
              "raw_score": 469.9984410119017,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3759987528095214,
              "weight": 0.4,
              "weighted_score": 0.15039950112380857
            },
            "graph": {
              "raw_score": 1.0826994290453729,
              "query_max": 1.7306904119915272,
              "query_min": 1.0062,
              "normalized_score": 0.3866783675162046,
              "weight": 0.25,
              "weighted_score": 0.09666959187905115
            }
          },
          "contribution_percentages": {
            "dense": 44.190812679180446,
            "sparse": 33.972982331218944,
            "graph": 21.836204989600606
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.442703262426276,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.35416260994102083
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.35416260994102083
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.",
                "reasons": [
                  "Abstraction"
                ],
                "suggestions": [
                  {
                    "CweID": "862",
                    "Comment": "Missing Authorization"
                  },
                  {
                    "CweID": "863",
                    "Comment": "Incorrect Authorization"
                  },
                  {
                    "CweID": "732",
                    "Comment": "Incorrect Permission Assignment for Critical Resource"
                  }
                ]
              },
              "score_after": 0.28333008795281667
            }
          },
          "combined_score": 0.28333008795281667
        }
      },
      "similarity": 0.28333008795281667
    },
    {
      "metadata": {
        "doc_id": "CWE-862",
        "name": "Missing Authorization",
        "type": "Class",
        "original_content": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
        "relationships": [],
        "original_sparse_score": 385.5501051497986,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5252577212148325,
            "sparse": 385.5501051497986
          },
          "normalized_scores": {
            "dense": 0.5252577212148325,
            "sparse": 0.30844008411983886
          },
          "weighted_scores": {
            "dense": 0.18384020242519136,
            "sparse": 0.12337603364793555
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5252577212148325,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5252577212148325,
              "weight": 0.35,
              "weighted_score": 0.18384020242519136
            },
            "sparse": {
              "raw_score": 385.5501051497986,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.30844008411983886,
              "weight": 0.4,
              "weighted_score": 0.12337603364793555
            }
          },
          "contribution_percentages": {
            "dense": 59.840653207349284,
            "sparse": 40.159346792650716
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.3072162360731269,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.24577298885850155
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.24577298885850155
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.25806163830142664
            }
          },
          "combined_score": 0.25806163830142664
        }
      },
      "similarity": 0.25806163830142664
    },
    {
      "metadata": {
        "doc_id": "CWE-116",
        "name": "Improper Encoding or Escaping of Output",
        "type": "Class",
        "original_content": "The product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.",
        "relationships": [],
        "original_sparse_score": 395.30936992273087,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4968999557855972,
            "sparse": 395.30936992273087
          },
          "normalized_scores": {
            "dense": 0.4968999557855972,
            "sparse": 0.3162474959381847
          },
          "weighted_scores": {
            "dense": 0.17391498452495902,
            "sparse": 0.12649899837527387
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4968999557855972,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.4968999557855972,
              "weight": 0.35,
              "weighted_score": 0.17391498452495902
            },
            "sparse": {
              "raw_score": 395.30936992273087,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3162474959381847,
              "weight": 0.4,
              "weighted_score": 0.12649899837527387
            }
          },
          "contribution_percentages": {
            "dense": 57.891774159765376,
            "sparse": 42.10822584023462
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.3004139829002329,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.24033118632018635
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.24033118632018635
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.25234774563619566
            }
          },
          "combined_score": 0.25234774563619566
        }
      },
      "similarity": 0.25234774563619566
    },
    {
      "metadata": {
        "doc_id": "CWE-1390",
        "name": "Weak Authentication",
        "type": "Class",
        "original_content": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.",
        "relationships": [],
        "original_sparse_score": 434.30957666707616,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 434.30957666707616,
            "graph": 1.0408123262285554
          },
          "normalized_scores": {
            "sparse": 0.34744766133366095,
            "graph": 0.3717186879387698
          },
          "weighted_scores": {
            "sparse": 0.1389790645334644,
            "graph": 0.09292967198469244
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 434.30957666707616,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.34744766133366095,
              "weight": 0.4,
              "weighted_score": 0.1389790645334644
            },
            "graph": {
              "raw_score": 1.0408123262285554,
              "query_max": 1.7306904119915272,
              "query_min": 1.0062,
              "normalized_score": 0.3717186879387698,
              "weight": 0.25,
              "weighted_score": 0.09292967198469244
            }
          },
          "contribution_percentages": {
            "sparse": 59.928343632100855,
            "graph": 40.071656367899145
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.23190873651815685,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.18552698921452548
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.18552698921452548
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.19480333867525176
            }
          },
          "combined_score": 0.19480333867525176
        }
      },
      "similarity": 0.19480333867525176
    },
    {
      "metadata": {
        "doc_id": "CWE-287",
        "name": "Improper Authentication",
        "type": "Class",
        "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
        "relationships": [],
        "original_sparse_score": 366.34720057037384,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.",
          "reasons": [
            "Frequent Misuse"
          ],
          "suggestions": [
            {
              "CweID": "1390",
              "Comment": "Weak Authentication"
            },
            {
              "CweID": "306",
              "Comment": "Missing Authentication for Critical Function"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5084442821655044,
            "sparse": 366.34720057037384
          },
          "normalized_scores": {
            "dense": 0.5084442821655044,
            "sparse": 0.2930777604562991
          },
          "weighted_scores": {
            "dense": 0.17795549875792654,
            "sparse": 0.11723110418251964
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5084442821655044,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5084442821655044,
              "weight": 0.35,
              "weighted_score": 0.17795549875792654
            },
            "sparse": {
              "raw_score": 366.34720057037384,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.2930777604562991,
              "weight": 0.4,
              "weighted_score": 0.11723110418251964
            }
          },
          "contribution_percentages": {
            "dense": 60.28576398293693,
            "sparse": 39.71423601706307
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.2951866029404462,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.23614928235235697
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.23614928235235697
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.",
                "reasons": [
                  "Frequent Misuse"
                ],
                "suggestions": [
                  {
                    "CweID": "1390",
                    "Comment": "Weak Authentication"
                  },
                  {
                    "CweID": "306",
                    "Comment": "Missing Authentication for Critical Function"
                  }
                ]
              },
              "score_after": 0.1889194258818856
            }
          },
          "combined_score": 0.1889194258818856
        }
      },
      "similarity": 0.1889194258818856
    },
    {
      "metadata": {
        "doc_id": "CWE-269",
        "name": "Improper Privilege Management",
        "type": "Class",
        "original_content": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
        "relationships": [],
        "original_sparse_score": 371.43369742388137,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-269 is commonly misused. It can be conflated with \"privilege escalation,\" which is a technical impact that is listed in many low-information vulnerability reports [REF-1287]. It is not useful for trend analysis.",
          "comments": "If an error or mistake allows privilege escalation, then use the CWE ID for that mistake. Avoid using CWE-269 when only phrases such as \"privilege escalation\" or \"gain privileges\" are available, as these indicate technical impact of the vulnerability - not the root cause weakness. If the root cause seems to be directly related to privileges, then examine the children of CWE-269 for additional hints, such as Execution with Unnecessary Privileges (CWE-250) or Incorrect Privilege Assignment (CWE-266).",
          "reasons": [
            "Frequent Misuse"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.49662763330651155,
            "sparse": 371.43369742388137
          },
          "normalized_scores": {
            "dense": 0.49662763330651155,
            "sparse": 0.2971469579391051
          },
          "weighted_scores": {
            "dense": 0.17381967165727905,
            "sparse": 0.11885878317564205
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.49662763330651155,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.49662763330651155,
              "weight": 0.35,
              "weighted_score": 0.17381967165727905
            },
            "sparse": {
              "raw_score": 371.43369742388137,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.2971469579391051,
              "weight": 0.4,
              "weighted_score": 0.11885878317564205
            }
          },
          "contribution_percentages": {
            "dense": 59.38929524433427,
            "sparse": 40.61070475566573
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.2926784548329211,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.2341427638663369
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.2341427638663369
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-269 is commonly misused. It can be conflated with \"privilege escalation,\" which is a technical impact that is listed in many low-information vulnerability reports [REF-1287]. It is not useful for trend analysis.",
                "comments": "If an error or mistake allows privilege escalation, then use the CWE ID for that mistake. Avoid using CWE-269 when only phrases such as \"privilege escalation\" or \"gain privileges\" are available, as these indicate technical impact of the vulnerability - not the root cause weakness. If the root cause seems to be directly related to privileges, then examine the children of CWE-269 for additional hints, such as Execution with Unnecessary Privileges (CWE-250) or Incorrect Privilege Assignment (CWE-266).",
                "reasons": [
                  "Frequent Misuse"
                ]
              },
              "score_after": 0.18731421109306953
            }
          },
          "combined_score": 0.18731421109306953
        }
      },
      "similarity": 0.18731421109306953
    },
    {
      "metadata": {
        "doc_id": "CWE-1333",
        "name": "Inefficient Regular Expression Complexity",
        "type": "Base",
        "original_content": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles.",
        "relationships": [],
        "original_sparse_score": 384.7886973095094,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 384.7886973095094
          },
          "normalized_scores": {
            "sparse": 0.30783095784760756
          },
          "weighted_scores": {
            "sparse": 0.12313238313904303
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 384.7886973095094,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.30783095784760756,
              "weight": 0.4,
              "weighted_score": 0.12313238313904303
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.12313238313904303,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.16007209808075593
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.16007209808075593
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.17607930788883153
            }
          },
          "combined_score": 0.17607930788883153
        }
      },
      "similarity": 0.17607930788883153
    },
    {
      "metadata": {
        "doc_id": "CWE-201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "type": "Base",
        "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor.",
        "relationships": [],
        "original_sparse_score": 383.7968778859279,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 383.7968778859279
          },
          "normalized_scores": {
            "sparse": 0.3070375023087423
          },
          "weighted_scores": {
            "sparse": 0.12281500092349694
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 383.7968778859279,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3070375023087423,
              "weight": 0.4,
              "weighted_score": 0.12281500092349694
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.12281500092349694,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.15965950120054603
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.15965950120054603
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.17562545132060065
            }
          },
          "combined_score": 0.17562545132060065
        }
      },
      "similarity": 0.17562545132060065
    },
    {
      "metadata": {
        "doc_id": "CWE-79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "type": "Base",
        "original_content": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
        "relationships": [],
        "original_sparse_score": 376.91868376467744,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 376.91868376467744
          },
          "normalized_scores": {
            "sparse": 0.30153494701174194
          },
          "weighted_scores": {
            "sparse": 0.12061397880469678
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 376.91868376467744,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.30153494701174194,
              "weight": 0.4,
              "weighted_score": 0.12061397880469678
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.12061397880469678,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.1567981724461058
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.1567981724461058
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.1724779896907164
            }
          },
          "combined_score": 0.1724779896907164
        }
      },
      "similarity": 0.1724779896907164
    },
    {
      "metadata": {
        "doc_id": "CWE-284",
        "name": "Improper Access Control",
        "type": "Pillar",
        "original_content": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
        "relationships": [],
        "original_sparse_score": 386.6847265621893,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-284 is extremely high-level, a Pillar. Its name, \"Improper Access Control,\" is often misused in low-information vulnerability reports [REF-1287] or by active use of the OWASP Top Ten, such as \"A01:2021-Broken Access Control\". It is not useful for trend analysis.",
          "comments": "Consider using descendants of CWE-284 that are more specific to the kind of access control involved, such as those involving authorization (Missing Authorization (CWE-862), Incorrect Authorization (CWE-863), Incorrect Permission Assignment for Critical Resource (CWE-732), etc.); authentication (Missing Authentication (CWE-306) or Weak Authentication (CWE-1390)); Incorrect User Management (CWE-286); Improper Restriction of Communication Channel to Intended Endpoints (CWE-923); etc.",
          "reasons": [
            "Frequent Misuse",
            "Abstraction"
          ],
          "suggestions": [
            {
              "CweID": "862",
              "Comment": "Missing Authorization"
            },
            {
              "CweID": "863",
              "Comment": "Incorrect Authorization"
            },
            {
              "CweID": "732",
              "Comment": "Incorrect Permission Assignment for Critical Resource"
            },
            {
              "CweID": "306",
              "Comment": "Missing Authentication"
            },
            {
              "CweID": "1390",
              "Comment": "Weak Authentication"
            },
            {
              "CweID": "923",
              "Comment": "Improper Restriction of Communication Channel to Intended Endpoints"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5110769123112306,
            "sparse": 386.6847265621893
          },
          "normalized_scores": {
            "dense": 0.5110769123112306,
            "sparse": 0.3093477812497515
          },
          "weighted_scores": {
            "dense": 0.1788769193089307,
            "sparse": 0.1237391124999006
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5110769123112306,
              "query_max": 0.5603516760853712,
              "query_min": 0.49640183132262833,
              "normalized_score": 0.5110769123112306,
              "weight": 0.35,
              "weighted_score": 0.1788769193089307
            },
            "sparse": {
              "raw_score": 386.6847265621893,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.3093477812497515,
              "weight": 0.4,
              "weighted_score": 0.1237391124999006
            }
          },
          "contribution_percentages": {
            "dense": 59.1101926225544,
            "sparse": 40.889807377445585
          },
          "abstraction_factor": 0.6,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.30261603180883134,
            "abstraction": {
              "type": "pillar",
              "factor": 0.6,
              "score_after": 0.1815696190852988
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.1815696190852988
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-284 is extremely high-level, a Pillar. Its name, \"Improper Access Control,\" is often misused in low-information vulnerability reports [REF-1287] or by active use of the OWASP Top Ten, such as \"A01:2021-Broken Access Control\". It is not useful for trend analysis.",
                "comments": "Consider using descendants of CWE-284 that are more specific to the kind of access control involved, such as those involving authorization (Missing Authorization (CWE-862), Incorrect Authorization (CWE-863), Incorrect Permission Assignment for Critical Resource (CWE-732), etc.); authentication (Missing Authentication (CWE-306) or Weak Authentication (CWE-1390)); Incorrect User Management (CWE-286); Improper Restriction of Communication Channel to Intended Endpoints (CWE-923); etc.",
                "reasons": [
                  "Frequent Misuse",
                  "Abstraction"
                ],
                "suggestions": [
                  {
                    "CweID": "862",
                    "Comment": "Missing Authorization"
                  },
                  {
                    "CweID": "863",
                    "Comment": "Incorrect Authorization"
                  },
                  {
                    "CweID": "732",
                    "Comment": "Incorrect Permission Assignment for Critical Resource"
                  },
                  {
                    "CweID": "306",
                    "Comment": "Missing Authentication"
                  },
                  {
                    "CweID": "1390",
                    "Comment": "Weak Authentication"
                  },
                  {
                    "CweID": "923",
                    "Comment": "Improper Restriction of Communication Channel to Intended Endpoints"
                  }
                ]
              },
              "score_after": 0.14525569526823906
            }
          },
          "combined_score": 0.14525569526823906
        }
      },
      "similarity": 0.14525569526823906
    },
    {
      "metadata": {
        "doc_id": "CWE-282",
        "name": "Improper Ownership Management",
        "type": "Class",
        "original_content": "The product assigns the wrong ownership, or does not properly verify the ownership, of an object or resource.",
        "relationships": [],
        "original_sparse_score": 369.63745887900814,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 369.63745887900814
          },
          "normalized_scores": {
            "sparse": 0.2957099671032065
          },
          "weighted_scores": {
            "sparse": 0.1182839868412826
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 369.63745887900814,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.2957099671032065,
              "weight": 0.4,
              "weighted_score": 0.1182839868412826
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.1182839868412826,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.09462718947302609
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.09462718947302609
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.0993585489466774
            }
          },
          "combined_score": 0.0993585489466774
        }
      },
      "similarity": 0.0993585489466774
    },
    {
      "metadata": {
        "doc_id": "CWE-522",
        "name": "Insufficiently Protected Credentials",
        "type": "Class",
        "original_content": "The product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.",
        "relationships": [],
        "original_sparse_score": 366.4762102279662,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 366.4762102279662
          },
          "normalized_scores": {
            "sparse": 0.29318096818237294
          },
          "weighted_scores": {
            "sparse": 0.11727238727294918
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 366.4762102279662,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.29318096818237294,
              "weight": 0.4,
              "weighted_score": 0.11727238727294918
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.11727238727294918,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.09381790981835936
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.09381790981835936
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.09850880530927733
            }
          },
          "combined_score": 0.09850880530927733
        }
      },
      "similarity": 0.09850880530927733
    },
    {
      "metadata": {
        "doc_id": "CWE-400",
        "name": "Uncontrolled Resource Consumption",
        "type": "Class",
        "original_content": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
        "relationships": [],
        "original_sparse_score": 389.1918623632048,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the \"technical impact\" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Closely analyze the specific mistake that is causing resource consumption, and perform a CWE mapping for that mistake. Consider children/descendants such as CWE-770: Allocation of Resources Without Limits or Throttling, CWE-771: Missing Reference to Active Allocated Resource, CWE-410: Insufficient Resource Pool, CWE-772: Missing Release of Resource after Effective Lifetime, CWE-834: Excessive Iteration, CWE-405: Asymmetric Resource Consumption (Amplification), and others.",
          "reasons": [
            "Frequent Misuse"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 389.1918623632048
          },
          "normalized_scores": {
            "sparse": 0.31135348989056383
          },
          "weighted_scores": {
            "sparse": 0.12454139595622554
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 389.1918623632048,
              "query_max": 612.6659517452371,
              "query_min": 366.34720057037384,
              "normalized_score": 0.31135348989056383,
              "weight": 0.4,
              "weighted_score": 0.12454139595622554
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.12454139595622554,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.09963311676498043
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.09963311676498043
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the \"technical impact\" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Closely analyze the specific mistake that is causing resource consumption, and perform a CWE mapping for that mistake. Consider children/descendants such as CWE-770: Allocation of Resources Without Limits or Throttling, CWE-771: Missing Reference to Active Allocated Resource, CWE-410: Insufficient Resource Pool, CWE-772: Missing Release of Resource after Effective Lifetime, CWE-834: Excessive Iteration, CWE-405: Asymmetric Resource Consumption (Amplification), and others.",
                "reasons": [
                  "Frequent Misuse"
                ]
              },
              "score_after": 0.07970649341198435
            }
          },
          "combined_score": 0.07970649341198435
        }
      },
      "similarity": 0.07970649341198435
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-425",
      "CWE-862",
      "CWE-863",
      "CWE-639",
      "CWE-602",
      "CWE-669",
      "CWE-565"
    ],
    "critic_additional": []
  }
}