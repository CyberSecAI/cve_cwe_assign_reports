# Vulnerability Information: CVE-2021-3999

## Vulnerability Description
A flaw was found in glibc. An **off-by-one buffer overflow and underflow** in getcwd() may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd() in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system.

### Vulnerability Description Key Phrases
- **rootcause:** **off-by-one buffer overflow and underflow**
- **impact:** memory corruption
- **vector:** control the input buffer and size
- **attacker:** local attacker
- **product:** glibc
- **component:** getcwd()

## CVE Reference Links Content Summary
```
{
  "CVE-2021-3999": {
    "description": "A flaw was found in glibc. An off-by-one buffer overflow and underflow in getcwd() may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd() in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system.",
    "vulnerability_details": {
      "root_cause": "The `getcwd` function in glibc has a flaw where a buffer of size 1 can lead to an off-by-one buffer overflow and underflow due to incorrect size checks and logic in the generic implementation, specifically when the current working directory is long and the root filesystem is bind mounted onto the current directory.",
      "weaknesses": [
        "Off-by-one buffer overflow",
        "Off-by-one buffer underflow",
        "Incorrect size checks"
      ],
      "impact": "Memory corruption, potentially leading to arbitrary code execution and privilege escalation.",
      "attack_vectors": [
        "Local access",
        "Control of input buffer and size arguments passed to the `getcwd()` function",
          "The current working directory must be longer than PATH_MAX",
          "The root filesystem must be bind mounted onto the current directory"
        ],
      "attacker_capabilities": "Local attacker with the ability to control input buffer size in a setuid program, ability to create an unprivileged mount namespace, long working directory"
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.9366 | dense, sparse, graph | dense: 0.603, sparse: 0.531, graph: 0.926 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7882 | dense, sparse, graph | dense: 0.588, sparse: 0.395, graph: 0.750 |
| 3 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.7723 | dense, sparse, graph | dense: 0.553, sparse: 0.402, graph: 0.743 |
| 4 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.7231 | dense, sparse, graph | dense: 0.570, sparse: 0.388, graph: 0.603 |
| 5 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6320 | dense, sparse, graph | dense: 0.576, sparse: 0.339, graph: 0.566 |
| 6 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4909 | dense, sparse | dense: 0.564, sparse: 0.365 |
| 7 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4865 | dense, sparse | dense: 0.549, sparse: 0.370 |
| 8 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4836 | sparse, graph | sparse: 0.381, graph: 0.807 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4664 | dense, sparse | dense: 0.569, sparse: 0.385 |
| 10 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.3999 | sparse, graph | sparse: 0.342, graph: 0.572 |

