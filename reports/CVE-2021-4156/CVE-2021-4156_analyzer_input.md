# Vulnerability Information: CVE-2021-4156

## Vulnerability Description
An **out-of-bounds read** flaw was found in libsndfiles FLAC codec functionality. An attacker who is able to submit a specially crafted file (via tricking a user to open or otherwise) to an application linked with libsndfile and using the FLAC codec, could trigger an **out-of-bounds read** that would most likely cause a crash but could potentially leak memory information that could be used in further exploitation of other flaws.

### Vulnerability Description Key Phrases
- **rootcause:** **out-of-bounds read**
- **impact:** crash
- **vector:** specially crafted file
- **attacker:** attacker
- **product:** libsndfiles
- **component:** FLAC codec functionality

## CVE Reference Links Content Summary
```
{
  "CVE-2021-4156": {
    "Description": "An out-of-bounds read flaw was found in libsndfile's FLAC codec functionality. An attacker who is able to submit a specially crafted file (via tricking a user to open or otherwise) to an application linked with libsndfile and using the FLAC codec, could trigger an out-of-bounds read that would most likely cause a crash but could potentially leak memory information that could be used in further exploitation of other flaws.",
    "Root cause": "The vulnerability exists in the `flac_buffer_copy` function within `src/flac.c`. The code does not properly validate the `frame->header.blocksize` against the allocated size of the `buffer`, leading to an out-of-bounds read when `frame->header.blocksize` is larger than the buffer's allocated size.",
    "Weaknesses": [
      "CWE-125 Out-of-bounds Read"
    ],
    "Impact": "An out-of-bounds read can lead to a crash due to memory access violations. It can potentially leak sensitive memory information, which could be used in further exploitation of other vulnerabilities.",
    "Attack vectors": "The vulnerability can be exploited by providing a specially crafted FLAC file to an application using the vulnerable `libsndfile` library.",
    "Required attacker capabilities/position": "An attacker needs to be able to provide a crafted FLAC file to a user, who then must open this file using an application that uses the vulnerable libsndfile library."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.9297 | dense, sparse, graph | dense: 0.593, sparse: 0.482, graph: 1.000 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.8626 | dense, sparse, graph | dense: 0.588, sparse: 0.368, graph: 1.000 |
| 3 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.8398 | dense, sparse, graph | dense: 0.542, sparse: 0.369, graph: 1.000 |
| 4 | CWE-193 | Off-by-one Error | Base | Allowed | 0.8345 | dense, sparse, graph | dense: 0.542, sparse: 0.360, graph: 1.000 |
| 5 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6893 | dense, sparse, graph | dense: 0.574, sparse: 0.312, graph: 0.786 |
| 6 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.4698 | dense, sparse | dense: 0.554, sparse: 0.337 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4675 | dense, sparse | dense: 0.549, sparse: 0.337 |
| 8 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.4626 | dense, sparse | dense: 0.552, sparse: 0.326 |
| 9 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4585 | dense, sparse | dense: 0.541, sparse: 0.328 |
| 10 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4582 | dense, sparse | dense: 0.544, sparse: 0.325 |

