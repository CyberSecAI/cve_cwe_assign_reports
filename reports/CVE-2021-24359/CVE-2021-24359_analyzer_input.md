# Vulnerability Information: CVE-2021-24359

## Vulnerability Description
The Plus Addons for Elementor Page Builder WordPress plugin before 4.1.11 **did not properly check that a user requesting a password reset was the legitimate user**, allowing an attacker to send an arbitrary reset password email to a registered user on behalf of the WordPress site. Such issue could be chained with an open redirect (CVE-2021-24358) in version below 4.1.10, to include a crafted password reset link in the email, which would lead to an account takeover.

### Vulnerability Description Key Phrases
- **rootcause:** **did not properly check that a user requesting a password reset was the legitimate user**
- **impact:** arbitrary reset password email to a registered user
- **vector:** open redirect
- **attacker:** attacker
- **product:** Plus Addons for Elementor Page Builder WordPress plugin
- **version:** before 4.1.11

## CVE Reference Links Content Summary
### Summary:
The provided content describes a vulnerability in the "The Plus Addons for Elementor Page Builder" plugin, specifically an arbitrary password reset email sending issue (CVE-2021-24359).

**Root cause:**
The plugin's password reset functionality does not properly verify that the user requesting the reset is indeed the legitimate owner of the account. This allows an attacker to trigger password reset emails for any user by using the `theplus_ajax_forgot_password_ajax` function.

**Weaknesses/vulnerabilities:**
- Improper access control: The plugin fails to adequately check the legitimacy of password reset requests.
- Lack of user verification: The password reset process does not include any mechanism to ensure that the request is coming from the legitimate user.
- Insecure handling of user input: The plugin accepts arbitrary user input (email subject and message) without proper sanitization when sending password reset emails.

**Impact of exploitation:**
- Arbitrary password reset email: An attacker can send a password reset email to any registered user on the WordPress site.
- Account takeover: By chaining this vulnerability with an open redirect, an attacker can craft a password reset link in the email that redirects the victim to a malicious site after they click it. The attacker can then use the key obtained through the crafted link to complete the password reset process and take over the victim's account.
- Phishing: The attacker can include malicious links within the password reset email to potentially trick the user into providing credentials.

**Attack vectors:**
- Network request: The vulnerability is exploited by sending a crafted POST request to the WordPress `admin-ajax.php` endpoint.
- Lack of CSRF protection: The plugin relies on a nonce which can be obtained from the page, making it possible to exploit this vulnerability without any special user privileges.

**Required attacker capabilities/position:**
- The attacker needs to have access to a web browser or a tool that can send HTTP POST requests.
- The attacker also needs to be able to obtain the "tp\_user\_lost\_password\_nonce", which is present in the HTML source of any page where the vulnerable widget is placed.
- The attacker does not need to be authenticated on the target WordPress site.
- The "WP Login & Register" widget must be activated and present on a page of the WordPress site.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-620 | Unverified Password Change | Base | Allowed | 0.8676 | dense, sparse, graph | dense: 0.540, sparse: 0.661, graph: 0.613 |
| 2 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.7450 | dense, sparse, graph | dense: 0.468, sparse: 0.437, graph: 0.730 |
| 3 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.6735 | dense, sparse, graph | dense: 0.422, sparse: 0.456, graph: 0.563 |
| 4 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.4658 | dense, sparse | dense: 0.441, sparse: 0.428 |
| 5 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.4648 | dense, sparse | dense: 0.449, sparse: 0.420 |
| 6 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.4600 | dense, sparse | dense: 0.437, sparse: 0.422 |
| 7 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4486 | sparse, graph | sparse: 0.445, graph: 0.543 |
| 8 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.4451 | dense, sparse | dense: 0.423, sparse: 0.408 |
| 9 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.4043 | dense, sparse | dense: 0.532, sparse: 0.453 |
| 10 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2834 | dense, sparse | dense: 0.451, sparse: 0.449 |

