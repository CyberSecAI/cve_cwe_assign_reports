# Vulnerability Information: CVE-2021-45830

## Vulnerability Description
A **heap-based buffer overflow** vulnerability exists in HDF5 1.13.1-1 via H5F_addr_decode_len in /hdf5/src/H5Fint.c, which could cause a Denial of Service.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-based buffer overflow**
- **impact:** Denial of Service
- **product:** HDF5
- **version:** 1.13.1-1
- **component:** H5F_addr_decode_len in /hdf5/src/H5Fint.c

## CVE Reference Links Content Summary
The provided content is related to CVE-2021-45830.

**Root cause of vulnerability:**
The root cause is a heap-buffer-overflow in the `H5F_addr_decode_len` function within the HDF5 library. This function is responsible for decoding the length of an address, and it appears that the code attempts to read beyond the allocated buffer when handling a crafted HDF5 file.

**Weaknesses/vulnerabilities present:**
- Heap-buffer-overflow: The vulnerability manifests as a heap-buffer-overflow, meaning the code writes data beyond the boundaries of an allocated memory buffer.

**Impact of exploitation:**
- Segmentation fault: The immediate impact of exploitation is a segmentation fault, causing the program (`h5format_convert`) to crash.
- Potential for further exploitation: While the provided information only shows a crash, heap-buffer-overflows can be exploited to achieve arbitrary code execution with the permissions of the application.

**Attack vectors:**
- Crafted HDF5 file: The attack vector is a specially crafted HDF5 file that triggers the overflow when processed by HDF5 library functions. In the provided example, a file named `POC5.zip` containing this crafted file was used to reproduce the issue with the `h5format_convert` tool.

**Required attacker capabilities/position:**
- Ability to provide the crafted HDF5 file: The attacker needs to be able to provide a specially crafted HDF5 file as input to an application using the vulnerable version of the HDF5 library.
- User interaction might be required: In the specific case described the `h5format_convert` tool is used, so a user needs to execute this tool with the crafted file as input.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7079 | dense, sparse, graph | dense: 0.566, sparse: 0.165, graph: 0.923 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6723 | dense, sparse, graph | dense: 0.572, sparse: 0.170, graph: 0.808 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5248 | dense, sparse, graph | dense: 0.549, sparse: 0.162, graph: 0.563 |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5092 | dense, sparse, graph | dense: 0.536, sparse: 0.142, graph: 0.447 |
| 5 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4820 | dense, sparse, graph | dense: 0.518, sparse: 0.142, graph: 0.459 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3852 | dense, sparse | dense: 0.601, sparse: 0.203 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3638 | dense, sparse | dense: 0.549, sparse: 0.156 |
| 8 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3609 | sparse, graph | sparse: 0.138, graph: 0.789 |
| 9 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3502 | dense, sparse | dense: 0.518, sparse: 0.159 |
| 10 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3489 | dense, sparse | dense: 0.522, sparse: 0.153 |

