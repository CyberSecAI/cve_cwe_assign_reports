# Vulnerability Information: CVE-2021-43206

## Vulnerability Description
A server-generated error message containing sensitive information in Fortinet FortiOS 7.0.0 through 7.0.3, 6.4.0 through 6.4.8, 6.2.x, 6.0.x and FortiProxy 7.0.0 through 7.0.1, 2.0.x allows malicious webservers to retrieve a web proxys client username and IP via same origin HTTP requests triggering proxy-generated HTTP status codes pages.

### Vulnerability Description Key Phrases
- **impact:** retrieve web proxys client username and IP
- **vector:** same origin HTTP requests
- **attacker:** malicious webservers
- **product:** Fortinet FortiOS and FortiProxy
- **version:** 7.0.0 through 7.0.3 and 6.4.0 through 6.4.8 and 6.2.x and 6.0.x and 7.0.0 through 7.0.1 and 2.0.x

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A server-generated error message containing sensitive information vulnerability [CWE-550] in FortiOS and FortiProxy web proxy.
- **Weaknesses/vulnerabilities present**: Web proxy error pages disclose sensitive information, specifically the client username and IP.
- **Impact of exploitation**: A malicious webserver can retrieve a web proxy's client username and IP.
- **Attack vectors**: A malicious web server leverages same-origin HTTP requests to trigger proxy-generated HTTP status code pages, which include sensitive information.
- **Required attacker capabilities/position**: The attacker needs to host a malicious webserver that can be accessed through the vulnerable FortiOS/FortiProxy instance. The user must also interact with this malicious server.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-550 | Server-generated Error Message Containing Sensitive Information | Variant | Allowed | 0.4046 | dense, sparse | dense: 0.715, sparse: 0.141 |
| 2 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.3979 | sparse, graph | sparse: 0.076, graph: 0.991 |
| 3 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.3147 | sparse, graph | sparse: 0.077, graph: 0.757 |
| 4 | CWE-444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | Allowed | 0.2956 | dense, sparse | dense: 0.512, sparse: 0.069 |
| 5 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.2898 | dense, sparse | dense: 0.502, sparse: 0.068 |
| 6 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.2891 | dense, sparse | dense: 0.496, sparse: 0.072 |
| 7 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.2805 | dense, sparse | dense: 0.515, sparse: 0.080 |
| 8 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | 0.1318 | dense, sparse | dense: 0.503, sparse: 0.075 |
| 9 | CWE-209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | 0.0426 | sparse | sparse: 0.074 |
| 10 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.0412 | sparse | sparse: 0.072 |

