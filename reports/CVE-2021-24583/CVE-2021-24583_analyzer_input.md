# Vulnerability Information: CVE-2021-24583

## Vulnerability Description
The Timetable and Event Schedule WordPress plugin before 2.4.2 does not have proper access control when deleting a timeslot, allowing any user with the edit_posts capability (contributor+) to delete arbitrary timeslot from any events. Furthermore, no CSRF check is in place as well, allowing such attack to be performed via CSRF against a logged in with such capability

### Vulnerability Description Key Phrases
- **rootcause:** **improper access control**
- **impact:** delete arbitrary timeslot from any events
- **attacker:** any user with edit_posts capability
- **product:** Timetable and Event Schedule WordPress plugin
- **version:** before 2.4.2

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The plugin lacks proper access control when deleting a timeslot. Any user with the `edit_posts` capability (contributor or higher) can delete arbitrary timeslots from any event. Additionally, there is no CSRF check implemented.
- **Weaknesses/vulnerabilities present**:
    - Broken Access Control: Improper authorization checks allow unauthorized users to delete timeslots.
    - CSRF: Lack of CSRF protection allows attacks to be performed by tricking an authorized user into submitting a malicious request.
- **Impact of exploitation**: An attacker can delete arbitrary event timeslots, leading to data loss and disruption of event schedules.
- **Attack vectors**:
    - Direct exploitation: An attacker with a contributor or higher role can directly send a crafted POST request to delete timeslots.
    - CSRF: An attacker can create a malicious page or link that forces an authenticated user with `edit_posts` capability to unknowingly delete timeslots when the user clicks or loads the crafted content.
- **Required attacker capabilities/position**:
    -  The attacker needs a WordPress account with a role that has the `edit_posts` capability (contributor or higher).
    - Alternatively, the attacker can trick a logged in user with those permissions into triggering a CSRF attack.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.6142 | dense, sparse, graph | dense: 0.447, sparse: 0.226, graph: 0.730 |
| 2 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.5821 | dense, sparse, graph | dense: 0.447, sparse: 0.250, graph: 0.602 |
| 3 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.5462 | dense, sparse, graph | dense: 0.444, sparse: 0.231, graph: 0.538 |
| 4 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.3903 | dense, sparse | dense: 0.551, sparse: 0.405 |
| 5 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3658 | dense, sparse | dense: 0.419, sparse: 0.273 |
| 6 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.3647 | dense, sparse | dense: 0.440, sparse: 0.252 |
| 7 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3562 | dense, sparse | dense: 0.425, sparse: 0.251 |
| 8 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.3412 | dense, sparse | dense: 0.406, sparse: 0.241 |
| 9 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2453 | dense, sparse | dense: 0.477, sparse: 0.312 |
| 10 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2340 | dense, sparse | dense: 0.448, sparse: 0.304 |

