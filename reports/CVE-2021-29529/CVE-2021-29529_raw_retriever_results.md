# Raw Retriever Results for CVE-2021-29529

# Raw Retriever Results for CVE-2021-29529

## Query
TensorFlow is an end-to-end open source platform for machine learning. An attacker can trigger a heap buffer overflow in `tf.raw_ops.QuantizedResizeBilinear` by manipulating input values so that float rounding results in off-by-one error in accessing image elements. This is because the implementation(https//github.com/tensorflow/tensorflow/blob/44b7f486c0143f68b56c34e2d01e146ee445134a/tensorflow/core/kernels/quantized_resize_bilinear_op.cc#L62-L66) computes two integers (representing the upper and lower bounds for interpolation) by ceiling and flooring a floating point value. For some values of `in`, `interpolation->upper[i]` might be smaller than `interpolation->lower[i]`. This is an issue if `interpolation->upper[i]` is capped at `in_size-1` as it means that `interpolation->lower[i]` points outside of the image. Then, in the interpolation code(https//github.com/tensorflow/tensorflow/blob/44b7f486c0143f68b56c34e2d01e146ee445134a/tensorflow/core/kernels/quantized_resize_bilinear_op.cc#L245-L264), this would result in heap buffer overflow. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.

## Keyphrases
- **rootcause**: float rounding results in off-by-one error
- **weakness**: heap buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4628 | 0.5544 | 0.4965 | 0.4938 | 20 |
| Sparse | 899.9105 | 3386.2605 | 1873.5041 | 1796.8227 | 20 |
| Graph | 1.3676 | 2.7196 | 1.8190 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 787 | Out-of-bounds Write | base | 2.7196 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | Base | 2.5207 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 4 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 5 | 195 | Signed to Unsigned Conversion Error | variant | 2.1936 | Allowed |
| 6 | 193 | Off-by-one Error | Base | 2.1047 | Allowed |
| 7 | 681 | Incorrect Conversion between Numeric Types | Base | 1.9889 | Allowed |
| 8 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 9 | 822 | Untrusted Pointer Dereference | base | 1.6848 | Allowed |
| 10 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 11 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 12 | 824 | Access of Uninitialized Pointer | Base | 1.6631 | Allowed |
| 13 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | 1.6368 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.6238 | Allowed |
| 15 | 125 | Out-of-bounds Read | Base | 1.5302 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | 0.5544 | 0.5544 | Allowed |
| 2 | 122 | Heap-based Buffer Overflow | Variant | 0.5458 | 0.5458 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5302 | 0.5302 | Allowed |
| 4 | 681 | Incorrect Conversion between Numeric Types | Base | 0.5234 | 0.5234 | Allowed |
| 5 | 824 | Access of Uninitialized Pointer | Base | 0.5101 | 0.5101 | Allowed |
| 6 | 1287 | Improper Validation of Specified Type of Input | Base | 0.5101 | 0.5101 | Allowed |
| 7 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5054 | 0.5054 | Allowed |
| 8 | 680 | Integer Overflow to Buffer Overflow | Compound | 0.5012 | 0.5012 | Discouraged |
| 9 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5007 | 0.5007 | Allowed |
| 10 | 193 | Off-by-one Error | Base | 0.4984 | 0.4984 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4891 | 0.4891 | Allowed |
| 12 | 415 | Double Free | Variant | 0.4855 | 0.4855 | Allowed |
| 13 | 126 | Buffer Over-read | Variant | 0.4855 | 0.4855 | Allowed |
| 14 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | 0.4825 | 0.4825 | Allowed |
| 15 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4768 | 0.4768 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-193 | Off-by-one Error | 3386.2605 | 3386.2605 | Allowed |
| 2 | CWE-824 | Access of Uninitialized Pointer | 2452.5271 | 2452.5271 | Allowed |
| 3 | CWE-681 | Incorrect Conversion between Numeric Types | 2388.2831 | 2388.2831 | Allowed |
| 4 | CWE-122 | Heap-based Buffer Overflow | 2226.3645 | 2226.3645 | Allowed |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | 2206.7875 | 2206.7875 | Allowed |
| 6 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 2019.9736 | 2019.9736 | Allowed |
| 7 | CWE-125 | Out-of-bounds Read | 1892.9465 | 1892.9465 | Allowed |
| 8 | CWE-415 | Double Free | 1855.3879 | 1855.3879 | Allowed |
| 9 | CWE-617 | Reachable Assertion | 1833.8474 | 1833.8474 | Allowed |
| 10 | CWE-674 | Uncontrolled Recursion | 1817.9085 | 1817.9085 | Allowed-with-Review |
| 11 | CWE-476 | NULL Pointer Dereference | 1775.7369 | 1775.7369 | Allowed |
| 12 | CWE-787 | Out-of-bounds Write | 1654.8311 | 1654.8311 | Allowed |
| 13 | CWE-190 | Integer Overflow or Wraparound | 1641.8680 | 1641.8680 | Allowed |
| 14 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 1635.9327 | 1635.9327 | Allowed |
| 15 | CWE-20 | Improper Input Validation | 1620.0658 | 1620.0658 | Discouraged |
