# Vulnerability Information: CVE-2021-43114

## Vulnerability Description
FORT Validator versions prior to 1.5.2 will crash if an RPKI CA publishes an X.509 EE certificate. This will lead to RTR clients such as BGP routers to lose access to the RPKI VRP data set, effectively disabling Route Origin Validation.

### Vulnerability Description Key Phrases
- **impact:** crash
- **vector:** X.509 EE certificate
- **attacker:** RPKI CA
- **product:** FORT Validator
- **version:** prior to 1.5.2

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The vulnerability stems from improper handling of certificate data and lack of proper validation within the FORT RPKI validator, specifically related to the processing of certificates during RPKI validation.",
    "weaknesses": [
      "Improper certificate handling",
      "Lack of input validation",
      "Memory management issues leading to potential crashes"
    ],
    "impact": "The vulnerability could lead to a denial-of-service (DoS) condition, where the validator crashes, or potentially path traversal. The BGPsec certificate validation component was also crashing and needed to be disabled for version 1.5.2",
     "attack_vectors": [
      "Crafted RPKI data containing malicious or malformed certificates"
    ],
    "required_capabilities": [
      "An attacker would need the ability to insert malicious certificates into the RPKI data stream being processed by the FORT validator."
    ],
   "additional_details": "The issue was addressed by fixing situational crash due to bad code cleanup, performance optimizations, and removing BGPsec certificate code"
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1288 | Improper Validation of Consistency within Input | Base | Allowed | 0.4887 | dense, sparse, graph | dense: 0.454, sparse: 0.086, graph: 0.595 |
| 2 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.4695 | dense, sparse, graph | dense: 0.420, sparse: 0.056, graph: 0.636 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3264 | sparse, graph | sparse: 0.051, graph: 0.832 |
| 4 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.2180 | sparse, graph | sparse: 0.054, graph: 0.524 |
| 5 | CWE-573 | Improper Following of Specification by Caller | Class | Allowed-with-Review | 0.1528 | sparse, graph | sparse: 0.150, graph: 0.487 |
| 6 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.0278 | sparse | sparse: 0.049 |
| 7 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.0271 | sparse | sparse: 0.047 |
| 8 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.0258 | sparse | sparse: 0.045 |
| 9 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.0255 | sparse | sparse: 0.045 |
| 10 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.0250 | sparse | sparse: 0.044 |

