{
  "method": "sparse_with_keyphrases",
  "query": "HyperKit is a toolkit for embedding hypervisor capabilities in an application. In versions 0.20210107 and prior of HyperKit, the implementation of `qnotify` at `pci_vtrnd_notify` fails to check the return value of `vq_getchain`. This leads to `struct iovec iov` being uninitialized and used to read memory in `len = (int) read(sc->vrsc_fd, iov.iov_base, iov.iov_len)` when an attacker is able to make `vq_getchain` fail. This issue may lead to a guest crashing the host causing a denial of service and, under certain circumstance, memory corruption. This issue is fixed in commit 41272a980197917df8e58ff90642d14dec8fe948.",
  "keyphrases": {
    "rootcause": "fails to check the return value of vq_getchain",
    "weakness": "struct iovec iov being uninitialized"
  },
  "timestamp": "2025-03-17T23:47:55.408137",
  "results_count": 20,
  "results_summary": [
    {
      "doc_id": "CWE-252",
      "name": "Unchecked Return Value",
      "score": 1745.68753685941
    },
    {
      "doc_id": "CWE-394",
      "name": "Unexpected Status Code or Return Value",
      "score": 1202.9728443588854
    },
    {
      "doc_id": "CWE-824",
      "name": "Access of Uninitialized Pointer",
      "score": 921.7018970504004
    },
    {
      "doc_id": "CWE-909",
      "name": "Missing Initialization of Resource",
      "score": 911.6965109388923
    },
    {
      "doc_id": "CWE-125",
      "name": "Out-of-bounds Read",
      "score": 901.851060395918
    }
  ]
}