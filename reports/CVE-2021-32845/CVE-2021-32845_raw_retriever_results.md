# Raw Retriever Results for CVE-2021-32845

# Raw Retriever Results for CVE-2021-32845

## Query
HyperKit is a toolkit for embedding hypervisor capabilities in an application. In versions 0.20210107 and prior of HyperKit, the implementation of `qnotify` at `pci_vtrnd_notify` fails to check the return value of `vq_getchain`. This leads to `struct iovec iov` being uninitialized and used to read memory in `len = (int) read(sc->vrsc_fd, iov.iov_base, iov.iov_len)` when an attacker is able to make `vq_getchain` fail. This issue may lead to a guest crashing the host causing a denial of service and, under certain circumstance, memory corruption. This issue is fixed in commit 41272a980197917df8e58ff90642d14dec8fe948.

## Keyphrases
- **rootcause**: fails to check the return value of vq_getchain
- **weakness**: struct iovec iov being uninitialized

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4912 | 0.5316 | 0.5064 | 0.5032 | 20 |
| Sparse | 508.2508 | 1745.6875 | 902.3305 | 855.7550 | 20 |
| Graph | 1.1088 | 4.3290 | 2.0067 | 1.7619 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 125 | Out-of-bounds Read | base | 4.3290 | Allowed |
| 2 | 908 | Use of Uninitialized Resource | Base | 2.8255 | Allowed |
| 3 | 824 | Access of Uninitialized Pointer | Base | 2.8064 | Allowed |
| 4 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 5 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 6 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 7 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 8 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 9 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 11 | 909 | Missing Initialization of Resource | Class | 1.7559 | Allowed-with-Review |
| 12 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 13 | 252 | Unchecked Return Value | Base | 1.6552 | Allowed |
| 14 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6196 | Allowed |
| 15 | 476 | NULL Pointer Dereference | Base | 1.5353 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 908 | Use of Uninitialized Resource | Base | 0.5316 | 0.5316 | Allowed |
| 2 | 909 | Missing Initialization of Resource | Class | 0.5300 | 0.5300 | Allowed-with-Review |
| 3 | 394 | Unexpected Status Code or Return Value | Base | 0.5269 | 0.5269 | Allowed |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5232 | 0.5232 | Allowed |
| 5 | 277 | Insecure Inherited Permissions | Variant | 0.5161 | 0.5161 | Allowed |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5105 | 0.5105 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5092 | 0.5092 | Allowed-with-Review |
| 8 | 416 | Use After Free | Variant | 0.5082 | 0.5082 | Allowed |
| 9 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5071 | 0.5071 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5047 | 0.5047 | Allowed |
| 11 | 190 | Integer Overflow or Wraparound | Base | 0.5016 | 0.5016 | Allowed |
| 12 | 252 | Unchecked Return Value | Base | 0.5006 | 0.5006 | Allowed |
| 13 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.5006 | 0.5006 | Allowed |
| 14 | 667 | Improper Locking | Class | 0.4976 | 0.4976 | Allowed-with-Review |
| 15 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4966 | 0.4966 | Discouraged |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-252 | Unchecked Return Value | 1745.6875 | 1745.6875 | Allowed |
| 2 | CWE-394 | Unexpected Status Code or Return Value | 1202.9728 | 1202.9728 | Allowed |
| 3 | CWE-824 | Access of Uninitialized Pointer | 921.7019 | 921.7019 | Allowed |
| 4 | CWE-909 | Missing Initialization of Resource | 911.6965 | 911.6965 | Allowed-with-Review |
| 5 | CWE-125 | Out-of-bounds Read | 901.8511 | 901.8511 | Allowed |
| 6 | CWE-476 | NULL Pointer Dereference | 881.7447 | 881.7447 | Allowed |
| 7 | CWE-754 | Improper Check for Unusual or Exceptional Conditions | 875.5588 | 875.5588 | Allowed-with-Review |
| 8 | CWE-190 | Integer Overflow or Wraparound | 861.4445 | 861.4445 | Allowed |
| 9 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 858.7544 | 858.7544 | Allowed-with-Review |
| 10 | CWE-770 | Allocation of Resources Without Limits or Throttling | 858.0943 | 858.0943 | Allowed |
| 11 | CWE-755 | Improper Handling of Exceptional Conditions | 853.4157 | 853.4157 | Discouraged |
| 12 | CWE-1284 | Improper Validation of Specified Quantity in Input | 846.9207 | 846.9207 | Allowed |
| 13 | CWE-415 | Double Free | 844.8304 | 844.8304 | Allowed |
| 14 | CWE-908 | Use of Uninitialized Resource | 841.1516 | 841.1516 | Allowed |
| 15 | CWE-457 | Use of Uninitialized Variable | 839.1731 | 839.1731 | Allowed |
