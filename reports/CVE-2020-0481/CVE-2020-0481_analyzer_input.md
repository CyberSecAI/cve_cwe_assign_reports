# Vulnerability Information: CVE-2020-0481

## Vulnerability Description
In AndroidManifest.xml, there is a possible **permissions bypass**. This could lead to local escalation of privilege allowing a non-system app to send a broadcast it shouldnt have permissions to send, with no additional execution privileges needed. User interaction is not needed for exploitation.Product AndroidVersions Android-11Android ID A-157472962

### Vulnerability Description Key Phrases
- **weakness:** **permissions bypass**
- **impact:** send broadcast without permission
- **attacker:** non-system app
- **product:** Android
- **version:** Android-11

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2020-0481:

**Verification:**

The commit log from android.googlesource.com explicitly mentions "Bug: 157472962" which is the same bug id as referenced in the Pixel Update Bulletin for CVE-2020-0481. Therefore, the content is related to this CVE.

**Root cause of vulnerability:**

The vulnerability lies in the handling of Bluetooth device alias changes, specifically related to the `bluetooth.device.action.ALIAS_CHANGED` action. The vulnerability allows the file transfer to complete without unlocking the phone.

**Weaknesses/vulnerabilities present:**

- Improper access control or handling of Bluetooth device actions, specifically `bluetooth.device.action.ALIAS_CHANGED`.
- Allowing file transfer operations to proceed even when the device is in a locked state, bypassing device security.

**Impact of exploitation:**

- **Elevation of Privilege (EoP):** An attacker could potentially transfer files to a locked device, potentially including malicious files, without the user's knowledge or consent.
- Bypassing security controls by exploiting the file transfer vulnerability on locked devices.

**Attack vectors:**

-  **Bluetooth file transfer:** An attacker within Bluetooth range of a locked device could initiate a file transfer.
- Exploiting the insecure handling of the `bluetooth.device.action.ALIAS_CHANGED` action by sending a crafted Bluetooth signal to trigger an alias change and then transfer files without authorization.

**Required attacker capabilities/position:**

- The attacker needs to be within Bluetooth range of the target device.
- The attacker needs to be able to initiate a file transfer via Bluetooth.
- The attacker needs to be able to send a crafted Bluetooth signal to trigger the alias change.

**Additional notes:**

The commit log from android.googlesource.com provides more detail on how the vulnerability is triggered (by changing alias and sending files to locked phone) and what the fix addresses (private notification without accept and decline buttons). The commit log associated with the fix for CVE-2020-0473 indicates that files should not be accepted on a locked phone. The fix for CVE-2020-0481 adds a private notification without accept and decline buttons so the files will no longer be accepted on an unlocked phone.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.6750 | dense, sparse, graph | dense: 0.577, sparse: 0.307, graph: 0.590 |
| 2 | CWE-941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | 0.6534 | dense, sparse, graph | dense: 0.580, sparse: 0.265, graph: 0.591 |
| 3 | CWE-925 | Improper Verification of Intent by Broadcast Receiver | Variant | Allowed | 0.5029 | dense, sparse | dense: 0.674, sparse: 0.363 |
| 4 | CWE-927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | 0.4346 | dense, sparse | dense: 0.657, sparse: 0.249 |
| 5 | CWE-223 | Omission of Security-relevant Information | Base | Allowed | 0.4339 | dense, sparse | dense: 0.562, sparse: 0.266 |
| 6 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.3884 | dense, sparse | dense: 0.501, sparse: 0.241 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3051 | sparse, graph | sparse: 0.243, graph: 0.465 |
| 8 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2590 | dense, sparse | dense: 0.526, sparse: 0.310 |
| 9 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2435 | dense, sparse | dense: 0.523, sparse: 0.267 |
| 10 | CWE-514 | Covert Channel | Class | Allowed-with-Review | 0.2418 | dense, sparse | dense: 0.506, sparse: 0.277 |

