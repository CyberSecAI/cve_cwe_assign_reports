# Critic Input for CVE-2020-0481



# Original Analyzer Input
## Vulnerability Description
In AndroidManifest.xml, there is a possible **permissions bypass**. This could lead to local escalation of privilege allowing a non-system app to send a broadcast it shouldnt have permissions to send, with no additional execution privileges needed. User interaction is not needed for exploitation.Product AndroidVersions Android-11Android ID A-157472962

### Vulnerability Description Key Phrases
- **weakness:** **permissions bypass**
- **impact:** send broadcast without permission
- **attacker:** non-system app
- **product:** Android
- **version:** Android-11

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2020-0481:

**Verification:**

The commit log from android.googlesource.com explicitly mentions "Bug: 157472962" which is the same bug id as referenced in the Pixel Update Bulletin for CVE-2020-0481. Therefore, the content is related to this CVE.

**Root cause of vulnerability:**

The vulnerability lies in the handling of Bluetooth device alias changes, specifically related to the `bluetooth.device.action.ALIAS_CHANGED` action. The vulnerability allows the file transfer to complete without unlocking the phone.

**Weaknesses/vulnerabilities present:**

- Improper access control or handling of Bluetooth device actions, specifically `bluetooth.device.action.ALIAS_CHANGED`.
- Allowing file transfer operations to proceed even when the device is in a locked state, bypassing device security.

**Impact of exploitation:**

- **Elevation of Privilege (EoP):** An attacker could potentially transfer files to a locked device, potentially including malicious files, without the user's knowledge or consent.
- Bypassing security controls by exploiting the file transfer vulnerability on locked devices.

**Attack vectors:**

-  **Bluetooth file transfer:** An attacker within Bluetooth range of a locked device could initiate a file transfer.
- Exploiting the insecure handling of the `bluetooth.device.action.ALIAS_CHANGED` action by sending a crafted Bluetooth signal to trigger an alias change and then transfer files without authorization.

**Required attacker capabilities/position:**

- The attacker needs to be within Bluetooth range of the target device.
- The attacker needs to be able to initiate a file transfer via Bluetooth.
- The attacker needs to be able to send a crafted Bluetooth signal to trigger the alias change.

**Additional notes:**

The commit log from android.googlesource.com provides more detail on how the vulnerability is triggered (by changing alias and sending files to locked phone) and what the fix addresses (private notification without accept and decline buttons). The commit log associated with the fix for CVE-2020-0473 indicates that files should not be accepted on a locked phone. The fix for CVE-2020-0481 adds a private notification without accept and decline buttons so the files will no longer be accepted on an unlocked phone.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.6750 | dense, sparse, graph | dense: 0.577, sparse: 0.307, graph: 0.590 |
| 2 | CWE-941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | 0.6534 | dense, sparse, graph | dense: 0.580, sparse: 0.265, graph: 0.591 |
| 3 | CWE-925 | Improper Verification of Intent by Broadcast Receiver | Variant | Allowed | 0.5029 | dense, sparse | dense: 0.674, sparse: 0.363 |
| 4 | CWE-927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | 0.4346 | dense, sparse | dense: 0.657, sparse: 0.249 |
| 5 | CWE-223 | Omission of Security-relevant Information | Base | Allowed | 0.4339 | dense, sparse | dense: 0.562, sparse: 0.266 |
| 6 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.3884 | dense, sparse | dense: 0.501, sparse: 0.241 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3051 | sparse, graph | sparse: 0.243, graph: 0.465 |
| 8 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2590 | dense, sparse | dense: 0.526, sparse: 0.310 |
| 9 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2435 | dense, sparse | dense: 0.523, sparse: 0.267 |
| 10 | CWE-514 | Covert Channel | Class | Allowed-with-Review | 0.2418 | dense, sparse | dense: 0.506, sparse: 0.277 |



# Analysis to Review
# Summary
| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
| ------- | --------------------------------------------------------------- | ---------- | --------------------- | ------------------------------- | ------------------------------- |
| CWE-284 | Improper Access Control                                         | 0.85       | Base                  | Allowed                         | Proper access control is needed |
| CWE-285 | Improper Authorization                                        | 0.65       | Class                  | Discouraged                      | Alternative mappings available    |

## Evidence and Confidence

*   **Confidence Score:** 0.75
*   **Evidence Strength:** MEDIUM

- **Analysis and Justification:**
  - *Explanation:* The vulnerability description indicates a **permissions bypass**, allowing a non-system app to send a broadcast it should not have permission to send. The core issue is a failure to properly restrict access to a specific functionality, aligning with CWE-284 (Improper Access Control). The CVE Reference Links Content Summary confirms this, highlighting "Improper access control or handling of Bluetooth device actions". CWE-284 is a base level CWE, which is a preferred level of abstraction.
  - *Relationship Analysis:* CWE-284 is a child of CWE-285 (Improper Authorization). While authorization and access control are closely related, access control focuses on the mechanism used to enforce permissions, making CWE-284 a more precise fit.

- **Confidence Score:**
  - Confidence: 0.85 (Moderate evidence from the vulnerability description and CVE reference materials)

---

# Summary
| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
| ------- | --------------------------------------------------------------- | ---------- | --------------------- | ------------------------------- | ------------------------------- |
| CWE-284 | Improper Access Control                                         | 0.85       | Base                  | Allowed                         | Proper access control is needed |
| CWE-285 | Improper Authorization                                        | 0.65       | Class                  | Discouraged                      | Alternative mappings available    |

## Evidence and Confidence

*   **Confidence Score:** 0.75
*   **Evidence Strength:** MEDIUM

- **Analysis and Justification:**
  - *Explanation:* The vulnerability description indicates a **permissions bypass**, allowing a non-system app to send a broadcast it should not have permission to send. The core issue is a failure to properly restrict access to a specific functionality, aligning with CWE-284 (Improper Access Control). The CVE Reference Links Content Summary confirms this, highlighting "Improper access control or handling of Bluetooth device actions". CWE-284 is a base level CWE, which is a preferred level of abstraction.
  - *Relationship Analysis:* CWE-284 is a child of CWE-285 (Improper Authorization). While authorization and access control are closely related, access control focuses on the mechanism used to enforce permissions, making CWE-284 a more precise fit.

- **Confidence Score:**
  - Confidence: 0.85 (Moderate evidence from the vulnerability description and CVE reference materials)

---
# Summary
| CWE ID  | CWE Name                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
| ------- | --------------------------------------------------------------- | ---------- | --------------------- | ------------------------------- | ------------------------------- |
| CWE-284 | Improper Access Control                                         | 0.85       | Base                  | Allowed                         | Proper access control is needed |
| CWE-285 | Improper Authorization                                        | 0.65       | Class                  | Discouraged                      | Alternative mappings available    |

## Evidence and Confidence

*   **Confidence Score:** 0.75
*   **Evidence Strength:** MEDIUM

- **Analysis and Justification:**
  - *Explanation:* The vulnerability description indicates a **permissions bypass**, allowing a non-system app to send a broadcast it should not have permission to send. The core issue is a failure to properly restrict access to a specific functionality, aligning with CWE-284 (Improper Access Control). The CVE Reference Links Content Summary confirms this, highlighting "Improper access control or handling of Bluetooth device actions". CWE-284 is a base level CWE, which is a preferred level of abstraction.
  - *Relationship Analysis:* CWE-284 is a child of CWE-285 (Improper Authorization). While authorization and access control are closely related, access control focuses on the mechanism used to enforce permissions, making CWE-284 a more precise fit.

- **Confidence Score:**
  - Confidence: 0.85 (Moderate evidence from the vulnerability description and CVE reference materials)

---

# CWE Examples from Database


## Known Examples for CWE-284: Improper Access Control
### Observed Examples
- **CVE-2022-24985** [https://www.cve.org/CVERecord?id=CVE-2022-24985](https://www.cve.org/CVERecord?id=CVE-2022-24985): A form hosting website only checks the session authentication status for a single form, making it possible to bypass authentication when there are multiple forms
- **CVE-2022-29238** [https://www.cve.org/CVERecord?id=CVE-2022-29238](https://www.cve.org/CVERecord?id=CVE-2022-29238): Access-control setting in web-based document collaboration tool is not properly implemented by the code, which prevents listing hidden directories but does not prevent direct requests to files in those directories.
- **CVE-2022-23607** [https://www.cve.org/CVERecord?id=CVE-2022-23607](https://www.cve.org/CVERecord?id=CVE-2022-23607): Python-based HTTP library did not scope cookies to a particular domain such that "supercookies" could be sent to any domain on redirect
- **CVE-2021-21972** [https://www.cve.org/CVERecord?id=CVE-2021-21972](https://www.cve.org/CVERecord?id=CVE-2021-21972): Chain: Cloud computing virtualization platform does not require authentication for upload of a tar format file (CWE-306), then uses .. path traversal sequences (CWE-23) in the file to access unexpected files, as exploited in the wild per CISA KEV.
- **CVE-2021-37415** [https://www.cve.org/CVERecord?id=CVE-2021-37415](https://www.cve.org/CVERecord?id=CVE-2021-37415): IT management product does not perform authentication for some REST API requests, as exploited in the wild per CISA KEV.
- **CVE-2021-35033** [https://www.cve.org/CVERecord?id=CVE-2021-35033](https://www.cve.org/CVERecord?id=CVE-2021-35033): Firmware for a WiFi router uses a hard-coded password for a BusyBox shell, allowing bypass of authentication through the UART port
- **CVE-2020-10263** [https://www.cve.org/CVERecord?id=CVE-2020-10263](https://www.cve.org/CVERecord?id=CVE-2020-10263): Bluetooth speaker does not require authentication for the debug functionality on the UART port, allowing root shell access
- **CVE-2020-13927** [https://www.cve.org/CVERecord?id=CVE-2020-13927](https://www.cve.org/CVERecord?id=CVE-2020-13927): Default setting in workflow management product allows all API requests without authentication, as exploited in the wild per CISA KEV.
- **CVE-2010-4624** [https://www.cve.org/CVERecord?id=CVE-2010-4624](https://www.cve.org/CVERecord?id=CVE-2010-4624): Bulletin board applies restrictions on number of images during post creation, but does not enforce this on editing.
### Top 25 Examples
- **CVE-2021-1581**: Multiple vulnerabilities in the web UI and API endpoints of Cisco Application Policy Infrastructure Controller (APIC) or Cisco Cloud APIC could allow a remote attacker to perform a command injection or file upload attack on an affected system. For more information about these vulnerabilities, see the Details section of this advisory.


# Relevant CWE Specifications

## CWE-284: Improper Access Control
**Abstraction:** Pillar
**Status:** Incomplete

### Description
The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.

### Extended Description


Access control involves the use of several protection mechanisms such as:


  - Authentication (proving the identity of an actor)

  - Authorization (ensuring that a given actor can access a resource), and

  - Accountability (tracking of activities that were performed)

When any mechanism is not applied or otherwise fails, attackers can compromise the security of the product by gaining privileges, reading sensitive information, executing commands, evading detection, etc.

There are two distinct behaviors that can introduce access control weaknesses:


  - Specification: incorrect privileges, permissions, ownership, etc. are explicitly specified for either the user or the resource (for example, setting a password file to be world-writable, or giving administrator capabilities to a guest user). This action could be performed by the program or the administrator.

  - Enforcement: the mechanism contains errors that prevent it from properly enforcing the specified access control requirements (e.g., allowing the user to specify their own privileges, or allowing a syntactically-incorrect ACL to produce insecure settings). This problem occurs within the program itself, in that it does not actually enforce the intended security policy that the administrator specifies.



### Alternative Terms
Authorization: The terms "access control" and "authorization" are often used interchangeably, although many people have distinct definitions. The CWE usage of "access control" is intended as a general term for the various mechanisms that restrict which users can access which resources, and "authorization" is more narrowly defined. It is unlikely that there will be community consensus on the use of these terms.

### Relationships
ParentOf -> CWE-1191
ParentOf -> CWE-1220
ParentOf -> CWE-1224
ParentOf -> CWE-1231
ParentOf -> CWE-1233
ParentOf -> CWE-1242
ParentOf -> CWE-1252
ParentOf -> CWE-1257
ParentOf -> CWE-1259
ParentOf -> CWE-1260
ParentOf -> CWE-1262
ParentOf -> CWE-1263
ParentOf -> CWE-1267
ParentOf -> CWE-1268
ParentOf -> CWE-1270
ParentOf -> CWE-1274
ParentOf -> CWE-1276
ParentOf -> CWE-1280
ParentOf -> CWE-1283
ParentOf -> CWE-1290
ParentOf -> CWE-1292
ParentOf -> CWE-1294
ParentOf -> CWE-1296
ParentOf -> CWE-1304
ParentOf -> CWE-1311
ParentOf -> CWE-1312
ParentOf -> CWE-1313
ParentOf -> CWE-1315
ParentOf -> CWE-1316
ParentOf -> CWE-1317
ParentOf -> CWE-1320
ParentOf -> CWE-1323
ParentOf -> CWE-1334
ParentOf -> CWE-269
ParentOf -> CWE-282
ParentOf -> CWE-285
ParentOf -> CWE-286
ParentOf -> CWE-287
ParentOf -> CWE-288
ParentOf -> CWE-346
ParentOf -> CWE-639
ParentOf -> CWE-749
ParentOf -> CWE-862
ParentOf -> CWE-863
ParentOf -> CWE-923

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-284 is extremely high-level, a Pillar. Its name, "Improper Access Control," is often misused in low-information vulnerability reports [REF-1287] or by active use of the OWASP Top Ten, such as "A01:2021-Broken Access Control". It is not useful for trend analysis.
**Comments:** Consider using descendants of CWE-284 that are more specific to the kind of access control involved, such as those involving authorization (Missing Authorization (CWE-862), Incorrect Authorization (CWE-863), Incorrect Permission Assignment for Critical Resource (CWE-732), etc.); authentication (Missing Authentication (CWE-306) or Weak Authentication (CWE-1390)); Incorrect User Management (CWE-286); Improper Restriction of Communication Channel to Intended Endpoints (CWE-923); etc.
**Reasons:**
- Frequent Misuse
- Abstraction
**Suggested Alternatives:**
- CWE-862: Missing Authorization
- CWE-863: Incorrect Authorization
- CWE-732: Incorrect Permission Assignment for Critical Resource
- CWE-306: Missing Authentication
- CWE-1390: Weak Authentication
- CWE-923: Improper Restriction of Communication Channel to Intended Endpoints


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design, Operation
- **Description:** Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software.

**Mitigation 2:**
- **Phase:** Architecture and Design
- **Strategy:** Separation of Privilege
- **Description:** 

Compartmentalize the system to have "safe" areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area.


Ensure that appropriate compartmentalization is built into the system design, and the compartmentalization allows for and reinforces privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges.




### Additional Notes
**[Maintenance]** 

This entry needs more work. Possible sub-categories include:


  - Trusted group includes undesired entities (partially covered by CWE-286)

  - Group can perform undesired actions

  - ACL parse error does not fail closed





### Observed Examples
- **CVE-2022-24985:** A form hosting website only checks the session authentication status for a single form, making it possible to bypass authentication when there are multiple forms
- **CVE-2022-29238:** Access-control setting in web-based document collaboration tool is not properly implemented by the code, which prevents listing hidden directories but does not prevent direct requests to files in those directories.
- **CVE-2022-23607:** Python-based HTTP library did not scope cookies to a particular domain such that "supercookies" could be sent to any domain on redirect



## CWE-285: Improper Authorization
**Abstraction:** Class
**Status:** Draft

### Description
The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.

### Extended Description


Assuming a user with a given identity, authorization is the process of determining whether that user can access a given resource, based on the user's privileges and any permissions or other access-control specifications that apply to the resource.


When access control checks are not applied consistently - or not at all - users are able to access data or perform actions that they should not be allowed to perform. This can lead to a wide range of problems, including information exposures, denial of service, and arbitrary code execution.


### Alternative Terms
AuthZ: "AuthZ" is typically used as an abbreviation of "authorization" within the web application security community. It is distinct from "AuthN" (or, sometimes, "AuthC") which is an abbreviation of "authentication." The use of "Auth" as an abbreviation is discouraged, since it could be used for either authentication or authorization.

### Relationships
ChildOf -> CWE-284
ChildOf -> CWE-284
ParentOf -> CWE-1230
ParentOf -> CWE-1256
ParentOf -> CWE-1297
ParentOf -> CWE-1328
ParentOf -> CWE-552
ParentOf -> CWE-732
ParentOf -> CWE-862
ParentOf -> CWE-863
ParentOf -> CWE-926
ParentOf -> CWE-927

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).
**Comments:** Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.
**Reasons:**
- Abstraction
**Suggested Alternatives:**
- CWE-862: Missing Authorization
- CWE-863: Incorrect Authorization
- CWE-732: Incorrect Permission Assignment for Critical Resource


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** 

Divide the product into anonymous, normal, privileged, and administrative areas. Reduce the attack surface by carefully mapping roles with data and functionality. Use role-based access control (RBAC) to enforce the roles at the appropriate boundaries.


Note that this approach may not protect against horizontal authorization, i.e., it will not protect a user from attacking others with the same role.


**Mitigation 2:**
- **Phase:** Architecture and Design
- **Description:** Ensure that you perform access control checks related to your business logic. These checks may be different than the access control checks that you apply to more generic resources such as files, connections, processes, memory, and database records. For example, a database may restrict access for medical records to a specific database user, but each record might only be intended to be accessible to the patient and the patient's doctor.

**Mitigation 3:**
- **Phase:** Architecture and Design
- **Strategy:** Libraries or Frameworks
- **Description:** 

Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.


For example, consider using authorization frameworks such as the JAAS Authorization Framework [REF-233] and the OWASP ESAPI Access Control feature [REF-45].





### Observed Examples
- **CVE-2022-24730:** Go-based continuous deployment product does not check that a user has certain privileges to update or create an app, allowing adversaries to read sensitive repository information
- **CVE-2009-3168:** Web application does not restrict access to admin scripts, allowing authenticated users to reset administrative passwords.
- **CVE-2009-2960:** Web application does not restrict access to admin scripts, allowing authenticated users to modify passwords of other users.

