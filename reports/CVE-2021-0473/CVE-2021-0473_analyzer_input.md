# Vulnerability Information: CVE-2021-0473

## Vulnerability Description
In rw_t3t_process_error of rw_t3t.cc, there is a possible **double free** due to **uninitialized data**. This could lead to remote code execution over NFC with no additional execution privileges needed. User interaction is not needed for exploitation.Product AndroidVersions Android-9 Android-10 Android-11 Android-8.1Android ID A-179687208

### Vulnerability Description Key Phrases
- **rootcause:** **uninitialized data**
- **weakness:** **double free**
- **impact:** remote code execution
- **product:** Android
- **version:** ['9', '10', '11', '8.1']
- **component:** rw_t3t_process_error of rw_t3t.cc

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-0473:

**Root Cause of Vulnerability:**
The vulnerability lies within the NFC (Near Field Communication) T3T tag handling component in the Android system. The commit message mentions "Memory Disclosure, OOB Write, and Double Free". This indicates memory corruption issues, specifically:
  - Memory Disclosure: Information leakage due to improper memory handling.
  - Out-of-Bounds Write (OOB Write): Writing data outside the allocated memory buffer, which can overwrite adjacent memory regions.
  - Double Free: Attempting to free the same memory location more than once.

**Weaknesses/Vulnerabilities Present:**
- Memory corruption due to improper handling of NFC T3T tags.
- Potential for out-of-bounds writes.
- Double free vulnerability.
- Memory disclosure, possibly leaking sensitive information.

**Impact of Exploitation:**
- **Remote Code Execution (RCE):** The vulnerability could enable a remote attacker to execute arbitrary code within the context of a privileged process. This means an attacker could potentially gain full control of the affected device.
- Memory Corruption: OOB write can lead to crashes, unexpected behavior or further exploitation.
- Information Disclosure: Memory disclosure may leak sensitive data, like keys or tokens.
- Denial of Service: A double free can cause a crash, leading to a denial of service.

**Attack Vectors:**
- The attack vector is through a specially crafted file related to NFC T3T tags. This suggests that a malicious NFC tag or a file containing malicious T3T tag data is used to trigger the vulnerability.
- The vulnerability is triggered when the system processes this crafted file via NFC.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to provide the specially crafted file, which is related to NFC T3T tags, to the target device.
- The attacker needs to be able to cause the device to process the malicious NFC T3T tag file.
- A remote attacker, possibly someone close enough to use NFC.

**Additional Notes:**

- This vulnerability is considered "Critical", highlighting the severity of the risk.
- The vulnerability impacts Android versions 8.1, 9, 10 and 11.
- The fix is present in the AOSP commit linked in the bulletin.

This information is more detailed than the placeholder description in the original CVE.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 1.0050 | dense, sparse, graph | dense: 0.580, sparse: 0.625, graph: 1.000 |
| 2 | CWE-415 | Double Free | Variant | Allowed | 0.7910 | dense, sparse, graph | dense: 0.605, sparse: 0.504, graph: 0.744 |
| 3 | CWE-416 | Use After Free | Variant | Allowed | 0.7544 | dense, sparse, graph | dense: 0.547, sparse: 0.453, graph: 0.795 |
| 4 | CWE-413 | Improper Resource Locking | Base | Allowed | 0.7314 | dense, sparse, graph | dense: 0.552, sparse: 0.430, graph: 0.585 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.5369 | dense, sparse | dense: 0.552, sparse: 0.456 |
| 6 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.5347 | dense, sparse | dense: 0.548, sparse: 0.455 |
| 7 | CWE-248 | Uncaught Exception | Base | Allowed | 0.5173 | dense, sparse | dense: 0.543, sparse: 0.430 |
| 8 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.4593 | dense, sparse, graph | dense: 0.599, sparse: 0.445, graph: 0.636 |
| 9 | CWE-927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | 0.3755 | dense, sparse | dense: 0.531, sparse: 0.246 |
| 10 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.3223 | dense, sparse | dense: 0.541, sparse: 0.486 |

