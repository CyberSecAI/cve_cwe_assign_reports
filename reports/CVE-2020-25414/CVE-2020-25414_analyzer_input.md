# Vulnerability Information: CVE-2020-25414

## Vulnerability Description
A **local file inclusion** vulnerability was discovered in the captcha function in Monstra 3.0.4 which allows remote attackers to execute arbitrary PHP code.

### Vulnerability Description Key Phrases
- **rootcause:** **local file inclusion**
- **impact:** execute arbitrary PHP code
- **attacker:** remote attackers
- **product:** Monstra
- **version:** 3.0.4
- **component:** captcha function

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the `cryptographp.inc.php` file directly including a file path provided by the user through the `cfg` GET parameter without proper sanitization or validation.

**Weaknesses/Vulnerabilities:**

*   **Local File Inclusion (LFI):** The primary vulnerability is LFI. The application takes user-supplied input (the `cfg` parameter) and uses it to include a file on the server, allowing attackers to potentially include files outside the intended directory.
*   **Unvalidated Input:** The code directly uses `$_GET['cfg']` to set the `$_SESSION['configfile']` variable, which is then directly used in an `include` statement. There's no check to ensure that the provided value points to a valid configuration file or that it stays within an allowed path.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** By including files with PHP code, such as a custom `phpinfo.txt` or even web server access logs, an attacker can execute arbitrary PHP code on the server. This can allow the attacker to compromise the entire system.
*   **Information Disclosure:** Attackers can include any file on the server accessible by the web server user, which can lead to the disclosure of sensitive information such as configuration files, database credentials, or source code.

**Attack Vectors:**

*   **HTTP GET Request:** The attack vector is an HTTP GET request where the `cfg` parameter is manipulated to include a malicious file.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable application.
*   **No Authentication Required:** The vulnerability is present in a publicly accessible part of the application, requiring no authentication.
*   **Knowledge of File Paths:** While not strictly necessary, knowledge of specific file paths on the server can help an attacker achieve code execution (e.g., knowing the path to web server logs).

**Additional Notes:**

*   The provided examples showcase how to include a simple `phpinfo.txt` file and also how to include the Apache webserver access logs. This demonstrates the potential for information leakage or code injection through the log file if it contains injected php code.
*   The vulnerability is specifically present in Monstra CMS version 3.0.4 and earlier.
*   The file `plugins\captcha\crypt\cryptographp.inc.php` is the vulnerable file in Monstra CMS.

The provided information is more detailed than a typical CVE description, giving a concrete example with attack vectors and demonstrating impact.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | 0.6290 | dense, sparse, graph | dense: 0.563, sparse: 0.177, graph: 0.834 |
| 2 | CWE-96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | 0.5893 | dense, sparse, graph | dense: 0.602, sparse: 0.122, graph: 0.610 |
| 3 | CWE-829 | Inclusion of Functionality from Untrusted Control Sphere | Base | Allowed | 0.5484 | dense, sparse, graph | dense: 0.512, sparse: 0.127, graph: 0.613 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5419 | dense, sparse, graph | dense: 0.508, sparse: 0.108, graph: 0.631 |
| 5 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.5261 | dense, sparse, graph | dense: 0.515, sparse: 0.114, graph: 0.569 |
| 6 | CWE-36 | Absolute Path Traversal | Base | Allowed | 0.3147 | dense, sparse | dense: 0.513, sparse: 0.101 |
| 7 | CWE-24 | Path Traversal: '../filedir' | Variant | Allowed | 0.3102 | dense, sparse | dense: 0.532, sparse: 0.122 |
| 8 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | 0.3046 | dense, sparse | dense: 0.544, sparse: 0.101 |
| 9 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.2858 | sparse, graph | sparse: 0.119, graph: 0.609 |
| 10 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.2843 | sparse, graph | sparse: 0.106, graph: 0.664 |

