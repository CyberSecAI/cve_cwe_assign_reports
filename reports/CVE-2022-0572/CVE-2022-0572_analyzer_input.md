# Vulnerability Information: CVE-2022-0572

## Vulnerability Description
**Heap-based Buffer Overflow** in GitHub repository vim/vim prior to 8.2.

### Vulnerability Description Key Phrases
- **weakness:** **Heap-based Buffer Overflow**
- **product:** vim
- **version:** prior to 8.2

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 20)
- CWE-122 (Count: 18)

## CVE Reference Links Content Summary
```
{
  "guidelines": [
    "1. First verify if the content relates to the CVE specified based on the official description",
    "2. If the content does not relate to this CVE, respond with \"UNRELATED\"",
    "3. If no useful vulnerability information is found, respond with \"NOINFO\"",
    "4. For relevant content, extract:",
    "   - Root cause of vulnerability",
    "   - Weaknesses/vulnerabilities present",
    "   - Impact of exploitation",
    "   - Attack vectors",
    "   - Required attacker capabilities/position",
    "",
    "Additional instructions:",
    "- Preserve original technical details and descriptions",
    "- Remove unrelated content",
    "- Translate non-English content to English",
    "- Note if the content provides more detail than the official CVE description"
  ],
  "response": [
    {
      "source": "github.com_6f2974a4_20250108_125743.html",
      "is_relevant": true,
      "vulnerability": {
        "root_cause": "The vulnerability lies in the `:retab` command of Vim. When repeatedly using the `:retab` command, the line could become excessively long, exceeding the maximum allowed column, leading to a crash.",
        "weaknesses": [
          "Heap overflow"
        ],
        "impact": "Crash of the application.",
        "attack_vectors": ":retab command",
        "attacker_capabilities": "User must be able to execute vim commands.",
        "details": "The patch introduces a check to bail out when the line gets too long. Specifically, it adds a check within the `ex_retab` function in `src/indent.c` to see if the calculated virtual column `vcol` exceeds `MAXCOL`. If it does, the function displays an error message `emsg(_(e_resulting_text_too_long))` and breaks the loop."
      }
    },
    {
      "source": "seclists.org_a74b06bd_20250108_125743.html",
      "is_relevant": true,
        "vulnerability": {
        "root_cause": "Multiple issues in Vim.",
        "weaknesses": [
          "Multiple unspecified vulnerabilities"
        ],
        "impact": "Multiple issues were addressed by updating Vim.",
        "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
        "details": "This document lists CVE-2022-0572 as one of multiple vulnerabilities addressed by updating Vim."
      }
    },
    {
      "source": "support.apple.com_dda8084e_20250108_125747.html",
        "is_relevant": true,
        "vulnerability": {
        "root_cause": "Multiple issues in Vim.",
        "weaknesses": [
          "Multiple unspecified vulnerabilities"
        ],
         "impact": "Multiple issues were addressed by updating Vim.",
        "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
        "details": "This document lists CVE-2022-0572 as one of multiple vulnerabilities addressed by updating Vim."
      }
    },
    {
      "source": "lists.debian.org_4b387973_20250108_125744.html",
      "is_relevant": true,
        "vulnerability": {
        "root_cause": "Multiple security vulnerabilities have been discovered in vim, an enhanced vi editor. Buffer overflows, out-of-bounds reads and use-after-free may lead to a denial-of-service (application crash) or other unspecified impact.",
        "weaknesses": [
          "Buffer overflows",
          "Out-of-bounds reads",
          "Use-after-free"
        ],
         "impact": "Denial-of-service (application crash) or other unspecified impact.",
        "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
         "details": "CVE-2022-0572 is listed as one of the vulnerabilities addressed in this security update for vim."
       }
    },
    {
      "source": "seclists.org_c2ef64c5_20250108_125742.html",
     "is_relevant": true,
        "vulnerability": {
        "root_cause": "Multiple issues in Vim.",
         "weaknesses": [
          "Multiple unspecified vulnerabilities"
        ],
        "impact": "Multiple issues were addressed by updating Vim.",
        "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
         "details": "This document lists CVE-2022-0572 as one of multiple vulnerabilities addressed by updating Vim."
      }
    },
     {
      "source": "lists.debian.org_7dba5273_20250108_125744.html",
      "is_relevant": true,
        "vulnerability": {
        "root_cause": "Multiple security vulnerabilities have been discovered in vim, an enhanced vi editor. Buffer overflows, out-of-bounds reads and use-after-free may lead to a denial-of-service (application crash) or other unspecified impact.",
         "weaknesses": [
          "Buffer overflows",
          "Out-of-bounds reads",
          "Use-after-free"
        ],
        "impact": "Denial-of-service (application crash) or other unspecified impact.",
        "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
        "details": "CVE-2022-0572 is listed as one of the vulnerabilities addressed in this security update for vim."
      }
    },
    {
      "source": "lists.fedoraproject.org_75b03b35_20250108_125745.html",
       "is_relevant": true,
        "vulnerability": {
        "root_cause": "Heap overflow in ex_retab().",
        "weaknesses": [
          "Heap overflow"
        ],
        "impact": "Crash of application.",
         "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
        "details":"The newest upstream commit provides a security fix for CVE-2022-0572. The vulnerability is a heap overflow in ex_retab(), which may lead to a crash."
      }
    },
    {
      "source": "huntr.dev_6c3ab49c_20250108_125744.html",
      "is_relevant": false,
      "vulnerability": null
    },
     {
      "source": "lists.fedoraproject.org_e1e974ac_20250108_125746.html",
      "is_relevant": true,
        "vulnerability": {
        "root_cause": "Multiple security issues in vim.",
        "weaknesses": [
          "Use of Out-of-range Pointer Offset",
          "Heap overflow",
		  "Stack-based Buffer Overflow",
		  "NULL Pointer Dereference",
		  "Use after free",
		  "Out-of-bounds read"
        ],
         "impact": "Unspecified, potentially including application crash.",
         "attack_vectors": "Unspecified.",
        "attacker_capabilities": "Unspecified.",
        "details": "This update includes security fixes for multiple CVEs including CVE-2022-0572, which is described as a heap overflow in ex_retab() that may lead to a crash."
      }
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.5833 | dense, sparse, graph | dense: 0.572, sparse: 0.130, graph: 0.623 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4803 | dense, sparse, graph | dense: 0.509, sparse: 0.106, graph: 0.462 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4753 | dense, sparse, graph | dense: 0.531, sparse: 0.108, graph: 0.413 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4731 | dense, sparse, graph | dense: 0.492, sparse: 0.084, graph: 0.563 |
| 5 | CWE-786 | Access of Memory Location Before Start of Buffer | Base | Discouraged | 0.4115 | dense, sparse, graph | dense: 0.556, sparse: 0.114, graph: 0.622 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3432 | dense, sparse | dense: 0.571, sparse: 0.150 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3403 | dense, sparse | dense: 0.574, sparse: 0.142 |
| 8 | CWE-839 | Numeric Range Comparison Without Minimum Check | Base | Allowed | 0.3312 | sparse, graph | sparse: 0.086, graph: 0.789 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3012 | dense, sparse | dense: 0.501, sparse: 0.088 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.2960 | dense, sparse | dense: 0.491, sparse: 0.088 |

