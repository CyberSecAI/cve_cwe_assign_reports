# Vulnerability Information: CVE-2021-27306

## Vulnerability Description
An **improper access control** vulnerability in the JWT plugin in Kong Gateway prior to 2.3.2.0 allows unauthenticated users access to authenticated routes without a valid token JWT.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access control**
- **impact:** access to authenticated routes without a valid token JWT
- **attacker:** unauthenticated users
- **product:** Kong Gateway
- **version:** prior to 2.3.2.0
- **component:** JWT plugin

## CVE Reference Links Content Summary
```json
{
  "0": {
    "Root cause of vulnerability": "Kong API Gateway prior to 2.3.2.0 does not normalize the incoming request URI before matching against the Router. This allowed an attacker to bypass authentication by using an unauthenticated route with a path traversal.",
    "Weaknesses/vulnerabilities present": "Path traversal vulnerability, authentication bypass, and incorrect subroute inheritance.",
    "Impact of exploitation": "Access to an authenticated route without proper authentication.",
    "Attack vectors": "Sending a request to an unauthenticated route with a path traversal like `public/../api/v1/customers`.",
    "Required attacker capabilities/position": "The attacker needs to be able to send requests to a Kong API Gateway that uses the JWT plugin and has an unauthenticated route. Also, the attacker requires a service or proxy in the middle which normalizes the path and send the request to the application."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5631 | dense, sparse, graph | dense: 0.523, sparse: 0.144, graph: 0.613 |
| 2 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.3862 | sparse, graph | sparse: 0.155, graph: 0.832 |
| 3 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.3342 | dense, sparse | dense: 0.501, sparse: 0.145 |
| 4 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.3296 | dense, sparse | dense: 0.499, sparse: 0.139 |
| 5 | CWE-807 | Reliance on Untrusted Inputs in a Security Decision | Base | Allowed | 0.2999 | sparse, graph | sparse: 0.162, graph: 0.580 |
| 6 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2824 | dense, sparse, graph | dense: 0.508, sparse: 0.157, graph: 0.382 |
| 7 | CWE-57 | Path Equivalence: 'fakedir/../realdir/filename' | Variant | Allowed | 0.2613 | sparse, graph | sparse: 0.227, graph: 0.429 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2222 | dense, sparse, graph | dense: 0.515, sparse: 0.177, graph: 0.384 |
| 9 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.1953 | dense, sparse | dense: 0.509, sparse: 0.136 |
| 10 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1934 | dense, sparse | dense: 0.493, sparse: 0.145 |

