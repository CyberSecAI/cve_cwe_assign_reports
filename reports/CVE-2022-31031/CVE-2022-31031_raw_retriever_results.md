# Raw Retriever Results for CVE-2022-31031

# Raw Retriever Results for CVE-2022-31031

## Query
PJSIP is a free and open source multimedia communication library written in C language implementing standard based protocols such as SIP, SDP, RTP, STUN, TURN, and ICE. In versions prior to and including 2.12.1 a stack buffer overflow vulnerability affects PJSIP users that use STUN in their applications, either by setting a STUN server in their account/media config in PJSUA/PJSUA2 level, or directly using `pjlib-util/stun_simple` API. A patch is available in commit 450baca which should be included in the next release. There are no known workarounds for this issue.

## Keyphrases
- **weakness**: stack buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4202 | 0.5021 | 0.4520 | 0.4470 | 20 |
| Sparse | 393.7706 | 563.9026 | 445.5287 | 434.2686 | 20 |
| Graph | 1.5164 | 2.7014 | 1.9191 | 1.8410 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 123 | Write-what-where Condition | base | 2.7014 | Allowed |
| 2 | 476 | NULL Pointer Dereference | base | 2.4232 | Allowed |
| 3 | 364 | Signal Handler Race Condition | base | 2.2100 | Allowed |
| 4 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 5 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 6 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 7 | 415 | Double Free | variant | 2.1720 | Allowed |
| 8 | 416 | Use After Free | Variant | 2.1492 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.8945 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.8871 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.7949 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | 1.7357 | Allowed-with-Review |
| 14 | 126 | Buffer Over-read | Variant | 1.6766 | Allowed |
| 15 | 823 | Use of Out-of-range Pointer Offset | base | 1.6016 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | 0.5021 | 0.5021 | Allowed |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4935 | 0.4935 | Allowed |
| 3 | 416 | Use After Free | Variant | 0.4754 | 0.4754 | Allowed |
| 4 | 122 | Heap-based Buffer Overflow | Variant | 0.4733 | 0.4733 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4690 | 0.4690 | Allowed |
| 6 | 674 | Uncontrolled Recursion | Class | 0.4669 | 0.4669 | Allowed-with-Review |
| 7 | 126 | Buffer Over-read | Variant | 0.4630 | 0.4630 | Allowed |
| 8 | 190 | Integer Overflow or Wraparound | Base | 0.4560 | 0.4560 | Allowed |
| 9 | 346 | Origin Validation Error | Class | 0.4539 | 0.4539 | Allowed-with-Review |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4475 | 0.4475 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 0.4466 | 0.4466 | Allowed-with-Review |
| 12 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | 0.4460 | 0.4460 | Allowed-with-Review |
| 13 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4423 | 0.4423 | Allowed |
| 14 | 676 | Use of Potentially Dangerous Function | Base | 0.4362 | 0.4362 | Allowed |
| 15 | 400 | Uncontrolled Resource Consumption | Class | 0.4356 | 0.4356 | Discouraged |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-126 | Buffer Over-read | 563.9026 | 563.9026 | Allowed |
| 2 | CWE-754 | Improper Check for Unusual or Exceptional Conditions | 525.1636 | 525.1636 | Allowed-with-Review |
| 3 | CWE-667 | Improper Locking | 505.1984 | 505.1984 | Allowed-with-Review |
| 4 | CWE-121 | Stack-based Buffer Overflow | 495.5877 | 495.5877 | Allowed |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | 493.4426 | 493.4426 | Allowed |
| 6 | CWE-770 | Allocation of Resources Without Limits or Throttling | 463.2841 | 463.2841 | Allowed |
| 7 | CWE-674 | Uncontrolled Recursion | 450.6038 | 450.6038 | Allowed-with-Review |
| 8 | CWE-193 | Off-by-one Error | 444.2549 | 444.2549 | Allowed |
| 9 | CWE-789 | Memory Allocation with Excessive Size Value | 437.2775 | 437.2775 | Allowed |
| 10 | CWE-190 | Integer Overflow or Wraparound | 436.7992 | 436.7992 | Allowed |
| 11 | CWE-125 | Out-of-bounds Read | 431.7379 | 431.7379 | Allowed |
| 12 | CWE-122 | Heap-based Buffer Overflow | 428.2083 | 428.2083 | Allowed |
| 13 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 423.7097 | 423.7097 | Allowed |
| 14 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 406.6067 | 406.6067 | Allowed |
| 15 | CWE-863 | Incorrect Authorization | 405.5896 | 405.5896 | Allowed-with-Review |
