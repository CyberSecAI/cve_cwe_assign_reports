# Vulnerability Information: CVE-2021-21506

## Vulnerability Description
PowerScale OneFS 8.1.2,8.2.2 and 9.1.0 contains an **improper input sanitization** issue in its API handler. An un-authtenticated with ISI_PRIV_SYS_SUPPORT and ISI_PRIV_LOGIN_PAPI privileges could potentially exploit this vulnerability, leading to potential privileges escalation.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input sanitization**
- **impact:** privileges escalation
- **attacker:** unauthenticated attacker with ISI_PRIV_SYS_SUPPORT and ISI_PRIV_LOGIN_PAPI privileges
- **product:** PowerScale OneFS
- **version:** 8.1.2, 8.2.2 and 9.1.0
- **component:** API handler

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "CVE-2021-21506": {
      "root_cause": "improper use of validation framework vulnerability",
      "weaknesses": "A vulnerability in the API.",
      "impact": "Privilege escalation",
      "attack_vectors": "Remote",
      "required_capabilities": "A remote user with ISI_PRIV_LOGIN_PAPI and ISI_PRIV_SYS_SUPPORT privileges"
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.7182 | dense, sparse, graph | dense: 0.562, sparse: 0.139, graph: 1.000 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5813 | dense, sparse, graph | dense: 0.554, sparse: 0.158, graph: 0.597 |
| 3 | CWE-274 | Improper Handling of Insufficient Privileges | Base | Discouraged | 0.4964 | dense, sparse, graph | dense: 0.561, sparse: 0.159, graph: 0.869 |
| 4 | CWE-1173 | Improper Use of Validation Framework | Base | Allowed | 0.4837 | sparse, graph | sparse: 0.294, graph: 0.882 |
| 5 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.3106 | sparse, graph | sparse: 0.148, graph: 0.631 |
| 6 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2705 | dense, sparse, graph | dense: 0.576, sparse: 0.156, graph: 0.634 |
| 7 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2142 | dense, sparse | dense: 0.559, sparse: 0.148 |
| 8 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1710 | dense, sparse | dense: 0.594, sparse: 0.149 |
| 9 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1609 | dense, sparse | dense: 0.555, sparse: 0.143 |
| 10 | CWE-285 | Improper Authorization | Class | Discouraged | 0.1578 | dense, sparse | dense: 0.546, sparse: 0.139 |

