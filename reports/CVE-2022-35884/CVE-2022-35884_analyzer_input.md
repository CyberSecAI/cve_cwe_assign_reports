# Vulnerability Information: CVE-2022-35884

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the web interface /action/wirelessConnect functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9Z and 6.9X. A specially-crafted HTTP request can lead to memory corruption, information disclosure and denial of service. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.This vulnerability arises from **format string injection** via the `ssid_hex` HTTP parameter, as used within the `/action/wirelessConnect` handler.

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9Z and 6.9X
- **component:** /action/wirelessConnect functionality

## CVE Reference Links Content Summary
The provided content is a vulnerability report from Cisco Talos detailing four format string injection vulnerabilities in the Abode Systems, Inc. iota All-In-One Security Kit web interface. Specifically, CVE-2022-35884 is one of the four vulnerabilities described.

**CVE-2022-35884 Details:**

*   **Root Cause:** The vulnerability stems from a format string injection flaw in the `web_wireless_connect` function of the device's web interface. Specifically, the `ssid_hex` parameter, which is intended to set the Wi-Fi SSID, is used in an `snprintf` function to create an OS command. This command is then passed as the `format` argument to a logging function, `log`, which uses `vsnprintf`. This allows an attacker to control the format string passed to `vsnprintf`.
*   **Weaknesses/Vulnerabilities:** The primary vulnerability is the use of an attacker-controlled string as the format string in `vsnprintf`. This is a classic format string vulnerability (CWE-134).
*   **Impact of Exploitation:**  Exploitation of this vulnerability can lead to:
    *   **Memory Corruption:** By crafting a specific format string, an attacker could potentially overwrite arbitrary memory locations.
    *   **Information Disclosure:** By utilizing format specifiers like `%x`, an attacker can leak stack memory, potentially exposing sensitive information.
    *   **Denial of Service (DoS):** Malicious format strings might cause the application to crash or behave unpredictably, leading to a denial of service.
*  **Attack Vectors:**
    *   The vulnerability is triggered by sending an HTTP request to the `/action/wirelessConnect` endpoint.
    *   The `ssid_hex` parameter must be included in the request, containing the malicious format string.
*   **Required Attacker Capabilities/Position:**
    *   The attacker must have network access to the device's web interface.
    *   The web interface must be enabled. It is disabled by default, but it can be re-enabled using other vulnerabilities.
    *  The attacker must be authenticated to make the request, as the `web_wireless_connect` function is not accessible without a valid session.

**Additional Details:**
*   The report clarifies that the output from this format string injection would only be visible to a physically present attacker who has accessed the device's UART console. This means that while the vulnerability is exploitable via the network, the direct impact (memory corruption/information disclosure) will only be directly seen locally unless some other vulnerability is used to exfiltrate this.

The content provides more detail than the typical CVE description, including the exact vulnerable code location, function names, and parameters, as well as examples of how to trigger the vulnerability. It also explicitly mentions the other related vulnerabilities (CVE-2022-35885, CVE-2022-35886, CVE-2022-35887) and the methods to enable the web interface (TALOS-2022-1552 and TALOS-2022-1553).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.0513 | dense, sparse, graph | dense: 0.711, sparse: 0.818, graph: 0.636 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7185 | dense, sparse, graph | dense: 0.613, sparse: 0.342, graph: 0.604 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5667 | sparse, graph | sparse: 0.366, graph: 1.000 |
| 4 | CWE-1287 | Improper Validation of Specified Type of Input | Base | Allowed | 0.4976 | sparse, graph | sparse: 0.319, graph: 0.882 |
| 5 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4593 | dense, sparse | dense: 0.560, sparse: 0.313 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4411 | dense, sparse | dense: 0.573, sparse: 0.306 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4291 | dense, sparse | dense: 0.585, sparse: 0.301 |
| 8 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3843 | sparse, graph | sparse: 0.317, graph: 0.568 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2103 | dense, sparse | dense: 0.563, sparse: 0.329 |
| 10 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1792 | sparse | sparse: 0.313 |

