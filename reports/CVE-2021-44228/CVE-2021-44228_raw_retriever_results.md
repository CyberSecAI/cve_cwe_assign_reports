# Raw Retriever Results for CVE-2021-44228

# Raw Retriever Results for CVE-2021-44228

## Query
Apache Log4j2 2.0-beta9 through 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1) JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled. From log4j 2.15.0, this behavior has been disabled by default. From version 2.16.0 (along with 2.12.2, 2.12.3, and 2.3.1), this functionality has been completely removed. Note that this vulnerability is specific to log4j-core and does not affect log4net, log4cxx, or other Apache Logging Services projects.

## Keyphrases
- **rootcause**: improper input validation

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4465 | 0.5424 | 0.4654 | 0.4545 | 20 |
| Sparse | 526.8709 | 1060.9113 | 577.5637 | 550.3446 | 20 |
| Graph | 1.4805 | 2.2100 | 1.7853 | 1.7208 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | base | 2.2100 | Allowed |
| 2 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 3 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 5 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 6 | 117 | Improper Output Neutralization for Logs | Base | 1.8913 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 1.8852 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 10 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 11 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 12 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 13 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.6200 | Allowed |
| 14 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 1.6084 | Allowed |
| 15 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.5424 | 0.5424 | Allowed |
| 2 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.5053 | 0.5053 | Allowed |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | 0.5009 | 0.5009 | Allowed |
| 4 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.4782 | 0.4782 | Allowed |
| 5 | 117 | Improper Output Neutralization for Logs | Base | 0.4750 | 0.4750 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4692 | 0.4692 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | Base | 0.4638 | 0.4638 | Allowed |
| 8 | 285 | Improper Authorization | Class | 0.4597 | 0.4597 | Discouraged |
| 9 | 863 | Incorrect Authorization | Class | 0.4551 | 0.4551 | Allowed-with-Review |
| 10 | 862 | Missing Authorization | Class | 0.4547 | 0.4547 | Allowed-with-Review |
| 11 | 256 | Plaintext Storage of a Password | Base | 0.4543 | 0.4543 | Allowed |
| 12 | 284 | Improper Access Control | Pillar | 0.4539 | 0.4539 | Discouraged |
| 13 | 287 | Improper Authentication | Class | 0.4533 | 0.4533 | Discouraged |
| 14 | 250 | Execution with Unnecessary Privileges | Base | 0.4524 | 0.4524 | Allowed |
| 15 | 522 | Insufficiently Protected Credentials | Class | 0.4506 | 0.4506 | Allowed-with-Review |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | 1060.9113 | 1060.9113 | Allowed |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 589.2713 | 589.2713 | Allowed |
| 3 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 579.1054 | 579.1054 | Allowed |
| 4 | CWE-863 | Incorrect Authorization | 576.9165 | 576.9165 | Allowed-with-Review |
| 5 | CWE-287 | Improper Authentication | 576.6149 | 576.6149 | Discouraged |
| 6 | CWE-116 | Improper Encoding or Escaping of Output | 569.3422 | 569.3422 | Allowed-with-Review |
| 7 | CWE-1390 | Weak Authentication | 563.4600 | 563.4600 | Allowed-with-Review |
| 8 | CWE-306 | Missing Authentication for Critical Function | 562.5235 | 562.5235 | Allowed |
| 9 | CWE-532 | Insertion of Sensitive Information into Log File | 558.6232 | 558.6232 | Allowed |
| 10 | CWE-285 | Improper Authorization | 556.5541 | 556.5541 | Discouraged |
| 11 | CWE-639 | Authorization Bypass Through User-Controlled Key | 544.1352 | 544.1352 | Allowed |
| 12 | CWE-74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 541.4539 | 541.4539 | Discouraged |
| 13 | CWE-1333 | Inefficient Regular Expression Complexity | 540.7567 | 540.7567 | Allowed |
| 14 | CWE-732 | Incorrect Permission Assignment for Critical Resource | 540.0266 | 540.0266 | Allowed-with-Review |
| 15 | CWE-319 | Cleartext Transmission of Sensitive Information | 536.5660 | 536.5660 | Allowed |
