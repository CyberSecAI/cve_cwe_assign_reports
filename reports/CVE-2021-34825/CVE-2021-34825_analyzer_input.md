# Vulnerability Information: CVE-2021-34825

## Vulnerability Description
Quassel through 0.13.1, when --require-ssl is enabled, launches without SSL or TLS support if a usable X.509 certificate is not found on the local system.

### Vulnerability Description Key Phrases
- **impact:** launches without SSL or TLS support
- **product:** Quassel
- **version:** through 0.13.1

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described in CVE-2021-34825:

**Root Cause of Vulnerability:**

- The Quassel IRC client, when launched with the `--require-ssl` flag but unable to load an SSL/TLS certificate (due to the file not existing, incorrect permissions, or invalid certificate content), would fall back to plaintext mode instead of terminating.

**Weaknesses/Vulnerabilities Present:**

- **Insecure fallback:** The core's behavior of falling back to plaintext when SSL/TLS is required creates a vulnerability. It fails to enforce the desired encrypted connection, potentially exposing user data to eavesdropping.
- **Lack of proper error handling:** The lack of an explicit error and termination when the certificate cannot be loaded masked the security issue, only giving a minor warning on the console.
- **Misleading warnings:** Clients connecting to a vulnerable core would only receive a standard "Unencrypted Connection" warning, which might not be noticed by the user.

**Impact of Exploitation:**

- **Man-in-the-middle (MitM) attacks:** An attacker positioned between the client and the core could eavesdrop on communication due to the lack of encryption. This would expose sensitive data such as IRC credentials, chat messages and other user-related data.

**Attack Vectors:**

- The vulnerability is triggered by launching the Quassel core with the `--require-ssl` flag while not having a valid SSL/TLS certificate in place.
- An attacker needs to be in a network position to eavesdrop on unencrypted traffic between the client and the core.

**Required Attacker Capabilities/Position:**

- The attacker must have network access to the unencrypted connection between the Quassel client and server. No prior authentication or user interaction is required to exploit the vulnerability beyond a plaintext connection being established due to the misconfiguration.

**Additional Details:**

- The fix implemented in pull request #581 ensures that the Quassel core now terminates with an error if `--require-ssl` is specified but a certificate cannot be loaded.
- This change is considered a potential breaking change because it turns a previous warning into a fatal error, requiring users to fix certificate issues or remove the `--require-ssl` flag.
- The fix includes adding a link to the Quassel FAQ on how to set up SSL.
- The vulnerability is triggered during the startup of the Quassel core process.
- The fix prevents the Quassel core from falling back to plaintext mode and enforces encrypted connections when required via the `--require-ssl` flag.
- The fix also introduces a new translatable string for the error message.
- The core's exit message will not be shown if logging is set to a file.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.4305 | dense, sparse, graph | dense: 0.359, sparse: 0.044, graph: 0.631 |
| 2 | CWE-1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | 0.4163 | dense, sparse, graph | dense: 0.360, sparse: 0.037, graph: 0.601 |
| 3 | CWE-297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | 0.4033 | dense, sparse, graph | dense: 0.377, sparse: 0.036, graph: 0.636 |
| 4 | CWE-208 | Observable Timing Discrepancy | Base | Allowed | 0.3785 | sparse, graph | sparse: 0.037, graph: 1.000 |
| 5 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.3287 | sparse, graph | sparse: 0.039, graph: 0.857 |
| 6 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.2385 | sparse, graph | sparse: 0.055, graph: 0.579 |
| 7 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.1915 | dense, sparse, graph | dense: 0.338, sparse: 0.044, graph: 0.368 |
| 8 | CWE-400 | Uncontrolled Resource Consumption | Class | Discouraged | 0.0783 | sparse, graph | sparse: 0.040, graph: 0.426 |
| 9 | CWE-1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | 0.0217 | sparse | sparse: 0.038 |
| 10 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.0216 | sparse | sparse: 0.038 |

