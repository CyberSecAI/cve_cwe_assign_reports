# Vulnerability Information: CVE-2020-22784

## Vulnerability Description
In Etherpad UeberDB < 0.4.4, due to **MySQL omitting trailing spaces on char / varchar columns during comparisons**, retrieving database records using UeberDBs MySQL connector could allow bypassing access controls enforced on key names.

### Vulnerability Description Key Phrases
- **rootcause:** **MySQL omitting trailing spaces on char / varchar columns during comparisons**
- **impact:** bypass access controls
- **product:** Etherpad UeberDB
- **version:** < 0.4.4
- **component:** MySQL connector

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis related to the potential vulnerability:

**Root Cause of Vulnerability:**

The root cause is the use of `BINARY` in SQL queries without proper indexing, leading to performance issues. Specifically, the `BINARY` keyword forces a byte-by-byte comparison, which prevents the database from utilizing indexes on the `key` column, resulting in significantly slower queries.

**Weaknesses/Vulnerabilities Present:**

*   **Performance degradation:** The primary vulnerability is the performance degradation due to the `BINARY` keyword in SQL queries, particularly for `SELECT` queries. This impacts the `get` and `findKeys` functions of the database.
*   **Lack of Index Usage:** The use of `BINARY` in the `WHERE` clause prevents MySQL from using indexes, causing full table scans on large datasets.

**Impact of Exploitation:**

*   **Denial of Service:** On large databases, the slow query times can lead to timeouts and effectively cause a denial of service for applications relying on the database.
*   **Performance bottlenecks:** Applications using the database experience significant performance slowdowns.
*   **Service disruption:** The slow database queries disrupt normal functionality and responsiveness.

**Attack Vectors:**

*   An attacker doesn't need any special capabilities. The vulnerability lies in the way the database queries are constructed. Any interaction with the system that triggers these queries could expose the vulnerability.
*   The attack vector is the use of specific functions that utilize the database, particularly `get` and `findKeys` functions.

**Required Attacker Capabilities/Position:**

*   The attacker doesn't need any specific capabilities or position. The vulnerability is inherent in the code. The attacker needs to trigger the flawed database query, which is likely used in normal application operation.

**Additional Notes:**

*   The comments in the commit log indicate a fix was implemented by adding "AND BINARY `key` = ?", but the fix was still not correct.
*   The issue affects versions of `ueberDB` that use the problematic query pattern. It seems the issue was present in `ueberDB` versions prior to 0.4.9 and in Etherpad 1.8.3, which used `ueberDB` 0.4.5.
*  The conversation suggests the fix was to add an `AND` clause to make the query utilize the index.

In summary, while the commit is intended to fix an issue, it highlights the performance vulnerability caused by the improper use of `BINARY` in SQL queries, which can result in a denial of service under certain circumstances.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-41 | Improper Resolution of Path Equivalence | Base | Allowed | 0.4384 | sparse, graph | sparse: 0.141, graph: 1.000 |
| 2 | CWE-1393 | Use of Default Password | Base | Allowed | 0.3328 | sparse, graph | sparse: 0.109, graph: 0.757 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.2741 | sparse, graph | sparse: 0.085, graph: 0.631 |
| 4 | CWE-597 | Use of Wrong Operator in String Comparison | Variant | Allowed | 0.2347 | dense, sparse | dense: 0.408, sparse: 0.088 |
| 5 | CWE-697 | Incorrect Comparison | Pillar | Discouraged | 0.1437 | dense, sparse | dense: 0.390, sparse: 0.408 |
| 6 | CWE-625 | Permissive Regular Expression | Base | Allowed | 0.0520 | sparse | sparse: 0.091 |
| 7 | CWE-178 | Improper Handling of Case Sensitivity | Base | Allowed | 0.0513 | sparse | sparse: 0.090 |
| 8 | CWE-194 | Unexpected Sign Extension | Variant | Allowed | 0.0509 | sparse | sparse: 0.096 |
| 9 | CWE-297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | 0.0489 | sparse | sparse: 0.093 |
| 10 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.0482 | sparse | sparse: 0.091 |

