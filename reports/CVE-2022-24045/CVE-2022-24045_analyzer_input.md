# Vulnerability Information: CVE-2022-24045

## Vulnerability Description
A vulnerability has been identified in Desigo DXR2 (All versions < V01.21.142.5-22), Desigo PXC3 (All versions < V01.21.142.4-18), Desigo PXC4 (All versions < V02.20.142.10-10884), Desigo PXC5 (All versions < V02.20.142.10-10884). The application, after a successful login, sets the session cookie on the browser via client-side JavaScript code, without applying any security attributes (such as Secure, HttpOnly, or SameSite). Any attempts to browse the application via unencrypted HTTP protocol would lead to the transmission of all his/her session cookies in plaintext through the network. An attacker could then be able to sniff the network and capture sensitive information.

### Vulnerability Description Key Phrases
- **rootcause:** **missing security attributes on session cookie**
- **impact:** session cookies transmitted in plaintext
- **vector:** sniffing unencrypted HTTP traffic
- **attacker:** attacker
- **product:** Desigo DXR2 and Desigo PXC3 and Desigo PXC4 and Desigo PXC5
- **version:** All versions < V01.21.142.5-22 and All versions < V01.21.142.4-18 and All versions < V02.20.142.10-10884 and All versions < V02.20.142.10-10884

## CVE Reference Links Content Summary
Based on the provided document, here's the information regarding CVE-2022-24045:

**Root Cause of Vulnerability:**

The application sets the session cookie on the browser via client-side JavaScript code after a successful login, without applying security attributes.

**Weaknesses/Vulnerabilities Present:**

*   Lack of security attributes (like "Secure", "HttpOnly", or "SameSite") on session cookies.
*   The session cookies are set via client-side JavaScript.

**Impact of Exploitation:**

*   Session cookies can be transmitted in plaintext over the network when using unencrypted HTTP connections.
*   An attacker can intercept the unencrypted session cookies.
*   Captured session cookies can be used by the attacker for unauthorized access.

**Attack Vectors:**

*   Network sniffing of HTTP traffic.
*   Man-in-the-middle attacks on unencrypted HTTP connections.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be positioned on the network to sniff traffic or perform a man-in-the-middle attack.
*   The attacker must be on the same network or have the ability to intercept HTTP traffic between the client and the affected server/application.
*   The attacker needs the victim to connect via HTTP to be able to sniff the plaintext session cookies.
*   The attacker needs to be able to intercept the network traffic when a user successfully logs in.

**Additional Details:**

*   The document provides specific details about how the session cookie is set (via client-side Javascript) which is more specific than a generic description of cookie not being set with secure attributes.
*   The vulnerability is present in Desigo PXC and DXR devices.
* The CVSS v3.1 base score for this vulnerability is 6.5
* The corresponding CWE is CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | 0.7882 | dense, sparse | dense: 0.670, sparse: 0.906 |
| 2 | CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | 0.6197 | dense, sparse, graph | dense: 0.601, sparse: 0.406, graph: 0.388 |
| 3 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.5707 | sparse, graph | sparse: 0.624, graph: 0.598 |
| 4 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.5164 | dense, sparse | dense: 0.551, sparse: 0.421 |
| 5 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.4912 | dense, sparse | dense: 0.553, sparse: 0.375 |
| 6 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | 0.2956 | dense, sparse, graph | dense: 0.547, sparse: 0.440, graph: 0.377 |
| 7 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.2956 | dense, sparse | dense: 0.553, sparse: 0.396 |
| 8 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.2875 | dense, sparse | dense: 0.552, sparse: 0.373 |
| 9 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2242 | dense, sparse | dense: 0.551, sparse: 0.394 |
| 10 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.2216 | sparse | sparse: 0.387 |

