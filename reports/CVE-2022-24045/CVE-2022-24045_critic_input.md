# Critic Input for CVE-2022-24045



# Original Analyzer Input
## Vulnerability Description
A vulnerability has been identified in Desigo DXR2 (All versions < V01.21.142.5-22), Desigo PXC3 (All versions < V01.21.142.4-18), Desigo PXC4 (All versions < V02.20.142.10-10884), Desigo PXC5 (All versions < V02.20.142.10-10884). The application, after a successful login, sets the session cookie on the browser via client-side JavaScript code, without applying any security attributes (such as Secure, HttpOnly, or SameSite). Any attempts to browse the application via unencrypted HTTP protocol would lead to the transmission of all his/her session cookies in plaintext through the network. An attacker could then be able to sniff the network and capture sensitive information.

### Vulnerability Description Key Phrases
- **rootcause:** **missing security attributes on session cookie**
- **impact:** session cookies transmitted in plaintext
- **vector:** sniffing unencrypted HTTP traffic
- **attacker:** attacker
- **product:** Desigo DXR2 and Desigo PXC3 and Desigo PXC4 and Desigo PXC5
- **version:** All versions < V01.21.142.5-22 and All versions < V01.21.142.4-18 and All versions < V02.20.142.10-10884 and All versions < V02.20.142.10-10884

## CVE Reference Links Content Summary
Based on the provided document, here's the information regarding CVE-2022-24045:

**Root Cause of Vulnerability:**

The application sets the session cookie on the browser via client-side JavaScript code after a successful login, without applying security attributes.

**Weaknesses/Vulnerabilities Present:**

*   Lack of security attributes (like "Secure", "HttpOnly", or "SameSite") on session cookies.
*   The session cookies are set via client-side JavaScript.

**Impact of Exploitation:**

*   Session cookies can be transmitted in plaintext over the network when using unencrypted HTTP connections.
*   An attacker can intercept the unencrypted session cookies.
*   Captured session cookies can be used by the attacker for unauthorized access.

**Attack Vectors:**

*   Network sniffing of HTTP traffic.
*   Man-in-the-middle attacks on unencrypted HTTP connections.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be positioned on the network to sniff traffic or perform a man-in-the-middle attack.
*   The attacker must be on the same network or have the ability to intercept HTTP traffic between the client and the affected server/application.
*   The attacker needs the victim to connect via HTTP to be able to sniff the plaintext session cookies.
*   The attacker needs to be able to intercept the network traffic when a user successfully logs in.

**Additional Details:**

*   The document provides specific details about how the session cookie is set (via client-side Javascript) which is more specific than a generic description of cookie not being set with secure attributes.
*   The vulnerability is present in Desigo PXC and DXR devices.
* The CVSS v3.1 base score for this vulnerability is 6.5
* The corresponding CWE is CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | 0.7882 | dense, sparse | dense: 0.670, sparse: 0.906 |
| 2 | CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | 0.6197 | dense, sparse, graph | dense: 0.601, sparse: 0.406, graph: 0.388 |
| 3 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.5707 | sparse, graph | sparse: 0.624, graph: 0.598 |
| 4 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.5164 | dense, sparse | dense: 0.551, sparse: 0.421 |
| 5 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.4912 | dense, sparse | dense: 0.553, sparse: 0.375 |
| 6 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | 0.2956 | dense, sparse, graph | dense: 0.547, sparse: 0.440, graph: 0.377 |
| 7 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.2956 | dense, sparse | dense: 0.553, sparse: 0.396 |
| 8 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.2875 | dense, sparse | dense: 0.552, sparse: 0.373 |
| 9 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2242 | dense, sparse | dense: 0.551, sparse: 0.394 |
| 10 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.2216 | sparse | sparse: 0.387 |



# Analysis to Review
# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 1.0 | Variant | Allowed | Primary CWE. The application sets session cookies without the 'Secure' attribute, leading to potential plaintext transmission. |
| CWE-319 | Cleartext Transmission of Sensitive Information | 0.7 | Base | Allowed | Secondary CWE. Captures the general risk of transmitting sensitive information (session cookies) in cleartext over HTTP. |

## Evidence and Confidence

*   **Confidence Score:** 0.9
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**  
  - *Explanation:* "The vulnerability description clearly states that the application sets session cookies without applying the 'Secure' attribute, which leads to the transmission of cookies in plaintext when using HTTP. This aligns directly with CWE-614 (Sensitive Cookie in HTTPS Session Without 'Secure' Attribute). The CVE reference summary reinforces this by explicitly mentioning the lack of security attributes on session cookies as the root cause. Additionally, the summary notes that the corresponding CWE is CWE-614. While CWE-319 (Cleartext Transmission of Sensitive Information) is also relevant, CWE-614 is more specific and accurately reflects the **root cause** related to the **missing security attributes on the session cookie**. Both the vulnerability description and the CVE reference links content summary highlight this specific weakness. The retriever results also strongly suggest CWE-614 as the primary candidate."
  
  - *Relationship Analysis:* "CWE-614 is a variant-level CWE, providing a specific description of the vulnerability. It is related to CWE-319 (Cleartext Transmission of Sensitive Information) as the lack of the 'Secure' attribute leads to cleartext transmission. However, CWE-614 is a more precise description of the underlying issue. There are no direct relationships specified in the retriever results, but based on the vulnerability description, CWE-614 directly causes CWE-319 to be possible. Mapping guidance for CWE-614 indicates that its usage is ALLOWED."

- **Confidence Score:**  
  - Confidence: 0.9 (High evidence from technical description, CVE reference materials, and retriever results)

---

# CWE Examples from Database


## Known Examples for CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute
### Observed Examples
- **CVE-2004-0462** [https://www.cve.org/CVERecord?id=CVE-2004-0462](https://www.cve.org/CVERecord?id=CVE-2004-0462): A product does not set the Secure attribute for sensitive cookies in HTTPS sessions, which could cause the user agent to send those cookies in plaintext over an HTTP session with the product.
- **CVE-2008-3663** [https://www.cve.org/CVERecord?id=CVE-2008-3663](https://www.cve.org/CVERecord?id=CVE-2008-3663): A product does not set the secure flag for the session cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
- **CVE-2008-3662** [https://www.cve.org/CVERecord?id=CVE-2008-3662](https://www.cve.org/CVERecord?id=CVE-2008-3662): A product does not set the secure flag for the session cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
- **CVE-2008-0128** [https://www.cve.org/CVERecord?id=CVE-2008-0128](https://www.cve.org/CVERecord?id=CVE-2008-0128): A product does not set the secure flag for a cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
### Top 25 Examples
- **CVE-2021-35236**: The Secure flag is not set in the SSL Cookie of Kiwi Syslog Server 9.7.2 and previous versions. The Secure attribute tells the browser to only send the cookie if the request is being sent over a secure channel such as HTTPS. This will help protect the cookie from being passed over unencrypted requests. If the application can be accessed over both HTTP, there is a potential for the cookie can be sent in clear text.
- **CVE-2021-29883**: IBM Standards Processing Engine (IBM Transformation Extender Advanced 9.0 and 10.0) does not set the secure attribute on authorization tokens or session cookies. Attackers may be able to get the cookie values by sending a http:// link to a user or by planting this link in a site the user goes to. The cookie will be sent to the insecure link and the attacker can then obtain the cookie value by snooping the traffic. IBM X-Force ID: 207090.
- **CVE-2021-38977**: IBM Tivoli Key Lifecycle Manager 3.0, 3.0.1, 4.0, and 4.1 does not set the secure attribute on authorization tokens or session cookies. Attackers may be able to get the cookie values by sending a http:// link to a user or by planting this link in a site the user goes to. The cookie will be sent to the insecure link and the attacker can then obtain the cookie value by snooping the traffic. IBM X-Force ID: 212782.
- **CVE-2021-3882**: LedgerSMB does not set the 'Secure' attribute on the session authorization cookie when the client uses HTTPS and the LedgerSMB server is behind a reverse proxy. By tricking a user to use an unencrypted connection (HTTP), an attacker may be able to obtain the authentication data by capturing network traffic. LedgerSMB 1.8 and newer switched from Basic authentication to using cookie authentication with encrypted cookies. Although an attacker can't access the information inside the cookie, nor the password of the user, possession of the cookie is enough to access the application as the user from which the cookie has been obtained. In order for the attacker to obtain the cookie, first of all the server must be configured to respond to unencrypted requests, the attacker must be suitably positioned to eavesdrop on the network traffic between the client and the server *and* the user must be tricked into using unencrypted HTTP traffic. Proper audit control and separation of duties limit Integrity impact of the attack vector. Users of LedgerSMB 1.8 are urged to upgrade to known-fixed versions. Users of LedgerSMB 1.7 or 1.9 are unaffected by this vulnerability and don't need to take action. As a workaround, users may configure their Apache or Nginx reverse proxy to add the Secure attribute at the network boundary instead of relying on LedgerSMB. For Apache, please refer to the 'Header always edit' configuration command in the mod_headers module. For Nginx, please refer to the 'proxy_cookie_flags' configuration command.
- **CVE-2021-29248**: BTCPay Server through 1.0.7.0 could allow a remote attacker to obtain sensitive information, caused by failure to set the Secure flag for a cookie.
- **CVE-2022-24045**: A vulnerability has been identified in Desigo DXR2 (All versions < V01.21.142.5-22), Desigo PXC3 (All versions < V01.21.142.4-18), Desigo PXC4 (All versions < V02.20.142.10-10884), Desigo PXC5 (All versions < V02.20.142.10-10884). The application, after a successful login, sets the session cookie on the browser via client-side JavaScript code, without applying any security attributes (such as “Secure”, “HttpOnly”, or “SameSite”). Any attempts to browse the application via unencrypted HTTP protocol would lead to the transmission of all his/her session cookies in plaintext through the network. An attacker could then be able to sniff the network and capture sensitive information.


# Relevant CWE Specifications

## CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute
**Abstraction:** Variant
**Status:** Draft

### Description
The Secure attribute for sensitive cookies in HTTPS sessions is not set, which could cause the user agent to send those cookies in plaintext over an HTTP session.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-319

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Implementation
- **Description:** Always set the secure attribute when the cookie should sent via HTTPS only.




### Observed Examples
- **CVE-2004-0462:** A product does not set the Secure attribute for sensitive cookies in HTTPS sessions, which could cause the user agent to send those cookies in plaintext over an HTTP session with the product.
- **CVE-2008-3663:** A product does not set the secure flag for the session cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.
- **CVE-2008-3662:** A product does not set the secure flag for the session cookie in an https session, which can cause the cookie to be sent in http requests and make it easier for remote attackers to capture this cookie.



## CWE-319: Cleartext Transmission of Sensitive Information
**Abstraction:** Base
**Status:** Draft

### Description
The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

### Extended Description


Many communication channels can be "sniffed" (monitored) by adversaries during data transmission. For example, in networking, packets can traverse many intermediary nodes from the source to the destination, whether across the internet, an internal network, the cloud, etc. Some actors might have privileged access to a network interface or any link along the channel, such as a router, but they might not be authorized to collect the underlying data. As a result, network traffic could be sniffed by adversaries, spilling security-critical data.


Applicable communication channels are not limited to software products. Applicable channels include hardware-specific technologies such as internal hardware networks and external debug channels, supporting remote JTAG debugging. When mitigations are not applied to combat adversaries within the product's threat model, this weakness significantly lowers the difficulty of exploitation by such adversaries.


When full communications are recorded or logged, such as with a packet dump, an adversary could attempt to obtain the dump long after the transmission has occurred and try to "sniff" the cleartext from the recorded communications in the dump itself. Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information. 


### Alternative Terms
None

### Relationships
ChildOf -> CWE-311
ChildOf -> CWE-311
ParentOf -> CWE-5
ParentOf -> CWE-614

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** Before transmitting, encrypt the data using reliable, confidentiality-protecting cryptographic protocols.

**Mitigation 2:**
- **Phase:** Implementation
- **Description:** When using web applications with SSL, use SSL for the entire session from login to logout, not just for the initial login page.

**Mitigation 3:**
- **Phase:** Implementation
- **Description:** When designing hardware platforms, ensure that approved encryption algorithms (such as those recommended by NIST) protect paths from security critical data to trusted user applications.



### Additional Notes
**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2022-29519:** Programmable Logic Controller (PLC) sends sensitive information in plaintext, including passwords and session tokens.
- **CVE-2022-30312:** Building Controller uses a protocol that transmits authentication credentials in plaintext.
- **CVE-2022-31204:** Programmable Logic Controller (PLC) sends password in plaintext.

