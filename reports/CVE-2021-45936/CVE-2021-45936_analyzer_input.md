# Vulnerability Information: CVE-2021-45936

## Vulnerability Description
wolfSSL wolfMQTT 1.9 has a **heap-based buffer overflow** in MqttDecode_Disconnect (called from MqttClient_DecodePacket and MqttClient_WaitType).

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** wolfSSL wolfMQTT
- **version:** 1.9
- **component:** MqttDecode_Disconnect

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "Heap-buffer-overflow in the MqttDecode_Disconnect function within the wolfMQTT library.",
    "weaknesses": [
      "Heap-buffer-overflow"
    ],
    "impact": "A heap-buffer-overflow write vulnerability.",
    "attack_vectors": [
      "By sending a crafted MQTT Disconnect packet to a vulnerable wolfMQTT client."
    ],
    "required_capabilities": "The attacker needs to be able to send network packets to a vulnerable wolfMQTT client. The specific structure of the packet required to trigger the vulnerability can be deduced from the source code or fuzzing."
  },
  "additional_information": {
    "fix_commit": "84d4b53122e0fa0280c7872350b89d5777dabbb2",
    "introduction_commit": "237f693c5731dcbd6adc9de69d9f575421c4414e",
     "vulnerable_function": "MqttDecode_Disconnect",
     "crash_location": [
      "MqttDecode_Disconnect",
      "MqttClient_DecodePacket",
      "MqttClient_WaitType"
    ]
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6769 | dense, sparse, graph | dense: 0.568, sparse: 0.108, graph: 0.925 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6248 | dense, sparse, graph | dense: 0.571, sparse: 0.115, graph: 0.765 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5477 | dense, sparse, graph | dense: 0.587, sparse: 0.116, graph: 0.653 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4627 | dense, sparse, graph | dense: 0.534, sparse: 0.090, graph: 0.464 |
| 5 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.3750 | sparse, graph | sparse: 0.106, graph: 0.880 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3630 | dense, sparse | dense: 0.603, sparse: 0.160 |
| 7 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3290 | dense, sparse | dense: 0.549, sparse: 0.095 |
| 8 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3273 | dense, sparse | dense: 0.540, sparse: 0.100 |
| 9 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3263 | dense, sparse | dense: 0.541, sparse: 0.097 |
| 10 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3258 | dense, sparse | dense: 0.535, sparse: 0.102 |

