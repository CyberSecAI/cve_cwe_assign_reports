# Vulnerability Information: CVE-2021-3319

## Vulnerability Description
DOS Incorrect 802154 Frame Validation for Omitted Source / Dest Addresses. Zephyr versions >= > v2.4.0 contain **NULL Pointer Dereference (CWE-476), Attempt to Access Child of a Non-structure Pointer (CWE-588)**. For more information, see https//github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-94jg-2p6q-5364

### Vulnerability Description Key Phrases
- **rootcause:** **NULL Pointer Dereference (CWE-476), Attempt to Access Child of a Non-structure Pointer (CWE-588)**
- **product:** Zephyr
- **version:** >= v2.4.0
- **component:** 802154 Frame Validation

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Improper processing of omitted source and destination addresses in IEEE 802.15.4 frame validation, specifically within the `ieee802154_validate_frame` function. When source/destination addresses are omitted or the packet is too short, NULL pointers are incorrectly handled, leading to a corrupted pointer being used in later processing.
- **Weaknesses/vulnerabilities present**:
    -  Improper handling of NULL pointers during address validation in `ieee802154_validate_frame`.
    -  Lack of NULL pointer checks in `set_pkt_ll_addr`, leading to assignment of invalid pointer values.
    -  Use of corrupted pointer in `sys_mem_swap` within `ieee802154_manage_recv_packet`, causing unintended memory manipulation.
    - In MAC Command frames, usage of potentially NULL destination address during validation leads to a crash
-  **Impact of exploitation**:
    -  Denial of service (crash of firmware) due to invalid memory access.
    -  In some niche cases, potential for Remote Code Execution (RCE) if the memory corruption can be manipulated to overwrite critical system data like the initial stack pointer and reset vector address.
-  **Attack vectors**:
    -  Sending specially crafted IEEE 802.15.4 frames with omitted or invalid source/destination addresses.
    -  Sending too short packets that trigger the vulnerability.
-  **Required attacker capabilities/position**:
    -  Attacker needs to be able to send IEEE 802.15.4 frames to the vulnerable device.
    - No specific user interaction is required.

The provided content gives much more technical detail than the CVE description placeholder, including code snippets, vulnerable code paths, and proposed fixes. It clarifies the specific functions involved and the nature of the pointer corruption.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.7800 | dense, sparse, graph | dense: 0.563, sparse: 0.246, graph: 1.000 |
| 2 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.7544 | dense, sparse, graph | dense: 0.582, sparse: 0.472, graph: 0.540 |
| 3 | CWE-825 | Expired Pointer Dereference | Base | Allowed | 0.7430 | dense, sparse, graph | dense: 0.543, sparse: 0.264, graph: 0.896 |
| 4 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.6194 | dense, sparse, graph | dense: 0.549, sparse: 0.267, graph: 0.536 |
| 5 | CWE-588 | Attempt to Access Child of a Non-structure Pointer | Variant | Allowed | 0.5531 | dense, sparse | dense: 0.645, sparse: 0.483 |
| 6 | CWE-824 | Access of Uninitialized Pointer | Base | Allowed | 0.5235 | sparse, graph | sparse: 0.290, graph: 1.000 |
| 7 | CWE-252 | Unchecked Return Value | Base | Allowed | 0.4290 | sparse, graph | sparse: 0.257, graph: 0.789 |
| 8 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.4258 | dense, sparse | dense: 0.562, sparse: 0.253 |
| 9 | CWE-694 | Use of Multiple Resources with Duplicate Identifier | Base | Allowed | 0.4139 | dense, sparse | dense: 0.529, sparse: 0.261 |
| 10 | CWE-823 | Use of Out-of-range Pointer Offset | Base | Allowed | 0.4125 | dense, sparse | dense: 0.552, sparse: 0.238 |

