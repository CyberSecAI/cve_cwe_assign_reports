# Raw Retriever Results for CVE-2022-36804

# Raw Retriever Results for CVE-2022-36804

## Query
Multiple API endpoints in Atlassian Bitbucket Server and Data Center 7.0.0 before version 7.6.17, from version 7.7.0 before version 7.17.10, from version 7.18.0 before version 7.21.4, from version 8.0.0 before version 8.0.3, from version 8.1.0 before version 8.1.3, and from version 8.2.0 before version 8.2.2, and from version 8.3.0 before 8.3.1 allows remote attackers with read permissions to a public or private Bitbucket repository to execute arbitrary code by sending a malicious HTTP request. This vulnerability was reported via our Bug Bounty Program by TheGrandPew.

## Keyphrases
- **rootcause**: improper input validation

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5249 | 0.5625 | 0.5381 | 0.5366 | 20 |
| Sparse | 515.7215 | 738.5163 | 543.5948 | 529.7629 | 20 |
| Graph | 1.1412 | 2.2100 | 1.5204 | 1.5091 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 2 | 23 | Relative Path Traversal | base | 2.1190 | Allowed |
| 3 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7151 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.6298 | Allowed |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 1.6264 | Allowed |
| 9 | 184 | Incomplete List of Disallowed Inputs | Base | 1.5415 | Allowed |
| 10 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | base | 1.5210 | Allowed |
| 11 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 1.4971 | Allowed |
| 12 | 425 | Direct Request ('Forced Browsing') | Base | 1.3211 | Allowed |
| 13 | 183 | Permissive List of Allowed Inputs | base | 1.3010 | Allowed |
| 14 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.2864 | Allowed |
| 15 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 1.2860 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 863 | Incorrect Authorization | Class | 0.5625 | 0.5625 | Allowed-with-Review |
| 2 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5516 | 0.5516 | Allowed |
| 3 | 285 | Improper Authorization | Class | 0.5514 | 0.5514 | Discouraged |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5490 | 0.5490 | Allowed |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5456 | 0.5456 | Allowed |
| 6 | 527 | Exposure of Version-Control Repository to an Unauthorized Control Sphere | Variant | 0.5439 | 0.5439 | Allowed |
| 7 | 502 | Deserialization of Untrusted Data | Base | 0.5424 | 0.5424 | Allowed |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5395 | 0.5395 | Allowed-with-Review |
| 9 | 862 | Missing Authorization | Class | 0.5389 | 0.5389 | Allowed-with-Review |
| 10 | 269 | Improper Privilege Management | Class | 0.5371 | 0.5371 | Discouraged |
| 11 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.5361 | 0.5361 | Allowed |
| 12 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.5360 | 0.5360 | Allowed |
| 13 | 540 | Inclusion of Sensitive Information in Source Code | Base | 0.5325 | 0.5325 | Allowed |
| 14 | 306 | Missing Authentication for Critical Function | Base | 0.5319 | 0.5319 | Allowed |
| 15 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.5295 | 0.5295 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-158 | Improper Neutralization of Null Byte or NUL Character | 738.5163 | 738.5163 | Allowed |
| 2 | CWE-285 | Improper Authorization | 576.3229 | 576.3229 | Discouraged |
| 3 | CWE-863 | Incorrect Authorization | 562.8595 | 562.8595 | Allowed-with-Review |
| 4 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 560.7099 | 560.7099 | Allowed |
| 5 | CWE-23 | Relative Path Traversal | 541.9154 | 541.9154 | Allowed |
| 6 | CWE-287 | Improper Authentication | 541.6341 | 541.6341 | Discouraged |
| 7 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 539.3624 | 539.3624 | Allowed |
| 8 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 537.5334 | 537.5334 | Allowed |
| 9 | CWE-269 | Improper Privilege Management | 533.9907 | 533.9907 | Discouraged |
| 10 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 532.8000 | 532.8000 | Allowed |
| 11 | CWE-20 | Improper Input Validation | 526.7257 | 526.7257 | Discouraged |
| 12 | CWE-284 | Improper Access Control | 525.1089 | 525.1089 | Discouraged |
| 13 | CWE-306 | Missing Authentication for Critical Function | 522.4757 | 522.4757 | Allowed |
| 14 | CWE-1284 | Improper Validation of Specified Quantity in Input | 521.3875 | 521.3875 | Allowed |
| 15 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 521.1867 | 521.1867 | Allowed |
