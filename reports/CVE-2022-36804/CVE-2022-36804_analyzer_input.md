# Vulnerability Information: CVE-2022-36804

## Vulnerability Description
Multiple API endpoints in Atlassian Bitbucket Server and Data Center 7.0.0 before version 7.6.17, from version 7.7.0 before version 7.17.10, from version 7.18.0 before version 7.21.4, from version 8.0.0 before version 8.0.3, from version 8.1.0 before version 8.1.3, and from version 8.2.0 before version 8.2.2, and from version 8.3.0 before 8.3.1 allows remote attackers with read permissions to a public or private Bitbucket repository to execute arbitrary code by sending a malicious HTTP request. This vulnerability was reported via our Bug Bounty Program by TheGrandPew.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input validation**
- **impact:** arbitrary code execution
- **vector:** malicious HTTP request
- **attacker:** remote attackers with read permissions
- **product:** Atlassian Bitbucket Server and Data Center
- **version:** 7.0.0 before 7.6.17 and 7.7.0 before 7.17.10 and 7.18.0 before 7.21.4 and 8.0.0 before 8.0.3 and 8.1.0 before 8.1.3 and 8.2.0 before 8.2.2 and 8.3.0 before 8.3.1
- **component:** Multiple API endpoints

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "Command injection vulnerability in multiple API endpoints.",
    "weaknesses": [
      "Command Injection"
    ],
    "impact": "An attacker can execute arbitrary code by sending a malicious HTTP request.",
    "attack_vectors": "Sending a malicious HTTP request to vulnerable API endpoints.",
    "attacker_capabilities": "An attacker with access to a public Bitbucket repository or with read permissions to a private one can exploit the vulnerability."
  },
  "affected_products": [
    "Bitbucket Server",
    "Bitbucket Data Center"
  ],
  "affected_versions": [
    "Versions between 7.0.0 and 8.3.0 inclusive"
  ],
  "fixed_versions": [
     "7.6.17 or newer",
     "7.17.10 or newer",
     "7.21.4 or newer",
     "8.0.3 or newer",
     "8.1.3 or newer",
     "8.2.2 or newer",
     "8.3.1 or newer"
  ],
  "cvss_score": "9.9",
  "cvss_severity": "Critical"
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.7284 | dense, sparse, graph | dense: 0.549, sparse: 0.430, graph: 0.581 |
| 2 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.7160 | dense, sparse, graph | dense: 0.536, sparse: 0.449, graph: 0.535 |
| 3 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.5185 | sparse, graph | sparse: 0.434, graph: 0.757 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.5104 | dense, sparse | dense: 0.527, sparse: 0.431 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5053 | dense, sparse | dense: 0.532, sparse: 0.418 |
| 6 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4642 | sparse, graph | sparse: 0.417, graph: 0.631 |
| 7 | CWE-158 | Improper Neutralization of Null Byte or NUL Character | Variant | Allowed | 0.4534 | sparse, graph | sparse: 0.591, graph: 0.429 |
| 8 | CWE-917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | 0.4304 | sparse, graph | sparse: 0.413, graph: 0.543 |
| 9 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.3167 | dense, sparse | dense: 0.563, sparse: 0.450 |
| 10 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.2438 | sparse | sparse: 0.426 |

