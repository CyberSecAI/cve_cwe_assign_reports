{
  "query": "PySAML2 is a pure python implementation of SAML Version 2 Standard. PySAML2 before 6.5.0 has an improper verification of cryptographic signature vulnerability. All users of pysaml2 that need to validate signed SAML documents are impacted. The vulnerability is a variant of XML Signature wrapping because it did not validate the SAML document against an XML schema. This allowed invalid XML documents to be processed and such a document can trick pysaml2 with a wrapped signature. This is fixed in PySAML2 6.5.0.",
  "keyphrases": {
    "rootcause": "improper verification of cryptographic signature",
    "weakness": "XML Signature wrapping"
  },
  "timestamp": "2025-03-16T23:41:57.827087",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.2100000000000004,
        "description": "CWE-208: Observable Timing Discrepancy...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.1762,
        "description": "CWE-301: Reflection Attack in an Authentication Protocol...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.7680000000000005,
        "description": "CWE-385: Covert Timing Channel...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.6882801398323541,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.6701616138495776,
        "description": "The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.6577019631190004,
        "description": "The product uses an algorithm that produces a digest (output value) that does not meet security expectations for a hash function that allows an adversary to reasonably determine the original input (pr...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.6292533993548042,
        "description": "The product accepts XML from an untrusted source but does not validate the XML against the proper schema....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.592099025571596,
        "description": "The product implements a Security Token mechanism to differentiate what actions are allowed or disallowed when a transaction originates from an entity. However, the Security Tokens generated in the sy...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.521,
        "description": "CWE-708: Incorrect Ownership Assignment...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.521,
        "description": "CWE-1304: Improperly Preserved Integrity of Hardware Configuration State During a Power Save/Restore Operation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.4559133471755723,
        "description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.4080000000000001,
        "description": "CWE-1390: Weak Authentication...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.3572000000000002,
        "description": "CWE-804: Guessable CAPTCHA...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.25521704405429,
        "description": "This attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.2496,
        "description": "CWE-20: Improper Input Validation...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.15872,
        "description": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.1466,
        "description": "CWE-1293: Missing Source Correlation of Multiple Independent Data...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.1466,
        "description": "CWE-836: Use of Password Hash Instead of Password for Authentication...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.1466,
        "description": "CWE-1271: Uninitialized Value on Reset for Registers Holding Security Settings...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.1377974517042033,
        "description": "The product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data....",
        "mapping_usage": "Discouraged"
      }
    ],
    "dense": [
      {
        "cwe_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "abstraction": "Base",
        "score": 0.47356121248598165,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1270",
        "name": "Generation of Incorrect Security Tokens",
        "abstraction": "Base",
        "score": 0.4430772196694759,
        "description": "The product implements a Security Token mechanism to differentiate what actions are allowed or disallowed when a transaction originates from an entity. However, the Security Tokens generated in the sy...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 0.4297152595186585,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "112",
        "name": "Missing XML Validation",
        "abstraction": "Base",
        "score": 0.42295716067968525,
        "description": "The product accepts XML from an untrusted source but does not validate the XML against the proper schema....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "303",
        "name": "Incorrect Implementation of Authentication Algorithm",
        "abstraction": "Base",
        "score": 0.42275905760430765,
        "description": "The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "611",
        "name": "Improper Restriction of XML External Entity Reference",
        "abstraction": "Base",
        "score": 0.41473244256192626,
        "description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "abstraction": "Compound",
        "score": 0.40934234670778774,
        "description": "The product, when opening a file or directory, does not sufficiently account for when the file is a symbolic link that resolves to a target outside of the intended control sphere. This could allow an ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "287",
        "name": "Improper Authentication",
        "abstraction": "Class",
        "score": 0.4091769985235745,
        "description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 0.40628579557890354,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "90",
        "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
        "abstraction": "Base",
        "score": 0.4058107369282707,
        "description": "The product constructs all or part of an LDAP query using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modi...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 0.4056532803287374,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "345",
        "name": "Insufficient Verification of Data Authenticity",
        "abstraction": "Class",
        "score": 0.40395085618155946,
        "description": "The product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "294",
        "name": "Authentication Bypass by Capture-replay",
        "abstraction": "Base",
        "score": 0.4031414859636785,
        "description": "A capture-replay flaw exists when the design of the product makes it possible for a malicious user to sniff network traffic and bypass authentication by replaying it to the server in question to the s...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "295",
        "name": "Improper Certificate Validation",
        "abstraction": "Base",
        "score": 0.4010851590329321,
        "description": "The product does not validate, or incorrectly validates, a certificate....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "abstraction": "Base",
        "score": 0.4006826843074026,
        "description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected d...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "502",
        "name": "Deserialization of Untrusted Data",
        "abstraction": "Base",
        "score": 0.39927659882102035,
        "description": "The product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "297",
        "name": "Improper Validation of Certificate with Host Mismatch",
        "abstraction": "Variant",
        "score": 0.3967238546877405,
        "description": "The product communicates with a host that provides a certificate, but the product does not properly ensure that the certificate is actually associated with that host....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "325",
        "name": "Missing Cryptographic Step",
        "abstraction": "Base",
        "score": 0.39650018349887384,
        "description": "The product does not implement a required step in a cryptographic algorithm, resulting in weaker encryption than advertised by the algorithm....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 0.39386733243520444,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 0.3926320802161192,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "abstraction": "Base",
        "score": 1532.8199991372126,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "611",
        "name": "Improper Restriction of XML External Entity Reference",
        "abstraction": "Base",
        "score": 831.9445465250564,
        "description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "328",
        "name": "Use of Weak Hash",
        "abstraction": "Base",
        "score": 811.5683760302817,
        "description": "The product uses an algorithm that produces a digest (output value) that does not meet security expectations for a hash function that allows an adversary to reasonably determine the original input (pr...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "345",
        "name": "Insufficient Verification of Data Authenticity",
        "abstraction": "Class",
        "score": 782.3718408372137,
        "description": "The product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "1390",
        "name": "Weak Authentication",
        "abstraction": "Class",
        "score": 739.2775062820288,
        "description": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "116",
        "name": "Improper Encoding or Escaping of Output",
        "abstraction": "Class",
        "score": 738.1591948060994,
        "description": "The product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of t...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "112",
        "name": "Missing XML Validation",
        "abstraction": "Base",
        "score": 735.312906443063,
        "description": "The product accepts XML from an untrusted source but does not validate the XML against the proper schema....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "835",
        "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
        "abstraction": "Base",
        "score": 720.5528429559846,
        "description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "325",
        "name": "Missing Cryptographic Step",
        "abstraction": "Base",
        "score": 719.500928283236,
        "description": "The product does not implement a required step in a cryptographic algorithm, resulting in weaker encryption than advertised by the algorithm....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "287",
        "name": "Improper Authentication",
        "abstraction": "Class",
        "score": 712.5272044296601,
        "description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "115",
        "name": "Misinterpretation of Input",
        "abstraction": "Base",
        "score": 709.836383807611,
        "description": "The product misinterprets an input, whether from an attacker or another product, in a security-relevant fashion....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "208",
        "name": "Observable Timing Discrepancy",
        "abstraction": "Base",
        "score": 709.0501605134284,
        "description": "Two separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, su...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 707.359405832258,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "abstraction": "Base",
        "score": 702.0032265127644,
        "description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "776",
        "name": "Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')",
        "abstraction": "Base",
        "score": 700.033974513641,
        "description": "The product uses XML documents and allows their structure to be defined with a Document Type Definition (DTD), but it does not properly control the number of recursive definitions of entities....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "297",
        "name": "Improper Validation of Certificate with Host Mismatch",
        "abstraction": "Variant",
        "score": 693.4544126492437,
        "description": "The product communicates with a host that provides a certificate, but the product does not properly ensure that the certificate is actually associated with that host....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "303",
        "name": "Incorrect Implementation of Authentication Algorithm",
        "abstraction": "Base",
        "score": 673.0266857427915,
        "description": "The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "abstraction": "Class",
        "score": 663.6200149828268,
        "description": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when th...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "203",
        "name": "Observable Discrepancy",
        "abstraction": "Base",
        "score": 438.0403863792061,
        "description": "The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the s...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 421.46442527162503,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.3926320802161192,
      "max": 0.47356121248598165,
      "mean": 0.41154658728659194,
      "median": 0.405732008628504,
      "count": 20
    },
    "sparse": {
      "min": 421.46442527162503,
      "max": 1532.8199991372126,
      "mean": 737.0962210967616,
      "median": 711.1817941186355,
      "count": 20
    },
    "graph": {
      "min": 1.1377974517042033,
      "max": 2.2100000000000004,
      "mean": 1.4947971992330698,
      "median": 1.4884566735877862,
      "count": 20
    }
  }
}