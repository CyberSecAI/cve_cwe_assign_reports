# Vulnerability Information: CVE-2022-24675

## Vulnerability Description
encoding/pem in Go before 1.17.9 and 1.18.x before 1.18.1 has a Decode **stack overflow** via a large amount of PEM data.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **vector:** large amount of PEM data
- **product:** Go
- **version:** before 1.17.9 and 1.18.x before 1.18.1
- **component:** encoding/pem

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2022-24675:

**Root Cause of Vulnerability:**
- The vulnerability lies in the `encoding/pem` package of the Go programming language, specifically in the `Decode` function.
- The `Decode` function calls `decodeError`, a recursive function which could lead to a stack overflow when processing a large amount of PEM data that includes errors.

**Weaknesses/Vulnerabilities Present:**
- Stack overflow due to unbounded recursion in the `decodeError` function, triggered by large, malformed PEM data.
- Improper Resource allocation without limits.

**Impact of Exploitation:**
- A successful attack can lead to a Denial of Service (DoS) by causing the application to crash due to a stack overflow.

**Attack Vectors:**
- The attack vector is network-based, where an attacker sends a specially crafted PEM file containing a large amount of data and errors to a vulnerable application using `encoding/pem.Decode`.
- The crafted PEM data triggers the vulnerable code path.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to provide a crafted PEM input. This can be done remotely.
- No special privileges are required.
- The vulnerability can be exploited by an unauthenticated user.

**Additional details:**
- The vulnerability is present in Go versions prior to 1.17.9 and 1.18.x before 1.18.1.
- The vulnerability was discovered by Juho Nurminen of Mattermost.
- The vulnerability is tracked as CVE-2022-24675.
- The fix involves removing the recursive call to decodeError.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.6682 | dense, sparse, graph | dense: 0.497, sparse: 0.109, graph: 1.000 |
| 2 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.5892 | dense, sparse, graph | dense: 0.457, sparse: 0.143, graph: 0.916 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3941 | sparse, graph | sparse: 0.138, graph: 0.882 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3492 | sparse, graph | sparse: 0.117, graph: 0.789 |
| 5 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2937 | dense, sparse | dense: 0.472, sparse: 0.100 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2846 | dense, sparse | dense: 0.464, sparse: 0.133 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2749 | dense, sparse | dense: 0.474, sparse: 0.106 |
| 8 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2734 | sparse, graph | sparse: 0.106, graph: 0.631 |
| 9 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2166 | dense, sparse | dense: 0.529, sparse: 0.182 |
| 10 | CWE-400 | Uncontrolled Resource Consumption | Class | Discouraged | 0.1109 | sparse, graph | sparse: 0.119, graph: 0.503 |

