# Raw Retriever Results for CVE-2022-41873

# Raw Retriever Results for CVE-2022-41873

## Query
Contiki-NG is an open-source, cross-platform operating system for Next-Generation IoT devices. Versions prior to 4.9 are vulnerable to an Out-of-bounds read. While processing the L2CAP protocol, the Bluetooth Low Energy stack of Contiki-NG needs to map an incoming channel ID to its metadata structure. While looking up the corresponding channel structure in get_channel_for_cid (in os/net/mac/ble/ble-l2cap.c), a bounds check is performed on the incoming channel ID, which is meant to ensure that the channel ID does not exceed the maximum number of supported channels.However, an integer truncation issue leads to only the lowest byte of the channel ID to be checked, which leads to an incomplete out-of-bounds check. A crafted channel ID leads to out-of-bounds memory to be read and written with attacker-controlled data. The vulnerability has been patched in the develop branch of Contiki-NG, and will be included in release 4.9. As a workaround, Users can apply the patch in Contiki-NG pull request 2081 on GitHub.

## Keyphrases
- **rootcause**: integer truncation issue
- **weakness**: Out-of-bounds read

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5126 | 0.5523 | 0.5309 | 0.5234 | 20 |
| Sparse | 907.1907 | 3077.5247 | 1587.5942 | 1546.4223 | 20 |
| Graph | 1.6669 | 2.8256 | 2.0972 | 2.2066 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 823 | Use of Out-of-range Pointer Offset | Base | 2.8256 | Allowed |
| 2 | 125 | Out-of-bounds Read | Base | 2.8180 | Allowed |
| 3 | 190 | Integer Overflow or Wraparound | Base | 2.4169 | Allowed |
| 4 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 5 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.2674 | Allowed |
| 7 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 8 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 11 | 195 | Signed to Unsigned Conversion Error | variant | 2.2032 | Allowed |
| 12 | 129 | Improper Validation of Array Index | variant | 2.0400 | Allowed |
| 13 | 124 | Buffer Underwrite ('Buffer Underflow') | base | 1.8122 | Allowed |
| 14 | 197 | Numeric Truncation Error | Base | 1.7896 | Allowed |
| 15 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5523 | 0.5523 | Allowed |
| 2 | 823 | Use of Out-of-range Pointer Offset | Base | 0.5522 | 0.5522 | Allowed |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5515 | 0.5515 | Allowed |
| 4 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5504 | 0.5504 | Allowed |
| 5 | 197 | Numeric Truncation Error | Base | 0.5489 | 0.5489 | Allowed |
| 6 | 126 | Buffer Over-read | Variant | 0.5478 | 0.5478 | Allowed |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.5457 | 0.5457 | Allowed |
| 8 | 121 | Stack-based Buffer Overflow | Variant | 0.5313 | 0.5313 | Allowed |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5305 | 0.5305 | Allowed |
| 10 | 824 | Access of Uninitialized Pointer | Base | 0.5240 | 0.5240 | Allowed |
| 11 | 125 | Out-of-bounds Read | Base | 0.5228 | 0.5228 | Allowed |
| 12 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | 0.5218 | 0.5218 | Allowed |
| 13 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.5204 | 0.5204 | Allowed |
| 14 | 193 | Off-by-one Error | Base | 0.5202 | 0.5202 | Allowed |
| 15 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5201 | 0.5201 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-197 | Numeric Truncation Error | 3077.5247 | 3077.5247 | Allowed |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1749.0241 | 1749.0241 | Allowed |
| 3 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 1722.6658 | 1722.6658 | Allowed |
| 4 | CWE-190 | Integer Overflow or Wraparound | 1699.3788 | 1699.3788 | Allowed |
| 5 | CWE-125 | Out-of-bounds Read | 1694.2551 | 1694.2551 | Allowed |
| 6 | CWE-824 | Access of Uninitialized Pointer | 1614.4046 | 1614.4046 | Allowed |
| 7 | CWE-193 | Off-by-one Error | 1596.5474 | 1596.5474 | Allowed |
| 8 | CWE-20 | Improper Input Validation | 1595.3380 | 1595.3380 | Discouraged |
| 9 | CWE-754 | Improper Check for Unusual or Exceptional Conditions | 1568.8742 | 1568.8742 | Allowed-with-Review |
| 10 | CWE-770 | Allocation of Resources Without Limits or Throttling | 1564.6882 | 1564.6882 | Allowed |
| 11 | CWE-126 | Buffer Over-read | 1528.1565 | 1528.1565 | Allowed |
| 12 | CWE-122 | Heap-based Buffer Overflow | 1526.1190 | 1526.1190 | Allowed |
| 13 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1524.2744 | 1524.2744 | Allowed-with-Review |
| 14 | CWE-476 | NULL Pointer Dereference | 1511.3830 | 1511.3830 | Allowed |
| 15 | CWE-131 | Incorrect Calculation of Buffer Size | 1506.3770 | 1506.3770 | Allowed |
