# Vulnerability Information: CVE-2021-24249

## Vulnerability Description
The Business Directory Plugin Easy Listing Directories for WordPress WordPress plugin before 5.11.2 suffered from a **Cross-Site Request Forgery** issue, allowing an attacker to make a logged in administrator export files, which could then be downloaded by the attacker to get access to PII, such as email, home addresses etc

### Vulnerability Description Key Phrases
- **rootcause:** **Cross-Site Request Forgery**
- **impact:** get access to PII
- **attacker:** attacker
- **product:** Business Directory Plugin Easy Listing Directories for WordPress
- **version:** before 5.11.2

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The Business Directory plugin lacks proper CSRF protection when exporting listings.
- **Weaknesses/vulnerabilities present**: Cross-Site Request Forgery (CSRF). The plugin doesn't validate the origin of the export request, allowing an attacker to trigger the export functionality on behalf of a logged-in administrator.
- **Impact of exploitation**: An attacker can force a logged-in administrator to export sensitive data, such as email and home addresses (PII), which can then be downloaded by the attacker.
- **Attack vectors**: By crafting a malicious HTML form that targets the vulnerable endpoint `/wp-admin/admin-ajax.php` with the `wpbdp-csv-export` action.
- **Required attacker capabilities/position**: The attacker needs to trick a logged-in administrator into visiting a malicious webpage or clicking a malicious link. The attacker does not need any prior authentication on the target WordPress website.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.7426 | dense, sparse, graph | dense: 0.464, sparse: 0.269, graph: 0.998 |
| 2 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.6877 | dense, sparse, graph | dense: 0.441, sparse: 0.305, graph: 0.819 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.6562 | dense, sparse, graph | dense: 0.486, sparse: 0.259, graph: 0.740 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5814 | dense, sparse, graph | dense: 0.432, sparse: 0.272, graph: 0.586 |
| 5 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.3879 | dense, sparse | dense: 0.566, sparse: 0.386 |
| 6 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3768 | dense, sparse | dense: 0.452, sparse: 0.264 |
| 7 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.3669 | dense, sparse | dense: 0.449, sparse: 0.249 |
| 8 | CWE-552 | Files or Directories Accessible to External Parties | Base | Allowed | 0.3604 | dense, sparse | dense: 0.440, sparse: 0.245 |
| 9 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.3542 | dense, sparse | dense: 0.429, sparse: 0.244 |
| 10 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2330 | dense, sparse | dense: 0.481, sparse: 0.273 |

