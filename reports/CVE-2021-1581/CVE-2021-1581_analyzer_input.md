# Vulnerability Information: CVE-2021-1581

## Vulnerability Description
Multiple vulnerabilities in the web UI and API endpoints of Cisco Application Policy Infrastructure Controller (APIC) or Cisco Cloud APIC could allow a remote attacker to perform a **command injection** or file upload attack on an affected system. For more information about these vulnerabilities, see the Details section of this advisory.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** ['arbitrary file write', 'execute system commands']
- **attacker:** remote attacker
- **product:** Cisco APIC
- **component:** web UI and API endpoints

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-78

#### Top CWEs
- CWE-78 (Count: 13)
- CWE-79 (Count: 10)
- CWE-20 (Count: 9)

## CVE Reference Links Content Summary
```
CVE-2021-1581: Cisco APIC File Upload Vulnerability
- Root cause of vulnerability: Improper access control in an API endpoint of Cisco APIC or Cisco Cloud APIC.
- Weaknesses/vulnerabilities present:  Lack of proper access control allows for unauthorized file uploads.
- Impact of exploitation: An attacker can upload files to the affected device, potentially filling the upload partition.
- Attack vectors: A remote attacker can exploit a specific API endpoint to upload files.
- Required attacker capabilities/position: The attacker can be unauthenticated and remote.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.7814 | dense, sparse, graph | dense: 0.565, sparse: 0.247, graph: 1.000 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.6641 | dense, sparse, graph | dense: 0.614, sparse: 0.236, graph: 0.619 |
| 3 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.4478 | sparse, graph | sparse: 0.232, graph: 0.882 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.4061 | dense, sparse | dense: 0.566, sparse: 0.214 |
| 5 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.3421 | sparse, graph | sparse: 0.203, graph: 0.631 |
| 6 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2915 | dense, sparse, graph | dense: 0.561, sparse: 0.253, graph: 0.632 |
| 7 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.2820 | sparse, graph | sparse: 0.211, graph: 0.488 |
| 8 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.1391 | dense, sparse | dense: 0.566, sparse: 0.229 |
| 9 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.1291 | sparse | sparse: 0.226 |
| 10 | CWE-1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | 0.1249 | sparse | sparse: 0.218 |

