# CWE Search Results for CVE-2021-21339

## Query
    TYPO3 is an open source PHP based web content management system. In TYPO3 before versions 6.2.57, 7.6.51, 8.7.40, 9.5.25, 10.4.14, 11.1.1 user session identifiers were stored in cleartext - without processing of additional cryptographic hashing algorithms. This vulnerability cannot be exploited directly and occurs in combination with a chained attack - like for instance SQL injection in any other component of the system. This is fixed in versions 6.2.57, 7.6.51, 8.7.40, 9.5.25, 10.4.14, 11.1.1.            
            
    ## Keyphrases
    - **weakness**: cleartext storage of user session identifiers

    ## Top 10 Results
    
| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.8295 | dense, sparse, graph | dense: 0.536, sparse: 0.582, graph: 0.639 |
| 2 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.7109 | dense, sparse, graph | dense: 0.530, sparse: 0.359, graph: 0.673 |
| 3 | CWE-209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | 0.6602 | dense, sparse, graph | dense: 0.511, sparse: 0.375, graph: 0.532 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4170 | sparse, graph | sparse: 0.334, graph: 0.631 |
| 5 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2370 | sparse, graph | sparse: 0.356, graph: 0.911 |
| 6 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.2010 | sparse | sparse: 0.351 |
| 7 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.1964 | sparse | sparse: 0.343 |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.1943 | sparse | sparse: 0.340 |
| 9 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.1937 | sparse | sparse: 0.339 |
| 10 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.1817 | sparse | sparse: 0.333 |


    
### Retriever Score Interpretation
The scores are calculated with a sophisticated methodology that considers multiple factors:

- **Dense Vector Search**: Measures semantic similarity to the vulnerability description (0-1 scale)
- **Property Graph**: Identifies CWEs with relevant structural relationships (0-1 scale)
- **Sparse Retrieval**: Finds exact keyword matches using BM25, normalized to 0-1 scale (original scores capped at 1000)

The combined score is calculated as follows:

1. **Individual Scores**: Each retriever score is normalized to 0-1 scale and weighted according to retriever weights

2. **Quality-Adjusted Consensus Boost**: When multiple retrievers agree on a CWE:
- The boost is scaled by the average confidence score (higher confidence = higher boost)
- Different retriever combinations receive different boost modifiers:
    - Sparse + Dense (more independent signals): +20% boost
    - Sparse + Graph (partially independent): +10% boost  
    - Dense + Graph (more overlap): -10% boost reduction

3. **Relationship Boosting**: CWEs identified by the graph retriever with explicit relationships receive:
- Additional weight to the graph retriever's score
- A relationship bonus based on the number of relevant relationships

4. **Abstraction Level Adjustment**:
- Base CWEs: +30% boost
- Variant CWEs: +20% boost
- Class CWEs: -20% penalty
- Pillar CWEs: -40% penalty

This approach favors CWEs that are identified by multiple independent retrieval methods, and prioritizes those with explicit structural relationships to other CWEs.


### Result Analysis
- **5** CWEs were found by multiple retrievers, indicating stronger relevance.
- The **sparse** retriever found the most relevant CWEs (20).
- The results are primarily Base-level CWEs, which balance specificity and generality.

Higher scores indicate stronger relevance. CWEs found by multiple independent retrievers, with explicit relationships, and at appropriate abstraction levels are particularly significant.
    