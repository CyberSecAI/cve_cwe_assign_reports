# Vulnerability Information: CVE-2020-25560

## Vulnerability Description
In SapphireIMS 5.0, it is possible to use the **hardcoded credential** in clients (username sapphire, password ims) and gain access to the portal. Once the access is available, the attacker can inject malicious OS commands on ping, traceroute and snmp functions and execute code on the server. We also observed the same is true if the JSESSIONID is completely removed.

### Vulnerability Description Key Phrases
- **rootcause:** **hardcoded credential**
- **impact:** command injection
- **product:** SapphireIMS
- **version:** 5.0
- **component:** clients

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described in CVE-2020-25560:

**Root cause of vulnerability:**
The application allows for the injection of malicious operating system commands into the "ping", "traceroute", and "snmp" functions. This is compounded by the fact that the application can be accessed without authentication, and even with an invalid JSESSIONID.

**Weaknesses/vulnerabilities present:**
-   **Unauthenticated access:** The application can be accessed without requiring any authentication, or with a missing/invalid JSESSIONID, which bypasses access controls.
-   **Command injection:** The application fails to sanitize user-supplied input when constructing OS commands for "ping", "traceroute", and "snmp" functions allowing for arbitrary command execution.
-  **Hardcoded Credentials:** The application uses hardcoded credentials, "username: sapphire, password: ims" to access the portal (referenced as a related vulnerability) which can also be used for RCE if successful login occurs, though the RCE can be achieved without authentication based on the provided report.

**Impact of exploitation:**
-   **Remote command execution:** An attacker can execute arbitrary OS commands on the server hosting the application. This can lead to a full compromise of the server and the network.

**Attack vectors:**
-   **Network:** The vulnerability can be exploited remotely over the network via HTTP requests.

**Required attacker capabilities/position:**
-   **Network access:** The attacker needs network access to the server hosting the vulnerable application. No other authentication is required to exploit the RCE vulnerability, though the hardcoded credentials could also be used to access the application and then exploit other functionality.

**Additional details:**
- The attacker can inject OS commands through the `hostorip` parameter in the `CmdProcess` endpoint.
- The response of command execution can be obtained by making a second request to `/SapphireIMS/PortletClass` with the JSESSIONID obtained from the first request.
-   The provided Proof of Concept (POC) demonstrates command execution by injecting `|ipconfig` command into a ping request.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.8030 | dense, sparse, graph | dense: 0.544, sparse: 0.438, graph: 0.784 |
| 2 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.7107 | dense, sparse, graph | dense: 0.518, sparse: 0.308, graph: 0.936 |
| 3 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.6971 | dense, sparse, graph | dense: 0.497, sparse: 0.301, graph: 0.936 |
| 4 | CWE-1392 | Use of Default Credentials | Base | Allowed | 0.6112 | dense, sparse, graph | dense: 0.524, sparse: 0.277, graph: 0.534 |
| 5 | CWE-257 | Storing Passwords in a Recoverable Format | Base | Allowed | 0.4379 | sparse, graph | sparse: 0.280, graph: 0.777 |
| 6 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.3939 | dense, sparse | dense: 0.486, sparse: 0.264 |
| 7 | CWE-1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | 0.3896 | dense, sparse | dense: 0.477, sparse: 0.263 |
| 8 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.3255 | dense, sparse, graph | dense: 0.502, sparse: 0.291, graph: 0.381 |
| 9 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.1593 | sparse | sparse: 0.279 |
| 10 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.1582 | sparse | sparse: 0.277 |

