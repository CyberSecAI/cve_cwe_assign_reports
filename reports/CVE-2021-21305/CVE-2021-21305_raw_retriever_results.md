# Raw Retriever Results for CVE-2021-21305

# Raw Retriever Results for CVE-2021-21305

## Query
CarrierWave is an open-source RubyGem which provides a simple and flexible way to upload files from Ruby applications. In CarrierWave before versions 1.3.2 and 2.1.1, there is a code injection vulnerability. The #manipulate! method inappropriately evals the content of mutation option(read/write), allowing attackers to craft a string that can be executed as a Ruby code. If an application developer supplies untrusted inputs to the option, it will lead to remote code execution(RCE). This is fixed in versions 1.3.2 and 2.1.1.

## Keyphrases
- **rootcause**: inappropriate eval
- **weakness**: code injection

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4884 | 0.5289 | 0.4997 | 0.4967 | 20 |
| Sparse | 446.4512 | 1188.3433 | 773.3203 | 749.6486 | 20 |
| Graph | 1.4963 | 2.6104 | 1.8262 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | base | 2.6104 | Allowed |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.4700 | Allowed |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 2.3066 | Allowed-with-Review |
| 4 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 5 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 1.8898 | Allowed |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 1.7800 | Allowed |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 11 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 12 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |
| 13 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |
| 14 | 471 | Modification of Assumed-Immutable Data (MAID) | base | 1.6016 | Allowed |
| 15 | 73 | External Control of File Name or Path | Base | 1.5366 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 915 | Improperly Controlled Modification of Dynamically-Determined Object Attributes | Base | 0.5289 | 0.5289 | Allowed |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.5158 | 0.5158 | Allowed |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5125 | 0.5125 | Allowed-with-Review |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.5089 | 0.5089 | Allowed |
| 5 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.5077 | 0.5077 | Allowed |
| 6 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 0.5058 | 0.5058 | Allowed |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.5043 | 0.5043 | Allowed |
| 8 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | 0.5001 | 0.5001 | Allowed |
| 9 | 502 | Deserialization of Untrusted Data | Base | 0.4985 | 0.4985 | Allowed |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4970 | 0.4970 | Allowed |
| 11 | 790 | Improper Filtering of Special Elements | Class | 0.4965 | 0.4965 | Allowed-with-Review |
| 12 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | 0.4939 | 0.4939 | Allowed-with-Review |
| 13 | 114 | Process Control | Class | 0.4933 | 0.4933 | Allowed-with-Review |
| 14 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 0.4931 | 0.4931 | Allowed |
| 15 | 627 | Dynamic Variable Evaluation | Variant | 0.4927 | 0.4927 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 1188.3433 | 1188.3433 | Allowed |
| 2 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 877.7119 | 877.7119 | Allowed |
| 3 | CWE-138 | Improper Neutralization of Special Elements | 825.5566 | 825.5566 | Discouraged |
| 4 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 817.2599 | 817.2599 | Allowed |
| 5 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 808.3863 | 808.3863 | Allowed-with-Review |
| 6 | CWE-502 | Deserialization of Untrusted Data | 806.2343 | 806.2343 | Allowed |
| 7 | CWE-1333 | Inefficient Regular Expression Complexity | 769.4552 | 769.4552 | Allowed |
| 8 | CWE-434 | Unrestricted Upload of File with Dangerous Type | 756.8344 | 756.8344 | Allowed |
| 9 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 753.6673 | 753.6673 | Allowed-with-Review |
| 10 | CWE-190 | Integer Overflow or Wraparound | 752.0718 | 752.0718 | Allowed |
| 11 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 747.2254 | 747.2254 | Allowed |
| 12 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 745.9735 | 745.9735 | Allowed |
| 13 | CWE-863 | Incorrect Authorization | 745.0097 | 745.0097 | Allowed-with-Review |
| 14 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 745.0079 | 745.0079 | Allowed |
| 15 | CWE-116 | Improper Encoding or Escaping of Output | 741.9984 | 741.9984 | Allowed-with-Review |
