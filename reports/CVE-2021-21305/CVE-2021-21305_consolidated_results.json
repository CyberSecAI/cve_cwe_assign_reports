{
  "cve_id": "CVE-2021-21305",
  "query": "CarrierWave is an open-source RubyGem which provides a simple and flexible way to upload files from Ruby applications. In CarrierWave before versions 1.3.2 and 2.1.1, there is a code injection vulnerability. The #manipulate! method inappropriately evals the content of mutation option(read/write), allowing attackers to craft a string that can be executed as a Ruby code. If an application developer supplies untrusted inputs to the option, it will lead to remote code execution(RCE). This is fixed in versions 1.3.2 and 2.1.1.",
  "keyphrases": {
    "rootcause": "inappropriate eval",
    "weakness": "code injection"
  },
  "timestamp": "2025-03-16T17:03:20.163065",
  "retriever_weights": {
    "dense": 0.35,
    "sparse": 0.4,
    "graph": 0.25
  },
  "results_count": 20,
  "results": [
    {
      "cwe_id": "CWE-95",
      "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "abstraction": "Variant",
      "score": 0.9185924946397848,
      "score_info": {
        "retrievers": [
          "dense",
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "dense": 0.5158007760397239,
          "sparse": 1188.3433238244615,
          "graph": 1.513156621674979
        },
        "normalized_scores": {
          "dense": 0.5158007760397239,
          "sparse": 0.9506746590595693,
          "graph": 0.5404130791696354
        },
        "weighted_scores": {
          "dense": 0.18053027161390334,
          "sparse": 0.38026986362382775,
          "graph": 0.13510326979240886
        },
        "normalization_details": {
          "dense": {
            "raw_score": 0.5158007760397239,
            "query_max": 0.5289206023188835,
            "query_min": 0.48844596387299544,
            "normalized_score": 0.5158007760397239,
            "weight": 0.35,
            "weighted_score": 0.18053027161390334
          },
          "sparse": {
            "raw_score": 1188.3433238244615,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.9506746590595693,
            "weight": 0.4,
            "weighted_score": 0.38026986362382775
          },
          "graph": {
            "raw_score": 1.513156621674979,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.5404130791696354,
            "weight": 0.25,
            "weighted_score": 0.13510326979240886
          }
        },
        "contribution_percentages": {
          "dense": 25.941857779253784,
          "sparse": 54.64405848213346,
          "graph": 19.414083738612756
        },
        "abstraction_factor": 1.2,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.6959034050301399,
          "abstraction": {
            "type": "variant",
            "factor": 1.2,
            "score_after": 0.8350840860361679
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.8350840860361679
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.9185924946397848
          }
        },
        "combined_score": 0.9185924946397848
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "abstraction": "Base",
      "score": 0.8813164800911821,
      "score_info": {
        "retrievers": [
          "dense",
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "dense": 0.504300272896907,
          "sparse": 877.7119359691654,
          "graph": 1.7800419370601717
        },
        "normalized_scores": {
          "dense": 0.504300272896907,
          "sparse": 0.7021695487753323,
          "graph": 0.6357292632357756
        },
        "weighted_scores": {
          "dense": 0.17650509551391746,
          "sparse": 0.28086781951013295,
          "graph": 0.1589323158089439
        },
        "normalization_details": {
          "dense": {
            "raw_score": 0.504300272896907,
            "query_max": 0.5289206023188835,
            "query_min": 0.48844596387299544,
            "normalized_score": 0.504300272896907,
            "weight": 0.35,
            "weighted_score": 0.17650509551391746
          },
          "sparse": {
            "raw_score": 877.7119359691654,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.7021695487753323,
            "weight": 0.4,
            "weighted_score": 0.28086781951013295
          },
          "graph": {
            "raw_score": 1.7800419370601717,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.6357292632357756,
            "weight": 0.25,
            "weighted_score": 0.1589323158089439
          }
        },
        "contribution_percentages": {
          "dense": 28.639233724392415,
          "sparse": 45.572843691512034,
          "graph": 25.78792258409554
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.6163052308329944,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.8011968000828927
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.8011968000828927
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.8813164800911821
          }
        },
        "combined_score": 0.8813164800911821
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-94",
      "name": "Improper Control of Generation of Code ('Code Injection')",
      "abstraction": "Base",
      "score": 0.8790841888453516,
      "score_info": {
        "retrievers": [
          "dense",
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "dense": 0.512544626069488,
          "sparse": 808.3863480509658,
          "graph": 2.306566866970189
        },
        "normalized_scores": {
          "dense": 0.512544626069488,
          "sparse": 0.6467090784407726,
          "graph": 0.8237738810607819
        },
        "weighted_scores": {
          "dense": 0.1793906191243208,
          "sparse": 0.25868363137630906,
          "graph": 0.20594347026519547
        },
        "normalization_details": {
          "dense": {
            "raw_score": 0.512544626069488,
            "query_max": 0.5289206023188835,
            "query_min": 0.48844596387299544,
            "normalized_score": 0.512544626069488,
            "weight": 0.35,
            "weighted_score": 0.1793906191243208
          },
          "sparse": {
            "raw_score": 808.3863480509658,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.6467090784407726,
            "weight": 0.4,
            "weighted_score": 0.25868363137630906
          },
          "graph": {
            "raw_score": 2.306566866970189,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.8237738810607819,
            "weight": 0.25,
            "weighted_score": 0.20594347026519547
          }
        },
        "contribution_percentages": {
          "dense": 27.85491972348226,
          "sparse": 40.16716047327064,
          "graph": 31.9779198032471
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.05,
        "mapping_usage": "ALLOWED-WITH-REVIEW",
        "adjustment_factors": {
          "initial_combined_score": 0.6440177207658253,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.8372230369955729
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.8372230369955729
          },
          "mapping": {
            "usage": "ALLOWED-WITH-REVIEW",
            "boost": 1.05,
            "notes": {
              "usage": "Allowed-with-Review",
              "rationale": "This entry is frequently misused for vulnerabilities with a technical impact of \"code execution,\" which does not by itself indicate a root cause weakness, since dozens of weaknesses can enable code execution.",
              "comments": "This weakness only applies when the product's functionality intentionally constructs all or part of a code segment. It could be that executing code could be the result of other weaknesses that do not involve the construction of code segments.",
              "reasons": [
                "Frequent Misuse",
                "Frequent Misinterpretation"
              ]
            },
            "score_after": 0.8790841888453516
          }
        },
        "combined_score": 0.8790841888453516
      },
      "mapping_notes": {
        "usage": "Allowed-with-Review",
        "rationale": "This entry is frequently misused for vulnerabilities with a technical impact of \"code execution,\" which does not by itself indicate a root cause weakness, since dozens of weaknesses can enable code execution.",
        "comments": "This weakness only applies when the product's functionality intentionally constructs all or part of a code segment. It could be that executing code could be the result of other weaknesses that do not involve the construction of code segments.",
        "reasons": [
          "Frequent Misuse",
          "Frequent Misinterpretation"
        ]
      }
    },
    {
      "cwe_id": "CWE-434",
      "name": "Unrestricted Upload of File with Dangerous Type",
      "abstraction": "Base",
      "score": 0.8423373086123112,
      "score_info": {
        "retrievers": [
          "dense",
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "dense": 0.508936327449121,
          "sparse": 756.8343817154484,
          "graph": 1.889802344679448
        },
        "normalized_scores": {
          "dense": 0.508936327449121,
          "sparse": 0.6054675053723587,
          "graph": 0.6749294088140887
        },
        "weighted_scores": {
          "dense": 0.17812771460719234,
          "sparse": 0.2421870021489435,
          "graph": 0.16873235220352217
        },
        "normalization_details": {
          "dense": {
            "raw_score": 0.508936327449121,
            "query_max": 0.5289206023188835,
            "query_min": 0.48844596387299544,
            "normalized_score": 0.508936327449121,
            "weight": 0.35,
            "weighted_score": 0.17812771460719234
          },
          "sparse": {
            "raw_score": 756.8343817154484,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.6054675053723587,
            "weight": 0.4,
            "weighted_score": 0.2421870021489435
          },
          "graph": {
            "raw_score": 1.889802344679448,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.6749294088140887,
            "weight": 0.25,
            "weighted_score": 0.16873235220352217
          }
        },
        "contribution_percentages": {
          "dense": 30.2399797900347,
          "sparse": 41.11505088662619,
          "graph": 28.644969323339097
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.5890470689596581,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.7657611896475556
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.7657611896475556
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.8423373086123112
          }
        },
        "combined_score": 0.8423373086123112
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-1336",
      "name": "Improper Neutralization of Special Elements Used in a Template Engine",
      "abstraction": "Base",
      "score": 0.7072702694486803,
      "score_info": {
        "retrievers": [
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "sparse": 817.2598920269608,
          "graph": 2.6104000000000003
        },
        "normalized_scores": {
          "sparse": 0.6538079136215686,
          "graph": 0.9322857142857145
        },
        "weighted_scores": {
          "sparse": 0.26152316544862747,
          "graph": 0.23307142857142862
        },
        "normalization_details": {
          "sparse": {
            "raw_score": 817.2598920269608,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.6538079136215686,
            "weight": 0.4,
            "weighted_score": 0.26152316544862747
          },
          "graph": {
            "raw_score": 2.6104000000000003,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.9322857142857145,
            "weight": 0.25,
            "weighted_score": 0.23307142857142862
          }
        },
        "contribution_percentages": {
          "sparse": 52.87626848546236,
          "graph": 47.123731514537624
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.4945945940200561,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.642972972226073
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.642972972226073
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.7072702694486803
          }
        },
        "combined_score": 0.7072702694486803
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-78",
      "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "abstraction": "Base",
      "score": 0.6572964255879578,
      "score_info": {
        "retrievers": [
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "sparse": 747.225424299358,
          "graph": 2.4700000000000006
        },
        "normalized_scores": {
          "sparse": 0.5977803394394864,
          "graph": 0.8821428571428575
        },
        "weighted_scores": {
          "sparse": 0.23911213577579457,
          "graph": 0.22053571428571436
        },
        "normalization_details": {
          "sparse": {
            "raw_score": 747.225424299358,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.5977803394394864,
            "weight": 0.4,
            "weighted_score": 0.23911213577579457
          },
          "graph": {
            "raw_score": 2.4700000000000006,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.8821428571428575,
            "weight": 0.25,
            "weighted_score": 0.22053571428571436
          }
        },
        "contribution_percentages": {
          "sparse": 52.02072320011878,
          "graph": 47.97927679988121
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.45964785006150893,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.5975422050799616
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.5975422050799616
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.6572964255879578
          }
        },
        "combined_score": 0.6572964255879578
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-184",
      "name": "Incomplete List of Disallowed Inputs",
      "abstraction": "Base",
      "score": 0.6192356374982716,
      "score_info": {
        "retrievers": [
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "sparse": 736.5952680094596,
          "graph": 2.2100000000000004
        },
        "normalized_scores": {
          "sparse": 0.5892762144075676,
          "graph": 0.7892857142857145
        },
        "weighted_scores": {
          "sparse": 0.23571048576302706,
          "graph": 0.19732142857142862
        },
        "normalization_details": {
          "sparse": {
            "raw_score": 736.5952680094596,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.5892762144075676,
            "weight": 0.4,
            "weighted_score": 0.23571048576302706
          },
          "graph": {
            "raw_score": 2.2100000000000004,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.7892857142857145,
            "weight": 0.25,
            "weighted_score": 0.19732142857142862
          }
        },
        "contribution_percentages": {
          "sparse": 54.43258983008218,
          "graph": 45.567410169917835
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.43303191433445565,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.5629414886347923
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.5629414886347923
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.6192356374982716
          }
        },
        "combined_score": 0.6192356374982716
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-502",
      "name": "Deserialization of Untrusted Data",
      "abstraction": "Base",
      "score": 0.6184240614059227,
      "score_info": {
        "retrievers": [
          "dense",
          "sparse"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "dense": 0.49848401833798694,
          "sparse": 806.23428808514
        },
        "normalized_scores": {
          "dense": 0.49848401833798694,
          "sparse": 0.6449874304681119
        },
        "weighted_scores": {
          "dense": 0.17446940641829542,
          "sparse": 0.25799497218724476
        },
        "normalization_details": {
          "dense": {
            "raw_score": 0.49848401833798694,
            "query_max": 0.5289206023188835,
            "query_min": 0.48844596387299544,
            "normalized_score": 0.49848401833798694,
            "weight": 0.35,
            "weighted_score": 0.17446940641829542
          },
          "sparse": {
            "raw_score": 806.23428808514,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.6449874304681119,
            "weight": 0.4,
            "weighted_score": 0.25799497218724476
          }
        },
        "contribution_percentages": {
          "dense": 40.34306986875158,
          "sparse": 59.65693013124842
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.4324643786055402,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.5622036921872023
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.5622036921872023
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.6184240614059227
          }
        },
        "combined_score": 0.6184240614059227
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "abstraction": "Base",
      "score": 0.5670931986392809,
      "score_info": {
        "retrievers": [
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "sparse": 745.9735234999264,
          "graph": 1.7680000000000005
        },
        "normalized_scores": {
          "sparse": 0.5967788187999411,
          "graph": 0.6314285714285717
        },
        "weighted_scores": {
          "sparse": 0.23871152751997646,
          "graph": 0.15785714285714292
        },
        "normalization_details": {
          "sparse": {
            "raw_score": 745.9735234999264,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.5967788187999411,
            "weight": 0.4,
            "weighted_score": 0.23871152751997646
          },
          "graph": {
            "raw_score": 1.7680000000000005,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.6314285714285717,
            "weight": 0.25,
            "weighted_score": 0.15785714285714292
          }
        },
        "contribution_percentages": {
          "sparse": 60.19424764265222,
          "graph": 39.80575235734777
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.3965686703771194,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.5155392714902552
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.5155392714902552
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.5670931986392809
          }
        },
        "combined_score": 0.5670931986392809
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "score": 0.5666513501434768,
      "score_info": {
        "retrievers": [
          "sparse",
          "graph"
        ],
        "is_graph_exclusive": false,
        "raw_scores": {
          "sparse": 745.0079454933617,
          "graph": 1.7680000000000005
        },
        "normalized_scores": {
          "sparse": 0.5960063563946894,
          "graph": 0.6314285714285717
        },
        "weighted_scores": {
          "sparse": 0.23840254255787574,
          "graph": 0.15785714285714292
        },
        "normalization_details": {
          "sparse": {
            "raw_score": 745.0079454933617,
            "query_max": 1188.3433238244615,
            "query_min": 446.45119923139134,
            "normalized_score": 0.5960063563946894,
            "weight": 0.4,
            "weighted_score": 0.23840254255787574
          },
          "graph": {
            "raw_score": 1.7680000000000005,
            "query_max": 2.6104000000000003,
            "query_min": 1.4962520241592607,
            "normalized_score": 0.6314285714285717,
            "weight": 0.25,
            "weighted_score": 0.15785714285714292
          }
        },
        "contribution_percentages": {
          "sparse": 60.16320895934372,
          "graph": 39.83679104065628
        },
        "abstraction_factor": 1.3,
        "relationship_count": 0,
        "relationship_bonus": 1.0,
        "mapping_boost": 1.1,
        "mapping_usage": "ALLOWED",
        "adjustment_factors": {
          "initial_combined_score": 0.39625968541501866,
          "abstraction": {
            "type": "base",
            "factor": 1.3,
            "score_after": 0.5151375910395243
          },
          "relationship": {
            "count": 0,
            "is_graph_exclusive": false,
            "bonus": 1.0,
            "score_after": 0.5151375910395243
          },
          "mapping": {
            "usage": "ALLOWED",
            "boost": 1.1,
            "notes": {
              "usage": "Allowed",
              "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
              "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
              "reasons": [
                "Acceptable-Use"
              ]
            },
            "score_after": 0.5666513501434768
          }
        },
        "combined_score": 0.5666513501434768
      },
      "mapping_notes": {
        "usage": "Allowed",
        "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
        "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
        "reasons": [
          "Acceptable-Use"
        ]
      }
    }
  ]
}