# Vulnerability Information: CVE-2021-33019

## Vulnerability Description
A **stack-based buffer overflow** vulnerability in Delta Electronics DOPSoft Version 4.00.11 and prior may be exploited by processing a specially crafted project file, which may allow an attacker to execute arbitrary code.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** execute arbitrary code
- **vector:** processing a specially crafted project file
- **attacker:** attacker
- **product:** Delta Electronics DOPSoft
- **version:** Version 4.00.11 and prior

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-33019:

**Root Cause of Vulnerability:**
- The vulnerability is a stack-based buffer overflow. It occurs due to a lack of proper validation of the length of user-supplied data before copying it to a fixed-length stack buffer during the parsing of TBK files.

**Weaknesses/Vulnerabilities Present:**
- **CWE-121:** Stack-based Buffer Overflow.
- Insufficient input validation: The software does not properly check the size of the data being read from the TBK file, before copying it to a stack buffer, leading to a buffer overflow.

**Impact of Exploitation:**
- Successful exploitation can lead to arbitrary code execution in the context of the current process. This could allow an attacker to gain control of the affected system, potentially leading to data breaches, system compromise, and disruption of industrial processes.

**Attack Vectors:**
- The attack vector involves a specially crafted TBK project file, which is processed by DOPSoft.
- The vulnerability can be triggered by a user opening a malicious TBK file.

**Required Attacker Capabilities/Position:**
- The attacker needs to craft a malicious TBK file.
- User interaction is required: the target user must open the malicious file or visit a malicious page.
- The attack is local (AV:L) meaning that the attacker needs to have access to the system running the vulnerable software.

**Additional Details:**
- The vulnerability was reported to CISA by an anonymous researcher working with Trend Micro's Zero Day Initiative.
- Delta Electronics has released a patch to address the vulnerability.
- The vulnerability affects versions 4.00.11 and prior of DOPSoft
- The ZDI advisory (ZDI-21-1059) indicates the vulnerability is in "TBK File Parsing"

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7518 | dense, sparse, graph | dense: 0.535, sparse: 0.221, graph: 1.000 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.6389 | dense, sparse, graph | dense: 0.533, sparse: 0.209, graph: 0.791 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6272 | dense, sparse, graph | dense: 0.503, sparse: 0.206, graph: 0.721 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6204 | dense, sparse, graph | dense: 0.541, sparse: 0.201, graph: 0.802 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4161 | dense, sparse | dense: 0.623, sparse: 0.243 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3643 | dense, sparse | dense: 0.509, sparse: 0.191 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3623 | dense, sparse | dense: 0.551, sparse: 0.204 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3548 | dense, sparse | dense: 0.506, sparse: 0.177 |
| 9 | CWE-676 | Use of Potentially Dangerous Function | Base | Allowed | 0.3546 | dense, sparse | dense: 0.509, sparse: 0.174 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.2716 | dense, sparse, graph | dense: 0.540, sparse: 0.193, graph: 0.633 |

