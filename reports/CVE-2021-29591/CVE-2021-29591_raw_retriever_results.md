# Raw Retriever Results for CVE-2021-29591

# Raw Retriever Results for CVE-2021-29591

## Query
TensorFlow is an end-to-end open source platform for machine learning. TFlite graphs must not have loops between nodes. However, this condition was not checked and an attacker could craft models that would result in infinite loop during evaluation. In certain cases, the infinite loop would be replaced by stack overflow due to too many recursive calls. For example, the `While` implementation(https//github.com/tensorflow/tensorflow/blob/106d8f4fb89335a2c52d7c895b7a7485465ca8d9/tensorflow/lite/kernels/while.cc) could be tricked into a scneario where both the body and the loop subgraphs are the same. Evaluating one of the subgraphs means calling the `Eval` function for the other and this quickly exhaust all stack space. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range. Please consult our security guide(https//github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.

## Keyphrases
- **rootcause**: loops between nodes
- **weakness**: stack overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3944 | 0.4610 | 0.4229 | 0.4131 | 20 |
| Sparse | 1326.8205 | 2646.8653 | 1718.3164 | 1656.9751 | 20 |
| Graph | 1.2992 | 2.2100 | 1.5885 | 1.5660 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 2 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 3 | 170 | Improper Null Termination | base | 1.7680 | Allowed |
| 4 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 5 | 822 | Untrusted Pointer Dereference | base | 1.6848 | Allowed |
| 6 | 823 | Use of Out-of-range Pointer Offset | base | 1.6848 | Allowed |
| 7 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 1.5948 | Allowed |
| 9 | 824 | Access of Uninitialized Pointer | Base | 1.5943 | Allowed |
| 10 | 195 | Signed to Unsigned Conversion Error | variant | 1.5768 | Allowed |
| 11 | 129 | Improper Validation of Array Index | variant | 1.5552 | Allowed |
| 12 | 125 | Out-of-bounds Read | Base | 1.4972 | Allowed |
| 13 | 1050 | Excessive Platform Resource Consumption within a Loop | Base | 1.4675 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.4631 | Allowed |
| 15 | 681 | Incorrect Conversion between Numeric Types | Base | 1.4533 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1050 | Excessive Platform Resource Consumption within a Loop | Base | 0.4610 | 0.4610 | Allowed |
| 2 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4554 | 0.4554 | Allowed |
| 3 | 674 | Uncontrolled Recursion | Class | 0.4525 | 0.4525 | Allowed-with-Review |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4500 | 0.4500 | Allowed |
| 5 | 824 | Access of Uninitialized Pointer | Base | 0.4480 | 0.4480 | Allowed |
| 6 | 834 | Excessive Iteration | Class | 0.4410 | 0.4410 | Discouraged |
| 7 | 415 | Double Free | Variant | 0.4399 | 0.4399 | Allowed |
| 8 | 1287 | Improper Validation of Specified Type of Input | Base | 0.4359 | 0.4359 | Allowed |
| 9 | 606 | Unchecked Input for Loop Condition | Base | 0.4336 | 0.4336 | Allowed |
| 10 | 663 | Use of a Non-reentrant Function in a Concurrent Context | Base | 0.4161 | 0.4161 | Allowed |
| 11 | 190 | Integer Overflow or Wraparound | Base | 0.4101 | 0.4101 | Allowed |
| 12 | 681 | Incorrect Conversion between Numeric Types | Base | 0.4058 | 0.4058 | Allowed |
| 13 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4053 | 0.4053 | Allowed |
| 14 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | 0.4034 | 0.4034 | Allowed |
| 15 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4027 | 0.4027 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 2646.8653 | 2646.8653 | Allowed |
| 2 | CWE-824 | Access of Uninitialized Pointer | 2074.1006 | 2074.1006 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 2025.7926 | 2025.7926 | Allowed |
| 4 | CWE-681 | Incorrect Conversion between Numeric Types | 1967.5878 | 1967.5878 | Allowed |
| 5 | CWE-674 | Uncontrolled Recursion | 1964.7406 | 1964.7406 | Allowed-with-Review |
| 6 | CWE-122 | Heap-based Buffer Overflow | 1850.0028 | 1850.0028 | Allowed |
| 7 | CWE-193 | Off-by-one Error | 1813.6161 | 1813.6161 | Allowed |
| 8 | CWE-415 | Double Free | 1731.7806 | 1731.7806 | Allowed |
| 9 | CWE-617 | Reachable Assertion | 1698.1072 | 1698.1072 | Allowed |
| 10 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 1664.9914 | 1664.9914 | Allowed |
| 11 | CWE-125 | Out-of-bounds Read | 1648.9587 | 1648.9587 | Allowed |
| 12 | CWE-663 | Use of a Non-reentrant Function in a Concurrent Context | 1616.9193 | 1616.9193 | Allowed |
| 13 | CWE-476 | NULL Pointer Dereference | 1594.1055 | 1594.1055 | Allowed |
| 14 | CWE-20 | Improper Input Validation | 1532.5958 | 1532.5958 | Discouraged |
| 15 | CWE-787 | Out-of-bounds Write | 1503.8842 | 1503.8842 | Allowed |
