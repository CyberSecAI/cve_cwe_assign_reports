# Vulnerability Information: CVE-2020-0479

## Vulnerability Description
In callUnchecked of DocumentsProvider.java, there is a possible permissions bypass. This could lead to local escalation of privilege allowing a malicious app to access files available to the DocumentProvider without user permission, with no additional execution privileges needed. User interaction is needed for exploitation.Product AndroidVersions Android-11Android ID A-157294893

### Vulnerability Description Key Phrases
- **impact:** access files without user permission
- **attacker:** malicious app
- **product:** Android
- **version:** 11
- **component:** callUnchecked of DocumentsProvider.java

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2020-0479:

**Root Cause of Vulnerability:**

The vulnerability stems from a lack of validation of user-supplied URIs in `DocumentsProvider` calls. This allows malicious apps to potentially exploit the system by providing crafted URIs with specific authorities that are not properly checked.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Input Validation:** The core issue is that user-provided URIs are not adequately validated before being used by the `DocumentsProvider`. This lack of validation creates an opportunity for attackers to inject malicious URIs.
*   **URI Authority Manipulation:** Malicious applications can craft URIs with specific authorities that, when processed by the vulnerable code, lead to unintended actions or information disclosure.

**Impact of Exploitation:**

*   **Elevation of Privilege (EoP):** The CVE is categorized as an EoP vulnerability. While the provided text doesn't give exact details on the kind of privilege escalation, it implies that successful exploitation could allow a malicious app to gain unauthorized access or control beyond its permitted scope.
*   **Information Disclosure (ID):** The vulnerability might also lead to some information disclosure by reading sensitive data with the crafted URI.

**Attack Vectors:**

*   **Malicious Application:** The primary attack vector involves a malicious application crafting and supplying a specially crafted URI to the `DocumentsProvider` component.
*   **Inter-process Communication (IPC):** The vulnerability likely exists within the IPC mechanisms of Android, where an app communicates with the `DocumentsProvider` using URIs as input.

**Required Attacker Capabilities/Position:**

*   **Ability to install an app:** An attacker must be able to install a malicious application on the affected Android device.
*   **Basic understanding of Android components:** The attacker needs to have some knowledge of how `DocumentsProvider` and URIs function within the Android framework to create the exploit.

**Additional Notes:**

* The provided commit log message for the fix includes the following information:
     -   The fix involves adding permission checks to `createInputConsumer`/`destroyInputConsumer` in `WindowManagerService` to prevent apps from consuming all touch events, denying them from reaching System UI.
     - It also limits the usage of `createInputConsumer` to defined types.
* The commit log indicates a fix for the vulnerability is addressed by validating user-supplied URIs within the `DocumentsProvider`, specifically targeting the authorities of the URIs.

In summary, CVE-2020-0479 is a moderate severity Elevation of Privilege and Information Disclosure vulnerability in Android's `DocumentsProvider` due to insufficient validation of user-supplied URIs. This allows malicious applications to potentially gain elevated privileges or disclose sensitive data by providing specially crafted URIs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.5556 | dense, sparse, graph | dense: 0.566, sparse: 0.109, graph: 0.588 |
| 2 | CWE-223 | Omission of Security-relevant Information | Base | Allowed | 0.5186 | dense, sparse, graph | dense: 0.539, sparse: 0.097, graph: 0.541 |
| 3 | CWE-927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | 0.4482 | dense, sparse, graph | dense: 0.579, sparse: 0.090, graph: 0.403 |
| 4 | CWE-925 | Improper Verification of Intent by Broadcast Receiver | Variant | Allowed | 0.4026 | dense, sparse, graph | dense: 0.530, sparse: 0.087, graph: 0.339 |
| 5 | CWE-248 | Uncaught Exception | Base | Allowed | 0.3029 | dense, sparse | dense: 0.502, sparse: 0.090 |
| 6 | CWE-941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | 0.2981 | dense, sparse | dense: 0.495, sparse: 0.088 |
| 7 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2714 | dense, sparse, graph | dense: 0.529, sparse: 0.111, graph: 0.374 |
| 8 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1866 | dense, sparse | dense: 0.525, sparse: 0.096 |
| 9 | CWE-638 | Not Using Complete Mediation | Class | Allowed-with-Review | 0.1754 | dense, sparse | dense: 0.494, sparse: 0.090 |
| 10 | CWE-667 | Improper Locking | Class | Allowed-with-Review | 0.1081 | sparse, graph | sparse: 0.096, graph: 0.361 |

