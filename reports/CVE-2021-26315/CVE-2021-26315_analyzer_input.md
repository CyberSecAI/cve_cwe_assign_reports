# Vulnerability Information: CVE-2021-26315

## Vulnerability Description
When the AMD Platform Security Processor (PSP) boot rom loads, authenticates, and subsequently decrypts an encrypted FW, due to **insufficient verification of the integrity of decrypted image**, arbitrary code may be executed in the PSP when encrypted firmware images are used.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient verification of the integrity of decrypted image**
- **impact:** arbitrary code execution
- **product:** AMD Platform Security Processor
- **component:** boot rom

## CVE Reference Links Content Summary
Based on the provided document, here's a breakdown of CVE-2021-26315:

**Root Cause of Vulnerability:**
- The vulnerability stems from the CPU internal ROM improperly implementing the decryption of signed off-chip firmware.

**Weaknesses/Vulnerabilities Present:**
- Improper decryption implementation.
- Inadequate protection of the off-chip firmware decryption process.

**Impact of Exploitation:**
- Execution of arbitrary code on the PSP (Platform Security Processor).
- Compromise of the attestation state authenticity.

**Attack Vectors:**
- Physical access to the affected system.
- Attacker with high privileges on the system.

**Required Attacker Capabilities/Position:**
- The attacker needs physical access to the system or high privileges.
- The attacker would need to be able to exploit the improper decryption to execute code on the PSP

**Additional Notes:**
- This vulnerability specifically affects 3rd Gen AMD EPYC processors.
- The vulnerability was reported by Shawn Hoffman of Microsoft Offensive Security Research.
- Mitigation is achieved through AGESA firmware updates provided to OEMs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.4441 | sparse, graph | sparse: 0.225, graph: 0.882 |
| 2 | CWE-1291 | Public Key Re-Use for Signing both Debug and Production Code | Base | Allowed | 0.4294 | sparse, graph | sparse: 0.215, graph: 0.857 |
| 3 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.2604 | sparse, graph | sparse: 0.190, graph: 0.486 |
| 4 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1450 | sparse, graph | sparse: 0.204, graph: 0.580 |
| 5 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.1102 | sparse | sparse: 0.193 |
| 6 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.1077 | sparse | sparse: 0.188 |
| 7 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.1060 | sparse | sparse: 0.185 |
| 8 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.1060 | sparse | sparse: 0.185 |
| 9 | CWE-459 | Incomplete Cleanup | Base | Allowed | 0.1052 | sparse | sparse: 0.184 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.1046 | sparse | sparse: 0.183 |

