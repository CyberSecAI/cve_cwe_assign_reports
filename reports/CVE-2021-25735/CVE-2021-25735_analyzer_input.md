# Vulnerability Information: CVE-2021-25735

## Vulnerability Description
A security issue was discovered in kube-apiserver that could allow node updates to bypass a Validating Admission Webhook. Clusters are only affected by this vulnerability if they run a Validating Admission Webhook for Nodes that denies admission based at least partially on the old state of the Node object. Validating Admission Webhook does not observe some previous fields.

### Vulnerability Description Key Phrases
- **impact:** bypass Validating Admission Webhook
- **vector:** node updates
- **product:** kube-apiserver

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-25735:

**Root Cause of Vulnerability:**

The vulnerability lies in how the Kubernetes `kube-apiserver` handles updates to node resources when a Validating Admission Webhook is in place. When a node update occurs, the admission controller receives information that could include old configurations of the node object. This old information is then used before the actual validation of the update, potentially allowing the overwriting of values used for validation and thus bypassing the webhook's restrictions.

**Weaknesses/Vulnerabilities Present:**

*   **Bypass of Validating Admission Webhook:** The core issue is the ability to bypass the intended restrictions imposed by a Validating Admission Webhook. The webhook should evaluate the update request to determine if it is allowed but due to the described mechanism it is not correctly validating the updated node.
*   **Use of Old State for Validation:** The vulnerability arises from the admission controller's reliance on potentially outdated information about the node, instead of using the most current state for validation, which allows an attacker to present a state that the webhook would approve, while effectively updating the node to a state that would be otherwise blocked.
*   **Improper Update Handling:** The vulnerability is specific to node updates, indicating a flaw in how the update process integrates with validating admission controllers.

**Impact of Exploitation:**

*   **Unauthorized Node Updates:** An attacker could perform unauthorized updates to node resources, potentially leading to the modification of critical node configurations.
*   **Compromise of Cluster Integrity:** By bypassing the admission controller's restrictions, the attacker can inject malicious updates, potentially compromising the overall integrity and security of the Kubernetes cluster.
*   **Possible Privilege Escalation (Indirect):** Although not directly stated, manipulating node configurations could potentially be leveraged to escalate privileges within the cluster, if the update could be used to give the attacker the ability to run arbitrary code inside the cluster or to access resources that would otherwise be restricted to them.

**Attack Vectors:**

*   **Network-based:** The vulnerability can be exploited remotely, as the attack vector is classified as "Network".
*   **Node Update Actions:** The specific action that triggers the vulnerability is an update to a node resource.

**Required Attacker Capabilities/Position:**

*   **High Privileges:** The attacker requires high privileges within the Kubernetes cluster, specifically the ability to update or patch node resources.
*   **Validating Admission Webhook:**  The vulnerability is only exploitable if the cluster has a Validating Admission Webhook for Nodes that denies admission based partially on the old state of the Node object.
*   **Network Access:** The attacker must have network access to the kube-apiserver.

**Additional Notes:**

*   The vulnerability does not affect calls from kubelets that go through the built-in NodeRestriction admission plugin.
*   The vulnerability is fixed in kube-apiserver versions 1.20.6, 1.19.10, and 1.18.18 and higher.

This information is more detailed than a standard CVE description and provides valuable insights for understanding and mitigating the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.4993 | dense, sparse, graph | dense: 0.439, sparse: 0.074, graph: 0.665 |
| 2 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.4918 | dense, sparse, graph | dense: 0.478, sparse: 0.065, graph: 0.603 |
| 3 | CWE-372 | Incomplete Internal State Distinction | Base | Discouraged | 0.4251 | dense, sparse, graph | dense: 0.507, sparse: 0.217, graph: 0.578 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3993 | sparse, graph | sparse: 0.073, graph: 1.000 |
| 5 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.2643 | dense, sparse | dense: 0.453, sparse: 0.065 |
| 6 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.2635 | dense, sparse | dense: 0.450, sparse: 0.067 |
| 7 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1598 | dense, sparse | dense: 0.464, sparse: 0.070 |
| 8 | CWE-1390 | Weak Authentication | Class | Allowed-with-Review | 0.1304 | sparse, graph | sparse: 0.074, graph: 0.503 |
| 9 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.0392 | sparse | sparse: 0.069 |
| 10 | CWE-112 | Missing XML Validation | Base | Allowed | 0.0382 | sparse | sparse: 0.067 |

