{
  "cve_id": "CVE-2021-33697",
  "description": "Under certain conditions, SAP BusinessObjects Business Intelligence Platform (SAPUI5), versions - 420, 430, can allow an unauthenticated attacker to redirect users to a malicious site due to Reverse Tabnabbing vulnerabilities.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "redirect users to malicious site",
    "vector": "",
    "attacker": "unauthenticated attacker",
    "product": "SAP BusinessObjects Business Intelligence Platform",
    "version": "420, 430",
    "component": "SAPUI5"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-601 | URL Redirection to Untrusted Site ('Open Redirect') | 0.9 | Base | Allowed | Primary CWE |\n| CWE-1022 | Use of Web Link to Untrusted Target with window.opener Access | 0.6 | Variant | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.75\n*   **Evidence Strength:** MEDIUM\n\n- **Analysis and Justification:**\n  - *Explanation:* The vulnerability description states that an unauthenticated attacker can **redirect users to a malicious site**. This aligns well with CWE-601 (URL Redirection to Untrusted Site ('Open Redirect')). CWE-601 describes a scenario where a web application accepts user-controlled input that specifies a link to an external site and uses that link in a redirect. The fact that the attacker is unauthenticated strengthens the case for CWE-601, as there is no access control preventing the redirection. The MITRE mapping guidance for CWE-601 indicates that its usage is ALLOWED. CWE-1022 (Use of Web Link to Untrusted Target with window.opener Access) is also a possibility, but it involves the `window.opener` object, which is not explicitly mentioned in the description. Thus, CWE-601 is the primary weakness.\n  - *Relationship Analysis:* There are no direct relationships for CWE-601 provided in the context. CWE-601 is a Base level CWE.\n\n- **Confidence Score:**\n  - Confidence: 0.9 (High match with the vulnerability description and the CWE definition. The description focuses on the redirection aspect which is core to CWE-601.\n\n---\n- **Analysis and Justification:**\n  - *Explanation:* CWE-1022 (Use of Web Link to Untrusted Target with `window.opener` Access) is a secondary candidate. While the vulnerability description doesn't explicitly mention the `window.opener` object, the Reverse Tabnabbing vulnerability type can involve it. Reverse Tabnabbing exploits the `window.opener` relationship between pages, allowing a malicious page to modify the original page's location. Given that this is a possibility, CWE-1022 is considered. The MITRE mapping guidance for CWE-1022 indicates its usage is ALLOWED and is at the Variant level of abstraction.\n  - *Relationship Analysis:* There are no direct relationships for CWE-1022 provided in the context. CWE-1022 is a Variant level CWE.\n\n- **Confidence Score:**\n  - Confidence: 0.6 (Possible, but less direct evidence compared to CWE-601. The reliance on reverse tabnabbing requiring the `window.opener` makes it less confident.)",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-601 | URL Redirection to Untrusted Site ('Open Redirect') | 0.9 | Base | Allowed | Primary CWE |\n| CWE-1022 | Use of Web Link to Untrusted Target with window.opener Access | 0.6 | Variant | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.75\n*   **Evidence Strength:** MEDIUM\n\n- **Analysis and Justification:**\n  - *Explanation:* The vulnerability description states that an unauthenticated attacker can **redirect users to a malicious site**. This aligns well with CWE-601 (URL Redirection to Untrusted Site ('Open Redirect')). CWE-601 describes a scenario where a web application accepts user-controlled input that specifies a link to an external site and uses that link in a redirect. The fact that the attacker is unauthenticated strengthens the case for CWE-601, as there is no access control preventing the redirection. The MITRE mapping guidance for CWE-601 indicates that its usage is ALLOWED. CWE-1022 (Use of Web Link to Untrusted Target with window.opener Access) is also a possibility, but it involves the `window.opener` object, which is not explicitly mentioned in the description. Thus, CWE-601 is the primary weakness.\n  - *Relationship Analysis:* There are no direct relationships for CWE-601 provided in the context. CWE-601 is a Base level CWE.\n\n- **Confidence Score:**\n  - Confidence: 0.9 (High match with the vulnerability description and the CWE definition. The description focuses on the redirection aspect which is core to CWE-601.\n\n---\n- **Analysis and Justification:**\n  - *Explanation:* CWE-1022 (Use of Web Link to Untrusted Target with `window.opener` Access) is a secondary candidate. While the vulnerability description doesn't explicitly mention the `window.opener` object, the Reverse Tabnabbing vulnerability type can involve it. Reverse Tabnabbing exploits the `window.opener` relationship between pages, allowing a malicious page to modify the original page's location. Given that this is a possibility, CWE-1022 is considered. The MITRE mapping guidance for CWE-1022 indicates its usage is ALLOWED and is at the Variant level of abstraction.\n  - *Relationship Analysis:* There are no direct relationships for CWE-1022 provided in the context. CWE-1022 is a Variant level CWE.\n\n- **Confidence Score:**\n  - Confidence: 0.6 (Possible, but less direct evidence compared to CWE-601. The reliance on reverse tabnabbing requiring the `window.opener` makes it less confident.)",
  "criticism": "Okay, here's a review of the analysis, incorporating the full CWE specifications you provided.\n\n**Overall Assessment:**\n\nThe analysis correctly identifies CWE-601 (URL Redirection to Untrusted Site ('Open Redirect')) as the primary weakness. It also reasonably considers CWE-1022 (Use of Web Link to Untrusted Target with window.opener Access) as a secondary candidate due to the \"Reverse Tabnabbing\" context. The confidence scores are appropriate, given the available information.\n\n**Detailed Review:**\n\n**CWE-601: URL Redirection to Untrusted Site ('Open Redirect')**\n\n*   **Justification:** The analysis accurately links the vulnerability description (\"redirect users to a malicious site\") to the core definition of CWE-601. The unauthenticated nature of the attacker further strengthens this mapping, as it indicates a lack of proper access control in the redirection process.\n*   **Confidence:** The assigned confidence of 0.9 is well-justified. The vulnerability description directly implies a redirection to an untrusted site, which aligns perfectly with CWE-601.\n*   **CWE Specification Alignment:** The analysis correctly notes that CWE-601 is at the Base level of abstraction and that its usage is \"Allowed\" according to the mapping guidance.\n*   **Mitigation Considerations:** The CWE specification for CWE-601 lists the following mitigations:\n    *   **Input Validation:** Employ an \"accept known good\" input validation strategy. Use a list of approved URLs or domains.\n    *   **Intermediate Disclaimer Page:** Use a disclaimer page that warns the user before redirecting.\n    *   **Enforcement by Conversion:** Map fixed input values (numeric IDs) to actual URLs and reject all other inputs.\n\n    The analysis could be improved by explicitly mentioning these mitigations and discussing their applicability in the context of the SAP BusinessObjects platform. This would add more actionable insights. For example, SAP could implement a whitelist of allowed redirect URLs or use an intermediate page with a warning message.\n*   **Observed Examples:** It may be helpful to explicitly call out relevant examples from the Observed Examples section. In this case, all of the observed examples are good examples of the CWE.\n*   **Relationships:** It may be helpful to consider CWE-610 as a parent. As CWE-610 states, the product uses an externally controlled name or reference that resolves to a resource that is outside of the intended control sphere. Since the URL is likely user controlled, this is a good parent to consider.\n\n**CWE-1022: Use of Web Link to Untrusted Target with window.opener Access**\n\n*   **Justification:** The analysis correctly identifies the potential for CWE-1022, given the mention of \"Reverse Tabnabbing.\" Reverse Tabnabbing relies on the `window.opener` object being accessible to the malicious page, which can then modify the original page's location.\n*   **Confidence:** The assigned confidence of 0.6 is appropriate. The connection is less direct than with CWE-601, as it depends on whether the application uses `target=\"_blank\"` or a similar mechanism that exposes the `window.opener` object.\n*   **CWE Specification Alignment:** The analysis correctly notes that CWE-1022 is at the Variant level of abstraction and that its usage is \"Allowed.\"\n*   **Mitigation Considerations:** The CWE specification for CWE-1022 lists the following mitigations:\n    *   **Architecture and Design:** Specify in the design that any linked external document must not be granted access to the location object of the calling page.\n    *   **Implementation:** Use the `rel=\"noopener noreferrer\"` attribute on links with `target=\"_blank\"`.\n    *   **Implementation:** Reset the opener by setting it equal to null when opening the external document in a new window via javascript.\n    *   **Implementation:** Do not use \"_blank\" targets.\n\n    The analysis could be improved by including these specific mitigation recommendations, which can be directly implemented by SAP. For example, SAP should ensure that all links to external sites use `rel=\"noopener noreferrer\"` to prevent Reverse Tabnabbing attacks.\n*   **Observed Examples:** The observed examples are good examples of the CWE.\n*   **Relationships:** The specification notes that CWE-1022 is a child of CWE-266. It may be useful to consider this relationship.\n\n**Additional Considerations from Retriever Results:**\n\nThe retriever results included the following CWEs which were not considered:\n* CWE-306: Missing Authentication for Critical Function\n* CWE-525: Use of Web Browser Cache Containing Sensitive Information\n* CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n* CWE-352: Cross-Site Request Forgery (CSRF)\n* CWE-287: Improper Authentication\n* CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\n* CWE-20: Improper Input Validation\n* CWE-285: Improper Authorization\n\nIt would be useful to explicitly explain why these CWEs were not selected as part of the final analysis.\n\n**Recommendations for Improvement:**\n\n1.  **Explicitly Discuss Mitigations:** For both CWE-601 and CWE-1022, explicitly state the recommended mitigations from the CWE specifications and discuss how they could be applied in the context of the SAP BusinessObjects platform.\n2.  **Consider all Relationships:** Explicitly call out all relevant relationships of the selected CWEs.\n3.  **Justify Exclusion:** Explain why other CWEs that were in the initial retriever results were not chosen.\n4.  **Observed Examples:** Call out relevant examples from the observed examples sections.\n\nBy incorporating these suggestions, the analysis will be more comprehensive and provide more actionable insights for addressing the vulnerability.",
  "resolution": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-601 | URL Redirection to Untrusted Site ('Open Redirect') | 0.95 | Base | Allowed | Primary CWE |\n| CWE-1022 | Use of Web Link to Untrusted Target with window.opener Access | 0.75 | Variant | Allowed | Secondary Candidate |\n| CWE-610 | Externally Controlled Reference to a Critical Resource | 0.5 | Class | Discouraged | Potential Parent of CWE-601 |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-601 URL Redirection to Untrusted Site ('Open Redirect')** which is a Base level CWE. The vulnerability description clearly indicates an unauthenticated attacker can redirect users to a malicious site. The secondary weakness is **CWE-1022 Use of Web Link to Untrusted Target with window.opener Access** which is a Variant level CWE, and is a potential consequence of reverse tabnabbing given the context. Finally, **CWE-610 Externally Controlled Reference to a Critical Resource** is considered as a potential parent to CWE-601 because the URL that is being redirected to is externally controlled. However, it is a Class level CWE and thus less specific than CWE-601.\n\n```mermaid\ngraph TD\n    cwe601[\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\n    cwe1022[\"CWE-1022: Use of Web Link to Untrusted Target with window.opener Access\"]\n    cwe610[\"CWE-610: Externally Controlled Reference to a Critical Resource\"]\n    \n    cwe601 -->|CANALSOBE| cwe1022\n    cwe601 -->|CHILDOF| cwe610\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe601 primary\n    class cwe1022 secondary\n    class cwe610 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with an **unauthenticated attacker** (**ROOTCAUSE**) being able to inject a malicious URL into the application. This is then used by the application to **redirect users** (**WEAKNESS: CWE-601**) to the attacker's malicious site. If the application uses `target=\"_blank\"` or similar mechanism that exposes the `window.opener` object, the attacker could leverage reverse tabnabbing (**WEAKNESS: CWE-1022**). The end result is that users are redirected to a malicious site where they could be subject to phishing attacks or have their credentials stolen.\n\n## Summary of Analysis\nThe initial analysis was correct in identifying **CWE-601** as the primary weakness. The vulnerability description explicitly mentions the redirection to a malicious site which directly corresponds to the description of **CWE-601**.\n> Under certain conditions, SAP BusinessObjects Business Intelligence Platform (SAPUI5), versions - 420, 430, can allow an unauthenticated attacker to **redirect users to a malicious site** due to Reverse Tabnabbing vulnerabilities.\n\nThe analysis also appropriately identified **CWE-1022** as a secondary candidate due to the mention of \"Reverse Tabnabbing.\" The criticism was helpful in pointing out the importance of explicitly discussing mitigations and considering all relationships. Mitigations for **CWE-601** include input validation (whitelisting allowed URLs) and using an intermediate disclaimer page. Mitigations for **CWE-1022** include using `rel=\"noopener noreferrer\"` on links with `target=\"_blank\"`, resetting the opener via javascript, and avoiding the use of \"_blank\" targets altogether.\n\nThe retriever results included several other CWEs which were not chosen:\n*   CWE-306: Missing Authentication for Critical Function: While the vulnerability description mentions an unauthenticated attacker, this is more about the lack of authorization to control the redirection target rather than a missing authentication mechanism. The core issue is the open redirect, not the missing authentication.\n*   CWE-525: Use of Web Browser Cache Containing Sensitive Information: This is not relevant to the vulnerability description.\n*   CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'): This is not relevant as the vulnerability is redirection, not XSS.\n*   CWE-352: Cross-Site Request Forgery (CSRF): This is not directly relevant. CSRF involves tricking a user into performing an action, while this vulnerability is about directly redirecting the user.\n*   CWE-287: Improper Authentication: As mentioned above, the core issue is not the lack of authentication, but the open redirect itself.\n*   CWE-200: Exposure of Sensitive Information to an Unauthorized Actor: This is not directly relevant. The vulnerability is about redirection, not information exposure.\n*   CWE-20: Improper Input Validation: While improper input validation is present, **CWE-601** is more specific and accurately describes the vulnerability.\n*   CWE-285: Improper Authorization: Similar to **CWE-306**, the lack of authorization is a contributing factor, but **CWE-601** captures the essence of the vulnerability (open redirect) more accurately.\n\n**CWE-610** was added as a potential parent of **CWE-601** to acknowledge that the URL being redirected to is externally controlled. However, **CWE-601** is more specific and therefore more appropriate as the primary **WEAKNESS**.\n\nThe final classification reflects the optimal level of specificity based on the available evidence and relationship analysis. **CWE-601** is the primary issue, with **CWE-1022** as a secondary concern due to the possibility of reverse tabnabbing. The confidence score has been increased to 0.85 to reflect the inclusion of the mitigations and considering other CWEs.",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "CWE-601",
        "name": "URL Redirection to Untrusted Site ('Open Redirect')",
        "type": "Base",
        "original_content": "The web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a redirect.",
        "relationships": [],
        "original_sparse_score": 43.542284574568264,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5008837506027575,
            "sparse": 43.542284574568264,
            "graph": 1.5153166372046936
          },
          "normalized_scores": {
            "dense": 0.5008837506027575,
            "sparse": 0.03483382765965461,
            "graph": 0.5411845132873906
          },
          "weighted_scores": {
            "dense": 0.17530931271096512,
            "sparse": 0.013933531063861845,
            "graph": 0.13529612832184765
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5008837506027575,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.5008837506027575,
              "weight": 0.35,
              "weighted_score": 0.17530931271096512
            },
            "sparse": {
              "raw_score": 43.542284574568264,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03483382765965461,
              "weight": 0.4,
              "weighted_score": 0.013933531063861845
            },
            "graph": {
              "raw_score": 1.5153166372046936,
              "query_max": 2.6784000000000003,
              "query_min": 1.1793600000000002,
              "normalized_score": 0.5411845132873906,
              "weight": 0.25,
              "weighted_score": 0.13529612832184765
            }
          },
          "contribution_percentages": {
            "dense": 54.017954015933555,
            "sparse": 4.2933306203087644,
            "graph": 41.68871536375768
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.3245389720966746,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.42190066372567697
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.42190066372567697
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.4640907300982447
            }
          },
          "combined_score": 0.4640907300982447
        }
      },
      "similarity": 0.4640907300982447
    },
    {
      "metadata": {
        "doc_id": "CWE-306",
        "name": "Missing Authentication for Critical Function",
        "type": "Base",
        "original_content": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.",
        "relationships": [],
        "original_sparse_score": 49.49942287440396,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4703612359951007,
            "sparse": 49.49942287440396,
            "graph": 1.613110013824765
          },
          "normalized_scores": {
            "dense": 0.4703612359951007,
            "sparse": 0.03959953829952317,
            "graph": 0.5761107192231304
          },
          "weighted_scores": {
            "dense": 0.16462643259828524,
            "sparse": 0.015839815319809266,
            "graph": 0.1440276798057826
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4703612359951007,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.4703612359951007,
              "weight": 0.35,
              "weighted_score": 0.16462643259828524
            },
            "sparse": {
              "raw_score": 49.49942287440396,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03959953829952317,
              "weight": 0.4,
              "weighted_score": 0.015839815319809266
            },
            "graph": {
              "raw_score": 1.613110013824765,
              "query_max": 2.6784000000000003,
              "query_min": 1.1793600000000002,
              "normalized_score": 0.5761107192231304,
              "weight": 0.25,
              "weighted_score": 0.1440276798057826
            }
          },
          "contribution_percentages": {
            "dense": 50.73328605963051,
            "sparse": 4.8813903640403105,
            "graph": 44.385323576329185
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.3244939277238771,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.4218421060410402
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.4218421060410402
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.46402631664514427
            }
          },
          "combined_score": 0.46402631664514427
        }
      },
      "similarity": 0.46402631664514427
    },
    {
      "metadata": {
        "doc_id": "CWE-525",
        "name": "Use of Web Browser Cache Containing Sensitive Information",
        "type": "Variant",
        "original_content": "The web application does not use an appropriate caching policy that specifies the extent to which each web page and associated form fields should be cached.",
        "relationships": [],
        "original_sparse_score": 43.96641746768287,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4941510054683462,
            "sparse": 43.96641746768287,
            "graph": 1.2640213976627195
          },
          "normalized_scores": {
            "dense": 0.4941510054683462,
            "sparse": 0.035173133974146294,
            "graph": 0.4514362134509713
          },
          "weighted_scores": {
            "dense": 0.17295285191392118,
            "sparse": 0.014069253589658519,
            "graph": 0.11285905336274282
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4941510054683462,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.4941510054683462,
              "weight": 0.35,
              "weighted_score": 0.17295285191392118
            },
            "sparse": {
              "raw_score": 43.96641746768287,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.035173133974146294,
              "weight": 0.4,
              "weighted_score": 0.014069253589658519
            },
            "graph": {
              "raw_score": 1.2640213976627195,
              "query_max": 2.6784000000000003,
              "query_min": 1.1793600000000002,
              "normalized_score": 0.4514362134509713,
              "weight": 0.25,
              "weighted_score": 0.11285905336274282
            }
          },
          "contribution_percentages": {
            "dense": 57.673797369516656,
            "sparse": 4.6916097172780855,
            "graph": 37.63459291320526
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.2998811588663225,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.359857390639587
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.359857390639587
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.39584312970354574
            }
          },
          "combined_score": 0.39584312970354574
        }
      },
      "similarity": 0.39584312970354574
    },
    {
      "metadata": {
        "doc_id": "CWE-1022",
        "name": "Use of Web Link to Untrusted Target with window.opener Access",
        "type": "Variant",
        "original_content": "The web application produces links to untrusted external sites outside of its sphere of control, but it does not properly prevent the external site from modifying  security-critical properties of the window.opener object, such as the location property.",
        "relationships": [],
        "original_sparse_score": 113.79824611743469,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.585531562372613,
            "sparse": 113.79824611743469
          },
          "normalized_scores": {
            "dense": 0.585531562372613,
            "sparse": 0.09103859689394775
          },
          "weighted_scores": {
            "dense": 0.20493604683041453,
            "sparse": 0.0364154387575791
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.585531562372613,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.585531562372613,
              "weight": 0.35,
              "weighted_score": 0.20493604683041453
            },
            "sparse": {
              "raw_score": 113.79824611743469,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.09103859689394775,
              "weight": 0.4,
              "weighted_score": 0.0364154387575791
            }
          },
          "contribution_percentages": {
            "dense": 84.91186467368874,
            "sparse": 15.088135326311262
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.24135148558799363,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.28962178270559236
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.28962178270559236
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.3185839609761516
            }
          },
          "combined_score": 0.3185839609761516
        }
      },
      "similarity": 0.3185839609761516
    },
    {
      "metadata": {
        "doc_id": "CWE-79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "type": "Base",
        "original_content": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
        "relationships": [],
        "original_sparse_score": 42.63353252471913,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4648250670634083,
            "sparse": 42.63353252471913
          },
          "normalized_scores": {
            "dense": 0.4648250670634083,
            "sparse": 0.034106826019775306
          },
          "weighted_scores": {
            "dense": 0.1626887734721929,
            "sparse": 0.013642730407910123
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4648250670634083,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.4648250670634083,
              "weight": 0.35,
              "weighted_score": 0.1626887734721929
            },
            "sparse": {
              "raw_score": 42.63353252471913,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.034106826019775306,
              "weight": 0.4,
              "weighted_score": 0.013642730407910123
            }
          },
          "contribution_percentages": {
            "dense": 92.26302157713887,
            "sparse": 7.736978422861139
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.17633150388010302,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.22923095504413393
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.22923095504413393
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.25215405054854734
            }
          },
          "combined_score": 0.25215405054854734
        }
      },
      "similarity": 0.25215405054854734
    },
    {
      "metadata": {
        "doc_id": "CWE-352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "type": "Compound",
        "original_content": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
        "relationships": [],
        "original_sparse_score": 42.44755572315137,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This is a well-known Composite of multiple weaknesses that must all occur simultaneously, although it is attack-oriented in nature.",
          "comments": "While attack-oriented composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine if other weaknesses allow CSRF attacks to occur, and map to those weaknesses. For example, predictable CSRF tokens might allow bypass of CSRF protection mechanisms; if this occurs, they might be better characterized as randomness/predictability weaknesses.",
          "reasons": [
            "Other"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 42.44755572315137,
            "graph": 1.2880000000000003
          },
          "normalized_scores": {
            "sparse": 0.03395804457852109,
            "graph": 0.46000000000000013
          },
          "weighted_scores": {
            "sparse": 0.013583217831408437,
            "graph": 0.11500000000000003
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 42.44755572315137,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03395804457852109,
              "weight": 0.4,
              "weighted_score": 0.013583217831408437
            },
            "graph": {
              "raw_score": 1.2880000000000003,
              "query_max": 2.6784000000000003,
              "query_min": 1.1793600000000002,
              "normalized_score": 0.46000000000000013,
              "weight": 0.25,
              "weighted_score": 0.11500000000000003
            }
          },
          "contribution_percentages": {
            "sparse": 10.563756344329503,
            "graph": 89.4362436556705
          },
          "abstraction_factor": 1.0,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.12858321783140847,
            "abstraction": {
              "type": "compound",
              "factor": 1.0,
              "score_after": 0.12858321783140847
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.12858321783140847
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This is a well-known Composite of multiple weaknesses that must all occur simultaneously, although it is attack-oriented in nature.",
                "comments": "While attack-oriented composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine if other weaknesses allow CSRF attacks to occur, and map to those weaknesses. For example, predictable CSRF tokens might allow bypass of CSRF protection mechanisms; if this occurs, they might be better characterized as randomness/predictability weaknesses.",
                "reasons": [
                  "Other"
                ]
              },
              "score_after": 0.14144153961454933
            }
          },
          "combined_score": 0.14144153961454933
        }
      },
      "similarity": 0.14144153961454933
    },
    {
      "metadata": {
        "doc_id": "CWE-287",
        "name": "Improper Authentication",
        "type": "Class",
        "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
        "relationships": [],
        "original_sparse_score": 46.13253405203046,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.",
          "reasons": [
            "Frequent Misuse"
          ],
          "suggestions": [
            {
              "CweID": "1390",
              "Comment": "Weak Authentication"
            },
            {
              "CweID": "306",
              "Comment": "Missing Authentication for Critical Function"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4755395294756915,
            "sparse": 46.13253405203046
          },
          "normalized_scores": {
            "dense": 0.4755395294756915,
            "sparse": 0.03690602724162437
          },
          "weighted_scores": {
            "dense": 0.166438835316492,
            "sparse": 0.014762410896649748
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4755395294756915,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.4755395294756915,
              "weight": 0.35,
              "weighted_score": 0.166438835316492
            },
            "sparse": {
              "raw_score": 46.13253405203046,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03690602724162437,
              "weight": 0.4,
              "weighted_score": 0.014762410896649748
            }
          },
          "contribution_percentages": {
            "dense": 91.85303015008785,
            "sparse": 8.146969849912153
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.18120124621314176,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.14496099697051343
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.14496099697051343
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.",
                "reasons": [
                  "Frequent Misuse"
                ],
                "suggestions": [
                  {
                    "CweID": "1390",
                    "Comment": "Weak Authentication"
                  },
                  {
                    "CweID": "306",
                    "Comment": "Missing Authentication for Critical Function"
                  }
                ]
              },
              "score_after": 0.11596879757641075
            }
          },
          "combined_score": 0.11596879757641075
        }
      },
      "similarity": 0.11596879757641075
    },
    {
      "metadata": {
        "doc_id": "CWE-200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "type": "Class",
        "original_content": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
        "relationships": [],
        "original_sparse_score": 51.43918467404375,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-200 is commonly misused to represent the loss of confidentiality in a vulnerability, but confidentiality loss is a technical impact - not a root cause error. As of CWE 4.9, over 400 CWE entries can lead to a loss of confidentiality. Other options are often available. [REF-1287].",
          "comments": "If an error or mistake causes information to be disclosed, then use the CWE ID for that error. Consider starting with improper authorization (CWE-285), insecure permissions (CWE-732), improper authentication (CWE-287), etc. Also consider children such as Insertion of Sensitive Information Into Sent Data (CWE-201), Observable Discrepancy (CWE-203), Insertion of Sensitive Information into Externally-Accessible File or Directory (CWE-538), or others.",
          "reasons": [
            "Frequent Misuse"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.46537090976390477,
            "sparse": 51.43918467404375
          },
          "normalized_scores": {
            "dense": 0.46537090976390477,
            "sparse": 0.041151347739235004
          },
          "weighted_scores": {
            "dense": 0.16287981841736665,
            "sparse": 0.016460539095694
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.46537090976390477,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.46537090976390477,
              "weight": 0.35,
              "weighted_score": 0.16287981841736665
            },
            "sparse": {
              "raw_score": 51.43918467404375,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.041151347739235004,
              "weight": 0.4,
              "weighted_score": 0.016460539095694
            }
          },
          "contribution_percentages": {
            "dense": 90.82162022873449,
            "sparse": 9.178379771265508
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.17934035751306066,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.14347228601044854
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.14347228601044854
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-200 is commonly misused to represent the loss of confidentiality in a vulnerability, but confidentiality loss is a technical impact - not a root cause error. As of CWE 4.9, over 400 CWE entries can lead to a loss of confidentiality. Other options are often available. [REF-1287].",
                "comments": "If an error or mistake causes information to be disclosed, then use the CWE ID for that error. Consider starting with improper authorization (CWE-285), insecure permissions (CWE-732), improper authentication (CWE-287), etc. Also consider children such as Insertion of Sensitive Information Into Sent Data (CWE-201), Observable Discrepancy (CWE-203), Insertion of Sensitive Information into Externally-Accessible File or Directory (CWE-538), or others.",
                "reasons": [
                  "Frequent Misuse"
                ]
              },
              "score_after": 0.11477782880835884
            }
          },
          "combined_score": 0.11477782880835884
        }
      },
      "similarity": 0.11477782880835884
    },
    {
      "metadata": {
        "doc_id": "CWE-20",
        "name": "Improper Input Validation",
        "type": "Class",
        "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
        "relationships": [],
        "original_sparse_score": 48.34322959535434,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-20 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available [REF-1287]. It is not useful for trend analysis. It is also a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Consider lower-level children such as Improper Use of Validation Framework (CWE-1173) or improper validation involving specific types or properties of input such as Specified Quantity (CWE-1284); Specified Index, Position, or Offset (CWE-1285); Syntactic Correctness (CWE-1286); Specified Type (CWE-1287); Consistency within Input (CWE-1288); or Unsafe Equivalence (CWE-1289).",
          "reasons": [
            "Frequent Misuse"
          ],
          "suggestions": [
            {
              "CweID": "1284",
              "Comment": "Specified Quantity"
            },
            {
              "CweID": "1285",
              "Comment": "Specified Index, Position, or Offset"
            },
            {
              "CweID": "1286",
              "Comment": "Syntactic Correctness"
            },
            {
              "CweID": "1287",
              "Comment": "Specified Type"
            },
            {
              "CweID": "1288",
              "Comment": "Consistency within Input"
            },
            {
              "CweID": "1289",
              "Comment": "Unsafe Equivalence"
            },
            {
              "CweID": "116",
              "Comment": "Improper Encoding or Escaping of Output"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.46440803636214373,
            "sparse": 48.34322959535434
          },
          "normalized_scores": {
            "dense": 0.46440803636214373,
            "sparse": 0.03867458367628347
          },
          "weighted_scores": {
            "dense": 0.1625428127267503,
            "sparse": 0.01546983347051339
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.46440803636214373,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.46440803636214373,
              "weight": 0.35,
              "weighted_score": 0.1625428127267503
            },
            "sparse": {
              "raw_score": 48.34322959535434,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03867458367628347,
              "weight": 0.4,
              "weighted_score": 0.01546983347051339
            }
          },
          "contribution_percentages": {
            "dense": 91.30969973146145,
            "sparse": 8.690300268538552
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.1780126461972637,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.14241011695781097
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.14241011695781097
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-20 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available [REF-1287]. It is not useful for trend analysis. It is also a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Consider lower-level children such as Improper Use of Validation Framework (CWE-1173) or improper validation involving specific types or properties of input such as Specified Quantity (CWE-1284); Specified Index, Position, or Offset (CWE-1285); Syntactic Correctness (CWE-1286); Specified Type (CWE-1287); Consistency within Input (CWE-1288); or Unsafe Equivalence (CWE-1289).",
                "reasons": [
                  "Frequent Misuse"
                ],
                "suggestions": [
                  {
                    "CweID": "1284",
                    "Comment": "Specified Quantity"
                  },
                  {
                    "CweID": "1285",
                    "Comment": "Specified Index, Position, or Offset"
                  },
                  {
                    "CweID": "1286",
                    "Comment": "Syntactic Correctness"
                  },
                  {
                    "CweID": "1287",
                    "Comment": "Specified Type"
                  },
                  {
                    "CweID": "1288",
                    "Comment": "Consistency within Input"
                  },
                  {
                    "CweID": "1289",
                    "Comment": "Unsafe Equivalence"
                  },
                  {
                    "CweID": "116",
                    "Comment": "Improper Encoding or Escaping of Output"
                  }
                ]
              },
              "score_after": 0.11392809356624878
            }
          },
          "combined_score": 0.11392809356624878
        }
      },
      "similarity": 0.11392809356624878
    },
    {
      "metadata": {
        "doc_id": "CWE-285",
        "name": "Improper Authorization",
        "type": "Class",
        "original_content": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.",
        "relationships": [],
        "original_sparse_score": 46.37426904830388,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.",
          "reasons": [
            "Abstraction"
          ],
          "suggestions": [
            {
              "CweID": "862",
              "Comment": "Missing Authorization"
            },
            {
              "CweID": "863",
              "Comment": "Incorrect Authorization"
            },
            {
              "CweID": "732",
              "Comment": "Incorrect Permission Assignment for Critical Resource"
            }
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4584291306190864,
            "sparse": 46.37426904830388
          },
          "normalized_scores": {
            "dense": 0.4584291306190864,
            "sparse": 0.0370994152386431
          },
          "weighted_scores": {
            "dense": 0.16045019571668023,
            "sparse": 0.014839766095457242
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4584291306190864,
              "query_max": 0.585531562372613,
              "query_min": 0.4552063125672014,
              "normalized_score": 0.4584291306190864,
              "weight": 0.35,
              "weighted_score": 0.16045019571668023
            },
            "sparse": {
              "raw_score": 46.37426904830388,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.0370994152386431,
              "weight": 0.4,
              "weighted_score": 0.014839766095457242
            }
          },
          "contribution_percentages": {
            "dense": 91.53416091712008,
            "sparse": 8.465839082879931
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.17528996181213746,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.14023196944970998
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.14023196944970998
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Look at CWE-285's children and consider mapping to CWEs such as CWE-862: Missing Authorization, CWE-863: Incorrect Authorization, CWE-732: Incorrect Permission Assignment for Critical Resource, or others.",
                "reasons": [
                  "Abstraction"
                ],
                "suggestions": [
                  {
                    "CweID": "862",
                    "Comment": "Missing Authorization"
                  },
                  {
                    "CweID": "863",
                    "Comment": "Incorrect Authorization"
                  },
                  {
                    "CweID": "732",
                    "Comment": "Incorrect Permission Assignment for Critical Resource"
                  }
                ]
              },
              "score_after": 0.11218557555976799
            }
          },
          "combined_score": 0.11218557555976799
        }
      },
      "similarity": 0.11218557555976799
    },
    {
      "metadata": {
        "doc_id": "CWE-311",
        "name": "Missing Encryption of Sensitive Data",
        "type": "Class",
        "original_content": "The product does not encrypt sensitive or critical information before storage or transmission.",
        "relationships": [],
        "original_sparse_score": 55.84029007564173,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-311 is high-level with more precise children available. It is a level-1 Class (i.e., a child of a Pillar).",
          "comments": "Consider children CWE-312: Cleartext Storage of Sensitive Information or CWE-319: Cleartext Transmission of Sensitive Information.",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 55.84029007564173,
            "graph": 1.192
          },
          "normalized_scores": {
            "sparse": 0.044672232060513385,
            "graph": 0.4257142857142857
          },
          "weighted_scores": {
            "sparse": 0.017868892824205354,
            "graph": 0.10642857142857143
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 55.84029007564173,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.044672232060513385,
              "weight": 0.4,
              "weighted_score": 0.017868892824205354
            },
            "graph": {
              "raw_score": 1.192,
              "query_max": 2.6784000000000003,
              "query_min": 1.1793600000000002,
              "normalized_score": 0.4257142857142857,
              "weight": 0.25,
              "weighted_score": 0.10642857142857143
            }
          },
          "contribution_percentages": {
            "sparse": 14.375910990321081,
            "graph": 85.62408900967891
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.12429746425277678,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.09943797140222144
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.09943797140222144
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-311 is high-level with more precise children available. It is a level-1 Class (i.e., a child of a Pillar).",
                "comments": "Consider children CWE-312: Cleartext Storage of Sensitive Information or CWE-319: Cleartext Transmission of Sensitive Information.",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.07955037712177715
            }
          },
          "combined_score": 0.07955037712177715
        }
      },
      "similarity": 0.07955037712177715
    },
    {
      "metadata": {
        "doc_id": "CWE-444",
        "name": "Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')",
        "type": "Base",
        "original_content": "The product acts as an intermediary HTTP agent\n         (such as a proxy or firewall) in the data flow between two\n         entities such as a client and server, but it does not\n         interpret malformed HTTP requests or responses in ways that\n         are consistent with how the messages will be processed by\n         those entities that are at the ultimate destination.",
        "relationships": [],
        "original_sparse_score": 43.91440298547478,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 43.91440298547478
          },
          "normalized_scores": {
            "sparse": 0.03513152238837983
          },
          "weighted_scores": {
            "sparse": 0.01405260895535193
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 43.91440298547478,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03513152238837983,
              "weight": 0.4,
              "weighted_score": 0.01405260895535193
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.01405260895535193,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.01826839164195751
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.01826839164195751
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.02009523080615326
            }
          },
          "combined_score": 0.02009523080615326
        }
      },
      "similarity": 0.02009523080615326
    },
    {
      "metadata": {
        "doc_id": "CWE-1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "type": "Base",
        "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
        "relationships": [],
        "original_sparse_score": 42.685343291954666,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 42.685343291954666
          },
          "normalized_scores": {
            "sparse": 0.034148274633563735
          },
          "weighted_scores": {
            "sparse": 0.013659309853425495
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 42.685343291954666,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.034148274633563735,
              "weight": 0.4,
              "weighted_score": 0.013659309853425495
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.013659309853425495,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.017757102809453144
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.017757102809453144
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.01953281309039846
            }
          },
          "combined_score": 0.01953281309039846
        }
      },
      "similarity": 0.01953281309039846
    },
    {
      "metadata": {
        "doc_id": "CWE-749",
        "name": "Exposed Dangerous Method or Function",
        "type": "Base",
        "original_content": "The product provides an Applications Programming Interface (API) or similar interface for interaction with external actors, but the interface includes a dangerous method or function that is not properly restricted.",
        "relationships": [],
        "original_sparse_score": 42.48887645465014,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 42.48887645465014
          },
          "normalized_scores": {
            "sparse": 0.03399110116372011
          },
          "weighted_scores": {
            "sparse": 0.013596440465488045
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 42.48887645465014,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03399110116372011,
              "weight": 0.4,
              "weighted_score": 0.013596440465488045
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.013596440465488045,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.017675372605134458
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.017675372605134458
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.019442909865647905
            }
          },
          "combined_score": 0.019442909865647905
        }
      },
      "similarity": 0.019442909865647905
    },
    {
      "metadata": {
        "doc_id": "CWE-1289",
        "name": "Improper Validation of Unsafe Equivalence in Input",
        "type": "Base",
        "original_content": "The product receives an input value that is used as a resource identifier or other type of reference, but it does not validate or incorrectly validates that the input is equivalent to a potentially-unsafe value.",
        "relationships": [],
        "original_sparse_score": 41.96337122529933,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 41.96337122529933
          },
          "normalized_scores": {
            "sparse": 0.03357069698023947
          },
          "weighted_scores": {
            "sparse": 0.013428278792095788
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 41.96337122529933,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03357069698023947,
              "weight": 0.4,
              "weighted_score": 0.013428278792095788
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.013428278792095788,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.017456762429724524
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.017456762429724524
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.019202438672696977
            }
          },
          "combined_score": 0.019202438672696977
        }
      },
      "similarity": 0.019202438672696977
    },
    {
      "metadata": {
        "doc_id": "CWE-95",
        "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
        "type": "Variant",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before using the input in a dynamic evaluation call (e.g. \"eval\").",
        "relationships": [],
        "original_sparse_score": 43.51332997726292,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 43.51332997726292
          },
          "normalized_scores": {
            "sparse": 0.03481066398181033
          },
          "weighted_scores": {
            "sparse": 0.013924265592724134
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 43.51332997726292,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03481066398181033,
              "weight": 0.4,
              "weighted_score": 0.013924265592724134
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.013924265592724134,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.01670911871126896
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.01670911871126896
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.018380030582395856
            }
          },
          "combined_score": 0.018380030582395856
        }
      },
      "similarity": 0.018380030582395856
    },
    {
      "metadata": {
        "doc_id": "CWE-862",
        "name": "Missing Authorization",
        "type": "Class",
        "original_content": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
        "relationships": [],
        "original_sparse_score": 43.32628987008035,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 43.32628987008035
          },
          "normalized_scores": {
            "sparse": 0.03466103189606428
          },
          "weighted_scores": {
            "sparse": 0.013864412758425712
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 43.32628987008035,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.03466103189606428,
              "weight": 0.4,
              "weighted_score": 0.013864412758425712
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.013864412758425712,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.011091530206740571
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.011091530206740571
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.0116461067170776
            }
          },
          "combined_score": 0.0116461067170776
        }
      },
      "similarity": 0.0116461067170776
    },
    {
      "metadata": {
        "doc_id": "CWE-668",
        "name": "Exposure of Resource to Wrong Sphere",
        "type": "Class",
        "original_content": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.",
        "relationships": [],
        "original_sparse_score": 56.33298887935788,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.",
          "comments": "Closely analyze the specific mistake that is allowing the resource to be exposed, and perform a CWE mapping for that mistake.",
          "reasons": [
            "Frequent Misuse",
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 56.33298887935788
          },
          "normalized_scores": {
            "sparse": 0.0450663911034863
          },
          "weighted_scores": {
            "sparse": 0.01802655644139452
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 56.33298887935788,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.0450663911034863,
              "weight": 0.4,
              "weighted_score": 0.01802655644139452
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.01802655644139452,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.014421245153115617
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.014421245153115617
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.",
                "comments": "Closely analyze the specific mistake that is allowing the resource to be exposed, and perform a CWE mapping for that mistake.",
                "reasons": [
                  "Frequent Misuse",
                  "Abstraction"
                ]
              },
              "score_after": 0.011536996122492494
            }
          },
          "combined_score": 0.011536996122492494
        }
      },
      "similarity": 0.011536996122492494
    },
    {
      "metadata": {
        "doc_id": "CWE-74",
        "name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
        "type": "Class",
        "original_content": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 44.03319859183579,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.",
          "comments": "Examine the children and descendants of this entry to find a more precise mapping.",
          "reasons": [
            "Frequent Misuse",
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 44.03319859183579
          },
          "normalized_scores": {
            "sparse": 0.035226558873468636
          },
          "weighted_scores": {
            "sparse": 0.014090623549387456
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 44.03319859183579,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.035226558873468636,
              "weight": 0.4,
              "weighted_score": 0.014090623549387456
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.014090623549387456,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.011272498839509966
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.011272498839509966
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.",
                "comments": "Examine the children and descendants of this entry to find a more precise mapping.",
                "reasons": [
                  "Frequent Misuse",
                  "Abstraction"
                ]
              },
              "score_after": 0.009017999071607974
            }
          },
          "combined_score": 0.009017999071607974
        }
      },
      "similarity": 0.009017999071607974
    },
    {
      "metadata": {
        "doc_id": "CWE-610",
        "name": "Externally Controlled Reference to a Resource in Another Sphere",
        "type": "Class",
        "original_content": "The product uses an externally controlled name or reference that resolves to a resource that is outside of the intended control sphere.",
        "relationships": [],
        "original_sparse_score": 42.483756482837634,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 42.483756482837634
          },
          "normalized_scores": {
            "sparse": 0.033987005186270104
          },
          "weighted_scores": {
            "sparse": 0.013594802074508042
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 42.483756482837634,
              "query_max": 113.79824611743469,
              "query_min": 41.96337122529933,
              "normalized_score": 0.033987005186270104,
              "weight": 0.4,
              "weighted_score": 0.013594802074508042
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.013594802074508042,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.010875841659606434
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.010875841659606434
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.008700673327685147
            }
          },
          "combined_score": 0.008700673327685147
        }
      },
      "similarity": 0.008700673327685147
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-1022",
      "CWE-601"
    ],
    "critic_additional": [
      "CWE-525",
      "CWE-352",
      "CWE-20",
      "CWE-306",
      "CWE-610",
      "CWE-200",
      "CWE-287",
      "CWE-79",
      "CWE-285",
      "CWE-266"
    ]
  }
}