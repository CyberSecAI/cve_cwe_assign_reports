# Raw Retriever Results for CVE-2021-42341

# Raw Retriever Results for CVE-2021-42341

## Query
checkpath in OpenRC before 0.44.7 uses the direct output of strlen() to allocate strings, which does not account for the \0 byte at the end of the string. This results in memory corruption. CVE-2021-42341 was introduced in git commit 63db2d99e730547339d1bdd28e8437999c380cae, which was introduced as part of OpenRC 0.44.0 development.

## Keyphrases
- **rootcause**: uses the direct output of strlen() to allocate strings, which does not account for the \0 byte at the end of the string

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4805 | 0.5211 | 0.4908 | 0.4861 | 20 |
| Sparse | 384.4210 | 789.3914 | 423.4142 | 399.7205 | 20 |
| Graph | 1.7680 | 3.8870 | 2.3643 | 2.2100 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | base | 3.8870 | Allowed |
| 2 | 170 | Improper Null Termination | Base | 2.8136 | Allowed |
| 3 | 193 | Off-by-one Error | Base | 2.8094 | Allowed |
| 4 | 123 | Write-what-where Condition | base | 2.7014 | Allowed |
| 5 | 126 | Buffer Over-read | Variant | 2.5496 | Allowed |
| 6 | 190 | Integer Overflow or Wraparound | Base | 2.3538 | Allowed |
| 7 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 8 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 9 | 364 | Signal Handler Race Condition | base | 2.2100 | Allowed |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 12 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 13 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 14 | 617 | Reachable Assertion | base | 2.2100 | Allowed |
| 15 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 126 | Buffer Over-read | Variant | 0.5211 | 0.5211 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | Base | 0.5061 | 0.5061 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5031 | 0.5031 | Allowed-with-Review |
| 4 | 416 | Use After Free | Variant | 0.5007 | 0.5007 | Allowed |
| 5 | 476 | NULL Pointer Dereference | Base | 0.5000 | 0.5000 | Allowed |
| 6 | 667 | Improper Locking | Class | 0.4968 | 0.4968 | Allowed-with-Review |
| 7 | 122 | Heap-based Buffer Overflow | Variant | 0.4956 | 0.4956 | Allowed |
| 8 | 786 | Access of Memory Location Before Start of Buffer | Base | 0.4902 | 0.4902 | Discouraged |
| 9 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4865 | 0.4865 | Allowed |
| 10 | 193 | Off-by-one Error | Base | 0.4864 | 0.4864 | Allowed |
| 11 | 665 | Improper Initialization | Class | 0.4858 | 0.4858 | Discouraged |
| 12 | 908 | Use of Uninitialized Resource | Base | 0.4850 | 0.4850 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4844 | 0.4844 | Allowed-with-Review |
| 14 | 788 | Access of Memory Location After End of Buffer | Base | 0.4843 | 0.4843 | Discouraged |
| 15 | 170 | Improper Null Termination | Base | 0.4830 | 0.4830 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-170 | Improper Null Termination | 789.3914 | 789.3914 | Allowed |
| 2 | CWE-125 | Out-of-bounds Read | 442.2293 | 442.2293 | Allowed |
| 3 | CWE-193 | Off-by-one Error | 432.5169 | 432.5169 | Allowed |
| 4 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 429.3984 | 429.3984 | Allowed |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | 420.9505 | 420.9505 | Allowed |
| 6 | CWE-335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 420.2425 | 420.2425 | Allowed |
| 7 | CWE-158 | Improper Neutralization of Null Byte or NUL Character | 411.2441 | 411.2441 | Allowed |
| 8 | CWE-116 | Improper Encoding or Escaping of Output | 410.1058 | 410.1058 | Allowed-with-Review |
| 9 | CWE-122 | Heap-based Buffer Overflow | 404.3798 | 404.3798 | Allowed |
| 10 | CWE-789 | Memory Allocation with Excessive Size Value | 400.8036 | 400.8036 | Allowed |
| 11 | CWE-639 | Authorization Bypass Through User-Controlled Key | 398.6374 | 398.6374 | Allowed |
| 12 | CWE-674 | Uncontrolled Recursion | 397.6740 | 397.6740 | Allowed-with-Review |
| 13 | CWE-770 | Allocation of Resources Without Limits or Throttling | 394.9404 | 394.9404 | Allowed |
| 14 | CWE-1333 | Inefficient Regular Expression Complexity | 393.4894 | 393.4894 | Allowed |
| 15 | CWE-625 | Permissive Regular Expression | 393.0168 | 393.0168 | Allowed |
