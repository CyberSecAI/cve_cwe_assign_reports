# Vulnerability Information: CVE-2021-23975

## Vulnerability Description
The developer page aboutmemory has a Measure function for exploring what object types the browser has allocated and their sizes. When this function was invoked we incorrectly called the sizeof function, instead of using the API method that checks for invalid pointers. This vulnerability affects Firefox < 86.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect function call**
- **vector:** invalid pointers
- **product:** Firefox
- **version:** < 86
- **component:** developer page aboutmemory

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-23975:

**Root Cause of Vulnerability:**
The vulnerability stems from an incorrect usage of memory profiling code within the `about:memory` developer tool in Firefox. Specifically, the code directly called the `sizeof` function on a pointer without first validating if the pointer was valid.

**Weaknesses/Vulnerabilities Present:**
- Incorrect pointer handling: The code attempted to use `malloc_usable_size()` on a pointer that was not allocated through malloc, leading to an invalid memory access.
- Lack of proper validation: The `sizeof` function was called directly without checking the pointer's validity, resulting in a crash.

**Impact of Exploitation:**
- Denial of Service: The primary impact of this vulnerability is a crash in Firefox when the `about:memory` "Measure" function is invoked.

**Attack Vectors:**
- User interaction: The vulnerability is triggered by a user navigating to `about:memory` and clicking the "Measure" button.

**Required Attacker Capabilities/Position:**
- The attacker needs to have the ability to access and interact with Firefox's user interface. No special privileges or remote access are needed, as it can be triggered by a user within their own browser session.

**Additional Notes:**
- The fix involved using the correct API that checks for invalid pointers before calling `sizeof`, thus preventing the crash.
- The vulnerability was classified as low severity and was fixed in Firefox 86 and later versions, and was not present in the ESR 78.x branch.
- The vulnerability was also fixed in Firefox Beta 86.
- This issue is not exploitable to execute code, but just leads to a crash of the browser.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5619 | dense, sparse, graph | dense: 0.487, sparse: 0.187, graph: 0.592 |
| 2 | CWE-467 | Use of sizeof() on a Pointer Type | Variant | Allowed | 0.5081 | dense, sparse | dense: 0.629, sparse: 0.412 |
| 3 | CWE-457 | Use of Uninitialized Variable | Variant | Allowed | 0.3888 | sparse, graph | sparse: 0.187, graph: 0.879 |
| 4 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.3744 | sparse, graph | sparse: 0.182, graph: 0.757 |
| 5 | CWE-415 | Double Free | Variant | Allowed | 0.3632 | sparse, graph | sparse: 0.190, graph: 0.797 |
| 6 | CWE-704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | 0.1939 | dense, sparse | dense: 0.454, sparse: 0.180 |
| 7 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.1029 | sparse | sparse: 0.180 |
| 8 | CWE-267 | Privilege Defined With Unsafe Actions | Base | Allowed | 0.1017 | sparse | sparse: 0.178 |
| 9 | CWE-911 | Improper Update of Reference Count | Base | Allowed | 0.1000 | sparse | sparse: 0.175 |
| 10 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.0995 | sparse | sparse: 0.174 |

