# Vulnerability Information: CVE-2022-0351

## Vulnerability Description
Access of Memory Location Before Start of Buffer in GitHub repository vim/vim prior to 8.2.

### Vulnerability Description Key Phrases
- **weakness:** **out-of-bounds read**
- **vector:** read value at uninitialized memory
- **product:** vim
- **version:** prior to 8.2

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by a lack of proper recursion limit during the parsing of nested parenthesis in expressions, leading to a stack overflow.",
    "weaknesses": [
      "Stack overflow",
      "Insufficient recursion limit"
    ],
    "impact": "The vulnerability can cause a denial-of-service (application crash) due to a stack overflow.",
    "attack_vectors": [
      "Crafted input with deeply nested parenthesis"
    ],
    "required_capabilities": [
      "Ability to provide input to the vulnerable application (Vim)"
    ],
     "additional_details": "The vulnerability is present in Vim's expression evaluation logic. Specifically, when parsing expressions containing many nested parentheses, the function `eval7()` recursively calls itself, and without a recursion limit it overflows the stack. The fix adds a check to the function that limits recursion to 1000 levels, avoiding the stack overflow."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.5552 | dense, sparse, graph | dense: 0.524, sparse: 0.131, graph: 0.611 |
| 2 | CWE-805 | Buffer Access with Incorrect Length Value | Base | Allowed | 0.5445 | dense, sparse, graph | dense: 0.540, sparse: 0.096, graph: 0.613 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5045 | dense, sparse, graph | dense: 0.541, sparse: 0.142, graph: 0.545 |
| 4 | CWE-786 | Access of Memory Location Before Start of Buffer | Base | Discouraged | 0.4728 | dense, sparse, graph | dense: 0.676, sparse: 0.149, graph: 0.634 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4616 | dense, sparse, graph | dense: 0.477, sparse: 0.121, graph: 0.537 |
| 6 | CWE-788 | Access of Memory Location After End of Buffer | Base | Discouraged | 0.3905 | dense, sparse, graph | dense: 0.533, sparse: 0.089, graph: 0.613 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3584 | sparse, graph | sparse: 0.106, graph: 0.832 |
| 8 | CWE-823 | Use of Out-of-range Pointer Offset | Base | Allowed | 0.3190 | dense, sparse | dense: 0.530, sparse: 0.094 |
| 9 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2920 | dense, sparse | dense: 0.474, sparse: 0.096 |
| 10 | CWE-193 | Off-by-one Error | Base | Allowed | 0.2806 | sparse, graph | sparse: 0.096, graph: 0.631 |

