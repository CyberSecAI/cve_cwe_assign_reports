# Raw Retriever Results for CVE-2022-29210

# Raw Retriever Results for CVE-2022-29210

## Query
TensorFlow is an open source platform for machine learning. In version 2.8.0, the `TensorKey` hash function used total estimated `AllocatedBytes()`, which (a) is an estimate per tensor, and (b) is a very poor hash function for constants (e.g. `int32_t`). It also tried to access individual tensor bytes through `tensor.data()` of size `AllocatedBytes()`. This led to ASAN failures because the `AllocatedBytes()` is an estimate of total bytes allocated by a tensor, including any pointed-to constructs (e.g. strings), and does not refer to contiguous bytes in the `.data()` buffer. The discoverers could not use this byte vector anyway because types such as `tstring` include pointers, whereas they needed to hash the string values themselves. This issue is patched in Tensorflow versions 2.9.0 and 2.8.1.

## Keyphrases
- **rootcause**: very poor hash function for constants

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3508 | 0.3981 | 0.3702 | 0.3677 | 20 |
| Sparse | 603.0133 | 784.0386 | 652.6577 | 632.4166 | 20 |
| Graph | 1.3676 | 2.7196 | 1.7221 | 1.6320 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 787 | Out-of-bounds Write | base | 2.7196 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.5108 | Allowed |
| 3 | 195 | Signed to Unsigned Conversion Error | variant | 2.1168 | Allowed |
| 4 | 476 | NULL Pointer Dereference | Base | 1.9397 | Allowed |
| 5 | 170 | Improper Null Termination | base | 1.7680 | Allowed |
| 6 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 7 | 823 | Use of Out-of-range Pointer Offset | base | 1.6848 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | base | 1.6848 | Allowed |
| 9 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 10 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 11 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 12 | 328 | Use of Weak Hash | Base | 1.6239 | Allowed |
| 13 | 681 | Incorrect Conversion between Numeric Types | Base | 1.5892 | Allowed |
| 14 | 125 | Out-of-bounds Read | Base | 1.4967 | Allowed |
| 15 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 1.4927 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 824 | Access of Uninitialized Pointer | Base | 0.3981 | 0.3981 | Allowed |
| 2 | 328 | Use of Weak Hash | Base | 0.3974 | 0.3974 | Allowed |
| 3 | 681 | Incorrect Conversion between Numeric Types | Base | 0.3936 | 0.3936 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.3874 | 0.3874 | Allowed |
| 5 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 0.3869 | 0.3869 | Allowed |
| 6 | 1287 | Improper Validation of Specified Type of Input | Base | 0.3864 | 0.3864 | Allowed |
| 7 | 759 | Use of a One-Way Hash without a Salt | Variant | 0.3738 | 0.3738 | Allowed |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.3692 | 0.3692 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.3688 | 0.3688 | Allowed |
| 10 | 834 | Excessive Iteration | Class | 0.3680 | 0.3680 | Discouraged |
| 11 | 415 | Double Free | Variant | 0.3674 | 0.3674 | Allowed |
| 12 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 0.3614 | 0.3614 | Allowed |
| 13 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | 0.3598 | 0.3598 | Allowed |
| 14 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.3577 | 0.3577 | Allowed |
| 15 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 0.3574 | 0.3574 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-1284 | Improper Validation of Specified Quantity in Input | 784.0386 | 784.0386 | Allowed |
| 2 | CWE-122 | Heap-based Buffer Overflow | 781.7106 | 781.7106 | Allowed |
| 3 | CWE-824 | Access of Uninitialized Pointer | 727.2211 | 727.2211 | Allowed |
| 4 | CWE-476 | NULL Pointer Dereference | 678.3926 | 678.3926 | Allowed |
| 5 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 676.6860 | 676.6860 | Allowed |
| 6 | CWE-190 | Integer Overflow or Wraparound | 668.3024 | 668.3024 | Allowed |
| 7 | CWE-335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 660.5598 | 660.5598 | Allowed |
| 8 | CWE-125 | Out-of-bounds Read | 658.4573 | 658.4573 | Allowed |
| 9 | CWE-193 | Off-by-one Error | 636.0369 | 636.0369 | Allowed |
| 10 | CWE-674 | Uncontrolled Recursion | 633.7604 | 633.7604 | Allowed-with-Review |
| 11 | CWE-789 | Memory Allocation with Excessive Size Value | 631.0727 | 631.0727 | Allowed |
| 12 | CWE-770 | Allocation of Resources Without Limits or Throttling | 626.6593 | 626.6593 | Allowed |
| 13 | CWE-328 | Use of Weak Hash | 621.8441 | 621.8441 | Allowed |
| 14 | CWE-617 | Reachable Assertion | 618.4266 | 618.4266 | Allowed |
| 15 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | 615.9726 | 615.9726 | Allowed |
