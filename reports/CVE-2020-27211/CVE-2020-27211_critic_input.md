# Critic Input for CVE-2020-27211



# Original Analyzer Input
## Vulnerability Description
Nordic Semiconductor nRF52840 devices through 2020-10-19 have **improper protection against physical side channels**. The flash read-out protection (APPROTECT) can be bypassed by injecting a fault during the boot phase.

### Vulnerability Description Key Phrases
- **rootcause:** **improper protection against physical side channels**
- **impact:** bypass flash read-out protection (APPROTECT)
- **vector:** injecting a fault during the boot phase
- **product:** Nordic Semiconductor nRF52840 devices

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis related to CVE-2020-27211:

**Verification:**

The content from `www.aisec.fraunhofer.de_9735de12_20250119_113318.html` explicitly mentions "Nordic Semiconductor nRF52840 - CVE-2020-27211" under the "Side-Channel Attacks" section. This confirms the relevance of this content to the specified CVE.

**Vulnerability Details:**

*   **Root Cause:** The vulnerability stems from a weakness in the cryptographic implementation within the Nordic Semiconductor nRF52840 microcontroller. Specifically, a side-channel attack is possible due to the micro-ecc library and ARM CryptoCell hardware accelerator.
*   **Weaknesses/Vulnerabilities:** The nRF52840's cryptographic implementation leaks information through electromagnetic (EM) side-channels. This leakage allows for the recovery of private cryptographic keys.
*   **Impact of Exploitation:** Successful exploitation of this vulnerability leads to the compromise of private cryptographic keys. This can allow attackers to impersonate legitimate users, bypass authentication mechanisms, and potentially gain access to sensitive data or systems.
*  **Attack Vectors:** The attack vector is a side-channel attack, specifically involving the measurement of electromagnetic emanations.
*   **Required Attacker Capabilities/Position:** An attacker requires physical access to the device containing the vulnerable nRF52840 microcontroller and the ability to perform EM measurements with pen-like probes and oscilloscopes. They also need expertise in side-channel analysis techniques to process and interpret the gathered measurements.

**Additional Notes:**

*   The content mentions that the vulnerability was discovered during a systematic analysis of commercially available open source security tokens.
*   The vulnerability is related to the micro-ecc library and the ARM CryptoCell hardware accelerator within the nRF52840.
*   The content also mentions fault injection attacks against the nRF52840 which are related to CVE-2021-29415.
*   The associated research paper, accessible via a link, provides further details about the attacks and potential countermeasures.

**Summary of extracted information:**

*   **Root cause:** Weaknesses in the cryptographic implementation of the nRF52840 allowing side-channel attacks.
*   **Vulnerabilities:** Information leakage via EM side-channels during cryptographic operations.
*  **Impact:** Compromise of private cryptographic keys, bypassing authentication, unauthorized access.
*   **Attack vector:** Electromagnetic side-channel analysis.
*   **Attacker capabilities:** Physical access, specialized EM measurement equipment, expertise in side-channel analysis.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1300 | Improper Protection of Physical Side Channels | Base | Allowed | 0.7434 | dense, sparse, graph | dense: 0.669, sparse: 0.366, graph: 0.558 |
| 2 | CWE-1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | Allowed | 0.5884 | dense, sparse, graph | dense: 0.586, sparse: 0.175, graph: 0.546 |
| 3 | CWE-1319 | Improper Protection against Electromagnetic Fault Injection (EM-FI) | Base | Allowed | 0.5817 | dense, sparse, graph | dense: 0.612, sparse: 0.138, graph: 0.550 |
| 4 | CWE-1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | Allowed | 0.5766 | dense, sparse, graph | dense: 0.601, sparse: 0.140, graph: 0.548 |
| 5 | CWE-1247 | Improper Protection Against Voltage and Clock Glitches | Base | Allowed | 0.5062 | dense, sparse, graph | dense: 0.570, sparse: 0.126, graph: 0.416 |
| 6 | CWE-1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | Allowed | 0.5046 | dense, sparse, graph | dense: 0.563, sparse: 0.130, graph: 0.416 |
| 7 | CWE-1263 | Improper Physical Access Control | Class | Allowed-with-Review | 0.3205 | dense, sparse, graph | dense: 0.518, sparse: 0.163, graph: 0.540 |
| 8 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.1729 | sparse, graph | sparse: 0.110, graph: 0.307 |
| 9 | CWE-208 | Observable Timing Discrepancy | Base | Allowed | 0.1564 | sparse, graph | sparse: 0.117, graph: 0.251 |
| 10 | CWE-1338 | Improper Protections Against Hardware Overheating | Base | Allowed | 0.0726 | sparse | sparse: 0.127 |



# Analysis to Review
# Summary
| CWE ID    | CWE Name                                                | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
| :-------- | :------------------------------------------------------ | :--------- | :-------------------- | :------------------------------ | :------------------------------ |
| CWE-1300  | Improper Protection of Physical Side Channels           | 0.95       | Base                  | Allowed                         | Primary CWE                     |
| CWE-1332  | Improper Handling of Faults that Lead to Instruction Skips | 0.75       | Base                  | Allowed                         | Secondary CWE                   |

## Evidence and Confidence

*   **Confidence Score:** 0.90
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**
  - *Explanation:* The vulnerability description explicitly states "**improper protection against physical side channels**". The CVE reference summary further details that the **root cause** is a weakness in the cryptographic implementation, leading to information leakage via electromagnetic side-channels. This aligns directly with CWE-1300 (Improper Protection of Physical Side Channels), which describes devices lacking sufficient protection mechanisms against physical side channels. The evidence is strong, as the description and summary highlight the core issue: side-channel vulnerability due to inadequate protection. CWE-1300 is a Base level CWE, which is appropriate as it directly describes the **weakness**.
  - *Relationship Analysis:* CWE-1300 has relationships to more specific weaknesses. It could be caused by things like Observable Discrepancy CWE-203 or Observable Timing Discrepancy CWE-208.

- **Confidence Score:**
  - Confidence: 0.95 (Strong match between vulnerability description and CWE definition, supported by CVE reference details)

---

- **Analysis and Justification:**
  - *Explanation:* The vulnerability description mentions "injecting a **fault** during the boot phase" to bypass flash read-out protection. This aspect suggests CWE-1332 (Improper Handling of Faults that Lead to Instruction Skips) as a contributing factor. While the primary issue is the lack of protection against side channels, the ability to inject a fault and bypass security mechanisms indicates that the system does not properly handle such faults. CWE-1332 is a Base level CWE, which is appropriate.
  - *Relationship Analysis:* CWE-1332 is related to CWE-1247 (Improper Protection Against Voltage and Clock Glitches) and is a child of CWE-1384. The ability to inject a fault during boot to bypass protection could potentially be related to a voltage or clock glitch.

- **Confidence Score:**
  - Confidence: 0.75 (The fault injection aspect is less prominent than the side-channel vulnerability, making this a secondary consideration.)

# CWE Examples from Database


## Known Examples for CWE-1384: Improper Handling of Physical or Environmental Conditions
### Observed Examples
- **CVE-2019-17391** [https://www.cve.org/CVERecord?id=CVE-2019-17391](https://www.cve.org/CVERecord?id=CVE-2019-17391): Lack of anti-glitch protections allows an attacker to launch a physical attack to bypass the secure boot and read protected eFuses.


## Known Examples for CWE-1247: Improper Protection Against Voltage and Clock Glitches
### Observed Examples
- **CVE-2019-17391** [https://www.cve.org/CVERecord?id=CVE-2019-17391](https://www.cve.org/CVERecord?id=CVE-2019-17391): Lack of anti-glitch protections allows an attacker to launch a physical attack to bypass the secure boot and read protected eFuses.
- **CVE-2021-33478** [https://www.cve.org/CVERecord?id=CVE-2021-33478](https://www.cve.org/CVERecord?id=CVE-2021-33478): IP communication firmware allows access to a boot shell via certain impulses
### Top 25 Examples
- **CVE-2021-33478**: The TrustZone implementation in certain Broadcom MediaxChange firmware could allow an unauthenticated, physically proximate attacker to achieve arbitrary code execution in the TrustZone Trusted Execution Environment (TEE) of an affected device. This, for example, affects certain Cisco IP Phone and Wireless IP Phone products before 2021-07-07. Exploitation is possible only when the attacker can disassemble the device in order to control the voltage/current for chip pins.


## Known Examples for CWE-1332: Improper Handling of Faults that Lead to Instruction Skips
### Observed Examples
- **CVE-2019-15894** [https://www.cve.org/CVERecord?id=CVE-2019-15894](https://www.cve.org/CVERecord?id=CVE-2019-15894): fault injection attack bypasses the verification mode, potentially allowing arbitrary code execution.
### Top 25 Examples
- **CVE-2020-27212**: STMicroelectronics STM32L4 devices through 2020-10-19 have incorrect access control. The flash read-out protection (RDP) can be degraded from RDP level 2 (no access via debug interface) to level 1 (limited access via debug interface) by injecting a fault during the boot phase.


## Known Examples for CWE-203: Observable Discrepancy
### Observed Examples
- **CVE-2020-8695** [https://www.cve.org/CVERecord?id=CVE-2020-8695](https://www.cve.org/CVERecord?id=CVE-2020-8695): Observable discrepancy in the RAPL interface for some Intel processors allows information disclosure.
- **CVE-2019-14353** [https://www.cve.org/CVERecord?id=CVE-2019-14353](https://www.cve.org/CVERecord?id=CVE-2019-14353): Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords
- **CVE-2019-10071** [https://www.cve.org/CVERecord?id=CVE-2019-10071](https://www.cve.org/CVERecord?id=CVE-2019-10071): Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies
- **CVE-2002-2094** [https://www.cve.org/CVERecord?id=CVE-2002-2094](https://www.cve.org/CVERecord?id=CVE-2002-2094): This, and others, use ".." attacks and monitor error responses, so there is overlap with directory traversal.


# Relevant CWE Specifications

## CWE-1384: Improper Handling of Physical or Environmental Conditions
**Abstraction:** Class
**Status:** Incomplete

### Description
The product does not properly handle unexpected physical or environmental conditions that occur naturally or are artificially induced.

### Extended Description


Hardware products are typically only guaranteed to behave correctly within certain physical limits or environmental conditions. Such products cannot necessarily control the physical or external conditions to which they are subjected. However, the inability to handle such conditions can undermine a product's security. For example, an unexpected physical or environmental condition may cause the flipping of a bit that is used for an authentication decision. This unexpected condition could occur naturally or be induced artificially by an adversary.


Physical or environmental conditions of concern are:


  -  **Atmospheric characteristics: ** extreme temperature ranges, etc.

  -  **Interference: ** electromagnetic interference (EMI), radio frequency interference (RFI), etc.

  -  **Assorted light sources: ** white light, ultra-violet light (UV), lasers, infrared (IR), etc.

  -  **Power variances: ** under-voltages, over-voltages, under-current, over-current, etc.

  -  **Clock variances: ** glitching, overclocking, clock stretching, etc.

  -  **Component aging and degradation** 

  -  **Materials manipulation: ** focused ion beams (FIB), etc.

  -  **Exposure to radiation: ** x-rays, cosmic radiation, etc.



### Alternative Terms
None

### Relationships
ChildOf -> CWE-703
ParentOf -> CWE-1247
ParentOf -> CWE-1261
ParentOf -> CWE-1332
ParentOf -> CWE-1351

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Requirements
- **Description:** In requirements, be specific about expectations for how the product will perform when it exceeds physical and environmental boundary conditions, e.g., by shutting down.

**Mitigation 2:**
- **Phase:** Architecture and Design, Implementation
- **Description:** Where possible, include independent components that can detect excess environmental conditions and have the capability to shut down the product.

**Mitigation 3:**
- **Phase:** Architecture and Design, Implementation
- **Description:** Where possible, use shielding or other materials that can increase the adversary's workload and reduce the likelihood of being able to successfully trigger a security-related failure.




### Observed Examples
- **CVE-2019-17391:** Lack of anti-glitch protections allows an attacker to launch a physical attack to bypass the secure boot and read protected eFuses.



## CWE-1247: Improper Protection Against Voltage and Clock Glitches
**Abstraction:** Base
**Status:** Stable

### Description
The device does not contain or contains incorrectly implemented circuitry or sensors to detect and mitigate voltage and clock glitches and protect sensitive information or software contained on the device.

### Extended Description


A device might support features such as secure boot which are supplemented with hardware and firmware support. This involves establishing a chain of trust, starting with an immutable root of trust by checking the signature of the next stage (culminating with the OS and runtime software) against a golden value before transferring control. The intermediate stages typically set up the system in a secure state by configuring several access control settings. Similarly, security logic for exercising a debug or testing interface may be implemented in hardware, firmware, or both. A device needs to guard against fault attacks such as voltage glitches and clock glitches that an attacker may employ in an attempt to compromise the system.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-1384

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design, Implementation
- **Description:** 

At the circuit-level, using Tunable Replica Circuits (TRCs) or special flip-flops such as Razor flip-flops helps mitigate glitch attacks. Working at the SoC or platform base, level sensors may be implemented to detect glitches. Implementing redundancy in security-sensitive code (e.g., where checks are performed)also can help with mitigation of glitch attacks.





### Observed Examples
- **CVE-2019-17391:** Lack of anti-glitch protections allows an attacker to launch a physical attack to bypass the secure boot and read protected eFuses.
- **CVE-2021-33478:** IP communication firmware allows access to a boot shell via certain impulses



## CWE-1332: Improper Handling of Faults that Lead to Instruction Skips
**Abstraction:** Base
**Status:** Stable

### Description
The device is missing or incorrectly implements circuitry or sensors that detect and mitigate the skipping of security-critical CPU instructions when they occur.

### Extended Description


The operating conditions of hardware may change in ways that cause unexpected behavior to occur, including the skipping of security-critical CPU instructions. Generally, this can occur due to electrical disturbances or when the device operates outside of its expected conditions.


In practice, application code may contain conditional branches that are security-sensitive (e.g., accepting or rejecting a user-provided password). These conditional branches are typically implemented by a single conditional branch instruction in the program binary which, if skipped, may lead to effectively flipping the branch condition - i.e., causing the wrong security-sensitive branch to be taken. This affects processes such as firmware authentication, password verification, and other security-sensitive decision points.


Attackers can use fault injection techniques to alter the operating conditions of hardware so that security-critical instructions are skipped more frequently or more reliably than they would in a "natural" setting.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-1384
PeerOf -> CWE-1247

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** Design strategies for ensuring safe failure if inputs, such as Vcc, are modified out of acceptable ranges.

**Mitigation 2:**
- **Phase:** Architecture and Design
- **Description:** Design strategies for ensuring safe behavior if instructions attempt to be skipped.

**Mitigation 3:**
- **Phase:** Architecture and Design
- **Description:** Identify mission critical secrets that should be wiped if faulting is detected, and design a mechanism to do the deletion.




### Observed Examples
- **CVE-2019-15894:** fault injection attack bypasses the verification mode, potentially allowing arbitrary code execution.



## CWE-203: Observable Discrepancy
**Abstraction:** Base
**Status:** Incomplete

### Description
The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.

### Extended Description
Discrepancies can take many forms, and variations may be detectable in timing, control flow, communications such as replies or requests, or general behavior. These discrepancies can reveal information about the product's operation or internal state to an unauthorized actor. In some cases, discrepancies can be used by attackers to form a side channel.

### Alternative Terms
Side Channel Attack: Observable Discrepancies are at the root of side channel attacks.

### Relationships
ChildOf -> CWE-200
ChildOf -> CWE-200
ParentOf -> CWE-1300
ParentOf -> CWE-1303
ParentOf -> CWE-204
ParentOf -> CWE-205
ParentOf -> CWE-208

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Strategy:** Separation of Privilege
- **Description:** 

Compartmentalize the system to have "safe" areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area.


Ensure that appropriate compartmentalization is built into the system design, and the compartmentalization allows for and reinforces privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges.


**Mitigation 2:**
- **Phase:** Implementation
- **Description:** 

Ensure that error messages only contain minimal details that are useful to the intended audience and no one else. The messages need to strike the balance between being too cryptic (which can confuse users) or being too detailed (which may reveal more than intended). The messages should not reveal the methods that were used to determine the error. Attackers can use detailed information to refine or optimize their original attack, thereby increasing their chances of success.


If errors must be captured in some detail, record them in log messages, but consider what could occur if the log messages can be viewed by attackers. Highly sensitive information such as passwords should never be saved to log files.


Avoid inconsistent messaging that might accidentally tip off an attacker about internal state, such as whether a user account exists or not.





### Observed Examples
- **CVE-2020-8695:** Observable discrepancy in the RAPL interface for some Intel processors allows information disclosure.
- **CVE-2019-14353:** Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords
- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies



## CWE-1300: Improper Protection of Physical Side Channels
**Abstraction:** Base
**Status:** Stable

### Description
The device does not contain sufficient protection
	mechanisms to prevent physical side channels from exposing
	sensitive information due to patterns in physically observable
	phenomena such as variations in power consumption,
	electromagnetic emissions (EME), or acoustic emissions.

### Extended Description


An adversary could monitor and measure physical phenomena to detect patterns and make inferences, even if it is not possible to extract the information in the digital domain.


Physical side channels have been well-studied for decades in the context of breaking implementations of cryptographic algorithms or other attacks against security features. These side channels may be easily observed by an adversary with physical access to the device, or using a tool that is in close proximity. If the adversary can monitor hardware operation and correlate its data processing with power, EME, and acoustic measurements, the adversary might be able to recover of secret keys and data.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-203
ChildOf -> CWE-203
ParentOf -> CWE-1255

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Architecture and Design
- **Description:** Apply blinding or masking techniques to implementations of cryptographic algorithms.

**Mitigation 2:**
- **Phase:** Implementation
- **Description:** Add shielding or tamper-resistant protections to the device to increase the difficulty of obtaining measurements of the side-channel.




### Observed Examples
- **CVE-2022-35888:** Power side-channels leak secret information from processor
- **CVE-2021-3011:** electromagnetic-wave side-channel in security-related microcontrollers allows extraction of private key
- **CVE-2019-14353:** Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords



## CWE-208: Observable Timing Discrepancy
**Abstraction:** Base
**Status:** Incomplete

### Description
Two separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.

### Extended Description
In security-relevant contexts, even small variations in timing can be exploited by attackers to indirectly infer certain details about the product's internal operations. For example, in some cryptographic algorithms, attackers can use timing differences to infer certain properties about a private key, making the key easier to guess. Timing discrepancies effectively form a timing side channel.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-203
CanPrecede -> CWE-385
CanPrecede -> CWE-327
ParentOf -> CWE-1254

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Additional Notes
**[Relationship]** Often primary in cryptographic applications and algorithms.

**[Maintenance]** CWE 4.16 removed a demonstrative example for a hardware module because it was inaccurate and unable to be adapted. The CWE team is developing an alternative.



### Observed Examples
- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies
- **CVE-2019-10482:** Smartphone OS uses comparison functions that are not in constant time, allowing side channels
- **CVE-2014-0984:** Password-checking function in router terminates validation of a password entry when it encounters the first incorrect character, which allows remote attackers to obtain passwords via a brute-force attack that relies on timing differences in responses to incorrect password guesses, aka a timing side-channel attack.

