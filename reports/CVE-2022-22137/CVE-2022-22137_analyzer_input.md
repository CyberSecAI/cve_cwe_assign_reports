# Vulnerability Information: CVE-2022-22137

## Vulnerability Description
**A memory corruption vulnerability** exists in the ioca_mys_rgb_allocate functionality of Accusoft ImageGear 19.10. A specially-crafted malformed file can lead to an arbitrary free. An attacker can provide a malicious file to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **A memory corruption vulnerability**
- **impact:** arbitrary free
- **vector:** specially-crafted malformed file
- **attacker:** attacker
- **product:** Accusoft ImageGear
- **version:** 19.1
- **component:** ioca_mys_rgb_allocate functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability stems from an incorrect calculation of buffer size when processing a malformed IOCA file. Specifically, when the `size_Y` value in the file is null, a zero-byte allocation occurs for the `table_mys_rgb` array and later when `IGDIBRunEnds::delete_table_mys_rbg_ptr` is called, the code attempts to free an uninitialized pointer within this array leading to an arbitrary free.
- **Weaknesses/vulnerabilities present:** Incorrect buffer size calculation, leading to a zero-byte allocation and use of uninitialized memory in subsequent free operations.
- **Impact of exploitation:**  An attacker can trigger an arbitrary free which can lead to memory corruption and potentially allow for arbitrary code execution.
- **Attack vectors:** By providing a specially crafted IOCA file, an attacker can trigger the vulnerability.
- **Required attacker capabilities/position:** The attacker needs to be able to provide a malicious file to the vulnerable application. No specific privileges are required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7182 | dense, sparse, graph | dense: 0.519, sparse: 0.243, graph: 0.894 |
| 2 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.6987 | dense, sparse, graph | dense: 0.514, sparse: 0.235, graph: 0.859 |
| 3 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.6459 | dense, sparse, graph | dense: 0.492, sparse: 0.266, graph: 0.693 |
| 4 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.6353 | dense, sparse, graph | dense: 0.539, sparse: 0.245, graph: 0.779 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4070 | sparse, graph | sparse: 0.218, graph: 0.789 |
| 6 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3614 | dense, sparse | dense: 0.472, sparse: 0.218 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3506 | dense, sparse | dense: 0.496, sparse: 0.230 |
| 8 | CWE-416 | Use After Free | Variant | Allowed | 0.3374 | dense, sparse | dense: 0.497, sparse: 0.204 |
| 9 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3354 | dense, sparse | dense: 0.473, sparse: 0.200 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3303 | dense, sparse | dense: 0.485, sparse: 0.201 |

