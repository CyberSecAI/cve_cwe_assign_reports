# Vulnerability Information: CVE-2021-46524

## Vulnerability Description
Cesanta MJS v2.20.0 was discovered to contain a **heap buffer overflow** via snquote at mjs/src/mjs_json.c.

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **product:** Cesanta MJS
- **version:** v2.20.0
- **component:** mjs/src/mjs_json.c

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A heap-buffer-overflow occurs in the `snquote` function within `src/mjs_json.c` at line 81, during JSON stringification.
- **Weaknesses/vulnerabilities present:** Heap-buffer-overflow due to incorrect buffer handling in the `snquote` function when processing specific inputs, leading to out-of-bounds memory access.
- **Impact of exploitation:** The heap-buffer-overflow can lead to program crashes or potentially enable further exploitation for code execution or data manipulation.
- **Attack vectors:** The vulnerability can be triggered by supplying a specially crafted JavaScript payload to the `JSON.stringify` function within the mjs JavaScript engine.
- **Required attacker capabilities/position:** An attacker needs to be able to provide input to the `JSON.stringify` function, such as through a malicious script that is executed by the mjs engine.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6808 | dense, sparse, graph | dense: 0.534, sparse: 0.149, graph: 0.919 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6379 | dense, sparse, graph | dense: 0.568, sparse: 0.113, graph: 0.808 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5146 | dense, sparse, graph | dense: 0.589, sparse: 0.103, graph: 0.569 |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4755 | dense, sparse, graph | dense: 0.531, sparse: 0.088, graph: 0.447 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3668 | dense, sparse | dense: 0.601, sparse: 0.169 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3390 | sparse, graph | sparse: 0.099, graph: 0.789 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3279 | dense, sparse | dense: 0.565, sparse: 0.127 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3212 | dense, sparse | dense: 0.518, sparse: 0.108 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3190 | dense, sparse | dense: 0.537, sparse: 0.087 |
| 10 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3162 | dense, sparse | dense: 0.530, sparse: 0.089 |

