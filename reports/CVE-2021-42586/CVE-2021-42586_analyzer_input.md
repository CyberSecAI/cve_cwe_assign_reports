# Vulnerability Information: CVE-2021-42586

## Vulnerability Description
A **heap buffer overflow** was discovered in copy_bytes in decode_r2007.c in dwgread before 0.12.4 via a crafted dwg file.

### Vulnerability Description Key Phrases
- **rootcause:** **heap buffer overflow**
- **vector:** crafted dwg file
- **product:** dwgread
- **version:** before 0.12.4
- **component:** copy_bytes in decode_r2007.c

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 6)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A heap buffer overflow occurs in the `copy_bytes` function within `decode_r2007.c` due to an invalid section size. The `section->data_size` might exceed the allocated `section_page->uncomp_size`.
- **Weaknesses/vulnerabilities present:** Heap buffer overflow.
- **Impact of exploitation:** A heap buffer overflow can lead to memory corruption, potentially resulting in a crash, denial of service, or, in some cases, arbitrary code execution.
- **Attack vectors:** The vulnerability is triggered when processing a crafted DWG file. Specifically, the `dwgread` program is used to open a specially crafted DWG file, which contains an invalid section size causing the `copy_bytes` function to write beyond the allocated buffer.
- **Required attacker capabilities/position:** An attacker needs to provide a specially crafted DWG file to the vulnerable application.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6904 | dense, sparse, graph | dense: 0.558, sparse: 0.154, graph: 0.903 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6818 | dense, sparse, graph | dense: 0.538, sparse: 0.146, graph: 0.920 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5741 | dense, sparse, graph | dense: 0.598, sparse: 0.155, graph: 0.655 |
| 4 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.5306 | dense, sparse, graph | dense: 0.521, sparse: 0.122, graph: 0.559 |
| 5 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5036 | dense, sparse, graph | dense: 0.538, sparse: 0.129, graph: 0.449 |
| 6 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4806 | dense, sparse, graph | dense: 0.530, sparse: 0.127, graph: 0.463 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3754 | dense, sparse | dense: 0.606, sparse: 0.181 |
| 8 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3564 | dense, sparse | dense: 0.557, sparse: 0.136 |
| 9 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3516 | dense, sparse | dense: 0.558, sparse: 0.126 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3326 | dense, sparse | dense: 0.559, sparse: 0.141 |

