# Vulnerability Information: CVE-2021-29416

## Vulnerability Description
An issue was discovered in PortSwigger Burp Suite before 2021.2. During viewing of a malicious request, it can be manipulated into issuing a request that does not respect its upstream proxy configuration. This could leak NetNTLM hashes on Windows systems that fail to block outbound SMB.

### Vulnerability Description Key Phrases
- **impact:** leak NetNTLM hashes
- **vector:** malicious request
- **product:** PortSwigger Burp Suite
- **version:** before 2021.2

## CVE Reference Links Content Summary
The provided content describes a security fix in Burp Suite, specifically addressing a vulnerability related to upstream proxy configurations and potential NetNTLM hash leaks on Windows systems. This aligns with the provided CVE description that mentions a fix regarding upstream proxy configuration.

Here's a breakdown of the vulnerability:

*   **Root Cause:** The vulnerability stemmed from Burp Suite not respecting its configured upstream proxy settings in certain scenarios.
*   **Weaknesses/Vulnerabilities:** The primary vulnerability was a failure to consistently use the configured upstream proxy. This could lead to Burp Suite making direct network connections, bypassing the intended proxy.
*   **Impact of Exploitation:** On Windows systems, this could lead to the leakage of NetNTLM hashes if a connection was made to a vulnerable SMB server. This is because the SMB protocol can be used to trigger authentication, and if the connection occurs without going through a proxy, the Windows system may send its NetNTLM hash over the network.
*   **Attack Vectors:** The attack vector is through network requests made by Burp Suite. By crafting malicious network traffic to trigger this issue in combination with a vulnerable SMB server, an attacker could potentially capture NetNTLM hashes.
*   **Required Attacker Capabilities/Position:** An attacker needs to be in a position to intercept and analyze the network traffic or have control of an SMB server that can trigger an authentication request and be able to intercept the leaked hash. Also, the victim machine must be a Windows system that does not block outbound SMB traffic.

This content provides more detail than the official CVE description, explaining the root cause, impact, and attack vector of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5363 | dense, sparse, graph | dense: 0.573, sparse: 0.061, graph: 0.601 |
| 2 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.2312 | sparse, graph | sparse: 0.054, graph: 0.560 |
| 3 | CWE-276 | Incorrect Default Permissions | Base | Allowed | 0.2278 | sparse, graph | sparse: 0.062, graph: 0.538 |
| 4 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.2271 | sparse, graph | sparse: 0.060, graph: 0.539 |
| 5 | CWE-346 | Origin Validation Error | Class | Allowed-with-Review | 0.1867 | dense, sparse | dense: 0.572, sparse: 0.055 |
| 6 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1828 | dense, sparse | dense: 0.555, sparse: 0.058 |
| 7 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1822 | dense, sparse | dense: 0.558, sparse: 0.055 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1419 | dense, sparse | dense: 0.571, sparse: 0.055 |
| 9 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.0327 | sparse | sparse: 0.057 |
| 10 | CWE-90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | 0.0325 | sparse | sparse: 0.057 |

