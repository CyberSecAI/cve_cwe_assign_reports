# Vulnerability Information: CVE-2021-45949

## Vulnerability Description
Ghostscript GhostPDL 9.50 through 9.54.0 has a **heap-based buffer overflow** in sampled_data_finish (called from sampled_data_continue and interp).

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** Ghostscript GhostPDL
- **version:** 9.50 through 9.54.0
- **component:** sampled_data_finish

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-45949:

**Root Cause of Vulnerability:**

*   The vulnerability is a heap-buffer-overflow within the `sampled_data_finish` function. This suggests a flaw in how the Ghostscript interpreter manages memory when processing sampled data, potentially in image or other data handling.

**Weaknesses/Vulnerabilities Present:**

*   **Heap-buffer-overflow:** A memory safety issue where data is written beyond the boundaries of an allocated heap buffer. This can lead to corruption of other heap data, program crashes, and potentially arbitrary code execution.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** The vulnerability can lead to program crashes due to memory corruption.
*   **Potential Arbitrary Code Execution:**  A heap-based buffer overflow can, in some scenarios, be manipulated to overwrite critical data structures, allowing an attacker to execute arbitrary code.

**Attack Vectors:**

*   Processing of malformed document files (e.g., PostScript or PDF) by Ghostscript. These files are likely crafted to trigger the specific code path that contains the buffer overflow.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to provide a specially crafted document to a system using a vulnerable version of Ghostscript. This could be done through various means such as:
    *   Opening a malicious document on a user's system.
    *   Uploading a malicious file to a system that uses Ghostscript to process it.
    *   Attacking a service that utilizes Ghostscript.

**Additional Details:**

*   The vulnerability was identified via the OSS-Fuzz project, and a crash report is available.
*   The vulnerability affects several versions of Ghostscript, as indicated in the provided github content, the affected versions include:
    *   `ghostpdl-9.28rc1` to `ghostpdl-9.54.0rc1_test`
    *   `ghostscript-9.50` to `ghostscript-9.52`
    *   `gpdf_alpha1` , `gs9.28-temp-for-testing-tag`, `rjj_9.53.2_test`
*   Debian security advisories indicate that the vulnerability was fixed in ghostscript versions:
    *   `9.26a~dfsg-0+deb9u8` for Debian 9 (stretch)
    *   `9.27~dfsg-2+deb10u5` for Debian 10 (buster)
    *    `9.53.3~dfsg-7+deb11u2` for Debian 11 (bullseye)

This information provides a more detailed picture of the vulnerability than the placeholder CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6149 | dense, sparse, graph | dense: 0.455, sparse: 0.110, graph: 0.907 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6036 | dense, sparse, graph | dense: 0.470, sparse: 0.120, graph: 0.839 |
| 3 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.5420 | dense, sparse, graph | dense: 0.482, sparse: 0.091, graph: 0.768 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5228 | dense, sparse, graph | dense: 0.506, sparse: 0.119, graph: 0.686 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4911 | dense, sparse, graph | dense: 0.440, sparse: 0.109, graph: 0.584 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3338 | sparse, graph | sparse: 0.090, graph: 0.789 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3189 | dense, sparse | dense: 0.523, sparse: 0.147 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.2918 | dense, sparse | dense: 0.462, sparse: 0.106 |
| 9 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.2860 | dense, sparse | dense: 0.457, sparse: 0.100 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2848 | dense, sparse | dense: 0.493, sparse: 0.108 |

