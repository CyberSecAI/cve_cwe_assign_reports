# Fully Enhanced Analysis for Critic Review - CVE-2021-35090

# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 0.9 | Base | Allowed | Primary CWE. The vulnerability is directly caused by a TOCTOU race condition. |
| CWE-413 | Improper Resource Locking | 0.3 | Base | Allowed | Secondary CWE. A race condition often stems from the lack of proper locking mechanisms, but the primary issue here is the TOCTOU condition. |
| CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 0.2 | Class | Allowed-with-Review | Secondary CWE. The description mentions a race condition, but doesn't elaborate on the concurrency aspect. |

## Evidence and Confidence

*   **Confidence Score:** 0.9
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**  
  - *Explanation:* The vulnerability description explicitly states "**TOC TOU race condition** when updating address mappings" which maps directly to CWE-367 (Time-of-check Time-of-use (TOCTOU) Race Condition). This CWE describes a scenario where the state of a resource is checked before use, but changes before it is actually used, leading to invalid actions. The **hypervisor memory corruption** is a direct consequence of this race condition, reinforcing the selection of CWE-367. The description mentions a race condition during address mapping updates, but does not specify any details about locking so CWE-413 is lower confidence. CWE-362 is even lower because it's a class-level CWE, and CWE-367 is more specific and describes the TOCTOU race.
  
  - *Relationship Analysis:* CWE-367 doesn't have direct relationships to the other CWEs, but CWE-413 (Improper Resource Locking) is a child of CWE-667 (Missing Mutex) and might be relevant since proper locking could mitigate the TOCTOU condition.

- **Confidence Score:**  
  - Confidence: 0.9 (High evidence due to explicit mention of TOCTOU race condition and its impact on memory corruption)

---



## Known Examples for CWE-413: Improper Resource Locking
### Observed Examples
- **CVE-2022-20141** [https://www.cve.org/CVERecord?id=CVE-2022-20141](https://www.cve.org/CVERecord?id=CVE-2022-20141): Chain: an operating system kernel has insufficent resource locking (CWE-413) leading to a use after free (CWE-416).
### Top 25 Examples
- **CVE-2020-11284**: Locked memory can be unlocked and modified by non secure boot loader through improper system call sequence making the memory region untrusted source of input for secure boot loader in Snapdragon Auto, Snapdragon Compute, Snapdragon Industrial IOT, Snapdragon Mobile, Snapdragon Wired Infrastructure and Networking
- **CVE-2022-20141**: In ip_check_mc_rcu of igmp.c, there is a possible use after free due to improper locking. This could lead to local escalation of privilege when opening and closing inet sockets with no additional execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android kernelAndroid ID: A-112551163References: Upstream kernel
- **CVE-2022-20371**: In dm_bow_dtr and related functions of dm-bow.c, there is a possible use after free due to a race condition. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android kernelAndroid ID: A-195565510References: Upstream kernel
- **CVE-2022-20422**: In emulation_proc_handler of armv8_deprecated.c, there is a possible way to corrupt memory due to a race condition. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android kernelAndroid ID: A-237540956References: Upstream kernel
- **CVE-2022-24946**: Improper Resource Locking vulnerability in Mitsubishi Electric MELSEC iQ-R Series R12CCPU-V firmware versions "16" and prior, Mitsubishi Electric MELSEC-Q Series Q03UDECPU the first 5 digits of serial No. "24061" and prior, Mitsubishi Electric MELSEC-Q Series Q04/06/10/13/20/26/50/100UDEHCPU the first 5 digits of serial No. "24061" and prior, Mitsubishi Electric MELSEC-Q Series Q03/04/06/13/26UDVCPU the first 5 digits of serial number "24051" and prior, Mitsubishi Electric MELSEC-Q Series Q04/06/13/26UDPVCPU the first 5 digits of serial number "24051" and prior, Mitsubishi Electric MELSEC-Q Series Q12DCCPU-V all versions, Mitsubishi Electric MELSEC-Q Series Q24DHCCPU-V(G) all versions, Mitsubishi Electric MELSEC-Q Series Q24/26DHCCPU-LS all versions, Mitsubishi Electric MELSEC-L series L02/06/26CPU(-P) the first 5 digits of serial number "24051" and prior, Mitsubishi Electric MELSEC-L series L26CPU-(P)BT the first 5 digits of serial number "24051" and prior and Mitsubishi Electric MELIPC Series MI5122-VW firmware versions "05" and prior allows a remote unauthenticated attacker to cause a denial of service (DoS) condition in Ethernet communications by sending specially crafted packets. A system reset of the products is required for recovery.


## Known Examples for CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition
### Observed Examples
- **CVE-2015-1743** [https://www.cve.org/CVERecord?id=CVE-2015-1743](https://www.cve.org/CVERecord?id=CVE-2015-1743): TOCTOU in sandbox process allows installation of untrusted browser add-ons by replacing a file after it has been verified, but before it is executed
- **CVE-2003-0813** [https://www.cve.org/CVERecord?id=CVE-2003-0813](https://www.cve.org/CVERecord?id=CVE-2003-0813): A multi-threaded race condition allows remote attackers to cause a denial of service (crash or reboot) by causing two threads to process the same RPC request, which causes one thread to use memory after it has been freed.
- **CVE-2004-0594** [https://www.cve.org/CVERecord?id=CVE-2004-0594](https://www.cve.org/CVERecord?id=CVE-2004-0594): PHP flaw allows remote attackers to execute arbitrary code by aborting execution before the initialization of key data structures is complete.
- **CVE-2008-2958** [https://www.cve.org/CVERecord?id=CVE-2008-2958](https://www.cve.org/CVERecord?id=CVE-2008-2958): chain: time-of-check time-of-use (TOCTOU) race condition in program allows bypass of protection mechanism that was designed to prevent symlink attacks.
