# Vulnerability Information: CVE-2022-29643

## Vulnerability Description
TOTOLINK A3100R V4.1.2cu.5050_B20200504 and V4.1.2cu.5247_B20211129 were discovered to contain a **stack overflow** via the macAddress parameter in the function setMacQos. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** TOTOLINK A3100R
- **version:** V4.1.2cu.5050_B20200504 and V4.1.2cu.5247_B20211129
- **component:** setMacQos function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 28)
- CWE-NVD-noinfo (Count: 9)
- CWE-120 (Count: 1)

## CVE Reference Links Content Summary
The provided content is related to CVE-2022-29643.

**Root cause of vulnerability:**
The `setMacQos` function in the `firewall.so` module does not properly validate the length of the `macAddress` parameter received in a POST request before using it in `strcpy` or `strcat` operations, leading to a stack buffer overflow.

**Weaknesses/vulnerabilities present:**
- Stack buffer overflow due to lack of input validation on the `macAddress` parameter.

**Impact of exploitation:**
- Denial of service (DoS) can be achieved. It is possible that further exploitation to achieve remote code execution could be possible, but the documentation only mentions DoS

**Attack vectors:**
- Sending a crafted POST request to the `/cgi-bin/cstecgi.cgi` endpoint with a long string for the `macAddress` parameter in the JSON payload.

**Required attacker capabilities/position:**
- The attacker must be able to send HTTP requests to the router.
- The attacker needs to know the correct URL endpoint to exploit this vulnerability

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.6054 | dense, sparse, graph | dense: 0.565, sparse: 0.228, graph: 0.538 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4439 | dense, sparse | dense: 0.638, sparse: 0.283 |
| 3 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.3906 | dense, sparse | dense: 0.562, sparse: 0.248 |
| 4 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3540 | dense, sparse | dense: 0.516, sparse: 0.167 |
| 5 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3533 | dense, sparse | dense: 0.524, sparse: 0.159 |
| 6 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3387 | dense, sparse | dense: 0.521, sparse: 0.165 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3329 | dense, sparse | dense: 0.527, sparse: 0.169 |
| 8 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.3263 | dense, sparse | dense: 0.516, sparse: 0.166 |
| 9 | CWE-790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | 0.2478 | dense, sparse | dense: 0.575, sparse: 0.235 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2204 | dense, sparse | dense: 0.518, sparse: 0.203 |

