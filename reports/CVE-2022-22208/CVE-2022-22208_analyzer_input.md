# Vulnerability Information: CVE-2022-22208

## Vulnerability Description
A **Use After Free** vulnerability in the Routing Protocol Daemon (rdp) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated network-based attacker to cause Denial of Service (DoS). When a BGP session flap happens, a **Use After Free** of a memory location that was assigned to another object can occur, which will lead to an rpd crash. This is a race condition that is outside of the attackers control and cannot be deterministically exploited. Continued flapping of BGP sessions can create a sustained Denial of Service (DoS) condition. This issue affects Juniper Networks Junos OS All versions prior to 18.4R2-S9, 18.4R3-S11 19.1 versions prior to 19.1R3-S8 19.2 version 19.2R1 and later versions 19.3 versions prior to 19.3R3-S5 19.4 versions prior to 19.4R2-S6, 19.4R3-S6 20.1 version 20.1R1 and later versions 20.2 versions prior to 20.2R3-S3 20.3 versions prior to 20.3R3-S2 20.4 versions prior to 20.4R3-S1 21.1 versions prior to 21.1R3-S3 21.2 versions prior to 21.2R2-S1, 21.2R3. Juniper Networks Junos OS Evolved All versions prior to 20.4R3-S4-EVO 21.1-EVO versions prior to 21.1R3-S2-EVO 21.2-EVO versions prior to 21.2R3-EVO 21.3-EVO versions prior to 21.3R2-EVO.

### Vulnerability Description Key Phrases
- **rootcause:** **Use After Free**
- **impact:** Denial of Service (DoS)
- **attacker:** unauthenticated network-based attacker
- **product:** Juniper Networks Junos OS
- **version:** All versions prior to 18.4R2-S9, 18.4R3-S11 19.1 versions prior to 19.1R3-S8 19.2 version 19.2R1 and later versions 19.3 versions prior to 19.3R3-S5 19.4 versions prior to 19.4R2-S6, 19.4R3-S6 20.1 version 20.1R1 and later versions 20.2 versions prior to 20.2R3-S3 20.3 versions prior to 20.3R3-S2 20.4 versions prior to 20.4R3-S1 21.1 versions prior to 21.1R3-S3 21.2 versions prior to 21.2R2-S1, 21.2R3
- **component:** Routing Protocol Daemon (rdp)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-410 | Insufficient Resource Pool | Base | Allowed | 1.2114 | dense, sparse, graph | dense: 0.563, sparse: 1.000, graph: 1.000 |
| 2 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 1.0035 | dense, sparse, graph | dense: 0.573, sparse: 1.000, graph: 0.639 |
| 3 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.8694 | sparse, graph | sparse: 1.000, graph: 0.832 |
| 4 | CWE-606 | Unchecked Input for Loop Condition | Base | Allowed | 0.8466 | dense, sparse | dense: 0.549, sparse: 1.000 |
| 5 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.8446 | dense, sparse | dense: 0.545, sparse: 1.000 |
| 6 | CWE-775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | Allowed | 0.7872 | dense, sparse | dense: 0.561, sparse: 1.000 |
| 7 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |
| 8 | CWE-1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |
| 9 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |
| 10 | CWE-497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |

