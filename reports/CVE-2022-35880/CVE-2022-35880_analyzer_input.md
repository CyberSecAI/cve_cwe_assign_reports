# Vulnerability Information: CVE-2022-35880

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the UPnP logging functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9Z and 6.9X. A specially-crafted UPnP negotiation can lead to memory corruption, information disclosure, and denial of service. An attacker can host a malicious UPnP service to trigger these vulnerabilities.This vulnerability arises from **format string injection** via `NewInternalClient` XML tag, as used within the `DoUpdateUPnPbyService` action handler.

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **vector:** specially-crafted UPnP negotiation
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9Z and 6.9X
- **component:** UPnP logging functionality

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `log` function uses `vsnprintf` with attacker-controlled input, leading to format string vulnerabilities.",
  "Weaknesses/vulnerabilities present": [
    "Format string injection vulnerability in the UPnP logging functionality."
  ],
  "Impact of exploitation": "Memory corruption, information disclosure, and denial of service. The output is only visible on the UART console.",
  "Attack vectors": "A malicious UPnP service can be hosted by an attacker to trigger the vulnerabilities.",
  "Required attacker capabilities/position": "Attacker needs to be on the same network as the vulnerable device and able to send and receive UPnP messages. Additionally, access to the device's UART console is needed to observe the exploit."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.0729 | dense, sparse, graph | dense: 0.692, sparse: 0.827, graph: 0.709 |
| 2 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5238 | sparse, graph | sparse: 0.291, graph: 1.000 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4887 | sparse, graph | sparse: 0.303, graph: 0.882 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4661 | dense, sparse | dense: 0.593, sparse: 0.296 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4136 | dense, sparse | dense: 0.589, sparse: 0.268 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4066 | dense, sparse | dense: 0.541, sparse: 0.271 |
| 7 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1973 | dense, sparse | dense: 0.548, sparse: 0.291 |
| 8 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.1637 | sparse | sparse: 0.286 |
| 9 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1632 | sparse | sparse: 0.285 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.1629 | sparse | sparse: 0.285 |

