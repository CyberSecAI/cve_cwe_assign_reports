# Vulnerability Information: CVE-2021-28278

## Vulnerability Description
A **Heap-based Buffer Overflow** vulnerability exists in jhead 3.04 and 3.05 via the RemoveSectionType function in jpgfile.c.

### Vulnerability Description Key Phrases
- **weakness:** **Heap-based Buffer Overflow**
- **product:** jhead
- **version:** 3.04 and 3.05
- **component:** RemoveSectionType function in jpgfile.c

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability described in CVE-2021-28278:

**Root Cause:**
The vulnerability is a heap-based buffer overflow in the `RemoveSectionType` function within `jpgfile.c`.

**Weaknesses/Vulnerabilities:**
- **Heap-based buffer overflow:**  The `memmove` operation within the `RemoveSectionType` function attempts to move a block of memory that exceeds the allocated buffer's boundaries. This is triggered when processing a crafted JPEG file.

**Impact of Exploitation:**
- **Denial of Service (DoS):** As evidenced by the AddressSanitizer report, the heap-based buffer overflow leads to a crash of the application. This can effectively cause a denial of service.

**Attack Vectors:**
- **Malicious JPEG file:** The attack vector involves processing a specially crafted JPEG file designed to trigger the overflow.

**Required Attacker Capabilities/Position:**
- **Ability to provide input:** An attacker needs to be able to supply a malicious JPEG file to the vulnerable application for processing. This could be achieved through various means, such as uploading the file or processing it through a vulnerable function in a different system.

**Additional Information:**
- The issue was identified using AddressSanitizer during a fuzzing process.
- The vulnerability was fixed in commit `a50953a`.
- The specific file that triggers the vulnerability is `tests_61786.jpg` and can be found within `tests_61786.zip`
- The overflow occurs because `RemoveSectionType` attempts to `memmove` memory past allocated buffer.
- The Gentoo Security Advisory identifies this vulnerability as "low" severity, but it is remotely exploitable.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6562 | dense, sparse, graph | dense: 0.500, sparse: 0.138, graph: 0.913 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6464 | dense, sparse, graph | dense: 0.522, sparse: 0.144, graph: 0.846 |
| 3 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.5702 | dense, sparse, graph | dense: 0.552, sparse: 0.109, graph: 0.780 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5065 | dense, sparse, graph | dense: 0.542, sparse: 0.134, graph: 0.562 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3546 | sparse, graph | sparse: 0.127, graph: 0.789 |
| 6 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3539 | sparse, graph | sparse: 0.110, graph: 0.813 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3519 | dense, sparse | dense: 0.572, sparse: 0.166 |
| 8 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3499 | sparse, graph | sparse: 0.118, graph: 0.789 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3270 | dense, sparse | dense: 0.517, sparse: 0.120 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3236 | dense, sparse | dense: 0.504, sparse: 0.125 |

