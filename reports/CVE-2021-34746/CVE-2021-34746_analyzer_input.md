# Vulnerability Information: CVE-2021-34746

## Vulnerability Description
A vulnerability in the TACACS+ authentication, authorization and accounting (AAA) feature of Cisco Enterprise NFV Infrastructure Software (NFVIS) could allow an unauthenticated, remote attacker to bypass authentication and log in to an affected device as an administrator. This vulnerability is due to **incomplete validation of user-supplied input** that is passed to an authentication script. An attacker could exploit this vulnerability by injecting parameters into an authentication request. A successful exploit could allow the attacker to bypass authentication and log in as an administrator to the affected device.

### Vulnerability Description Key Phrases
- **rootcause:** **incomplete validation of user-supplied input**
- **impact:** bypass authentication and log in as administrator
- **vector:** injecting parameters into authentication request
- **attacker:** unauthenticated remote attacker
- **product:** Cisco Enterprise NFV Infrastructure Software
- **component:** TACACS+ authentication authorization and accounting feature

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "Incomplete validation of user-supplied input passed to an authentication script.",
    "weaknesses": [
      "The TACACS+ authentication, authorization, and accounting (AAA) feature of Cisco Enterprise NFV Infrastructure Software (NFVIS) does not properly validate user-supplied input.",
      "The authentication script `/usr/bin/ext_auth.sh` is vulnerable to parameter injection due to insufficient input sanitization.",
      "The `/usr/bin/auth_hash.py` script, used for TACACS authentication with `maapi` or `rest` context, is susceptible to command injection via the `user` and `password` variables.",
      "The usage of character sequences like ';;;rest' within passwords allows control flow to be altered."
    ],
    "impact": "An unauthenticated, remote attacker can bypass authentication and log in to an affected device as an administrator.",
    "attack_vectors": [
      "Network-based attacks",
      "Parameter injection in authentication requests to bypass authentication checks"
    ],
    "attacker_capabilities": "The attacker needs to be able to send specially crafted authentication requests to the vulnerable device. No prior authentication is required.",
     "additional_information": "The vulnerability affects Cisco Enterprise NFVIS Release 4.5.1 if the TACACS external authentication method is configured. Proof-of-concept exploit code is publicly available. The vulnerability can be exploited via SSH CLI, Netconf and HTTPS. Configurations using RADIUS or local authentication are not affected."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | 0.7419 | dense, sparse, graph | dense: 0.527, sparse: 0.463, graph: 0.597 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7274 | dense, sparse, graph | dense: 0.530, sparse: 0.437, graph: 0.594 |
| 3 | CWE-289 | Authentication Bypass by Alternate Name | Base | Allowed | 0.6698 | dense, sparse | dense: 0.562, sparse: 0.679 |
| 4 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.5172 | dense, sparse | dense: 0.515, sparse: 0.453 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5162 | dense, sparse | dense: 0.510, sparse: 0.456 |
| 6 | CWE-1392 | Use of Default Credentials | Base | Allowed | 0.5112 | dense, sparse | dense: 0.524, sparse: 0.435 |
| 7 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4561 | sparse, graph | sparse: 0.456, graph: 0.547 |
| 8 | CWE-183 | Permissive List of Allowed Inputs | Base | Allowed | 0.2590 | sparse | sparse: 0.453 |
| 9 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.2557 | sparse | sparse: 0.447 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.2539 | sparse | sparse: 0.444 |

