# Vulnerability Information: CVE-2022-35874

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the XCMD testWifiAP functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9X and 6.9Z. Specially-crafted configuration values can lead to memory corruption, information disclosure and denial of service. An attacker can modify a configuration value and then execute an XCMD to trigger these vulnerabilities.This vulnerability arises from **format string injection** via the `ssid` and `ssid_hex` configuration parameters, as used within the `testWifiAP` XCMD handler

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **vector:** specially-crafted configuration values
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9X and 6.9Z
- **component:** XCMD testWifiAP functionality

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2022-35874:

**Root Cause of Vulnerability:**

The root cause is a format string injection vulnerability in the `log` function of the Abode Systems, Inc. iota All-In-One Security Kit. This function is used for logging diagnostic messages to the device's UART console. The vulnerability arises because attacker-controlled configuration values are injected into the format string parameter of the `log` function.

**Weaknesses/Vulnerabilities Present:**

*   **Format String Vulnerability:** The `log` function uses `vsnprintf` to format log messages, and the format string is directly constructed using values obtained from the device's configuration. Specifically the `config->ssid` or `config->ssid_hex` values.
*   **Lack of Input Sanitization:** The device fails to sanitize or validate the input values used to construct the format string, allowing an attacker to inject format specifiers.

**Impact of Exploitation:**

*   **Memory Corruption:** By injecting carefully crafted format strings, an attacker can potentially corrupt memory on the stack.
*   **Information Disclosure:** Format string injection can lead to the disclosure of stack memory, potentially revealing sensitive information.
*  **Denial of Service:** Memory corruption can lead to crashes and device instability, resulting in denial of service.

**Attack Vectors:**

*   **Network:** An attacker can send a crafted `testWifiAP` XCMD via the UDP/55050 service to trigger the vulnerability.
*   **Configuration Manipulation:** The attacker must first modify the device's Wi-Fi configuration values (`config->ssid` or `config->ssid_hex`) via the mobile application, web application, `setWifiAP` XCMD, or the device's local web interface.

**Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** The attacker does not need to authenticate to send the crafted XCMD due to the vulnerability in the UDP/55050 service.
*   **Configuration Write Access:** The attacker needs to be able to modify the device's configuration values.
*   **Physical Access for Information Disclosure:** The output of the format string injection is only available on the device's UART console. This requires a physical attacker to connect to the UART.

**CVE-2022-35874 Specifics:**

*   This specific CVE relates to the misuse of the log function via the `config->ssid` and `config->ssid_hex` values when setting the SSID.
*   The content provides the exact vulnerable code snippets in the `do_test_wifiap` function, detailing how the SSID is used to build the format string.
*   The content also provides a log example of a format string injection (`%x.%x.%x...`).

**Additional Notes:**

*   The content also details three other related vulnerabilities (CVE-2022-35875, CVE-2022-35876, and CVE-2022-35877) that follow the same pattern of format string injection but using other configuration values (`config->wpapsk`, `config->default_key_id`, and `config->key`).
*   The content states that the issues were patched by the vendor.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.1228 | dense, sparse, graph | dense: 0.702, sparse: 0.905, graph: 0.710 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7256 | dense, sparse, graph | dense: 0.618, sparse: 0.340, graph: 0.621 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5425 | sparse, graph | sparse: 0.323, graph: 1.000 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5136 | sparse, graph | sparse: 0.347, graph: 0.882 |
| 5 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.4611 | sparse, graph | sparse: 0.320, graph: 0.777 |
| 6 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4578 | dense, sparse | dense: 0.559, sparse: 0.311 |
| 7 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4540 | sparse, graph | sparse: 0.300, graph: 0.789 |
| 8 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4424 | dense, sparse | dense: 0.570, sparse: 0.311 |
| 9 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.4215 | dense, sparse | dense: 0.557, sparse: 0.311 |
| 10 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2102 | dense, sparse | dense: 0.571, sparse: 0.321 |

