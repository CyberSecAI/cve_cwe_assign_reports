# Vulnerability Information: CVE-2021-46520

## Vulnerability Description
Cesanta MJS v2.20.0 was discovered to contain a **heap buffer overflow** via mjs_jprintf at src/mjs_util.c.

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **product:** Cesanta MJS
- **version:** v2.20.0
- **component:** mjs_jprintf at src/mjs_util.c

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Heap-buffer-overflow in `mjs_jprintf` function due to insufficient buffer size when processing a complex JSON string.
- **Weaknesses/vulnerabilities present:** Heap-buffer-overflow.
- **Impact of exploitation:**  The vulnerability leads to a crash due to memory corruption. Specifically, the program attempts to read memory outside of the allocated buffer in the `mjs_jprintf` function.
- **Attack vectors:** Sending a crafted JSON string to the affected function.
- **Required attacker capabilities/position:** An attacker needs the ability to control the input to the `mjs_jprintf` function, or more specifically the crafted JSON string. The provided example uses `JSON.stringify` with a nested object containing `Object.create` to trigger the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6812 | dense, sparse, graph | dense: 0.555, sparse: 0.130, graph: 0.921 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6496 | dense, sparse, graph | dense: 0.589, sparse: 0.113, graph: 0.811 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5239 | dense, sparse, graph | dense: 0.608, sparse: 0.103, graph: 0.571 |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4885 | dense, sparse, graph | dense: 0.554, sparse: 0.088, graph: 0.450 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3714 | dense, sparse | dense: 0.621, sparse: 0.160 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3390 | sparse, graph | sparse: 0.099, graph: 0.789 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3358 | dense, sparse | dense: 0.590, sparse: 0.119 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3343 | dense, sparse | dense: 0.544, sparse: 0.108 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3260 | dense, sparse | dense: 0.551, sparse: 0.087 |
| 10 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3250 | dense, sparse | dense: 0.548, sparse: 0.089 |

