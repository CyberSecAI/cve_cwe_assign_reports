{
  "cve_id": "CVE-2021-33912",
  "query": "libspf2 before 1.2.11 has a four-byte heap-based buffer overflow that might allow remote attackers to execute arbitrary code (via an unauthenticated e-mail message from anywhere on the Internet) with a crafted SPF DNS record, because of incorrect sprintf usage in SPF_record_expand_data in spf_expand.c. The vulnerable code may be part of the supply chain of a sites e-mail infrastructure (e.g., with additional configuration, Exim can use libspf2 the Postfix web site links to unofficial patches for use of libspf2 with Postfix older versions of spfquery relied on libspf2) but most often is not.",
  "keyphrases": {
    "rootcause": "incorrect sprintf usage",
    "weakness": "heap-based buffer overflow"
  },
  "timestamp": "2025-03-17T23:55:08.948487",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 9,
      "average_score": 0.5544930663266393,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.6183556858367167,
      "unique_finds": 0
    },
    "graph": {
      "hit_count": 5,
      "average_score": 0.7851331740989517,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-193",
      "name": "Off-by-one Error",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.9692,
      "retriever_count": 0,
      "dense_score": 0.556,
      "sparse_score": 0.6332,
      "graph_score": 0.9195
    },
    {
      "cwe_id": "CWE-190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.9341,
      "retriever_count": 0,
      "dense_score": 0.5622,
      "sparse_score": 0.6755,
      "graph_score": 0.7452
    },
    {
      "cwe_id": "CWE-125",
      "name": "Out-of-bounds Read",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.8793,
      "retriever_count": 0,
      "dense_score": 0.5367,
      "sparse_score": 0.637,
      "graph_score": 0.689
    },
    {
      "cwe_id": "CWE-126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.8314,
      "retriever_count": 0,
      "dense_score": 0.5667,
      "sparse_score": 0.6319,
      "graph_score": 0.7149
    },
    {
      "cwe_id": "CWE-122",
      "name": "Heap-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.6972,
      "retriever_count": 0,
      "dense_score": 0.5819,
      "sparse_score": 0.8113,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6762,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.6465,
      "graph_score": 0.8571
    },
    {
      "cwe_id": "CWE-130",
      "name": "Improper Handling of Length Parameter Inconsistency",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6208,
      "retriever_count": 0,
      "dense_score": 0.5488,
      "sparse_score": 0.6051,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5967,
      "retriever_count": 0,
      "dense_score": 0.5314,
      "sparse_score": 0.5782,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-121",
      "name": "Stack-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.5899,
      "retriever_count": 0,
      "dense_score": 0.569,
      "sparse_score": 0.6194,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4668,
      "retriever_count": 0,
      "dense_score": 0.5378,
      "sparse_score": 0.3456,
      "graph_score": "-"
    }
  ]
}