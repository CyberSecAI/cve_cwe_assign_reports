# Vulnerability Information: CVE-2021-44988

## Vulnerability Description
Jerryscript v3.0.0 and below was discovered to contain a **stack overflow** via ecma_find_named_property in ecma-helpers.c.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** Jerryscript
- **version:** v3.0.0 and below
- **component:** ecma-helpers.c

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Vulnerability:** Stack overflow in `ecma_find_named_property` (ecma-helpers.c) and `ecma_lcache_lookup` (ecma-lcache.c) within the JerryScript engine.

**Root Cause:**
- The vulnerability in `ecma_find_named_property` is triggered by a recursive call.
- The vulnerability in `ecma_lcache_lookup` is caused by a potential recursive call within the function. Both are triggered by a crafted JavaScript payload using `Array.prototype.flat`.

**Weaknesses:**
- Lack of stack overflow checks within the `ecma_find_named_property` and `ecma_lcache_lookup` functions.
- The `Array.prototype.flat` function can be used to create recursive data structures that trigger the stack overflow.

**Impact of Exploitation:**
- Stack overflow leading to denial of service (crashes) of the JerryScript engine.
- Potentially other consequences based on the ability to control the stack through crafted input.

**Attack Vectors:**
- Crafting a malicious JavaScript payload.
- Executing the payload within a vulnerable instance of the JerryScript engine.

**Required Attacker Capabilities/Position:**
- Ability to provide input that is processed by the JerryScript engine.
- Knowledge of the vulnerable function and how it is impacted by `Array.prototype.flat`.
- Ability to execute arbitrary Javascript code.

**Additional Details:**
- Both issues are triggered by the same javascript snippet.
- The issue was found by the OWL337 team.
- Both issues were resolved by adding stack overflow checks in `Array.prototype.{flat, flatMap}`

The provided content gives more detail than the standard CVE description, explaining the root cause, test case and exploit, and the file location of the vulnerable code.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4172 | sparse, graph | sparse: 0.104, graph: 1.000 |
| 2 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4129 | sparse, graph | sparse: 0.097, graph: 1.000 |
| 3 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3933 | sparse, graph | sparse: 0.095, graph: 1.000 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3092 | sparse, graph | sparse: 0.079, graph: 0.811 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2957 | dense, sparse | dense: 0.503, sparse: 0.120 |
| 6 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.2922 | dense, sparse | dense: 0.490, sparse: 0.082 |
| 7 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2044 | dense, sparse | dense: 0.558, sparse: 0.120 |
| 8 | CWE-170 | Improper Null Termination | Base | Allowed | 0.0531 | sparse | sparse: 0.093 |
| 9 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.0518 | sparse | sparse: 0.091 |
| 10 | CWE-193 | Off-by-one Error | Base | Allowed | 0.0507 | sparse | sparse: 0.089 |

