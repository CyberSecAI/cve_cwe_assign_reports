# Vulnerability Information: CVE-2022-23537

## Vulnerability Description
PJSIP is a free and open source multimedia communication library written in C language implementing standard based protocols such as SIP, SDP, RTP, STUN, TURN, and ICE. **Buffer overread** is possible when parsing a specially crafted STUN message with unknown attribute. The vulnerability affects applications that uses STUN including PJNATH and PJSUA-LIB. The patch is available as a commit in the master branch (2.13.1).

### Vulnerability Description Key Phrases
- **weakness:** **Buffer overread**
- **vector:** specially crafted STUN message with unknown attribute
- **product:** PJSIP
- **version:** 2.13.1

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2022-23537:

**Root Cause of Vulnerability:**

The root cause is a buffer over-read in the STUN message decoder. This occurs when parsing a STUN message that contains an unknown attribute. Specifically, the code was not correctly validating the length of the attribute value, leading to a read beyond the allocated buffer.

**Weaknesses/Vulnerabilities Present:**

*   **Buffer Over-read:** The primary vulnerability is a buffer over-read. When parsing a STUN attribute, the code reads beyond the boundaries of the provided buffer.

**Impact of Exploitation:**

*   **Information Disclosure:** An attacker could potentially read sensitive data from memory by triggering the out-of-bounds read.
*   **Application Crash:** The over-read could lead to an application crash, resulting in a denial-of-service (DoS) scenario.
*   **Memory Corruption:** Although not explicitly mentioned, it's possible that an over-read could corrupt memory in some cases.

**Attack Vectors:**

*   **Specially Crafted STUN Message:** The attack vector is a specially crafted STUN message with an unknown attribute that causes the decoder to attempt to read beyond the buffer.

**Required Attacker Capabilities/Position:**

*   **Network Access:** An attacker needs to be able to send a crafted STUN message to a vulnerable application.
*   **Understanding of STUN Protocol:** An attacker must understand the STUN protocol and how to create a message that triggers the vulnerability.

**More Details:**

*   The provided GitHub commit diff shows the fix which involves checking the length of the attribute value before attempting to read it (`if (pdu_len < attr_val_len + ATTR_HDR_LEN)`).
*   The vulnerability affects applications that use STUN, including PJNATH and PJSUA-LIB.
*   The Debian LTS advisory indicates that this CVE affects the `ring` package, which uses pjsip/pjproject.

**Summary:**

CVE-2022-23537 is a buffer over-read vulnerability in the STUN message decoder of the pjsip/pjproject library. An attacker can exploit this vulnerability by sending a specially crafted STUN message with an unknown attribute, leading to information disclosure, a denial of service, and possibly memory corruption. The fix ensures that the decoder does not read beyond the bounds of the buffer when parsing STUN attributes.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6418 | dense, sparse, graph | dense: 0.479, sparse: 0.423, graph: 0.598 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6023 | dense, sparse, graph | dense: 0.425, sparse: 0.262, graph: 0.670 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6014 | dense, sparse, graph | dense: 0.425, sparse: 0.261, graph: 0.669 |
| 4 | CWE-415 | Double Free | Variant | Allowed | 0.3811 | sparse, graph | sparse: 0.237, graph: 0.776 |
| 5 | CWE-754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | 0.3604 | dense, sparse, graph | dense: 0.427, sparse: 0.314, graph: 0.616 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3496 | dense, sparse | dense: 0.465, sparse: 0.255 |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3496 | dense, sparse | dense: 0.439, sparse: 0.227 |
| 8 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3423 | dense, sparse | dense: 0.483, sparse: 0.225 |
| 9 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3363 | dense, sparse | dense: 0.413, sparse: 0.227 |
| 10 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3281 | dense, sparse | dense: 0.439, sparse: 0.237 |

