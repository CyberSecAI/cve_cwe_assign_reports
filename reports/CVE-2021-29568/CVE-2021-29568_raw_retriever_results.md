# Raw Retriever Results for CVE-2021-29568

# Raw Retriever Results for CVE-2021-29568

## Query
TensorFlow is an end-to-end open source platform for machine learning. An attacker can trigger undefined behavior by binding to null pointer in `tf.raw_ops.ParameterizedTruncatedNormal`. This is because the implementation(https//github.com/tensorflow/tensorflow/blob/3f6fe4dfef6f57e768260b48166c27d148f3015f/tensorflow/core/kernels/parameterized_truncated_normal_op.cc#L630) does not validate input arguments before accessing the first element of `shape`. If `shape` argument is empty, then `shape_tensor.flat()` is an empty array. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.

## Keyphrases
- **rootcause**: does not validate input arguments before accessing the first element of shape
- **weakness**: null pointer dereference

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4294 | 0.5232 | 0.4521 | 0.4423 | 20 |
| Sparse | 905.7140 | 2045.7786 | 1290.0595 | 1278.8907 | 20 |
| Graph | 1.5332 | 2.7196 | 1.8221 | 1.6584 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 787 | Out-of-bounds Write | base | 2.7196 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.5401 | Allowed |
| 3 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 4 | 195 | Signed to Unsigned Conversion Error | variant | 2.1168 | Allowed |
| 5 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 6 | 476 | NULL Pointer Dereference | Base | 1.9668 | Allowed |
| 7 | 681 | Incorrect Conversion between Numeric Types | Base | 1.8953 | Allowed |
| 8 | 617 | Reachable Assertion | Base | 1.8860 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 10 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 11 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 12 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 13 | 824 | Access of Uninitialized Pointer | Base | 1.6209 | Allowed |
| 14 | 1287 | Improper Validation of Specified Type of Input | Base | 1.6047 | Allowed |
| 15 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.5350 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 824 | Access of Uninitialized Pointer | Base | 0.5232 | 0.5232 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5006 | 0.5006 | Allowed |
| 3 | 1287 | Improper Validation of Specified Type of Input | Base | 0.4978 | 0.4978 | Allowed |
| 4 | 476 | NULL Pointer Dereference | Base | 0.4727 | 0.4727 | Allowed |
| 5 | 230 | Improper Handling of Missing Values | Variant | 0.4629 | 0.4629 | Allowed |
| 6 | 681 | Incorrect Conversion between Numeric Types | Base | 0.4536 | 0.4536 | Allowed |
| 7 | 252 | Unchecked Return Value | Base | 0.4439 | 0.4439 | Allowed |
| 8 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | 0.4436 | 0.4436 | Allowed |
| 9 | 197 | Numeric Truncation Error | Base | 0.4433 | 0.4433 | Allowed |
| 10 | 617 | Reachable Assertion | Base | 0.4425 | 0.4425 | Allowed |
| 11 | 415 | Double Free | Variant | 0.4421 | 0.4421 | Allowed |
| 12 | 822 | Untrusted Pointer Dereference | Base | 0.4409 | 0.4409 | Allowed |
| 13 | 1314 | Missing Write Protection for Parametric Data Values | Base | 0.4390 | 0.4390 | Allowed |
| 14 | 179 | Incorrect Behavior Order: Early Validation | Base | 0.4369 | 0.4369 | Allowed |
| 15 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4358 | 0.4358 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-824 | Access of Uninitialized Pointer | 2045.7786 | 2045.7786 | Allowed |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1565.9671 | 1565.9671 | Allowed |
| 3 | CWE-681 | Incorrect Conversion between Numeric Types | 1522.8015 | 1522.8015 | Allowed |
| 4 | CWE-122 | Heap-based Buffer Overflow | 1454.0766 | 1454.0766 | Allowed |
| 5 | CWE-617 | Reachable Assertion | 1410.7979 | 1410.7979 | Allowed |
| 6 | CWE-193 | Off-by-one Error | 1403.9957 | 1403.9957 | Allowed |
| 7 | CWE-476 | NULL Pointer Dereference | 1286.6610 | 1286.6610 | Allowed |
| 8 | CWE-674 | Uncontrolled Recursion | 1286.3297 | 1286.3297 | Allowed-with-Review |
| 9 | CWE-415 | Double Free | 1282.4745 | 1282.4745 | Allowed |
| 10 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 1281.4661 | 1281.4661 | Allowed |
| 11 | CWE-125 | Out-of-bounds Read | 1276.3153 | 1276.3153 | Allowed |
| 12 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 1212.2784 | 1212.2784 | Allowed |
| 13 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | 1182.0002 | 1182.0002 | Allowed |
| 14 | CWE-663 | Use of a Non-reentrant Function in a Concurrent Context | 1175.8601 | 1175.8601 | Allowed |
| 15 | CWE-20 | Improper Input Validation | 1135.4031 | 1135.4031 | Discouraged |
