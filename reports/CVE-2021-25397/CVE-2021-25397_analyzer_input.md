# Vulnerability Information: CVE-2021-25397

## Vulnerability Description
An **improper access control** vulnerability in TelephonyUI prior to SMR MAY-2021 Release 1 allows local attackers to write arbitrary files of telephony process via untrusted applications.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access control**
- **impact:** write arbitrary files
- **attacker:** local attackers
- **product:** TelephonyUI
- **version:** prior to SMR MAY-2021 Release 1

## CVE Reference Links Content Summary
```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "related": true,
    "information": {
      "root_cause": "An improper access control vulnerability in TelephonyUI allows local attackers to write arbitrary files of telephony process via untrusted applications.",
      "vulnerabilities": [
        "Improper Access Control"
      ],
      "impact": "Local attackers can write arbitrary files of the telephony process.",
      "attack_vectors": [
        "Sending a broadcast intent to the exported receiver `com.samsung.android.app.telephonyui.carrierui.photoring.model.PhotoringReceiver` with a crafted photoring_uri and down_file parameters."
      ],
       "required_capabilities": [
        "The attacker needs the ability to send broadcast intents to the vulnerable application.",
          "The attacker needs control of a server that can respond to the crafted photoring_uri with a `image/*` or `video/*` content type."
      ],
        "additional_details": "The receiver `com.samsung.android.app.telephonyui.carrierui.photoring.model.PhotoringReceiver` is exported. It saves files from the URL specified in `photoring_uri` to the path specified in `down_file`. The only requirement is that the content-type of the server response should be `image/*` or `video/*`"
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-213 | Exposure of Sensitive Information Due to Incompatible Policies | Base | Allowed | 0.5754 | dense, sparse, graph | dense: 0.598, sparse: 0.111, graph: 0.594 |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.5561 | dense, sparse, graph | dense: 0.578, sparse: 0.115, graph: 0.562 |
| 3 | CWE-927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | 0.5102 | dense, sparse, graph | dense: 0.573, sparse: 0.147, graph: 0.510 |
| 4 | CWE-926 | Improper Export of Android Application Components | Variant | Allowed | 0.3625 | dense, sparse | dense: 0.579, sparse: 0.180 |
| 5 | CWE-280 | Improper Handling of Insufficient Permissions or Privileges  | Base | Allowed | 0.3570 | dense, sparse | dense: 0.578, sparse: 0.119 |
| 6 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.3504 | dense, sparse | dense: 0.568, sparse: 0.116 |
| 7 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2099 | dense, sparse | dense: 0.587, sparse: 0.111 |
| 8 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1747 | dense, sparse | dense: 0.622, sparse: 0.138 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1669 | dense, sparse | dense: 0.605, sparse: 0.123 |
| 10 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1640 | dense, sparse | dense: 0.597, sparse: 0.119 |

