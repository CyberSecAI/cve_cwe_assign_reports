# Vulnerability Information: CVE-2021-21639

## Vulnerability Description
Jenkins 2.286 and earlier, LTS 2.277.1 and earlier does not validate the type of object created after loading the data submitted to the `config.xml` REST API endpoint of a node, allowing attackers with Computer/Configure permission to replace a node with one of a different type.

### Vulnerability Description Key Phrases
- **rootcause:** **improper type validation**
- **impact:** replace node with one of a different type
- **attacker:** attackers with Computer/Configure permission
- **product:** Jenkins
- **version:** 2.286 and earlier, LTS 2.277.1 and earlier
- **component:** config.xml REST API endpoint

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-21639:

**Root Cause:**

The vulnerability stems from a lack of type validation when processing data submitted to the `config.xml` REST API endpoint for a node in Jenkins. Specifically, the system doesn't verify the type of object being created after loading the data.

**Weaknesses/Vulnerabilities Present:**

- **Missing Input Validation:** The core issue is the absence of proper type validation on data received via the `config.xml` REST API.
- **Type Confusion:** This allows an attacker to potentially replace a node with a different, unexpected type, leading to potential misconfiguration or other issues.

**Impact of Exploitation:**

- An attacker can replace an existing node with a node of a different type.
- This could lead to unexpected behavior, service disruptions, or even further exploitation, depending on the specific differences in node types and the capabilities of the new node type.

**Attack Vectors:**

- **REST API Endpoint:** The vulnerability is triggered through the `config.xml` REST API endpoint for a node.
- **Data Injection:** An attacker submits crafted data to this endpoint, designed to create an object of an unexpected type.

**Required Attacker Capabilities/Position:**

- **Authentication:** The attacker must have valid credentials for the Jenkins instance.
- **Computer/Configure Permission:** Specifically, the attacker needs the "Computer/Configure" permission to access and manipulate node configurations.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.4894 | sparse, graph | sparse: 0.231, graph: 1.000 |
| 2 | CWE-1287 | Improper Validation of Specified Type of Input | Base | Allowed | 0.4446 | sparse, graph | sparse: 0.257, graph: 0.832 |
| 3 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3455 | dense, sparse | dense: 0.442, sparse: 0.217 |
| 4 | CWE-276 | Incorrect Default Permissions | Base | Allowed | 0.3430 | dense, sparse | dense: 0.444, sparse: 0.211 |
| 5 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2181 | dense, sparse | dense: 0.462, sparse: 0.245 |
| 6 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.1296 | sparse | sparse: 0.227 |
| 7 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1278 | sparse | sparse: 0.223 |
| 8 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.1271 | sparse | sparse: 0.222 |
| 9 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.1267 | sparse | sparse: 0.222 |
| 10 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.1259 | sparse | sparse: 0.220 |

