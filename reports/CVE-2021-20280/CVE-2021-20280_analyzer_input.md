# Vulnerability Information: CVE-2021-20280

## Vulnerability Description
Text-based feedback answers required additional sanitizing to prevent **stored XSS** and **blind SSRF** risks in moodle before 3.10.2, 3.9.5, 3.8.8, 3.5.17.

### Vulnerability Description Key Phrases
- **weakness:** **stored XSS and blind SSRF**
- **product:** moodle
- **version:** before 3.10.2, 3.9.5, 3.8.8, 3.5.17
- **component:** Text-based feedback answers

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "Text-based feedback answers were not properly sanitized, allowing for the injection of malicious code.",
    "weaknesses": [
      "Stored Cross-Site Scripting (XSS)",
      "Blind Server-Side Request Forgery (SSRF)"
    ],
    "impact": "An attacker could execute arbitrary JavaScript code in the victim's browser (XSS) or potentially make requests to internal resources (SSRF).",
    "attack_vectors": "By crafting a malicious text-based feedback answer, an attacker could inject XSS payloads or trigger blind SSRF.",
    "required_capabilities": "An attacker needs to be able to submit feedback answers to a Moodle instance. This could be an instructor, student, or any authenticated user depending on the feedback activity configuration."
  },
  "affected_versions": [
    "3.10 to 3.10.1",
    "3.9 to 3.9.4",
    "3.8 to 3.8.7",
    "3.5 to 3.5.16",
    "and earlier unsupported versions"
    ],
  "fixed_versions": [
    "3.10.2",
    "3.9.5",
    "3.8.8",
    "3.5.17"
    ],
   "references": [
        "https://bugzilla.redhat.com/show_bug.cgi?id=1939039",
        "https://moodle.org/mod/forum/discuss.php?d=419651",
        "https://access.redhat.com/security/cve/CVE-2021-20280"
   ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.6338 | dense, sparse, graph | dense: 0.507, sparse: 0.129, graph: 0.856 |
| 2 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.5186 | dense, sparse, graph | dense: 0.454, sparse: 0.144, graph: 0.585 |
| 3 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.4121 | dense, sparse, graph | dense: 0.487, sparse: 0.110, graph: 0.641 |
| 4 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.3407 | sparse, graph | sparse: 0.102, graph: 0.789 |
| 5 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.2847 | dense, sparse | dense: 0.444, sparse: 0.109 |
| 6 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.2639 | sparse, graph | sparse: 0.104, graph: 0.572 |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.2314 | sparse, graph | sparse: 0.099, graph: 0.488 |
| 8 | CWE-174 | Double Decoding of the Same Data | Variant | Allowed | 0.1386 | sparse | sparse: 0.262 |
| 9 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.0659 | sparse | sparse: 0.115 |
| 10 | CWE-611 | Improper Restriction of XML External Entity Reference | Base | Allowed | 0.0643 | sparse | sparse: 0.112 |

