# Vulnerability Information: CVE-2021-41694

## Vulnerability Description
An **Incorrect Access Control** vulnerability exists in Premiumdatingscript 4.2.7.7 via the password change procedure in requests\user.php.

### Vulnerability Description Key Phrases
- **rootcause:** **Incorrect Access Control**
- **product:** Premiumdatingscript
- **version:** 4.2.7.7
- **component:** password change procedure in requestsuser.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-41694:

**Root cause of vulnerability:**
- The password recovery function in `requests/user.php` uses `md5($time)` to generate a secret recovery code. The time value is easily predictable by an attacker.

**Weaknesses/vulnerabilities present:**
- **Weak Password Recovery:** The use of `md5($time)` makes the recovery code highly predictable due to the easily obtainable server time.
- **Brute-force vulnerability:** The predictable nature of the recovery code allows an attacker to brute-force it.

**Impact of exploitation:**
- **Account takeover:** An attacker can guess the recovery code for any user, gain access to their account by resetting password and subsequently performing unauthorized actions.

**Attack vectors:**
- **Network-based:** The attacker can send a request to initiate password recovery and then bruteforce recovery codes.
- **Server-side:** The vulnerability lies in how the recovery code is generated on the server.

**Required attacker capabilities/position:**
- **Basic web access:** The attacker needs to be able to access the website and initiate a password recovery request.
- **Time estimation:** The attacker needs to estimate server time and perform brute-force attempts on recovery codes based on that estimation

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.6328 | dense, sparse, graph | dense: 0.553, sparse: 0.108, graph: 0.823 |
| 2 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.6149 | dense, sparse, graph | dense: 0.506, sparse: 0.113, graph: 0.832 |
| 3 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.5383 | dense, sparse, graph | dense: 0.531, sparse: 0.111, graph: 0.586 |
| 4 | CWE-341 | Predictable from Observable State | Base | Allowed | 0.3744 | sparse, graph | sparse: 0.134, graph: 0.832 |
| 5 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.3259 | dense, sparse | dense: 0.530, sparse: 0.106 |
| 6 | CWE-303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | 0.3167 | dense, sparse | dense: 0.524, sparse: 0.095 |
| 7 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.2441 | sparse, graph | sparse: 0.093, graph: 0.534 |
| 8 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.2425 | sparse, graph | sparse: 0.095, graph: 0.583 |
| 9 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1867 | dense, sparse | dense: 0.516, sparse: 0.104 |
| 10 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1422 | dense, sparse | dense: 0.513, sparse: 0.107 |

