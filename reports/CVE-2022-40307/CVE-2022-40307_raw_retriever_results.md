# Raw Retriever Results for CVE-2022-40307

# Raw Retriever Results for CVE-2022-40307

## Query
An issue was discovered in the Linux kernel through 5.19.8. drivers/firmware/efi/capsule-loader.c has a race condition with a resultant use-after-free.

## Keyphrases
- **rootcause**: race condition
- **weakness**: use-after-free

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5297 | 0.6036 | 0.5540 | 0.5492 | 20 |
| Sparse | 138.8966 | 382.8843 | 263.0477 | 266.1516 | 20 |
| Graph | 1.5552 | 2.9120 | 2.0234 | 1.7609 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 2 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 3 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 4 | 416 | Use After Free | Variant | 2.5812 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 6 | 415 | Double Free | Variant | 2.2622 | Allowed |
| 7 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 9 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7892 | Allowed-with-Review |
| 11 | 366 | Race Condition within a Thread | Base | 1.7326 | Allowed |
| 12 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 1.7190 | Allowed |
| 13 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 14 | 170 | Improper Null Termination | base | 1.6848 | Allowed |
| 15 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.6036 | 0.6036 | Allowed-with-Review |
| 2 | 366 | Race Condition within a Thread | Base | 0.5865 | 0.5865 | Allowed |
| 3 | 416 | Use After Free | Variant | 0.5778 | 0.5778 | Allowed |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5754 | 0.5754 | Allowed |
| 5 | 667 | Improper Locking | Class | 0.5670 | 0.5670 | Allowed-with-Review |
| 6 | 908 | Use of Uninitialized Resource | Base | 0.5644 | 0.5644 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.5622 | 0.5622 | Allowed-with-Review |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.5527 | 0.5527 | Allowed |
| 9 | 122 | Heap-based Buffer Overflow | Variant | 0.5508 | 0.5508 | Allowed |
| 10 | 126 | Buffer Over-read | Variant | 0.5496 | 0.5496 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5489 | 0.5489 | Allowed |
| 12 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5436 | 0.5436 | Allowed |
| 13 | 665 | Improper Initialization | Class | 0.5428 | 0.5428 | Discouraged |
| 14 | 190 | Integer Overflow or Wraparound | Base | 0.5424 | 0.5424 | Allowed |
| 15 | 121 | Stack-based Buffer Overflow | Variant | 0.5407 | 0.5407 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 382.8843 | 382.8843 | Allowed-with-Review |
| 2 | CWE-366 | Race Condition within a Thread | 328.2099 | 328.2099 | Allowed |
| 3 | CWE-667 | Improper Locking | 313.8231 | 313.8231 | Allowed-with-Review |
| 4 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 313.6497 | 313.6497 | Allowed |
| 5 | CWE-415 | Double Free | 308.1533 | 308.1533 | Allowed |
| 6 | CWE-413 | Improper Resource Locking | 304.7301 | 304.7301 | Allowed |
| 7 | CWE-401 | Missing Release of Memory after Effective Lifetime | 297.2401 | 297.2401 | Allowed |
| 8 | CWE-911 | Improper Update of Reference Count | 281.4128 | 281.4128 | Allowed |
| 9 | CWE-416 | Use After Free | 281.1425 | 281.1425 | Allowed |
| 10 | CWE-665 | Improper Initialization | 269.0318 | 269.0318 | Discouraged |
| 11 | CWE-662 | Improper Synchronization | 263.2713 | 263.2713 | Discouraged |
| 12 | CWE-364 | Signal Handler Race Condition | 261.1251 | 261.1251 | Allowed |
| 13 | CWE-476 | NULL Pointer Dereference | 257.2300 | 257.2300 | Allowed |
| 14 | CWE-820 | Missing Synchronization | 254.8291 | 254.8291 | Allowed |
| 15 | CWE-833 | Deadlock | 245.6973 | 245.6973 | Allowed |
