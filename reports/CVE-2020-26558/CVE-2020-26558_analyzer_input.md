# Vulnerability Information: CVE-2020-26558

## Vulnerability Description
Bluetooth LE and BR/EDR secure pairing in Bluetooth Core Specification 2.1 through 5.2 may permit a nearby man-in-the-middle attacker to identify the Passkey used during pairing (in the Passkey authentication procedure) by reflection of the public key and the authentication evidence of the initiating device, potentially permitting this attacker to complete authenticated pairing with the responding device using the correct Passkey for the pairing session. The attack methodology determines the Passkey value one bit at a time.

### Vulnerability Description Key Phrases
- **impact:** identify the Passkey
- **vector:** reflection of the public key and the authentication evidence
- **attacker:** nearby man-in-the-middle attacker
- **product:** Bluetooth Core Specification
- **version:** 2.1 through 5.2
- **component:** Bluetooth LE and BR/EDR secure pairing

## CVE Reference Links Content Summary
```
{
  "CVE-2020-26558": {
    "description": "A vulnerability exists in the Bluetooth Passkey authentication method and in Linux's implementation. An attacker within range of two Bluetooth devices during pairing using Passkey authentication can obtain the shared secret (Passkey), allowing impersonation of either device to each other.",
    "root_cause": "Improper handling of public keys and authentication during Bluetooth Passkey pairing.",
    "weaknesses": [
      "Inadequate validation of public keys during the pairing process, which allows an attacker to insert themselves into the pairing process and obtain the passkey.",
      "Lack of proper checks for public keys received from the remote peer, allowing the remote peer to present the same public key as the local device.",
       "The vulnerability lies in the reflection of the public key and the authentication evidence of the initiating device during Passkey authentication which permits a MITM attacker to obtain the Passkey."
     ],
    "impact": "An attacker can impersonate one of the paired devices to the other, potentially gaining access to authenticated services, but not a fully transparent MITM attack between initiator and responder.",
    "attack_vectors": [
       "Proximity attacks via Bluetooth wireless communication between vulnerable devices.",
        "Man-in-the-middle (MITM) attack during the pairing or bonding process."
    ],
    "required_capabilities": [
      "Attacker must be within wireless range of two vulnerable Bluetooth devices.",
       "Attacker must be able to act as a MITM during the Passkey authentication."
    ],
     "additional_details": [
         "The vulnerability is in the Passkey Entry protocol used in Secure Simple Pairing (SSP), Secure Connections (SC), and LE Secure Connections (LESC).",
          "The attacker can use a crafted series of responses to determine each bit of the randomly generated Passkey selected by the pairing initiator.",
          "The vulnerability exists in Bluetooth Core Specifications 2.1 through 5.2.",
          "The attacker does not succeed in pairing with the initiator by this method, preventing a fully transparent MITM attack on the pairing procedure between the initiator and responder."

     ]
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-301 | Reflection Attack in an Authentication Protocol | Base | Allowed | 0.6911 | dense, sparse, graph | dense: 0.618, sparse: 0.284, graph: 0.614 |
| 2 | CWE-290 | Authentication Bypass by Spoofing | Base | Allowed | 0.5420 | dense, sparse, graph | dense: 0.407, sparse: 0.149, graph: 0.708 |
| 3 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.3668 | sparse, graph | sparse: 0.121, graph: 0.832 |
| 4 | CWE-295 | Improper Certificate Validation | Base | Allowed | 0.3437 | sparse, graph | sparse: 0.115, graph: 0.777 |
| 5 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.2168 | sparse, graph | sparse: 0.111, graph: 0.479 |
| 6 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1445 | sparse, graph | sparse: 0.116, graph: 0.503 |
| 7 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1108 | sparse, graph | sparse: 0.119, graph: 0.503 |
| 8 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.0647 | sparse | sparse: 0.113 |
| 9 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.0644 | sparse | sparse: 0.113 |
| 10 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.0618 | sparse | sparse: 0.108 |

