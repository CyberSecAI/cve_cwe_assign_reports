# Vulnerability Information: CVE-2022-24063

## Vulnerability Description
This vulnerability allows remote attackers to execute arbitrary code on affected installations of Sante DICOM Viewer Pro 13.2.0.21165. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the parsing of JP2 files. The issue results from the **lack of proper validation of user-supplied data**, which can result in a **memory corruption** condition. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-15105.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of proper validation of user-supplied data**
- **weakness:** **memory corruption**
- **impact:** execute arbitrary code
- **vector:** malicious page or file
- **attacker:** remote attackers
- **product:** Sante DICOM Viewer Pro
- **version:** 13.2.0.21165
- **component:** parsing of JP2 files

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 300)
- CWE-416 (Count: 283)
- CWE-125 (Count: 142)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability exists due to the lack of proper validation of user-supplied data when parsing JP2 files, which leads to a memory corruption condition.
- **Weaknesses/vulnerabilities present**: Memory corruption vulnerability.
- **Impact of exploitation**: Successful exploitation allows a remote attacker to execute arbitrary code within the context of the current process.
- **Attack vectors**: The attacker can exploit this by enticing a user to either visit a malicious page or open a specially crafted malicious JP2 file.
- **Required attacker capabilities/position**: The attacker needs to deliver a malicious JP2 file or a malicious page to a user. User interaction is required to trigger the vulnerability (opening the file/page).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.7891 | dense, sparse | dense: 0.558, sparse: 0.891 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.7527 | sparse, graph | sparse: 0.765, graph: 0.882 |
| 3 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.6754 | dense, sparse | dense: 0.559, sparse: 0.691 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.6663 | dense, sparse | dense: 0.557, sparse: 0.775 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.6503 | sparse, graph | sparse: 0.749, graph: 0.772 |
| 6 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.4529 | dense, sparse, graph | dense: 0.588, sparse: 0.859, graph: 0.632 |
| 7 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.4099 | dense, sparse | dense: 0.566, sparse: 0.725 |
| 8 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.4068 | sparse | sparse: 0.711 |
| 9 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4054 | sparse | sparse: 0.709 |
| 10 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4004 | sparse | sparse: 0.700 |

