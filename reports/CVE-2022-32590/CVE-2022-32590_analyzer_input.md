# Vulnerability Information: CVE-2022-32590

## Vulnerability Description
In wlan, there is a possible **use after free due to an incorrect status check**. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation. Patch ID ALPS07299425 Issue ID ALPS07299425.

### Vulnerability Description Key Phrases
- **rootcause:** **use after free due to an incorrect status check**
- **impact:** local escalation of privilege
- **product:** Android
- **component:** wlan

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2022-32590:

**Root Cause:**

*   The vulnerability is due to an "incorrect status check" within the wlan (Wi-Fi) component. This leads to a use-after-free condition.

**Weaknesses/Vulnerabilities:**

*   **CWE-703 Improper Check or Handling of Exceptional Conditions:**  The code fails to properly handle exceptional conditions, resulting in a use-after-free vulnerability.
*   Use-after-free: Memory that has been freed is accessed, potentially leading to crashes or other undefined behavior.

**Impact of Exploitation:**

*   **Elevation of Privilege (EoP):** Successful exploitation can lead to local privilege escalation, granting the attacker system-level privileges.

**Attack Vectors:**

*   Local attack: An attacker needs to have local access to the device in order to trigger the vulnerability
*   The vulnerability is in the wlan (Wi-Fi) component

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to interact with the wlan component to trigger the use after free.
*   No specific execution privileges are needed, but System execution privilege can be obtained.
*   User interaction is not needed for exploitation.

**Affected Chipsets:**

*   A wide range of MediaTek chipsets are affected including: MT6761, MT6762, MT6765, MT6768, MT6769, MT6779, MT6781, MT6785, MT6789, MT6833, MT6853, MT6853T, MT6855, MT6873, MT6877, MT6879, MT6883, MT6885, MT6889, MT6891, MT6893, MT6895, MT6983, MT7663, MT7668, MT7902, MT7921, MT8167S, MT8175, MT8183, MT8185, MT8362A, MT8365, MT8385, MT8512A, MT8518, MT8532, MT8667, MT8695, MT8696, MT8766, MT8768, MT8786, MT8788, MT8789.

**Affected Software Versions:**

*   Android 11.0, 12.0 and Yocto 3.1, 3.3

**Additional Notes:**

* The severity is rated as Medium by MediaTek.
*   The issue is located in the Wi-Fi driver.
*   The provided information is more detailed than the basic CVE description, including affected chipsets, software versions, and the specific CWE.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-413 | Improper Resource Locking | Base | Allowed | 0.6380 | dense, sparse, graph | dense: 0.545, sparse: 0.256, graph: 0.613 |
| 2 | CWE-416 | Use After Free | Variant | Allowed | 0.6273 | dense, sparse, graph | dense: 0.537, sparse: 0.263, graph: 0.729 |
| 3 | CWE-253 | Incorrect Check of Function Return Value | Base | Allowed | 0.4619 | dense, sparse | dense: 0.530, sparse: 0.344 |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4314 | dense, sparse | dense: 0.523, sparse: 0.297 |
| 5 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.4303 | dense, sparse | dense: 0.543, sparse: 0.277 |
| 6 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3976 | dense, sparse | dense: 0.522, sparse: 0.239 |
| 7 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3506 | sparse, graph | sparse: 0.237, graph: 0.602 |
| 8 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.2875 | sparse, graph | sparse: 0.286, graph: 0.911 |
| 9 | CWE-667 | Improper Locking | Class | Allowed-with-Review | 0.2542 | dense, sparse | dense: 0.533, sparse: 0.290 |
| 10 | CWE-662 | Improper Synchronization | Class | Discouraged | 0.2216 | sparse, graph | sparse: 0.296, graph: 0.911 |

