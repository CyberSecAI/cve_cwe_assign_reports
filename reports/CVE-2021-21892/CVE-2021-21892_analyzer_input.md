# Vulnerability Information: CVE-2021-21892

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in the Web Manager FsUnmount functionality of Lantronix PremierWave 2050 8.9.0.0R4 (in QEMU). A specially crafted HTTP request can lead to remote code execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Lantronix PremierWave 2050
- **version:** 8.9.0.0R4
- **component:** Web Manager FsUnmount functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 31)
- CWE-120 (Count: 4)
- CWE-1284 (Count: 1)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability is a stack-based buffer overflow in the `FsUnmount` function of the Lantronix PremierWave 2050 Web Manager application. The `sprintf` function is used with a fixed-size destination buffer on the stack, while one of its input parameters, "path", comes from an HTTP POST request and is not validated. 
- **Weaknesses/vulnerabilities present**: The primary vulnerability is a classic stack-based buffer overflow (CWE-121) due to the unsafe use of `sprintf`. The lack of input sanitization/validation on the `path` parameter allows for arbitrary data to be copied into a stack buffer, exceeding its boundaries.
- **Impact of exploitation**: Successful exploitation of this vulnerability allows an attacker to overwrite data on the stack, including the return address, leading to arbitrary code execution. This gives the attacker full control of the affected device.
- **Attack vectors**: The attack vector is a specially crafted HTTP POST request to the device's web interface, specifically targeting the `FsUnmount` ajax directive with an overly long path parameter.
- **Required attacker capabilities/position**: An attacker needs to be authenticated to the device's web interface with no special permissions. They must also be able to send HTTP requests to the vulnerable device.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6857 | dense, sparse, graph | dense: 0.577, sparse: 0.262, graph: 0.691 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.6309 | dense, sparse, graph | dense: 0.576, sparse: 0.277, graph: 0.600 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4630 | dense, sparse | dense: 0.657, sparse: 0.302 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4495 | sparse, graph | sparse: 0.250, graph: 0.857 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3954 | dense, sparse | dense: 0.581, sparse: 0.241 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3785 | dense, sparse | dense: 0.566, sparse: 0.222 |
| 7 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.3765 | dense, sparse | dense: 0.554, sparse: 0.229 |
| 8 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.3562 | sparse, graph | sparse: 0.228, graph: 0.631 |
| 9 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2511 | dense, sparse | dense: 0.563, sparse: 0.254 |
| 10 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1872 | dense, sparse | dense: 0.565, sparse: 0.237 |

