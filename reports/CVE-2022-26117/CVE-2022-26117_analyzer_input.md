# Vulnerability Information: CVE-2022-26117

## Vulnerability Description
An **empty password in configuration file** vulnerability [CWE-258] in FortiNAC version 8.3.7 and below, 8.5.2 and below, 8.5.4, 8.6.0, 8.6.5 and below, 8.7.6 and below, 8.8.11 and below, 9.1.5 and below, 9.2.3 and below may allow an authenticated attacker to access the MySQL databases via the CLI.

### Vulnerability Description Key Phrases
- **rootcause:** **empty password in configuration file**
- **impact:** access the MySQL databases
- **attacker:** authenticated attacker
- **product:** FortiNAC
- **version:** 8.3.7 and below, 8.5.2 and below, 8.5.4, 8.6.0, 8.6.5 and below, 8.7.6 and below, 8.8.11 and below, 9.1.5 and below, 9.2.3 and below
- **component:** CLI

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2022-26117:

**Root Cause:**
The vulnerability stems from an unprotected MySQL root account in FortiNAC. The MySQL database used by FortiNAC has no password set, allowing any local user to connect to the database.

**Weaknesses/Vulnerabilities:**
- **Missing Authentication:** The primary vulnerability is the lack of a password for the MySQL root user, allowing unauthorized access.
- **Insecure Default Configuration:** The system is configured with an insecure default setting for the MySQL database.

**Impact of Exploitation:**
- **Data Modification/Corruption:** An attacker with local access can connect to the database and modify or corrupt its data, potentially leading to an unstable or non-functional FortiNAC solution.
- **Data Exfiltration:** Attackers can retrieve tokens from database tables, potentially leading to further compromise.
- **Unauthorized Command Execution:** The Fortiguard article mentions "Execute unauthorized code or commands" which could be a secondary impact by modifying the underlying data of the application.

**Attack Vectors:**
- Local access is required for exploitation, the database is accessible only through localhost.

**Required Attacker Capabilities/Position:**
- The attacker needs to have a local unprivileged user account on the FortiNAC system.
- The attacker must be able to execute commands via the CLI of the FortiNAC system.

**Additional Details:**
- The Github advisory provides a simple Proof of Concept by showing how a local user can connect using `mysql -u root`.
- Affected versions include a wide range of FortiNAC versions from 8.3.7 up to 9.2.3.
- The vulnerability is rated as "High" severity, with a CVSS score of 8.8 in the github advisory and 8.0 in the Fortiguard article.

The information in both documents appears to be consistent and corroborates the vulnerability description. The Fortiguard article also notes the CWE related to the vulnerability [CWE-258], which is "Empty Password in Configuration File".

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-258 | Empty Password in Configuration File | Variant | Allowed | 0.8259 | dense, sparse, graph | dense: 0.776, sparse: 0.526, graph: 0.575 |
| 2 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.5710 | sparse, graph | sparse: 0.373, graph: 1.000 |
| 3 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5700 | sparse, graph | sparse: 0.375, graph: 0.995 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4813 | sparse, graph | sparse: 0.348, graph: 0.789 |
| 5 | CWE-41 | Improper Resolution of Path Equivalence | Base | Allowed | 0.4707 | sparse, graph | sparse: 0.330, graph: 0.789 |
| 6 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4576 | dense, sparse | dense: 0.539, sparse: 0.329 |
| 7 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.2850 | dense, sparse | dense: 0.547, sparse: 0.369 |
| 8 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.2026 | sparse | sparse: 0.354 |
| 9 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1950 | sparse | sparse: 0.341 |
| 10 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.1933 | sparse | sparse: 0.338 |

