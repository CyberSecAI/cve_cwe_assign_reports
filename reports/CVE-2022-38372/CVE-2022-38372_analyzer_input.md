# Vulnerability Information: CVE-2022-38372

## Vulnerability Description
A **hidden functionality vulnerability [CWE-1242]** in FortiTester CLI 2.3.0 through 3.9.1, 4.0.0 through 4.2.0, 7.0.0 through 7.1.0 may allow a local, privileged user to obtain a root shell on the device via an undocumented command.

### Vulnerability Description Key Phrases
- **rootcause:** **hidden functionality vulnerability [CWE-1242]**
- **impact:** obtain a root shell
- **vector:** undocumented command
- **attacker:** local, privileged user
- **product:** FortiTester CLI
- **version:** 2.3.0 through 3.9.1 and 4.0.0 through 4.2.0 and 7.0.0 through 7.1.0

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A hidden functionality vulnerability exists in FortiTester CLI. An undocumented shell command allows a local, privileged user to obtain a root shell.
- **Weaknesses/vulnerabilities present**: Improper access control [CWE-1242].
- **Impact of exploitation**: A local, privileged user can obtain a root shell on the device.
- **Attack vectors**: A local privileged user needs to execute an undocumented command through the FortiTester CLI.
- **Required attacker capabilities/position**: The attacker must be a local, privileged user on the FortiTester device.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1242 | Inclusion of Undocumented Features or Chicken Bits | Base | Allowed | 0.7223 | dense, sparse, graph | dense: 0.664, sparse: 0.336, graph: 0.553 |
| 2 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.6440 | dense, sparse, graph | dense: 0.608, sparse: 0.206, graph: 0.620 |
| 3 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.6138 | dense, sparse, graph | dense: 0.609, sparse: 0.200, graph: 0.545 |
| 4 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.5432 | dense, sparse, graph | dense: 0.564, sparse: 0.191, graph: 0.551 |
| 5 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.5373 | dense, sparse, graph | dense: 0.594, sparse: 0.195, graph: 0.485 |
| 6 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.3890 | dense, sparse | dense: 0.563, sparse: 0.187 |
| 7 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3799 | dense, sparse | dense: 0.546, sparse: 0.186 |
| 8 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.3323 | sparse, graph | sparse: 0.186, graph: 0.631 |
| 9 | CWE-912 | Hidden Functionality | Class | Allowed-with-Review | 0.2647 | dense, sparse | dense: 0.630, sparse: 0.236 |
| 10 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.2473 | dense, sparse, graph | dense: 0.592, sparse: 0.204, graph: 0.391 |

