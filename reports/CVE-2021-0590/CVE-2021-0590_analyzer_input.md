# Vulnerability Information: CVE-2021-0590

## Vulnerability Description
In sendNetworkConditionsBroadcast of NetworkMonitor.java, there is a possible way for a privileged app to receive WiFi BSSID and SSID without location permissions due to a **missing permission check**. This could lead to local information disclosure with System execution privileges needed. User interaction is not needed for exploitation.Product AndroidVersions Android-10 Android-11 Android-8.1 Android-9Android ID A-175213041

### Vulnerability Description Key Phrases
- **rootcause:** **missing permission check**
- **impact:** receive WiFi BSSID and SSID without location permissions
- **attacker:** privileged app
- **product:** Android
- **version:** 10, 11, 8.1, 9
- **component:** sendNetworkConditionsBroadcast of NetworkMonitor.java

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-0590:

**1. Verification of CVE Relevance:**

The provided content directly references CVE-2021-0590 within the Android Security Bulletin for July 2021 and contains commit messages related to the fix. The commit message mentions "Fix the security issue that preloaded apps can get SSID & BSSID". This vulnerability is related to the broadcast of network conditions containing sensitive information. Therefore, the content is relevant to CVE-2021-0590.

**2. Root Cause of Vulnerability:**

The root cause is the insecure broadcasting of the `NETWORK_CONDITIONS_MEASURED` intent, which included WiFi SSID and BSSID information. This broadcast only required the `ACCESS_NETWORK_CONDITIONS` permission, and not the more restrictive `ACCESS_FINE_LOCATION` permission. This allowed preloaded apps to access this sensitive information without user consent.

**3. Weaknesses/Vulnerabilities Present:**

*   **Information Disclosure:** The primary vulnerability is the disclosure of sensitive network information (SSID and BSSID) to applications that should not have access to it.
*   **Insufficient Permission Check:** The broadcast was protected by an insufficient permission, allowing applications to obtain data without the user's consent.

**4. Impact of Exploitation:**

*   **Privacy Violation:** Exploitation could allow malicious or unauthorized pre-loaded apps to collect users' WiFi network information without explicit consent.
*   **Potential Location Tracking:** Access to BSSID and SSID information could be used for device tracking.

**5. Attack Vectors:**

*   **Broadcast Interception:** An attacker could install a pre-loaded application, or convince a user to install an application with the required permissions, and register a broadcast receiver to intercept the `NETWORK_CONDITIONS_MEASURED` broadcast.

**6. Required Attacker Capabilities/Position:**

*   The attacker needs to have an application with the `android.permission.ACCESS_NETWORK_CONDITIONS` permission installed on the device.
*   The attacker's application must register a broadcast receiver for the `android.net.conn.NETWORK_CONDITIONS_MEASURED` intent.

**Additional Information:**
The provided commit logs indicate that the vulnerability was resolved by removing the broadcast entirely because it was no longer used, and the related code was also deleted.

**Summary:**

CVE-2021-0590 was an information disclosure vulnerability that allowed pre-loaded apps to obtain WiFi SSID and BSSID information via a broadcast intent, without requiring the `ACCESS_FINE_LOCATION` permission. This was resolved by removing the vulnerable broadcast and the associated code.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | 0.7597 | dense, sparse, graph | dense: 0.581, sparse: 0.449, graph: 0.592 |
| 2 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.6827 | dense, sparse, graph | dense: 0.536, sparse: 0.360, graph: 0.584 |
| 3 | CWE-223 | Omission of Security-relevant Information | Base | Allowed | 0.6686 | dense, sparse, graph | dense: 0.565, sparse: 0.335, graph: 0.543 |
| 4 | CWE-927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | 0.6207 | dense, sparse, graph | dense: 0.616, sparse: 0.382, graph: 0.408 |
| 5 | CWE-248 | Uncaught Exception | Base | Allowed | 0.4380 | dense, sparse | dense: 0.488, sparse: 0.339 |
| 6 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.4328 | dense, sparse | dense: 0.511, sparse: 0.310 |
| 7 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.3664 | dense, sparse, graph | dense: 0.519, sparse: 0.426, graph: 0.335 |
| 8 | CWE-514 | Covert Channel | Class | Allowed-with-Review | 0.3400 | dense, sparse, graph | dense: 0.519, sparse: 0.346, graph: 0.339 |
| 9 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2649 | dense, sparse | dense: 0.507, sparse: 0.344 |
| 10 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.2462 | dense, sparse | dense: 0.484, sparse: 0.309 |

