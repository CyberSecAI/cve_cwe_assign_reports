# Vulnerability Information: CVE-2022-22297

## Vulnerability Description
An incomplete filtering of one or more instances of special elements vulnerability [CWE-792] in the command line interpreter of FortiWeb version 6.4.0 through 6.4.1, FortiWeb version 6.3.0 through 6.3.17, FortiWeb all versions 6.2, FortiWeb all versions 6.1, FortiWeb all versions 6.0, FortiRecorder version 6.4.0 through 6.4.3, FortiRecorder all versions 6.0, FortiRecorder all versions 2.7 may allow an authenticated user to read arbitrary files via specially crafted command arguments.

### Vulnerability Description Key Phrases
- **rootcause:** **incomplete filtering of special elements**
- **weakness:** **arbitrary file read**
- **vector:** specially crafted command arguments
- **attacker:** authenticated user
- **product:** FortiWeb and FortiRecorder
- **version:** multiple versions
- **component:** command line interpreter

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Incomplete filtering of special elements in the command line interpreter.
- **Weaknesses/vulnerabilities present**: Improper neutralization of special elements used in a command ('Command Injection' - CWE-792).
- **Impact of exploitation**: Arbitrary file read, leading to information disclosure.
- **Attack vectors**: Crafted command arguments via command line interpreter.
- **Required attacker capabilities/position**: Authenticated user on the affected system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-792 | Incomplete Filtering of One or More Instances of Special Elements | Variant | Allowed | 1.0629 | dense, sparse, graph | dense: 0.750, sparse: 1.000, graph: 0.571 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.8569 | dense, sparse, graph | dense: 0.594, sparse: 0.550, graph: 0.686 |
| 3 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.7629 | dense, sparse, graph | dense: 0.586, sparse: 0.555, graph: 0.602 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.5693 | dense, sparse | dense: 0.576, sparse: 0.491 |
| 5 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.5127 | sparse, graph | sparse: 0.559, graph: 0.539 |
| 6 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.4220 | sparse, graph | sparse: 0.482, graph: 0.410 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4206 | sparse, graph | sparse: 0.529, graph: 0.429 |
| 8 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.2871 | sparse | sparse: 0.502 |
| 9 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.2847 | sparse | sparse: 0.498 |
| 10 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.2683 | sparse | sparse: 0.469 |

