# Vulnerability Information: CVE-2021-21890

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in the Web Manager FsBrowseClean functionality of Lantronix PremierWave 2050 8.9.0.0R4 (in QEMU). A specially crafted HTTP request can lead to remote code execution in the vulnerable portion of the branch (deletedir). An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Lantronix PremierWave 2050
- **version:** 8.9.0.0R4
- **component:** Web Manager FsBrowseClean functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 9)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability is caused by a stack-based buffer overflow in the `FsBrowseClean` function of the Lantronix PremierWave 2050 Web Manager application. Specifically, two calls to `sprintf` are made without proper bounds checking when constructing a file path, using a user-controlled source (`path` parameter).

- **Weaknesses/vulnerabilities present**: The primary vulnerability is a stack-based buffer overflow (CWE-121) due to the unchecked use of `sprintf`. The application doesn't validate the length of the `path` parameter before using it in `sprintf`, leading to a buffer overflow if a sufficiently long path is provided. There are two vulnerable calls to `sprintf`, depending on the `action` parameter's value ("deletedir" or "deletefile").

- **Impact of exploitation**: Successful exploitation allows an attacker to overwrite the stack, gaining control of the program counter and leading to remote code execution on the device.

- **Attack vectors**: An attacker can exploit this vulnerability by sending a specially crafted HTTP request to the device's web manager application. The request needs to include a large value in the "path" parameter within the FsBrowseClean ajax request. The "action" parameter determines which vulnerable code path is taken: either "deletedir" or "deletefile".

- **Required attacker capabilities/position**:
    - The attacker must be able to send HTTP requests to the vulnerable device.
    - The attacker must authenticate to the web manager application using valid credentials, as the code verifies that a user is logged in and has the `filesystem` permission before reaching the vulnerable `sprintf` calls.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.8212 | dense, sparse, graph | dense: 0.576, sparse: 0.307, graph: 1.000 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7060 | dense, sparse, graph | dense: 0.581, sparse: 0.310, graph: 0.758 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5240 | sparse, graph | sparse: 0.291, graph: 1.000 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4891 | dense, sparse | dense: 0.664, sparse: 0.345 |
| 5 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4295 | sparse, graph | sparse: 0.258, graph: 0.789 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4193 | dense, sparse | dense: 0.589, sparse: 0.279 |
| 7 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4112 | dense, sparse | dense: 0.586, sparse: 0.266 |
| 8 | CWE-195 | Signed to Unsigned Conversion Error | Variant | Allowed | 0.3764 | sparse, graph | sparse: 0.258, graph: 0.729 |
| 9 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.2990 | dense, sparse, graph | dense: 0.587, sparse: 0.256, graph: 0.637 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2651 | dense, sparse | dense: 0.568, sparse: 0.292 |

