# Vulnerability Information: CVE-2022-20733

## Vulnerability Description
A vulnerability in the login page of Cisco Identity Services Engine (ISE) could allow an unauthenticated, remote attacker to log in without credentials and access all roles without any restrictions. This vulnerability is due to **exposed sensitive Security Assertion Markup Language (SAML) metadata**. An attacker could exploit this vulnerability by using the exposed SAML metadata to bypass authentication to the user portal. A successful exploit could allow the attacker to access all roles without any restrictions.

### Vulnerability Description Key Phrases
- **rootcause:** **exposed sensitive Security Assertion Markup Language (SAML) metadata**
- **impact:** bypass authentication to the user portal
- **vector:** exploiting the exposed SAML metadata
- **attacker:** unauthenticated remote attacker
- **product:** Cisco Identity Services Engine (ISE)
- **component:** login page

## CVE Reference Links Content Summary
Based on the provided documents, here's a breakdown of the vulnerability described in CVE-2022-20733:

**Root Cause of Vulnerability:**
- The vulnerability is due to exposed sensitive Security Assertion Markup Language (SAML) metadata.

**Weaknesses/Vulnerabilities Present:**
- Improper authentication. Specifically, the exposed SAML metadata allows bypassing authentication.

**Impact of Exploitation:**
- An unauthenticated, remote attacker can log in without credentials and gain access to all roles without any restrictions.
- This could result in a complete compromise of the affected system, as the attacker would have full control.

**Attack Vectors:**
- Remote network attack. An attacker can exploit this vulnerability remotely.

**Required Attacker Capabilities/Position:**
- The attacker does not need any credentials.
- The attacker does not need any specific user interaction.
- The attacker needs to be able to access the exposed SAML metadata.

**Additional Details:**
- The vulnerability affects Cisco Identity Services Engine (ISE) software.
- Specifically, the SAML admin login feature which was introduced in Cisco ISE Release 3.1 is affected.
- There are no workarounds to mitigate this vulnerability.
- The vulnerability is fixed in Cisco ISE release 3.1 patch 3.
- The vulnerability was found during the resolution of a Cisco TAC support case.
- There are no known public announcements or malicious use of the vulnerability so far.
- The vulnerability has a CVSS base score of 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1230 | Exposure of Sensitive Information Through Metadata | Base | Allowed | 0.8769 | dense, sparse, graph | dense: 0.590, sparse: 0.650, graph: 0.588 |
| 2 | CWE-303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | 0.6792 | dense, sparse, graph | dense: 0.498, sparse: 0.373, graph: 0.607 |
| 3 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.6384 | dense, sparse, graph | dense: 0.500, sparse: 0.347, graph: 0.530 |
| 4 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.5331 | sparse, graph | sparse: 0.412, graph: 0.832 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.4529 | dense, sparse | dense: 0.493, sparse: 0.360 |
| 6 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.3421 | dense, sparse, graph | dense: 0.501, sparse: 0.344, graph: 0.378 |
| 7 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2643 | dense, sparse, graph | dense: 0.492, sparse: 0.366, graph: 0.377 |
| 8 | CWE-1390 | Weak Authentication | Class | Allowed-with-Review | 0.2327 | sparse, graph | sparse: 0.378, graph: 0.503 |
| 9 | CWE-611 | Improper Restriction of XML External Entity Reference | Base | Allowed | 0.1988 | sparse | sparse: 0.347 |
| 10 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.1942 | sparse | sparse: 0.339 |

