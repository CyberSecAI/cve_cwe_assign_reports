# Vulnerability Information: CVE-2020-7050

## Vulnerability Description
Codologic Codoforum through 4.8.4 allows a **DOM-based XSS**. While creating a new topic as a normal user, it is possible to add a poll that is automatically loaded in the DOM once the thread/topic is opened. Because session cookies lack the HttpOnly flag, it is possible to steal authentication cookies and take over accounts.

### Vulnerability Description Key Phrases
- **weakness:** **DOM-based XSS**
- **impact:** steal authentication cookies and take over accounts
- **product:** Codologic Codoforum
- **version:** through 4.8.4

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2020-7050:

**Root Cause of Vulnerability:**
The vulnerability is a DOM-Based Cross-Site Scripting (XSS) issue in the Codelogic Codoforum application.

**Weaknesses/Vulnerabilities Present:**
- DOM-Based XSS: The application does not properly sanitize or validate user-supplied input that is used to generate dynamic content on the client side. This allows execution of malicious JavaScript code within the victim's browser.
- Lack of HttpOnly Flag: The session cookie was not set with the `HttpOnly` flag, making it accessible to JavaScript. This allowed the attacker to steal session cookies and take over accounts.

**Impact of Exploitation:**
- Account Takeover: By injecting malicious JavaScript, an attacker could steal session cookies of other users, including administrators, and gain unauthorized access to their accounts.
- Arbitrary JavaScript Execution: An attacker could potentially execute arbitrary JavaScript in the victim's browser, leading to various malicious actions such as data theft, defacement, or further attacks on other users.

**Attack Vectors:**
- Injecting JavaScript code within a new thread poll.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to post new threads to a Codoforum instance, which seems to be available to regular authenticated users.
- The attacker needs to entice a victim to view a malicious thread.

**Additional Information:**

- Vulnerable Product: Codelogic Codoforum
- Vulnerable Version: 4.8.4
- A related CVE, CVE-2020-7051, is a Stored XSS vulnerability.
- The vulnerability was discovered by Polina Voronina

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.7678 | dense, sparse, graph | dense: 0.556, sparse: 0.316, graph: 0.864 |
| 2 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.6396 | dense, sparse, graph | dense: 0.507, sparse: 0.213, graph: 0.738 |
| 3 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.5762 | dense, sparse, graph | dense: 0.502, sparse: 0.234, graph: 0.534 |
| 4 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.4854 | dense, sparse, graph | dense: 0.527, sparse: 0.239, graph: 0.645 |
| 5 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.3916 | sparse, graph | sparse: 0.217, graph: 0.748 |
| 6 | CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | 0.3667 | dense, sparse | dense: 0.499, sparse: 0.258 |
| 7 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.3584 | sparse, graph | sparse: 0.224, graph: 0.729 |
| 8 | CWE-116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | 0.2195 | dense, sparse | dense: 0.489, sparse: 0.225 |
| 9 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.1299 | sparse | sparse: 0.227 |
| 10 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.1257 | sparse | sparse: 0.220 |

