# Raw Retriever Results for CVE-2020-7063

# Raw Retriever Results for CVE-2020-7063

## Query
In PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3, when creating PHAR archive using PharDatabuildFromIterator() function, the files are added with default permissions (0666, or all access) even if the original files on the filesystem were with more restrictive permissions. This may result in files having more lax permissions than intended when such archive is extracted.

## Keyphrases
- **weakness**: files are added with default permissions (0666, or all access)

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3390 | 0.4476 | 0.3617 | 0.3511 | 20 |
| Sparse | 357.3276 | 724.3806 | 398.5965 | 383.8996 | 20 |
| Graph | 1.3010 | 2.4800 | 1.7350 | 1.6633 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | class | 2.4800 | Allowed-with-Review |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.4700 | Allowed |
| 3 | 23 | Relative Path Traversal | base | 2.4700 | Allowed |
| 4 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 5 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 6 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 8 | 689 | Permission Race Condition During Resource Copy | Compound | 1.7517 | Allowed |
| 9 | 281 | Improper Preservation of Permissions | Base | 1.6888 | Allowed |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 11 | 276 | Incorrect Default Permissions | Base | 1.6522 | Allowed |
| 12 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 13 | 476 | NULL Pointer Dereference | base | 1.6016 | Allowed |
| 14 | 278 | Insecure Preserved Inherited Permissions | Variant | 1.4822 | Allowed |
| 15 | 416 | Use After Free | variant | 1.4784 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 281 | Improper Preservation of Permissions | Base | 0.4476 | 0.4476 | Allowed |
| 2 | 278 | Insecure Preserved Inherited Permissions | Variant | 0.4012 | 0.4012 | Allowed |
| 3 | 689 | Permission Race Condition During Resource Copy | Compound | 0.3953 | 0.3953 | Allowed |
| 4 | 276 | Incorrect Default Permissions | Base | 0.3734 | 0.3734 | Allowed |
| 5 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.3708 | 0.3708 | Allowed |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | 0.3682 | 0.3682 | Allowed |
| 7 | 616 | Incomplete Identification of Uploaded File Variables (PHP) | Variant | 0.3667 | 0.3667 | Allowed |
| 8 | 530 | Exposure of Backup File to an Unauthorized Control Sphere | Variant | 0.3629 | 0.3629 | Allowed |
| 9 | 36 | Absolute Path Traversal | Base | 0.3520 | 0.3520 | Allowed |
| 10 | 279 | Incorrect Execution-Assigned Permissions | Variant | 0.3514 | 0.3514 | Allowed |
| 11 | 277 | Insecure Inherited Permissions | Variant | 0.3507 | 0.3507 | Allowed |
| 12 | 473 | PHP External Variable Modification | Variant | 0.3496 | 0.3496 | Allowed |
| 13 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.3495 | 0.3495 | Allowed |
| 14 | 527 | Exposure of Version-Control Repository to an Unauthorized Control Sphere | Variant | 0.3463 | 0.3463 | Allowed |
| 15 | 708 | Incorrect Ownership Assignment | Base | 0.3450 | 0.3450 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-281 | Improper Preservation of Permissions | 724.3806 | 724.3806 | Allowed |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 417.5057 | 417.5057 | Allowed |
| 3 | CWE-732 | Incorrect Permission Assignment for Critical Resource | 414.0959 | 414.0959 | Allowed-with-Review |
| 4 | CWE-23 | Relative Path Traversal | 395.7586 | 395.7586 | Allowed |
| 5 | CWE-269 | Improper Privilege Management | 393.9660 | 393.9660 | Discouraged |
| 6 | CWE-522 | Insufficiently Protected Credentials | 392.6377 | 392.6377 | Allowed-with-Review |
| 7 | CWE-863 | Incorrect Authorization | 392.0171 | 392.0171 | Allowed-with-Review |
| 8 | CWE-379 | Creation of Temporary File in Directory with Insecure Permissions | 386.3181 | 386.3181 | Allowed |
| 9 | CWE-284 | Improper Access Control | 384.7554 | 384.7554 | Discouraged |
| 10 | CWE-285 | Improper Authorization | 384.0828 | 384.0828 | Discouraged |
| 11 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 383.7165 | 383.7165 | Allowed-with-Review |
| 12 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 381.0779 | 381.0779 | Allowed |
| 13 | CWE-321 | Use of Hard-coded Cryptographic Key | 374.5795 | 374.5795 | Allowed |
| 14 | CWE-250 | Execution with Unnecessary Privileges | 369.9726 | 369.9726 | Allowed |
| 15 | CWE-668 | Exposure of Resource to Wrong Sphere | 368.0799 | 368.0799 | Discouraged |
