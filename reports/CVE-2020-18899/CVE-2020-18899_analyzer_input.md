# Vulnerability Information: CVE-2020-18899

## Vulnerability Description
An **uncontrolled memory allocation** in DataBufdata(subBox.length-sizeof(box)) function of Exiv2 0.27 allows attackers to cause a denial of service (DOS) via a crafted input.

### Vulnerability Description Key Phrases
- **rootcause:** **uncontrolled memory allocation**
- **impact:** denial of service (DOS)
- **vector:** crafted input
- **attacker:** attackers
- **product:** Exiv2
- **version:** 0.27
- **component:** DataBufdata(subBox.length-sizeof(box)) function

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "Integer overflow in the calculation of the buffer size for a DataBuf object.",
    "weaknesses": [
      "Uncontrolled memory allocation due to missing input sanitization and integer overflow.",
      "Lack of proper bounds checking."
    ],
    "impact": "Program crash due to excessive memory allocation, leading to a denial of service. The ASAN logs indicate a crash due to a very large allocation request, specifically `0xffffffffffffffff` bytes.",
    "attack_vectors": "Crafted image files with malicious metadata values. The vulnerability is triggered by providing a large `subBox.length` value that causes an integer overflow when subtracting `sizeof(box)` before the allocation.",
    "required_attacker_capabilities": "Ability to provide a specially crafted image file to the application using the Exiv2 library. No specific position is required."
  },
  "affected_packages": [
    {
      "package": "media-gfx/exiv2",
      "affected_versions": "< 0.28.1",
      "unaffected_versions": ">= 0.28.1"
    }
  ],
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2020-18899",
    "https://github.com/Exiv2/exiv2/issues/742",
    "https://github.com/Exiv2/exiv2/pull/753"
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.6971 | dense, sparse, graph | dense: 0.535, sparse: 0.228, graph: 1.000 |
| 2 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.6918 | dense, sparse, graph | dense: 0.515, sparse: 0.134, graph: 1.000 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.5475 | dense, sparse, graph | dense: 0.490, sparse: 0.150, graph: 0.607 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4427 | sparse, graph | sparse: 0.149, graph: 1.000 |
| 5 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.3533 | sparse, graph | sparse: 0.124, graph: 0.789 |
| 6 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3379 | dense, sparse | dense: 0.508, sparse: 0.146 |
| 7 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3101 | dense, sparse | dense: 0.520, sparse: 0.133 |
| 8 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3096 | sparse, graph | sparse: 0.122, graph: 0.670 |
| 9 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3013 | dense, sparse | dense: 0.501, sparse: 0.132 |
| 10 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2998 | dense, sparse | dense: 0.507, sparse: 0.124 |

