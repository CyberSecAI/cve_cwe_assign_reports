# Vulnerability Information: CVE-2022-22150

## Vulnerability Description
**A memory corruption vulnerability** exists in the JavaScript engine of Foxit Softwares PDF Reader, version 11.1.0.52543. A specially-crafted PDF document can trigger an exception which is improperly handled, leaving the engine in an invalid state, which can lead to memory corruption and arbitrary code execution. An attacker needs to trick the user to open the malicious file to trigger this vulnerability. Exploitation is also possible if a user visits a specially-crafted, malicious site if the browser plugin extension is enabled.

### Vulnerability Description Key Phrases
- **rootcause:** **improperly handled exception**
- **weakness:** **A memory corruption vulnerability**
- **impact:** arbitrary code execution
- **vector:** specially-crafted PDF document
- **product:** Foxit Softwares PDF Reader
- **version:** 11.1.0.52543
- **component:** JavaScript engine

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability lies in the improper handling of exceptions within the JavaScript engine of Foxit Reader when the `getPageNthWordQuads` method is called with an invalid parameter.
- A C++ exception is thrown but not properly handled when triggered from nested JavaScript execution (e.g., within an event handler or callback).

**Weaknesses/Vulnerabilities:**

- **Improper Exception Handling:** The JavaScript engine doesn't correctly clean up or reset its state when an exception occurs during nested execution. This leaves the engine in an inconsistent state.
- **Memory Corruption:** The inconsistent state leads to memory corruption, potentially due to the engine's deoptimizer using a corrupted stack pointer.

**Impact of Exploitation:**

- **Arbitrary Code Execution:** Successful exploitation of this vulnerability can lead to arbitrary code execution, allowing an attacker to take control of the affected system.
- **Memory Corruption:** The vulnerability leads to memory corruption, causing crashes and potentially enabling other attacks.

**Attack Vectors:**

- **Malicious PDF Document:** An attacker can embed malicious JavaScript in a PDF document. When a user opens this document in a vulnerable version of Foxit Reader, the exploit is triggered.
- **Malicious Website:** If the Foxit Reader browser plugin is enabled, a user visiting a specially-crafted malicious website can also trigger the vulnerability.

**Required Attacker Capabilities/Position:**

-   **User Interaction:** The attacker must trick the user into opening a malicious PDF file or visiting a malicious website.
- **JavaScript Knowledge**: The attacker needs to craft specific JavaScript code that triggers the exception in a nested execution context to exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.9742 | dense, sparse, graph | dense: 0.569, sparse: 0.743, graph: 0.740 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.9071 | dense, sparse, graph | dense: 0.479, sparse: 0.712, graph: 0.728 |
| 3 | CWE-460 | Improper Cleanup on Thrown Exception | Base | Allowed | 0.8137 | dense, sparse | dense: 0.483, sparse: 1.000 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6759 | sparse, graph | sparse: 0.662, graph: 0.832 |
| 5 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6127 | dense, sparse | dense: 0.474, sparse: 0.656 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.5764 | dense, sparse | dense: 0.468, sparse: 0.682 |
| 7 | CWE-416 | Use After Free | Variant | Allowed | 0.5673 | dense, sparse | dense: 0.492, sparse: 0.644 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.5506 | dense, sparse | dense: 0.467, sparse: 0.634 |
| 9 | CWE-248 | Uncaught Exception | Base | Allowed | 0.4554 | dense, sparse | dense: 0.467, sparse: 0.387 |
| 10 | CWE-197 | Numeric Truncation Error | Base | Allowed | 0.3728 | sparse | sparse: 0.652 |

