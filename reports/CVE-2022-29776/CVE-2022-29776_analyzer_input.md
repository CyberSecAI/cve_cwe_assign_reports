# Vulnerability Information: CVE-2022-29776

## Vulnerability Description
Onlyoffice Document Server v6.0.0 and below and Core 6.1.0.26 and below were discovered to contain a **stack overflow** via the component DesktopEditor/common/File.cpp.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** Onlyoffice Document Server
- **version:** v6.0.0 and below and Core 6.1.0.26 and below
- **component:** DesktopEditor/common/File.cpp

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "cve": "CVE-2022-29776",
      "is_related": true,
      "content_type": "github commit diff",
      "details": {
        "root_cause": "The vulnerability stems from a missing bounds check in the `Read` function within the `CxFile` class, specifically when handling file reading with start and end limits. The `clamp_buffer` function, intended to prevent out-of-bounds reads, fails to properly constrain the buffer, leading to potential heap buffer overflows if the `size` is not validated against available buffer space.",
         "weaknesses": [
          "Heap buffer overflow",
          "Missing bounds check"
        ],
        "impact": "Heap buffer overflow could lead to denial of service, arbitrary code execution, or information disclosure.",
        "attack_vectors": "Maliciously crafted image files (BMP, etc.) that exploit the lack of proper buffer clamping during file read operations.",
        "required_capabilities": "Attacker needs the ability to supply a specially crafted file that is processed by the vulnerable code. No special privileges are needed."
      },
    },
    {
      "cve": "CVE-2022-29776",
      "is_related": false,
       "content_type": "github changelog",
        "details": {}
    },
    {
      "cve": "CVE-2022-29776",
       "is_related": true,
        "content_type": "github repo",
        "details": {}
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.5513 | dense, sparse, graph | dense: 0.502, sparse: 0.191, graph: 0.533 |
| 2 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3676 | sparse, graph | sparse: 0.123, graph: 0.832 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3462 | dense, sparse | dense: 0.555, sparse: 0.170 |
| 4 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3221 | dense, sparse | dense: 0.509, sparse: 0.118 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2981 | dense, sparse | dense: 0.500, sparse: 0.127 |
| 6 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.2917 | sparse, graph | sparse: 0.115, graph: 0.631 |
| 7 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.2878 | dense, sparse | dense: 0.500, sparse: 0.108 |
| 8 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.1999 | dense, sparse | dense: 0.527, sparse: 0.134 |
| 9 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1826 | dense, sparse | dense: 0.496, sparse: 0.109 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.0674 | sparse | sparse: 0.118 |

