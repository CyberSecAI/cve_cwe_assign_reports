# Vulnerability Information: CVE-2021-29247

## Vulnerability Description
BTCPay Server through 1.0.7.0 could allow a remote attacker to obtain sensitive information, caused by **failure to set the HTTPOnly flag for a cookie**.

### Vulnerability Description Key Phrases
- **rootcause:** **failure to set the HTTPOnly flag for a cookie**
- **impact:** obtain sensitive information
- **attacker:** remote attacker
- **product:** BTCPay Server
- **version:** through 1.0.7.0

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-311

#### Top CWEs
- CWE-311 (Count: 6)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-29247:

**CVE-2021-29247: Lack of httponly**

*   **Root Cause:** The vulnerability stems from the lack of the `HttpOnly` flag on a cookie used for saving user preferences (e.g., search strings in the invoices page).

*   **Weaknesses/Vulnerabilities Present:**
    *   Missing `HttpOnly` flag on a cookie.

*   **Impact of Exploitation:**
    *   A remote attacker could potentially obtain sensitive information from the cookie.
    *   This can lead to cookie stealing, potentially allowing for session hijacking or other malicious activities if the cookie contains sensitive data.

*   **Attack Vectors:**
    *   A remote attacker can exploit this vulnerability by injecting malicious JavaScript or through a Cross-Site Scripting (XSS) attack.

*   **Required Attacker Capabilities/Position:**
    *   The attacker needs to be able to execute malicious Javascript, possibly through XSS.

**Additional Notes:**

*   The content specifically mentions that the cookie stores user preferences like search strings on the invoices page.
*   The vulnerability is rated as "Low" severity.
*   This vulnerability affects BTCPay Server versions <= 1.0.7.1, according to the blog post.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | 0.5902 | dense, sparse, graph | dense: 0.586, sparse: 0.258, graph: 0.555 |
| 2 | CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | 0.5607 | dense, sparse, graph | dense: 0.596, sparse: 0.323, graph: 0.348 |
| 3 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.5509 | dense, sparse, graph | dense: 0.459, sparse: 0.182, graph: 0.608 |
| 4 | CWE-784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | Allowed | 0.5087 | dense, sparse, graph | dense: 0.531, sparse: 0.156, graph: 0.548 |
| 5 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.3612 | sparse, graph | sparse: 0.158, graph: 0.757 |
| 6 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.3123 | sparse, graph | sparse: 0.178, graph: 0.589 |
| 7 | CWE-316 | Cleartext Storage of Sensitive Information in Memory | Variant | Allowed | 0.1912 | sparse, graph | sparse: 0.147, graph: 0.344 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1404 | dense, sparse | dense: 0.451, sparse: 0.154 |
| 9 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.0894 | sparse | sparse: 0.156 |
| 10 | CWE-214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | 0.0857 | sparse | sparse: 0.150 |

