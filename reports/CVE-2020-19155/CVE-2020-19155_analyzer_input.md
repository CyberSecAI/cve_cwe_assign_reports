# Vulnerability Information: CVE-2020-19155

## Vulnerability Description
**Improper Access Control** in Jfinal CMS v4.7.1 and earlier allows remote attackers to obtain sensitive information and/or execute arbitrary code via the FileManager.rename() function in the component modules/filemanager/FileManagerController.java.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Access Control**
- **impact:** obtain sensitive information and execute arbitrary code
- **attacker:** remote attackers
- **product:** Jfinal CMS
- **version:** v4.7.1 and earlier
- **component:** Filemanager.rename() function in modules/filemanager/FileManagerController.java

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The application does not filter or validate the new file name during the file renaming process in the background template management, allowing an attacker to rename uploaded files to malicious extensions (e.g., jsp).",
  "Weaknesses/vulnerabilities present": [
    "Insecure file renaming functionality",
    "Lack of input validation on new file names",
     "Allows arbitrary file renaming"
  ],
  "Impact of exploitation": "An attacker can upload a file with a safe extension (e.g., .jpg) containing malicious code, then rename it to a server-executable extension (e.g., .jsp) to achieve arbitrary code execution, leading to a potential system compromise.",
  "Attack vectors": [
    "HTTP request with the mode parameter set to rename",
    "old parameter specifying the file to rename",
    "new parameter specifying the new file name including the malicious extension"
  ],
  "Required attacker capabilities/position": [
    "Must have access to the admin panel",
    "Must be able to upload files",
     "Must know file path to rename"
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-73 | External Control of File Name or Path | Base | Allowed | 0.7695 | dense, sparse, graph | dense: 0.532, sparse: 0.255, graph: 1.000 |
| 2 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.7308 | dense, sparse, graph | dense: 0.540, sparse: 0.180, graph: 1.000 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.6751 | dense, sparse, graph | dense: 0.554, sparse: 0.152, graph: 0.870 |
| 4 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4266 | sparse, graph | sparse: 0.156, graph: 1.000 |
| 5 | CWE-29 | Path Traversal: '\..\filename' | Variant | Allowed | 0.3846 | sparse, graph | sparse: 0.289, graph: 0.704 |
| 6 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.3479 | dense, sparse | dense: 0.537, sparse: 0.139 |
| 7 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3057 | sparse, graph | sparse: 0.140, graph: 0.631 |
| 8 | CWE-285 | Improper Authorization | Class | Discouraged | 0.1539 | dense, sparse | dense: 0.525, sparse: 0.142 |
| 9 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.1220 | dense, sparse | dense: 0.554, sparse: 0.151 |
| 10 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.0829 | sparse | sparse: 0.145 |

