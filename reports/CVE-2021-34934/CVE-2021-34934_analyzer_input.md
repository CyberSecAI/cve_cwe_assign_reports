# Vulnerability Information: CVE-2021-34934

## Vulnerability Description
This vulnerability allows remote attackers to execute arbitrary code on affected installations of Bentley View 10.15.0.75. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the parsing of JT files. The issue results from the **lack of proper validation of user-supplied data**, which can result in a memory corruption condition. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-14912.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of proper validation of user-supplied data**
- **impact:** memory corruption
- **vector:** malicious page or file
- **attacker:** remote attackers
- **product:** Bentley View
- **version:** 10.15.0.75
- **component:** parsing of JT files

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 306)
- CWE-416 (Count: 283)
- CWE-125 (Count: 142)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-34934

**Root Cause:**
- The vulnerability stems from a lack of proper validation of user-supplied data when parsing JT files. This leads to a memory corruption condition.

**Weaknesses/Vulnerabilities:**
- Out-of-bounds write or use-after-free vulnerability within the parsing of JT files.
- Memory corruption due to improper validation of user-supplied data.

**Impact of Exploitation:**
- Arbitrary code execution in the context of the current process.
- Complete compromise of confidentiality, integrity, and availability, as indicated by CVSS score.

**Attack Vectors:**
- Opening a maliciously crafted JT file with a vulnerable version of Bentley View or MicroStation.
- User interaction is required to trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to craft a malicious JT file and have it opened by a user of the vulnerable software.
-  No special privileges are required, a user with regular access is sufficient to trigger the vulnerability.

**Additional Information:**
- The vulnerability was discovered by Trend Micro's Zero Day Initiative (ZDI).
- Bentley has released updates to address this vulnerability.
- The advisory includes a large number of CVEs relating to similar vulnerabilities in the processing of JT files.

This information is more detailed than the placeholder CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.6331 | sparse, graph | sparse: 0.555, graph: 0.882 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5916 | sparse, graph | sparse: 0.483, graph: 0.882 |
| 3 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.5291 | dense, sparse | dense: 0.561, sparse: 0.435 |
| 4 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.5038 | sparse, graph | sparse: 0.471, graph: 0.772 |
| 5 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4861 | sparse, graph | sparse: 0.455, graph: 0.631 |
| 6 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.3178 | dense, sparse | dense: 0.562, sparse: 0.454 |
| 7 | CWE-116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | 0.3063 | dense, sparse | dense: 0.546, sparse: 0.434 |
| 8 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2666 | dense, sparse | dense: 0.576, sparse: 0.538 |
| 9 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.2559 | sparse | sparse: 0.447 |
| 10 | CWE-620 | Unverified Password Change | Base | Allowed | 0.2506 | sparse | sparse: 0.438 |

