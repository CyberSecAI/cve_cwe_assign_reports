# Raw Retriever Results for CVE-2021-28170

# Raw Retriever Results for CVE-2021-28170

## Query
In the Jakarta Expression Language implementation 3.0.3 and earlier, a bug in the ELParserTokenManager enables invalid EL expressions to be evaluated as if they were valid.

## Keyphrases
- **rootcause**: bug in the ELParserTokenManager

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3752 | 0.4854 | 0.3950 | 0.3839 | 20 |
| Sparse | 164.4780 | 328.6042 | 181.9815 | 171.9399 | 20 |
| Graph | 0.8606 | 3.6400 | 1.5169 | 1.3394 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | base | 3.6400 | Allowed |
| 2 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 2.4381 | Allowed |
| 3 | 182 | Collapse of Data into Unsafe Value | base | 2.2100 | Allowed |
| 4 | 204 | Observable Response Discrepancy | base | 2.1190 | Allowed |
| 5 | 1333 | Inefficient Regular Expression Complexity | base | 2.1190 | Allowed |
| 6 | 187 | Partial String Comparison | variant | 2.0400 | Allowed |
| 7 | 35 | Path Traversal: '.../...//' | variant | 1.6320 | Allowed |
| 8 | 34 | Path Traversal: '....//' | variant | 1.6320 | Allowed |
| 9 | 33 | Path Traversal: '....' (Multiple Dot) | variant | 1.6320 | Allowed |
| 10 | 624 | Executable Regular Expression Error | Base | 1.4867 | Allowed |
| 11 | 674 | Uncontrolled Recursion | class | 1.1920 | Allowed-with-Review |
| 12 | 109 | Struts: Validator Turned Off | Variant | 1.0372 | Allowed |
| 13 | 185 | Incorrect Regular Expression | Class | 0.9426 | Allowed-with-Review |
| 14 | 146 | Improper Neutralization of Expression/Command Delimiters | Variant | 0.9390 | Allowed |
| 15 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 0.9360 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.4854 | 0.4854 | Allowed |
| 2 | 624 | Executable Regular Expression Error | Base | 0.4229 | 0.4229 | Allowed |
| 3 | 146 | Improper Neutralization of Expression/Command Delimiters | Variant | 0.4223 | 0.4223 | Allowed |
| 4 | 185 | Incorrect Regular Expression | Class | 0.4158 | 0.4158 | Allowed-with-Review |
| 5 | 109 | Struts: Validator Turned Off | Variant | 0.4031 | 0.4031 | Allowed |
| 6 | 783 | Operator Precedence Logic Error | Base | 0.4022 | 0.4022 | Allowed |
| 7 | 106 | Struts: Plug-in Framework not in Use | Variant | 0.3987 | 0.3987 | Allowed |
| 8 | 537 | Java Runtime Error Message Containing Sensitive Information | Variant | 0.3918 | 0.3918 | Allowed |
| 9 | 159 | Improper Handling of Invalid Use of Special Elements | Class | 0.3870 | 0.3870 | Allowed-with-Review |
| 10 | 150 | Improper Neutralization of Escape, Meta, or Control Sequences | Variant | 0.3856 | 0.3856 | Allowed |
| 11 | 110 | Struts: Validator Without Form Field | Variant | 0.3823 | 0.3823 | Allowed |
| 12 | 154 | Improper Neutralization of Variable Name Delimiters | Variant | 0.3817 | 0.3817 | Allowed |
| 13 | 777 | Regular Expression without Anchors | Variant | 0.3814 | 0.3814 | Allowed |
| 14 | 575 | EJB Bad Practices: Use of AWT Swing | Variant | 0.3803 | 0.3803 | Allowed |
| 15 | 570 | Expression is Always False | Base | 0.3802 | 0.3802 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | 328.6042 | 328.6042 | Allowed |
| 2 | CWE-1333 | Inefficient Regular Expression Complexity | 198.9560 | 198.9560 | Allowed |
| 3 | CWE-204 | Observable Response Discrepancy | 194.9410 | 194.9410 | Allowed |
| 4 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 185.9549 | 185.9549 | Allowed |
| 5 | CWE-674 | Uncontrolled Recursion | 179.6809 | 179.6809 | Allowed-with-Review |
| 6 | CWE-1390 | Weak Authentication | 177.1879 | 177.1879 | Allowed-with-Review |
| 7 | CWE-863 | Incorrect Authorization | 175.5525 | 175.5525 | Allowed-with-Review |
| 8 | CWE-436 | Interpretation Conflict | 174.3743 | 174.3743 | Allowed-with-Review |
| 9 | CWE-407 | Inefficient Algorithmic Complexity | 174.2616 | 174.2616 | Allowed-with-Review |
| 10 | CWE-347 | Improper Verification of Cryptographic Signature | 172.5392 | 172.5392 | Allowed |
| 11 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 171.3406 | 171.3406 | Allowed-with-Review |
| 12 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | 169.7341 | 169.7341 | Allowed-with-Review |
| 13 | CWE-158 | Improper Neutralization of Null Byte or NUL Character | 169.5807 | 169.5807 | Allowed |
| 14 | CWE-617 | Reachable Assertion | 168.6579 | 168.6579 | Allowed |
| 15 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 167.9063 | 167.9063 | Allowed |
