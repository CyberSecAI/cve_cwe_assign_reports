# Vulnerability Information: CVE-2021-28170

## Vulnerability Description
In the Jakarta Expression Language implementation 3.0.3 and earlier, a **bug in the ELParserTokenManager** enables invalid EL expressions to be evaluated as if they were valid.

### Vulnerability Description Key Phrases
- **rootcause:** **bug in the ELParserTokenManager**
- **impact:** evaluate invalid EL expressions
- **product:** Jakarta Expression Language
- **version:** 3.0.3 and earlier

## CVE Reference Links Content Summary
```
{
  "RELATED": true,
  "CVE_ID": "CVE-2021-28170",
  "ROOT_CAUSE": "A bug in the `ELParserTokenManager` allows invalid EL expressions to be evaluated as if they were valid. Specifically, the parser consumes a backslash as part of the literal expression and leaves the character following it unescaped.",
  "WEAKNESSES": [
    "Improper Input Sanitization",
     "Incorrect EL expression tokenization"
  ],
  "IMPACT": "Allows attackers to bypass input sanitization controls (escaping, stripping) that developers may have put in place when handling user-controlled data in error messages potentially leading to Remote Code Execution (RCE) in affected applications.",
  "ATTACK_VECTORS": [
    "By injecting specially crafted EL expressions within user-controlled data, such as in Bean Validation constraint error messages, the attacker can bypass sanitization controls and execute arbitrary code or leak sensitive data."
  ],
    "REQUIRED_CAPABILITIES": "An attacker needs to be able to inject user controlled data, like an error message, that will be processed by the vulnerable EL implementation"
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | 0.7046 | dense, sparse, graph | dense: 0.485, sparse: 0.263, graph: 0.871 |
| 2 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.4426 | sparse, graph | sparse: 0.149, graph: 1.000 |
| 3 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.3616 | sparse, graph | sparse: 0.159, graph: 0.757 |
| 4 | CWE-204 | Observable Response Discrepancy | Base | Allowed | 0.3598 | sparse, graph | sparse: 0.156, graph: 0.757 |
| 5 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.1377 | sparse, graph | sparse: 0.144, graph: 0.426 |
| 6 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.0790 | sparse | sparse: 0.138 |
| 7 | CWE-617 | Reachable Assertion | Base | Allowed | 0.0772 | sparse | sparse: 0.135 |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.0768 | sparse | sparse: 0.134 |
| 9 | CWE-523 | Unprotected Transport of Credentials | Base | Allowed | 0.0763 | sparse | sparse: 0.133 |
| 10 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.0762 | sparse | sparse: 0.133 |

