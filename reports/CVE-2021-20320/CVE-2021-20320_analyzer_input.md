# Vulnerability Information: CVE-2021-20320

## Vulnerability Description
A flaw was found in s390 eBPF JIT in bpf_jit_insn in arch/s390/net/bpf_jit_comp.c in the Linux kernel. In this flaw, a local attacker with special user privilege can circumvent the verifier and may lead to a confidentiality problem.

### Vulnerability Description Key Phrases
- **impact:** circumvent the verifier
- **attacker:** local attacker
- **product:** Linux kernel
- **component:** arch/s390/net/bpf_jit_comp.c

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "A flaw was found in the s390 eBPF JIT compiler in the Linux kernel. Specifically, there were three miscompilation issues in the s390 eBPF JIT related to the `bpf_jit_insn` function.",
    "weaknesses": [
      "The eBPF JIT compiler for the s390 architecture had miscompilation issues."
    ],
    "impact": "A local attacker with special user privileges could circumvent the verifier and potentially gain root privileges, leading to a confidentiality problem.",
    "attack_vectors": [
      "Local attacker with special user privileges"
    ],
    "required_capabilities": [
      "Local access",
      "Special user privileges"
    ],
        "additional_information": "The issues were present in the initial s390x eBPF JIT compiler backend implementation (v4.1+) and one issue in v5.5+. The fixes were introduced in kernel 5.15 rc3 and were backported to stable kernel updates."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-733 | Compiler Optimization Removal or Modification of Security-critical Code | Base | Allowed | 0.5590 | dense, sparse, graph | dense: 0.565, sparse: 0.142, graph: 0.545 |
| 2 | CWE-415 | Double Free | Variant | Allowed | 0.3214 | sparse, graph | sparse: 0.069, graph: 0.864 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3032 | dense, sparse | dense: 0.529, sparse: 0.067 |
| 4 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.2796 | dense, sparse | dense: 0.531, sparse: 0.064 |
| 5 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.2398 | sparse, graph | sparse: 0.064, graph: 0.568 |
| 6 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.2365 | sparse, graph | sparse: 0.065, graph: 0.558 |
| 7 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.2357 | sparse, graph | sparse: 0.064, graph: 0.557 |
| 8 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.1849 | dense, sparse | dense: 0.548, sparse: 0.071 |
| 9 | CWE-667 | Improper Locking | Class | Allowed-with-Review | 0.1828 | dense, sparse | dense: 0.535, sparse: 0.076 |
| 10 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.1826 | dense, sparse | dense: 0.541, sparse: 0.070 |

