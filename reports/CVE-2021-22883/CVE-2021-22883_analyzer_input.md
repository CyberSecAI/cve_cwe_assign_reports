# Vulnerability Information: CVE-2021-22883

## Vulnerability Description
Node.js before 10.24.0, 12.21.0, 14.16.0, and 15.10.0 is vulnerable to a denial of service attack when too many connection attempts with an unknownProtocol are established. This leads to a leak of file descriptors. If a file descriptor limit is configured on the system, then the server is unable to accept new connections and prevent the process also from opening, e.g. a file. If no file descriptor limit is configured, then this lead to an excessive memory usage and cause the system to run out of memory.

### Vulnerability Description Key Phrases
- **impact:** denial of service
- **vector:** too many connection attempts with an unknownProtocol
- **product:** Node.js
- **version:** before 10.24.0, 12.21.0, 14.16.0, and 15.10.0

## CVE Reference Links Content Summary
```
{
  "CVE-2021-22883": {
    "root_cause": "The vulnerability is caused by a flaw in the HTTP2 implementation where a large number of connections with an 'unknownProtocol' can lead to a leak of file descriptors.",
    "weaknesses": [
      "Resource exhaustion",
       "File descriptor leak"
    ],
    "impact": "Denial of Service (DoS). The server becomes unable to accept new connections and may prevent the process from opening files. In systems without file descriptor limits, the vulnerability leads to excessive memory usage, potentially causing the system to run out of memory.",
    "attack_vectors": [
      "Network",
      "HTTP2 connections"
    ],
   "required_capabilities": "Attacker can establish HTTP2 connections to the vulnerable server."
  },
  "CVE-2021-22884": {
    "root_cause": "The vulnerability is caused by an insufficient check in the whitelist of domains that can be used with the --inspect flag, specifically when 'localhost6' is included and not present in /etc/hosts.",
    "weaknesses": [
      "DNS rebinding"
    ],
    "impact": "Bypassing DNS rebinding protection. An attacker controlling the victim's DNS server can use 'localhost6' to bypass the DNS rebinding protection, and then apply further attacks.",
    "attack_vectors": [
      "Network",
      "DNS spoofing"
    ],
    "required_capabilities": "Attacker must be able to control victim's DNS server or spoof its responses."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.6036 | dense, sparse, graph | dense: 0.578, sparse: 0.164, graph: 0.616 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5369 | dense, sparse, graph | dense: 0.509, sparse: 0.149, graph: 0.551 |
| 3 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.5167 | dense, sparse, graph | dense: 0.552, sparse: 0.153, graph: 0.549 |
| 4 | CWE-774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | Allowed | 0.5101 | dense, sparse, graph | dense: 0.543, sparse: 0.147, graph: 0.549 |
| 5 | CWE-775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | Allowed | 0.3649 | dense, sparse | dense: 0.537, sparse: 0.221 |
| 6 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3349 | dense, sparse | dense: 0.554, sparse: 0.149 |
| 7 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3032 | sparse, graph | sparse: 0.135, graph: 0.631 |
| 8 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.1943 | dense, sparse | dense: 0.506, sparse: 0.136 |
| 9 | CWE-346 | Origin Validation Error | Class | Allowed-with-Review | 0.1923 | dense, sparse | dense: 0.501, sparse: 0.134 |
| 10 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.1914 | dense, sparse | dense: 0.499, sparse: 0.133 |

