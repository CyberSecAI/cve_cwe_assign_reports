# Vulnerability Information: CVE-2021-30982

## Vulnerability Description
A **race condition** was addressed with improved locking. This issue is fixed in macOS Monterey 12.1, Security Update 2021-008 Catalina, macOS Big Sur 11.6.2. A remote attacker may be able to cause unexpected application termination or heap corruption.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **impact:** unexpected application termination or heap corruption
- **attacker:** remote attacker
- **product:** macOS Monterey and macOS Catalina and macOS Big Sur
- **version:** 12.1 and Security Update 2021-008 and 11.6.2

## CVE Reference Links Content Summary
The provided content includes information about CVE-2021-30982.

**Root cause of vulnerability:**
A race condition.

**Weaknesses/vulnerabilities present:**
Race condition in the IOUSBHostFamily component leading to unexpected application termination or heap corruption.

**Impact of exploitation:**
A remote attacker can cause unexpected application termination or heap corruption.

**Attack vectors:**
Remote attacker.

**Required attacker capabilities/position:**
The attacker needs to be able to send network traffic to the vulnerable device.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.6499 | dense, sparse, graph | dense: 0.553, sparse: 0.189, graph: 0.740 |
| 2 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.6401 | dense, sparse, graph | dense: 0.483, sparse: 0.237, graph: 0.735 |
| 3 | CWE-366 | Race Condition within a Thread | Base | Allowed | 0.6058 | dense, sparse, graph | dense: 0.577, sparse: 0.168, graph: 0.618 |
| 4 | CWE-415 | Double Free | Variant | Allowed | 0.4144 | sparse, graph | sparse: 0.245, graph: 0.864 |
| 5 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3938 | dense, sparse | dense: 0.494, sparse: 0.257 |
| 6 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3422 | dense, sparse | dense: 0.480, sparse: 0.178 |
| 7 | CWE-277 | Insecure Inherited Permissions | Variant | Allowed | 0.3306 | dense, sparse | dense: 0.484, sparse: 0.203 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3277 | sparse, graph | sparse: 0.178, graph: 0.631 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3148 | dense, sparse | dense: 0.475, sparse: 0.181 |
| 10 | CWE-667 | Improper Locking | Class | Allowed-with-Review | 0.2457 | dense, sparse | dense: 0.533, sparse: 0.265 |

