# Vulnerability Information: CVE-2021-37604

## Vulnerability Description
In version 6.5 of Microchip MiWi software and all previous versions including legacy products, there is a possibility of frame counters being validated/updated prior to the message authentication. With this vulnerability in place, an attacker may increment the incoming frame counter values by injecting messages with a sufficiently large frame counter value and invalid payload. This results in denial of service/valid packets in the network. There is also a possibility of a replay attack in the stack.

### Vulnerability Description Key Phrases
- **rootcause:** **improper validation of frame counters**
- **impact:** denial of service and replay attack
- **vector:** injecting messages with large frame counter value and invalid payload
- **attacker:** attacker
- **product:** Microchip MiWi software
- **version:** 6.5 and prior

## CVE Reference Links Content Summary
```json
{
  "CVE-2021-37604": {
    "related": true,
    "summary": "The MiWi software versions 6.5 and earlier, has a vulnerability where frame counters are validated/updated before message authentication. An attacker could increment the frame counter by injecting messages with a large frame counter value and invalid payload, resulting in denial of service or replay attack.",
    "details": {
      "root_cause": "Frame counters are validated before the message authentication.",
      "weaknesses": [
        "Improper frame counter validation",
         "Missing protection against replay attacks"
      ],
      "impact": "Denial of service in the network. Replay attacks may also be possible.",
      "attack_vectors": [
        "Wireless injection of crafted messages"
      ],
      "attacker_capabilities": "Attacker needs to be able to inject wireless messages into the network."
    },
     "affected_products": [
        "MiWi software versions 6.5 and earlier, including legacy products."
      ]
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5823 | sparse, graph | sparse: 0.393, graph: 1.000 |
| 2 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.5025 | sparse, graph | sparse: 0.382, graph: 0.911 |
| 3 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4416 | sparse, graph | sparse: 0.377, graph: 0.631 |
| 4 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4313 | sparse, graph | sparse: 0.359, graph: 0.631 |
| 5 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.4260 | sparse, graph | sparse: 0.384, graph: 0.578 |
| 6 | CWE-696 | Incorrect Behavior Order | Class | Allowed-with-Review | 0.3673 | dense, sparse | dense: 0.500, sparse: 0.656 |
| 7 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.2107 | sparse | sparse: 0.368 |
| 8 | CWE-409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | 0.2055 | sparse | sparse: 0.359 |
| 9 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.2038 | sparse | sparse: 0.356 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2030 | sparse | sparse: 0.385 |

