# Vulnerability Information: CVE-2021-23158

## Vulnerability Description
A flaw was found in htmldoc in v1.9.12. **Double-free** in function pspdf_export(),in ps-pdf.cxx may result in a write-what-where condition, allowing an attacker to execute arbitrary code and denial of service.

### Vulnerability Description Key Phrases
- **rootcause:** **Double-free**
- **impact:** write-what-where condition and denial of service
- **attacker:** attacker
- **product:** htmldoc
- **version:** v1.9.12
- **component:** ps-pdf.cxx

## CVE Reference Links Content Summary
```
{
  "CVE-2021-23158": {
    "description": "A flaw was found in htmldoc in v1.9.12. Double-free in function pspdf_export(),in ps-pdf.cxx may result in a write-what-where condition, allowing an attacker to execute arbitrary code and denial of service.",
    "vulnerability_details": {
      "root_cause": "Double-free in the `pspdf_export` function.",
      "weaknesses": [
        "Double-free vulnerability (CWE-415)"
      ],
      "impact": "Arbitrary code execution and denial of service.",
      "attack_vector": "The vulnerability is triggered when processing a specially crafted HTML document using the `htmldoc` tool.",
        "attacker_capabilities": "An attacker needs to be able to supply a crafted HTML file to htmldoc for conversion to PDF format."
    },
    "affected_component": "htmldoc v1.9.12"
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-415 | Double Free | Variant | Allowed | 0.7153 | dense, sparse, graph | dense: 0.545, sparse: 0.305, graph: 0.917 |
| 2 | CWE-416 | Use After Free | Variant | Allowed | 0.6316 | dense, sparse, graph | dense: 0.514, sparse: 0.176, graph: 0.912 |
| 3 | CWE-364 | Signal Handler Race Condition | Base | Allowed | 0.4686 | sparse, graph | sparse: 0.194, graph: 1.000 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4634 | sparse, graph | sparse: 0.185, graph: 1.000 |
| 5 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3507 | dense, sparse | dense: 0.492, sparse: 0.183 |
| 6 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.3477 | dense, sparse | dense: 0.493, sparse: 0.177 |
| 7 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.3470 | dense, sparse | dense: 0.489, sparse: 0.179 |
| 8 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3467 | dense, sparse | dense: 0.491, sparse: 0.177 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3361 | dense, sparse | dense: 0.511, sparse: 0.190 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3348 | dense, sparse | dense: 0.514, sparse: 0.184 |

