# Vulnerability Information: CVE-2021-22897

## Vulnerability Description
curl 7.61.0 through 7.76.1 suffers from exposure of data element to wrong session due to a **mistake in the code for CURLOPT_SSL_CIPHER_LIST** when libcurl is built to use the Schannel TLS library. The selected cipher set was stored in a single static variable in the library, which has the surprising side-effect that if an application sets up multiple concurrent transfers, the last one that sets the ciphers will accidentally control the set used by all transfers. In a worst-case scenario, this weakens transport security significantly.

### Vulnerability Description Key Phrases
- **rootcause:** **mistake in the code for CURLOPT_SSL_CIPHER_LIST**
- **impact:** exposure of data element to wrong session
- **product:** curl
- **version:** 7.61.0 through 7.76.1

## CVE Reference Links Content Summary
```
{
  "guidelines": [
    "1. First verify if the content relates to the CVE specified based on the official description",
    "2. If the content does not relate to this CVE, respond with \"UNRELATED\"",
    "3. If no useful vulnerability information is found, respond with \"NOINFO\"",
    "4. For relevant content, extract:",
    "   - Root cause of vulnerability",
    "   - Weaknesses/vulnerabilities present",
    "   - Impact of exploitation",
    "   - Attack vectors",
    "   - Required attacker capabilities/position",
     "Additional instructions:",
    " - Preserve original technical details and descriptions",
     " - Remove unrelated content",
    " - Translate non-English content to English",
     " - Note if the content provides more detail than the official CVE description"
  ],
  "analyzed_content": [
    {
      "source": "www.oracle.com_0b164f06_20250115_222850.html",
      "is_related": true,
      "vulnerability": {
        "root_cause": "A mistake in the code for `CURLOPT_SSL_CIPHER_LIST` when libcurl is built to use the Schannel TLS library. The selected cipher set was stored in a single \"static\" variable.",
        "weaknesses": [
          "Exposure of Data Element to Wrong Session"
        ],
        "impact": "The last transfer that sets the ciphers will accidentally control the set used by all transfers, potentially weakening transport security significantly.",
        "attack_vectors": [
          "Network"
        ],
        "required_capabilities": "An application that sets up multiple concurrent transfers, and the last one that sets the ciphers accidentally controls the set used by all transfers."
      },
      "additional_notes": "This content provides details about the root cause, affected products, and mitigation strategies for the vulnerability."
    },
    {
      "source": "github.com_161e693c_20250115_222837.html",
      "is_related": true,
      "vulnerability": {
        "root_cause": "A mistake in the code for CURLOPT_SSL_CIPHER_LIST when libcurl is built to use the Schannel TLS library. The selected cipher set was stored in a single 'static' variable in the library.",
        "weaknesses": [
          "CWE-668"
        ],
        "impact": "Exposure of data element to wrong session. In a worst-case scenario, this weakens transport security significantly.",
        "attack_vectors": [
          "Network"
         ],
        "required_capabilities": "The last transfer that sets the ciphers will accidentally control the set used by all transfers."
      },
     "additional_notes": "This content provides additional details, a CVSS score, and links to related resources."
    },
    {
      "source": "curl.se_47ffe70b_20250115_222836.html",
       "is_related": true,
       "vulnerability": {
         "root_cause": "The cipher selection is stored in a single \"static\" variable, which causes the last transfer that sets the ciphers to control the set used by all transfers when Schannel is used.",
         "weaknesses": [
          "CWE-416: Use After Free"
        ],
         "impact": "A malicious server can potentially achieve remote code execution by crafting memory content in the correct place. However, clients may also crash or exhibit undefined behavior.",
         "attack_vectors": [
          "Network"
        ],
        "required_capabilities": "An application that has libcurl built to use OpenSSL (or one of its forks).  The server needs to know the heap address details in order to provide the appropriate payload. The application must also use a multi-interface, and HTTP/1.1 over TLS or concurrent HTTP/2 connections."
      },
      "additional_notes": "This content provides detailed steps for achieving remote code execution, affected and unaffected versions, and credit information."
    },
    {
      "source": "github.com_a1b59367_20250115_222848.html",
      "is_related": false,
      "vulnerability": {
          "root_cause": null,
          "weaknesses": [],
          "impact": null,
          "attack_vectors": [],
          "required_capabilities": null
        },
        "additional_notes": "UNRELATED: This content is about GitHub security features, not the specified CVE."
    },
    {
      "source": "security.netapp.com_41afbccf_20250115_093144.html",
      "is_related": true,
      "vulnerability": {
        "root_cause": "Multiple NetApp products incorporate curl/libcurl. Libcurl versions 7.61.0 through 7.76.1 are susceptible to vulnerabilities. This content refers to the same issue.",
        "weaknesses": [],
        "impact": "Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).",
        "attack_vectors": [],
        "required_capabilities": null
       },
       "additional_notes": "This content mentions CVE-2021-22897 and CVE-2021-22901 together, and is an advisory that does not provide specific details on root causes or attack vectors of the CVE-2021-22897."
    },
       {
        "source": "github.com_dba769c8_20250115_222850.html",
          "is_related": false,
          "vulnerability": {
              "root_cause": null,
              "weaknesses": [],
              "impact": null,
              "attack_vectors": [],
              "required_capabilities": null
            },
            "additional_notes": "UNRELATED: This content is about GitHub Copilot and its features."
         },
        {
            "source": "avatars.githubusercontent.com_5b62c064_20250115_222837.html",
               "is_related": false,
               "vulnerability": {
                   "root_cause": null,
                   "weaknesses": [],
                   "impact": null,
                   "attack_vectors": [],
                   "required_capabilities": null
                 },
                 "additional_notes": "NOINFO: This appears to be an image file, not providing any vulnerability information."
          },
      {
        "source": "www.oracle.com_f2d78ea9_20250115_222852.html",
        "is_related": false,
        "vulnerability": {
          "root_cause": null,
          "weaknesses": [],
          "impact": null,
          "attack_vectors": [],
          "required_capabilities": null
          },
          "additional_notes": "UNRELATED: This content is an Oracle Critical Patch Update Advisory - April 2022, and does not contain any information about CVE-2021-22897."
      },
      {
        "source": "github.com_016f1600_20250115_222854.html",
        "is_related": true,
        "vulnerability": {
          "root_cause": "Schannel cipher selection uses a static variable, causing a mistake in code implementation, that results in incorrect selection of ciphers",
          "weaknesses": [],
          "impact": "The selected ciphers can be overwritten by a concurrent transfer.",
          "attack_vectors": [],
           "required_capabilities": "An application must set up multiple concurrent transfers."
        },
        "additional_notes": "This content is a commit detail from curl, demonstrating the code fix for the CVE, and provides a link to the vulnerability description"
      },
        {
            "source": "cert-portal.siemens.com_3ea5bb4b_20250115_222853.html",
             "is_related": true,
             "vulnerability": {
               "root_cause": null,
               "weaknesses": [],
               "impact": null,
               "attack_vectors": [],
               "required_capabilities": null
              },
             "additional_notes": "This content lists CVE-2021-22897 and other CVEs as affecting SINEC INS, but provides no specific details on the root cause or attack vectors for CVE-2021-22897 itself."
        },
        {
            "source": "github.com_ab1fb86b_20250115_222838.html",
            "is_related": false,
            "vulnerability": {
              "root_cause": null,
              "weaknesses": [],
              "impact": null,
              "attack_vectors": [],
              "required_capabilities": null
             },
            "additional_notes": "UNRELATED: This content is about GitHub security features, and not the specified CVE."
         },
        {
            "source": "www.oracle.com_cd95aeb5_20250115_222901.html",
            "is_related": false,
            "vulnerability": {
                "root_cause": null,
                "weaknesses": [],
                "impact": null,
                "attack_vectors": [],
                "required_capabilities": null
            },
            "additional_notes":"UNRELATED: This content is an Oracle Critical Patch Update Advisory - January 2022, and does not contain information about CVE-2021-22897"
        }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-488 | Exposure of Data Element to Wrong Session | Base | Allowed | 1.0007 | dense, sparse, graph | dense: 0.620, sparse: 0.864, graph: 0.549 |
| 2 | CWE-1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | 0.7010 | dense, sparse, graph | dense: 0.535, sparse: 0.374, graph: 0.614 |
| 3 | CWE-1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | 0.5178 | sparse, graph | sparse: 0.385, graph: 0.832 |
| 4 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.5163 | sparse, graph | sparse: 0.383, graph: 0.832 |
| 5 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4832 | sparse, graph | sparse: 0.352, graph: 0.789 |
| 6 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.4667 | dense, sparse | dense: 0.522, sparse: 0.359 |
| 7 | CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | 0.4432 | dense, sparse | dense: 0.550, sparse: 0.358 |
| 8 | CWE-212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | 0.4005 | sparse, graph | sparse: 0.354, graph: 0.554 |
| 9 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.2824 | dense, sparse | dense: 0.526, sparse: 0.380 |
| 10 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.2121 | sparse | sparse: 0.371 |

