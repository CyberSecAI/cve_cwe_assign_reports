# Raw Retriever Results for CVE-2021-22897

# Raw Retriever Results for CVE-2021-22897

## Query
curl 7.61.0 through 7.76.1 suffers from exposure of data element to wrong session due to a mistake in the code for CURLOPT_SSL_CIPHER_LIST when libcurl is built to use the Schannel TLS library. The selected cipher set was stored in a single static variable in the library, which has the surprising side-effect that if an application sets up multiple concurrent transfers, the last one that sets the ciphers will accidentally control the set used by all transfers. In a worst-case scenario, this weakens transport security significantly.

## Keyphrases
- **rootcause**: mistake in the code for CURLOPT_SSL_CIPHER_LIST

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5040 | 0.6196 | 0.5263 | 0.5214 | 20 |
| Sparse | 438.7106 | 1079.9471 | 485.8228 | 450.4097 | 20 |
| Graph | 1.2624 | 2.3296 | 1.7643 | 1.6814 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.3296 | Allowed |
| 2 | 1204 | Generation of Weak Initialization Vector (IV) | base | 2.3296 | Allowed |
| 3 | 567 | Unsynchronized Access to Shared Data in a Multithreaded Context | base | 2.2100 | Allowed |
| 4 | 208 | Observable Timing Discrepancy | base | 2.2100 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 6 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 7 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 8 | 494 | Download of Code Without Integrity Check | base | 1.7680 | Allowed |
| 9 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 1.7183 | Allowed |
| 10 | 184 | Incomplete List of Disallowed Inputs | base | 1.6848 | Allowed |
| 11 | 757 | Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') | Base | 1.6780 | Allowed |
| 12 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.5505 | Allowed |
| 13 | 488 | Exposure of Data Element to Wrong Session | Base | 1.5378 | Allowed |
| 14 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 15 | 301 | Reflection Attack in an Authentication Protocol | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 488 | Exposure of Data Element to Wrong Session | Base | 0.6196 | 0.6196 | Allowed |
| 2 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.5504 | 0.5504 | Allowed |
| 3 | 757 | Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') | Base | 0.5454 | 0.5454 | Allowed |
| 4 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.5363 | 0.5363 | Allowed |
| 5 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.5347 | 0.5347 | Allowed |
| 6 | 593 | Authentication Bypass: OpenSSL CTX Object Modified after SSL Objects are Created | Variant | 0.5287 | 0.5287 | Allowed |
| 7 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.5286 | 0.5286 | Allowed |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.5261 | 0.5261 | Allowed-with-Review |
| 9 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.5243 | 0.5243 | Allowed |
| 10 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.5216 | 0.5216 | Allowed |
| 11 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.5212 | 0.5212 | Allowed |
| 12 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.5182 | 0.5182 | Allowed |
| 13 | 325 | Missing Cryptographic Step | Base | 0.5161 | 0.5161 | Allowed |
| 14 | 1394 | Use of Default Cryptographic Key | Base | 0.5124 | 0.5124 | Allowed |
| 15 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5116 | 0.5116 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-488 | Exposure of Data Element to Wrong Session | 1079.9471 | 1079.9471 | Allowed |
| 2 | CWE-1204 | Generation of Weak Initialization Vector (IV) | 481.4558 | 481.4558 | Allowed |
| 3 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 478.3406 | 478.3406 | Allowed |
| 4 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 475.2724 | 475.2724 | Allowed-with-Review |
| 5 | CWE-1240 | Use of a Cryptographic Primitive with a Risky Implementation | 467.6036 | 467.6036 | Allowed |
| 6 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 463.9155 | 463.9155 | Allowed-with-Review |
| 7 | CWE-407 | Inefficient Algorithmic Complexity | 463.6033 | 463.6033 | Allowed-with-Review |
| 8 | CWE-347 | Improper Verification of Cryptographic Signature | 463.4548 | 463.4548 | Allowed |
| 9 | CWE-668 | Exposure of Resource to Wrong Sphere | 461.7806 | 461.7806 | Discouraged |
| 10 | CWE-1333 | Inefficient Regular Expression Complexity | 451.4956 | 451.4956 | Allowed |
| 11 | CWE-319 | Cleartext Transmission of Sensitive Information | 449.3237 | 449.3237 | Allowed |
| 12 | CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 447.2414 | 447.2414 | Allowed |
| 13 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 445.4362 | 445.4362 | Allowed |
| 14 | CWE-203 | Observable Discrepancy | 442.8599 | 442.8599 | Allowed |
| 15 | CWE-212 | Improper Removal of Sensitive Information Before Storage or Transfer | 442.5434 | 442.5434 | Allowed |
