# Vulnerability Information: CVE-2021-41325

## Vulnerability Description
Broken access control for user creation in Pydio Cells 2.2.9 allows remote anonymous users to create standard users via the profile parameter. (In addition, such users can be granted several admin permissions via the Roles parameter.)

### Vulnerability Description Key Phrases
- **rootcause:** **broken access control**
- **impact:** create standard users
- **vector:** profile parameter
- **attacker:** remote anonymous users
- **product:** Pydio Cells
- **version:** 2.2.9
- **component:** user creation

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2021-41325:

**Root Cause:** The vulnerability stems from the ability to create a user with an empty profile value (`""`) instead of the expected values ("admin", "standard", "shared", or "anon"). This allows an attacker with a valid public share link to create a persistent user and then escalate its privileges.

**Weaknesses/Vulnerabilities Present:**

*   **Broken Access Control:** An anonymous user, authenticated through a public share link, gains the ability to perform actions they should not be authorized to do.
*   **Privilege Escalation:** The attacker elevates the newly created user's privileges to the "ADMINS" role.
*   **Insufficient Input Validation:** The application does not properly validate the user profile value during user creation, allowing an empty string to be used.

**Impact of Exploitation:**

*   **User Enumeration:** An attacker can enumerate all usernames (including admins) on the Cells instance.
*   **Persistent User Creation:** An attacker can create a standard user account that persists beyond the session.
*   **Privilege Escalation:** The attacker can escalate their privileges to admin, granting them significant control.
*   **Configuration Access:** The attacker can read parts of the configuration.
*   **User/Role Deletion:** The attacker can delete any user or role.

**Attack Vectors:**

*   **Public Share Link:** The attacker requires a valid "/public/" link to initiate the attack.
*   **Web Request Tampering:** The attacker manipulates web requests to create a user with an empty profile value and then assigns administrative roles.

**Required Attacker Capabilities/Position:**

*   **Access to a Public Share Link:** The attacker needs a valid share link.
*   **Network Access:** The attacker must be able to send HTTP requests to the Pydio Cells server.
*   **Knowledge of the Pydio API:** The attacker needs to be able to craft or modify web requests to exploit the vulnerability.

**Additional Notes:**

*   The vulnerability is exploited in multiple steps, starting with the anonymous user access via a public link (partially related to CVE-2020-12848).
*   The vulnerability is specifically related to the profile value being set to `""` during user creation.
*   The provided content details the specific web requests involved in each stage of the exploit, including user creation and privilege escalation.
*   The fix involves updating Pydio Cells to version 2.2.12 or above.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.5498 | dense, sparse, graph | dense: 0.442, sparse: 0.161, graph: 0.662 |
| 2 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.5401 | dense, sparse, graph | dense: 0.444, sparse: 0.180, graph: 0.602 |
| 3 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.2990 | dense, sparse | dense: 0.431, sparse: 0.145 |
| 4 | CWE-267 | Privilege Defined With Unsafe Actions | Base | Allowed | 0.2987 | dense, sparse | dense: 0.421, sparse: 0.154 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.2963 | dense, sparse | dense: 0.408, sparse: 0.161 |
| 6 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.2922 | dense, sparse | dense: 0.415, sparse: 0.148 |
| 7 | CWE-266 | Incorrect Privilege Assignment | Base | Allowed | 0.2652 | sparse, graph | sparse: 0.149, graph: 0.504 |
| 8 | CWE-286 | Incorrect User Management | Class | Allowed-with-Review | 0.2425 | dense, sparse | dense: 0.491, sparse: 0.292 |
| 9 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1797 | dense, sparse | dense: 0.422, sparse: 0.165 |
| 10 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.1789 | dense, sparse | dense: 0.443, sparse: 0.145 |

