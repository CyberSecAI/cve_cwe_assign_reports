# Vulnerability Information: CVE-2021-25283

## Vulnerability Description
An issue was discovered in through SaltStack Salt before 3002.5. The jinja renderer does not protect against **server side template injection** attacks.

### Vulnerability Description Key Phrases
- **weakness:** **server side template injection**
- **product:** SaltStack Salt
- **version:** before 3002.5
- **component:** jinja renderer

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The Jinja template renderer in Salt does not properly protect against server-side template injection (SSTI) attacks.",
    "weaknesses": [
      "Server-Side Template Injection"
    ],
    "impact": "An attacker can potentially execute arbitrary code on the server by injecting malicious code into Jinja templates.",
    "attack_vectors": "An attacker can exploit vulnerable Jinja templates by injecting malicious code. This could occur when user-supplied data is incorporated into a Jinja template without proper sanitization or escaping.",
    "required_attacker_capabilities": "The attacker needs to be able to influence the content of a Jinja template used by Salt. This might require access to certain Salt configurations or resources that utilize Jinja templating."
  },
  "affected_products": [
    "salt"
  ],
  "references": [
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YOGNT2XWPOYV7YT75DN7PS4GIYWFKOK5/",
      "text": "Fedora 32 Update: salt-3001.6-1.fc32"
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/11/msg00009.html",
       "text": "[SECURITY] [DLA 2815-1] salt security update"
    },
   {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FUGLOJ6NXLCIFRD2JTXBYQEMAEF2B6XH/",
       "text":"Fedora 34 Update: salt-3002.5-1.fc34"
    },
     {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7GRVZ5WAEI3XFN2BDTL6DDXFS5HYSDVB/",
       "text":"Fedora 33 Update: salt-3002.5-1.fc33"
    },
    {
      "url":"https://www.debian.org/security/2021/dsa-5011",
      "text": "[SECURITY] [DSA 5011-1] salt security update"
    },
    {
      "url":"https://security.gentoo.org/glsa/202310-22",
      "text":"Salt: Multiple Vulnerabilities — GLSA 202310-22"
    },
     {
      "url":"https://security.gentoo.org/glsa/202103-01",
      "text":"Salt: Multiple vulnerabilities — GLSA 202103-01"
    },
    {
      "url":"https://github.com/saltstack/salt/releases",
       "text":"Releases: saltstack/salt"
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.7107 | dense, sparse, graph | dense: 0.610, sparse: 0.164, graph: 0.872 |
| 2 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.5188 | dense, sparse, graph | dense: 0.521, sparse: 0.089, graph: 0.579 |
| 3 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5077 | dense, sparse, graph | dense: 0.493, sparse: 0.085, graph: 0.593 |
| 4 | CWE-325 | Missing Cryptographic Step | Base | Allowed | 0.3323 | sparse, graph | sparse: 0.108, graph: 0.757 |
| 5 | CWE-90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | 0.3260 | sparse, graph | sparse: 0.097, graph: 0.757 |
| 6 | CWE-116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | 0.3072 | dense, sparse, graph | dense: 0.482, sparse: 0.104, graph: 0.622 |
| 7 | CWE-294 | Authentication Bypass by Capture-replay | Base | Allowed | 0.3054 | dense, sparse | dense: 0.509, sparse: 0.089 |
| 8 | CWE-96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | 0.3024 | dense, sparse | dense: 0.501, sparse: 0.091 |
| 9 | CWE-93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | 0.2978 | dense, sparse | dense: 0.500, sparse: 0.083 |
| 10 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.2830 | dense, sparse | dense: 0.493, sparse: 0.087 |

