{
  "cve_id": "CVE-2022-3607",
  "description": "Failure to Sanitize Special Elements into a Different Plane (Special Element Injection) in GitHub repository octoprint/octoprint prior to 1.8.3.",
  "key_phrases": {
    "rootcause": "Special Element Injection",
    "weakness": "",
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "octoprint/octoprint",
    "version": "prior to 1.8.3",
    "component": ""
  },
  "reference_content": "Based on the provided content, here's an analysis of the vulnerability:\n\n**Root cause of vulnerability:**\nThe vulnerability stems from insufficient sanitization of uploaded language packs in the OctoPrint software. Specifically, it was possible to include a directory-traversing symbolic link within a language pack.\n\n**Weaknesses/vulnerabilities present:**\n- **Path traversal via symbolic links:** The system did not properly validate the contents of uploaded ZIP or TAR archives, allowing the inclusion of symbolic links that point to arbitrary locations on the server's file system.\n- **Insufficient input validation:** The system lacked proper checks to ensure that file names within the archives did not contain path traversal sequences (e.g., `..`).\n\n**Impact of exploitation:**\n- **Information disclosure:** An attacker with administrative permissions could upload a malicious language pack containing a symbolic link. When a backup is created, the symbolic link would be followed, potentially leading to the inclusion of sensitive files or directories in the backup. This could be used to extract information from the server.\n\n**Attack vectors:**\n- **Malicious language pack upload:** An attacker with administrative privileges can upload a crafted language pack containing malicious symlinks.\n\n**Required attacker capabilities/position:**\n- **Administrative access:** The attacker must have administrative privileges on the OctoPrint instance to upload language packs.\n\n**Additional details from the content:**\n- The vulnerability was present in the language pack handling logic within the `src/octoprint/server/api/languages.py` file.\n- The fix involved modifying the `_validate_archive_name` function to check if the path constructed by joining the archive entry name to the target path starts with the target directory, preventing access outside the target directory\n- The original code checked if name started with `/` or contained `..` but failed to prevent symlink to be used to escape target directory.\n- The vulnerability was fixed by adding a check that the resulting path must start with the target directory.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.95 | Base | Allowed | Primary CWE |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.85 | Base | Allowed | Secondary Candidate |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 0.75 | Base | Allowed | Secondary Candidate |\n| CWE-73 | External Control of File Name or Path | 0.70 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.90\n*   **Evidence Strength:** HIGH\n\n- **Analysis and Justification:**  \n  - *Explanation:* The vulnerability description highlights the ability to include directory-traversing symbolic links within uploaded language packs in OctoPrint. This allows an attacker to bypass intended restrictions and access arbitrary files on the server's file system when backups are created. The core issue is that the application does not properly handle symbolic links within the uploaded archive, leading to **improper link resolution** when processing the archive contents. This aligns directly with the characteristics of CWE-59. Specifically, the software fails to prevent a filename from identifying a link or shortcut that resolves to an unintended resource (files outside the intended directory). The description details that the `_validate_archive_name` function was modified to check if the path constructed by joining the archive entry name to the target path starts with the target directory, preventing access outside the target directory. The fix itself reinforces the classification as CWE-59 as it addresses the link resolution issue.\n\n  - *Relationship Analysis:* CWE-59 is a Base level CWE, which is appropriate for mapping root causes. It is related to CWE-22 (Path Traversal) because the symbolic link is used to traverse outside of the intended directory. CWE-59 CanFollow CWE-73 (External Control of File Name or Path) as the filename is externally controlled and used to access a file. The MITRE mapping guidance for CWE-59 states that it is ALLOWED for this type of vulnerability.\n\n- **Confidence Score:**  \n  - Confidence: 0.95 (High confidence due to explicit description of symbolic link usage for path traversal)\n\n---\n\n- **Analysis and Justification:**  \n  - *Explanation:* The vulnerability involves path traversal through the use of symbolic links within the uploaded archives, allowing access to files outside the intended directory. While CWE-59 focuses on the improper resolution of links, CWE-22 addresses the **improper limitation of a pathname to a restricted directory**. The archive is intended to contain files within a specific directory, but the symbolic links allow the attacker to access files outside of this restricted area. The uploaded language pack is not properly validated, so the attacker can escape the targeted directory.\n\n  - *Relationship Analysis:* CWE-22 is a parent of CWE-23 (Relative Path Traversal) and CWE-36 (Absolute Path Traversal). It is also related to CWE-59 since the symlink is a mechanism for path traversal. While CWE-59 is a more precise match, CWE-22 captures the broader issue of path traversal.\n\n- **Confidence Score:**  \n  - Confidence: 0.85 (High confidence as path traversal is a clear aspect of the vulnerability)\n\n---\n\n- **Analysis and Justification:**  \n  - *Explanation:* The vulnerability description mentions the upload of a malicious language pack. While the primary issue is the symbolic link and path traversal, there's an element of allowing the upload of a file that has potentially dangerous content (the symbolic link itself). CWE-434 addresses the **unrestricted upload of a file with a dangerous type**, and while not the primary weakness, it's a contributing factor. An attacker uploads a crafted language pack containing malicious symlinks, so the file upload aspect can't be ignored.\n\n  - *Relationship Analysis:* CWE-434 is a Base level CWE. It can precede CWE-59 as the file upload is a prerequisite for the link following vulnerability.\n\n- **Confidence Score:**  \n  - Confidence: 0.75 (Moderate confidence as the file upload aspect is secondary to the path traversal)\n\n---\n\n- **Analysis and Justification:**  \n  - *Explanation:* CWE-73 (External Control of File Name or Path) applies because the filenames within the uploaded archive are under the control of the attacker, and these filenames (including the symbolic links) are used to access files on the server. The system uses external input (filenames in the archive) to construct a pathname, but it doesn't properly prevent malicious filenames from identifying unintended resources. This is less specific than CWE-59, which directly addresses the link resolution, but still relevant.\n\n  - *Relationship Analysis:* CWE-73 is a parent of several CWEs related to file access, including CWE-59. It CanFollow CWE-20 (Improper Input Validation) as the lack of input validation allows for external control of the filename. The description focuses on the symlink resolution, making CWE-59 a better primary match.\n\n- **Confidence Score:**  \n  - Confidence: 0.70 (Moderate confidence as the external control of the filename contributes to the vulnerability, but is not the main issue)",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.95 | Base | Allowed | Primary CWE |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.85 | Base | Allowed | Secondary Candidate |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 0.75 | Base | Allowed | Secondary Candidate |\n| CWE-73 | External Control of File Name or Path | 0.70 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.90\n*   **Evidence Strength:** HIGH\n\n- **Analysis and Justification:**  \n  - *Explanation:* The vulnerability description highlights the ability to include directory-traversing symbolic links within uploaded language packs in OctoPrint. This allows an attacker to bypass intended restrictions and access arbitrary files on the server's file system when backups are created. The core issue is that the application does not properly handle symbolic links within the uploaded archive, leading to **improper link resolution** when processing the archive contents. This aligns directly with the characteristics of CWE-59. Specifically, the software fails to prevent a filename from identifying a link or shortcut that resolves to an unintended resource (files outside the intended directory). The description details that the `_validate_archive_name` function was modified to check if the path constructed by joining the archive entry name to the target path starts with the target directory, preventing access outside the target directory. The fix itself reinforces the classification as CWE-59 as it addresses the link resolution issue.\n\n  - *Relationship Analysis:* CWE-59 is a Base level CWE, which is appropriate for mapping root causes. It is related to CWE-22 (Path Traversal) because the symbolic link is used to traverse outside of the intended directory. CWE-59 CanFollow CWE-73 (External Control of File Name or Path) as the filename is externally controlled and used to access a file. The MITRE mapping guidance for CWE-59 states that it is ALLOWED for this type of vulnerability.\n\n- **Confidence Score:**  \n  - Confidence: 0.95 (High confidence due to explicit description of symbolic link usage for path traversal)\n\n---\n\n- **Analysis and Justification:**  \n  - *Explanation:* The vulnerability involves path traversal through the use of symbolic links within the uploaded archives, allowing access to files outside the intended directory. While CWE-59 focuses on the improper resolution of links, CWE-22 addresses the **improper limitation of a pathname to a restricted directory**. The archive is intended to contain files within a specific directory, but the symbolic links allow the attacker to access files outside of this restricted area. The uploaded language pack is not properly validated, so the attacker can escape the targeted directory.\n\n  - *Relationship Analysis:* CWE-22 is a parent of CWE-23 (Relative Path Traversal) and CWE-36 (Absolute Path Traversal). It is also related to CWE-59 since the symlink is a mechanism for path traversal. While CWE-59 is a more precise match, CWE-22 captures the broader issue of path traversal.\n\n- **Confidence Score:**  \n  - Confidence: 0.85 (High confidence as path traversal is a clear aspect of the vulnerability)\n\n---\n\n- **Analysis and Justification:**  \n  - *Explanation:* The vulnerability description mentions the upload of a malicious language pack. While the primary issue is the symbolic link and path traversal, there's an element of allowing the upload of a file that has potentially dangerous content (the symbolic link itself). CWE-434 addresses the **unrestricted upload of a file with a dangerous type**, and while not the primary weakness, it's a contributing factor. An attacker uploads a crafted language pack containing malicious symlinks, so the file upload aspect can't be ignored.\n\n  - *Relationship Analysis:* CWE-434 is a Base level CWE. It can precede CWE-59 as the file upload is a prerequisite for the link following vulnerability.\n\n- **Confidence Score:**  \n  - Confidence: 0.75 (Moderate confidence as the file upload aspect is secondary to the path traversal)\n\n---\n\n- **Analysis and Justification:**  \n  - *Explanation:* CWE-73 (External Control of File Name or Path) applies because the filenames within the uploaded archive are under the control of the attacker, and these filenames (including the symbolic links) are used to access files on the server. The system uses external input (filenames in the archive) to construct a pathname, but it doesn't properly prevent malicious filenames from identifying unintended resources. This is less specific than CWE-59, which directly addresses the link resolution, but still relevant.\n\n  - *Relationship Analysis:* CWE-73 is a parent of several CWEs related to file access, including CWE-59. It CanFollow CWE-20 (Improper Input Validation) as the lack of input validation allows for external control of the filename. The description focuses on the symlink resolution, making CWE-59 a better primary match.\n\n- **Confidence Score:**  \n  - Confidence: 0.70 (Moderate confidence as the external control of the filename contributes to the vulnerability, but is not the main issue)",
  "criticism": "Okay, here's a detailed critique of the CWE analysis, taking into account the full CWE specifications you provided.\n\n**Overall Assessment:**\n\nThe analysis is well-structured, thorough, and demonstrates a good understanding of the vulnerability and the relevant CWEs. The use of confidence scores and evidence strength is helpful. The justification for each CWE mapping is clear and includes relationship analysis.  The inclusion of known examples from the CWE database helps to solidify the mappings. Overall a very solid analysis.\n\n**Specific CWE Mappings Critique:**\n\n**1. CWE-59: Improper Link Resolution Before File Access ('Link Following')**\n\n*   **Confidence:** 0.95\n*   **Assessment:** **Correct and well-justified.** This is the most accurate primary CWE. The explanation clearly articulates why the vulnerability is rooted in the failure to prevent a filename from identifying a symbolic link that resolves to an unintended resource. The reference to the `_validate_archive_name` function being the location of the fix further reinforces this.\n\n*   **Mapping Guidance Compliance:** Follows the \"Allowed\" usage as per the CWE specification.\n*   **Mitigation Appropriateness:** The provided mitigations from CWE-59 are suitable. Separation of privilege (limiting access rights) is a key mitigation strategy.\n*   **Relationships:** The relationships to CWE-706 and CWE-73 are correctly identified.\n\n**2. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**\n\n*   **Confidence:** 0.85\n*   **Assessment:** **Correct, but secondary to CWE-59.** The vulnerability *does* result in path traversal, but the *mechanism* of traversal is the improper link resolution. CWE-22 captures the effect, while CWE-59 captures the cause. So, a solid secondary candidate.\n\n*   **Mapping Guidance Compliance:** Follows the \"Allowed\" usage.\n*   **Mitigation Appropriateness:** The provided mitigations are relevant, especially input validation and the use of path canonicalization functions.\n*   **Relationships:** The analysis correctly notes the relationship to CWE-23, CWE-36, and CWE-73 and its relation to CWE-59.\n\n**3. CWE-434: Unrestricted Upload of File with Dangerous Type**\n\n*   **Confidence:** 0.75\n*   **Assessment:** **Acceptable as a contributing factor, but not a primary weakness.** The analysis correctly identifies that the ability to upload a malicious language pack is a component of the vulnerability. The weakness isn't that *any* file upload is dangerous, but specifically a zip file containing the malicious payload (symlink).\n\n*   **Mapping Guidance Compliance:** Follows the \"Allowed\" usage.\n*   **Mitigation Appropriateness:** The suggested mitigations (generating unique filenames, limiting acceptable objects) are relevant but not the *most* effective in this particular case. More targeted validation of the archive contents is crucial.\n*   **Relationships:** The CanFollow to CWE-73 is sound, as is the chaining relationship with incomplete denylists.\n\n**4. CWE-73: External Control of File Name or Path**\n\n*   **Confidence:** 0.70\n*   **Assessment:** **Correct as a general contributor but less specific than CWE-59 or CWE-22.** The filenames within the uploaded archive *are* under the attacker's control, and this control is used to access files. However, the *improper link resolution* is the more precise weakness.\n\n*   **Mapping Guidance Compliance:** Follows the \"Allowed\" usage.\n*   **Mitigation Appropriateness:** The suggested mitigations (mapping fixed input values, using a jail) are generally sound but less directly applicable than those for CWE-59.\n*   **Relationships:** The analysis accurately notes the CanPrecede relationships and the better fit of CWE-59 as a primary match.\n\n**Suggestions for Improvement:**\n\n1.  **Prioritization of CWEs:** While the confidence scores are useful, consider explicitly stating why CWE-59 is the *primary* CWE and the others are *secondary*.  Emphasize the causal relationship: the improper handling of symlinks (CWE-59) is the direct cause of the path traversal (CWE-22), which then leads to potential information disclosure.\n2.  **CWE-20 Analysis:** The retriever results identify **CWE-75: Failure to Sanitize Special Elements into a Different Plane (Special Element Injection)** and similar CWEs. While the decision to not include **CWE-20: Improper Input Validation** is reasonable given that a more specific CWE was chosen, it could be beneficial to add a quick note explaining that choice, particularly in light of the retriever result of CWE-75.\n\n**Recommendations**\n\nThe analysis is strong. Minor tweaks to emphasize the primary causal factor (CWE-59) and a brief note about why CWE-20/CWE-75 were not chosen will improve it.  Overall, the CWE selections are appropriate and well-defended.",
  "resolution": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.95 | Base | Allowed | Primary CWE |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.85 | Base | Allowed | Secondary Candidate |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 0.75 | Base | Allowed | Secondary Candidate |\n| CWE-73 | External Control of File Name or Path | 0.70 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.95\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-59 (**CWE-59: Improper Link Resolution Before File Access ('Link Following')**), a Base level CWE that accurately reflects the root cause. The secondary CWEs contribute to the overall vulnerability. CWE-22 (**CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**) captures the effect of the improper link resolution. CWE-434 (**CWE-434: Unrestricted Upload of File with Dangerous Type**) highlights the initial attack vector, and CWE-73 (**CWE-73: External Control of File Name or Path**) represents the attacker's ability to control file names within the uploaded archive.\n\n```mermaid\ngraph TD\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory\"]\n    cwe434[\"CWE-434: Unrestricted Upload of File with Dangerous Type\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n\n    cwe59 -->|CANCAUSE| cwe22\n    cwe434 -->|CANPRECEDE| cwe59\n    cwe73 -->|CANPRECEDE| cwe59\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe59 primary\n    class cwe22,cwe434,cwe73 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **unrestricted upload of a file with a dangerous type** (CWE-434), specifically a language pack containing malicious symbolic links. The attacker gains **external control of the file names** (CWE-73) within the archive, allowing them to create symbolic links that point to arbitrary files on the system. The application then **improperly resolves these links** (CWE-59), leading to **path traversal** (CWE-22) and potentially unauthorized file access.\n\n## Summary of Analysis\nThe initial analysis and criticism are both strong and well-justified. The primary **WEAKNESS** is the **improper link resolution** (CWE-59), which is the direct cause of the vulnerability. The provided evidence clearly supports this classification, as the vulnerability description explicitly mentions the use of symbolic links to bypass intended restrictions. The fix implemented in the `_validate_archive_name` function, which checks if the path constructed by joining the archive entry name to the target path starts with the target directory, further reinforces this classification.\n\nThe graph relationships influenced the final selection by highlighting the causal chain of events. The upload of the malicious file (CWE-434) allows the attacker to control the file names (CWE-73), which then leads to the improper link resolution (CWE-59) and path traversal (CWE-22).\n\nThe selected CWEs are at the optimal level of specificity. CWE-59 is a Base level CWE that directly addresses the **root cause** of the vulnerability. While other CWEs, such as CWE-22, CWE-434, and CWE-73, are contributing factors, they are less specific and do not fully capture the essence of the vulnerability.\n\nThe retriever results also identified CWE-75 (**CWE-75: Failure to Sanitize Special Elements into a Different Plane (Special Element Injection)**) and similar CWEs. While relevant, these are broader and less precise than CWE-59, which focuses specifically on the **improper link resolution**.",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "CWE-791",
        "name": "Incomplete Filtering of Special Elements",
        "type": "Base",
        "original_content": "The product receives data from an upstream component, but does not completely filter special elements before sending it to a downstream component.",
        "relationships": [],
        "original_sparse_score": 114.42065465093984,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.5215019657532012,
            "sparse": 114.42065465093984,
            "graph": 1.6359269824070926
          },
          "normalized_scores": {
            "dense": 0.5215019657532012,
            "sparse": 0.09153652372075187,
            "graph": 0.5842596365739616
          },
          "weighted_scores": {
            "dense": 0.1825256880136204,
            "sparse": 0.036614609488300746,
            "graph": 0.1460649091434904
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.5215019657532012,
              "query_max": 0.7908114827948922,
              "query_min": 0.4709574789976808,
              "normalized_score": 0.5215019657532012,
              "weight": 0.35,
              "weighted_score": 0.1825256880136204
            },
            "sparse": {
              "raw_score": 114.42065465093984,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09153652372075187,
              "weight": 0.4,
              "weighted_score": 0.036614609488300746
            },
            "graph": {
              "raw_score": 1.6359269824070926,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.5842596365739616,
              "weight": 0.25,
              "weighted_score": 0.1460649091434904
            }
          },
          "contribution_percentages": {
            "dense": 49.978939153197764,
            "sparse": 10.025763275563303,
            "graph": 39.99529757123893
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.36520520664541156,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.47476676863903505
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.47476676863903505
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.5222434455029386
            }
          },
          "combined_score": 0.5222434455029386
        }
      },
      "similarity": 0.5222434455029386
    },
    {
      "metadata": {
        "doc_id": "CWE-90",
        "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an LDAP query using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended LDAP query when it is sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 141.75790934755815,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 141.75790934755815,
            "graph": 2.3295999999999997
          },
          "normalized_scores": {
            "sparse": 0.11340632747804652,
            "graph": 0.832
          },
          "weighted_scores": {
            "sparse": 0.04536253099121861,
            "graph": 0.208
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 141.75790934755815,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.11340632747804652,
              "weight": 0.4,
              "weighted_score": 0.04536253099121861
            },
            "graph": {
              "raw_score": 2.3295999999999997,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.832,
              "weight": 0.25,
              "weighted_score": 0.208
            }
          },
          "contribution_percentages": {
            "sparse": 17.904198704421237,
            "graph": 82.09580129557878
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.2533625309912186,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.3293712902885842
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.3293712902885842
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.3623084193174426
            }
          },
          "combined_score": 0.3623084193174426
        }
      },
      "similarity": 0.3623084193174426
    },
    {
      "metadata": {
        "doc_id": "CWE-75",
        "name": "Failure to Sanitize Special Elements into a Different Plane (Special Element Injection)",
        "type": "Class",
        "original_content": "The product does not adequately filter user-controlled input for special elements with control implications.",
        "relationships": [],
        "original_sparse_score": 333.01001770118376,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry might be under consideraton for deprecation, as it is not easily distinguishable from CWE-74.",
          "comments": "N/A",
          "reasons": [
            "Potential Deprecation"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.7908114827948922,
            "sparse": 333.01001770118376,
            "graph": 1.0591607397615856
          },
          "normalized_scores": {
            "dense": 0.7908114827948922,
            "sparse": 0.266408014160947,
            "graph": 0.3782716927719949
          },
          "weighted_scores": {
            "dense": 0.27678401897821225,
            "sparse": 0.10656320566437881,
            "graph": 0.09456792319299873
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.7908114827948922,
              "query_max": 0.7908114827948922,
              "query_min": 0.4709574789976808,
              "normalized_score": 0.7908114827948922,
              "weight": 0.35,
              "weighted_score": 0.27678401897821225
            },
            "sparse": {
              "raw_score": 333.01001770118376,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.266408014160947,
              "weight": 0.4,
              "weighted_score": 0.10656320566437881
            },
            "graph": {
              "raw_score": 1.0591607397615856,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.3782716927719949,
              "weight": 0.25,
              "weighted_score": 0.09456792319299873
            }
          },
          "contribution_percentages": {
            "dense": 57.91488724132891,
            "sparse": 22.29751581363104,
            "graph": 19.787596945040033
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.4779151478355898,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.38233211826847185
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.38233211826847185
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry might be under consideraton for deprecation, as it is not easily distinguishable from CWE-74.",
                "comments": "N/A",
                "reasons": [
                  "Potential Deprecation"
                ]
              },
              "score_after": 0.30586569461477753
            }
          },
          "combined_score": 0.30586569461477753
        }
      },
      "similarity": 0.30586569461477753
    },
    {
      "metadata": {
        "doc_id": "CWE-93",
        "name": "Improper Neutralization of CRLF Sequences ('CRLF Injection')",
        "type": "Base",
        "original_content": "The product uses CRLF (carriage return line feeds) as a special element, e.g. to separate lines or records, but it does not neutralize or incorrectly neutralizes CRLF sequences from inputs.",
        "relationships": [],
        "original_sparse_score": 141.53694948480285,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 141.53694948480285,
            "graph": 1.6557462285741664
          },
          "normalized_scores": {
            "sparse": 0.11322955958784228,
            "graph": 0.591337938776488
          },
          "weighted_scores": {
            "sparse": 0.04529182383513691,
            "graph": 0.147834484694122
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 141.53694948480285,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.11322955958784228,
              "weight": 0.4,
              "weighted_score": 0.04529182383513691
            },
            "graph": {
              "raw_score": 1.6557462285741664,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.591337938776488,
              "weight": 0.25,
              "weighted_score": 0.147834484694122
            }
          },
          "contribution_percentages": {
            "sparse": 23.451918166951934,
            "graph": 76.54808183304806
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.1931263085292589,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.2510642010880366
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.2510642010880366
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.2761706211968403
            }
          },
          "combined_score": 0.2761706211968403
        }
      },
      "similarity": 0.2761706211968403
    },
    {
      "metadata": {
        "doc_id": "CWE-794",
        "name": "Incomplete Filtering of Multiple Instances of Special Elements",
        "type": "Variant",
        "original_content": "The product receives data from an upstream component, but does not filter all instances of a special element before sending it to a downstream component.",
        "relationships": [],
        "original_sparse_score": 130.29411561611042,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.47477276643057587,
            "sparse": 130.29411561611042
          },
          "normalized_scores": {
            "dense": 0.47477276643057587,
            "sparse": 0.10423529249288833
          },
          "weighted_scores": {
            "dense": 0.16617046825070153,
            "sparse": 0.041694116997155334
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.47477276643057587,
              "query_max": 0.7908114827948922,
              "query_min": 0.4709574789976808,
              "normalized_score": 0.47477276643057587,
              "weight": 0.35,
              "weighted_score": 0.16617046825070153
            },
            "sparse": {
              "raw_score": 130.29411561611042,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10423529249288833,
              "weight": 0.4,
              "weighted_score": 0.041694116997155334
            }
          },
          "contribution_percentages": {
            "dense": 79.94169283457332,
            "sparse": 20.058307165426687
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.20786458524785686,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.24943750229742823
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.24943750229742823
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.27438125252717105
            }
          },
          "combined_score": 0.27438125252717105
        }
      },
      "similarity": 0.27438125252717105
    },
    {
      "metadata": {
        "doc_id": "CWE-792",
        "name": "Incomplete Filtering of One or More Instances of Special Elements",
        "type": "Variant",
        "original_content": "The product receives data from an upstream component, but does not completely filter one or more instances of special elements before sending it to a downstream component.",
        "relationships": [],
        "original_sparse_score": 120.5709312872957,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.48340400248772597,
            "sparse": 120.5709312872957
          },
          "normalized_scores": {
            "dense": 0.48340400248772597,
            "sparse": 0.09645674502983656
          },
          "weighted_scores": {
            "dense": 0.16919140087070408,
            "sparse": 0.038582698011934626
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.48340400248772597,
              "query_max": 0.7908114827948922,
              "query_min": 0.4709574789976808,
              "normalized_score": 0.48340400248772597,
              "weight": 0.35,
              "weighted_score": 0.16919140087070408
            },
            "sparse": {
              "raw_score": 120.5709312872957,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09645674502983656,
              "weight": 0.4,
              "weighted_score": 0.038582698011934626
            }
          },
          "contribution_percentages": {
            "dense": 81.43045826239965,
            "sparse": 18.569541737600353
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.2077740988826387,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.24932891865916643
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.24932891865916643
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.2742618105250831
            }
          },
          "combined_score": 0.2742618105250831
        }
      },
      "similarity": 0.2742618105250831
    },
    {
      "metadata": {
        "doc_id": "CWE-1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "type": "Base",
        "original_content": "The product uses a template engine to insert or process externally-influenced input, but it does not neutralize or incorrectly neutralizes special elements or syntax that can be interpreted as template expressions or other code directives when processed by the engine.",
        "relationships": [],
        "original_sparse_score": 141.30063755791707,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 141.30063755791707,
            "graph": 1.611818431566324
          },
          "normalized_scores": {
            "sparse": 0.11304051004633366,
            "graph": 0.5756494398451157
          },
          "weighted_scores": {
            "sparse": 0.04521620401853346,
            "graph": 0.14391235996127894
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 141.30063755791707,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.11304051004633366,
              "weight": 0.4,
              "weighted_score": 0.04521620401853346
            },
            "graph": {
              "raw_score": 1.611818431566324,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.5756494398451157,
              "weight": 0.25,
              "weighted_score": 0.14391235996127894
            }
          },
          "contribution_percentages": {
            "sparse": 23.907654701676815,
            "graph": 76.09234529832318
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.1891285639798124,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.24586713317375614
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.24586713317375614
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.27045384649113174
            }
          },
          "combined_score": 0.27045384649113174
        }
      },
      "similarity": 0.27045384649113174
    },
    {
      "metadata": {
        "doc_id": "CWE-917",
        "name": "Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an expression language (EL) statement in a framework such as a Java Server Page (JSP) using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended EL statement before it is executed.",
        "relationships": [],
        "original_sparse_score": 114.09013100191008,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 114.09013100191008,
            "graph": 1.521
          },
          "normalized_scores": {
            "sparse": 0.09127210480152806,
            "graph": 0.5432142857142858
          },
          "weighted_scores": {
            "sparse": 0.036508841920611226,
            "graph": 0.13580357142857144
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 114.09013100191008,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09127210480152806,
              "weight": 0.4,
              "weighted_score": 0.036508841920611226
            },
            "graph": {
              "raw_score": 1.521,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.5432142857142858,
              "weight": 0.25,
              "weighted_score": 0.13580357142857144
            }
          },
          "contribution_percentages": {
            "sparse": 21.187586669468693,
            "graph": 78.8124133305313
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.17231241334918268,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.22400613735393748
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.22400613735393748
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.24640675108933124
            }
          },
          "combined_score": 0.24640675108933124
        }
      },
      "similarity": 0.24640675108933124
    },
    {
      "metadata": {
        "doc_id": "CWE-138",
        "name": "Improper Neutralization of Special Elements",
        "type": "Class",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 158.10053386137358,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.49862420306681354,
            "sparse": 158.10053386137358,
            "graph": 1.0814785638904656
          },
          "normalized_scores": {
            "dense": 0.49862420306681354,
            "sparse": 0.12648042708909887,
            "graph": 0.38624234424659487
          },
          "weighted_scores": {
            "dense": 0.17451847107338472,
            "sparse": 0.05059217083563955,
            "graph": 0.09656058606164872
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.49862420306681354,
              "query_max": 0.7908114827948922,
              "query_min": 0.4709574789976808,
              "normalized_score": 0.49862420306681354,
              "weight": 0.35,
              "weighted_score": 0.17451847107338472
            },
            "sparse": {
              "raw_score": 158.10053386137358,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.12648042708909887,
              "weight": 0.4,
              "weighted_score": 0.05059217083563955
            },
            "graph": {
              "raw_score": 1.0814785638904656,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.38624234424659487,
              "weight": 0.25,
              "weighted_score": 0.09656058606164872
            }
          },
          "contribution_percentages": {
            "dense": 54.25367763675018,
            "sparse": 15.727912985817955,
            "graph": 30.01840937743186
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.321671227970673,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.2573369823765384
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.2573369823765384
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.20586958590123072
            }
          },
          "combined_score": 0.20586958590123072
        }
      },
      "similarity": 0.20586958590123072
    },
    {
      "metadata": {
        "doc_id": "CWE-790",
        "name": "Improper Filtering of Special Elements",
        "type": "Class",
        "original_content": "The product receives data from an upstream component, but does not filter or incorrectly filters special elements before sending it to a downstream component.",
        "relationships": [],
        "original_sparse_score": 135.10754143158994,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "dense": 0.4821007668552966,
            "sparse": 135.10754143158994
          },
          "normalized_scores": {
            "dense": 0.4821007668552966,
            "sparse": 0.10808603314527195
          },
          "weighted_scores": {
            "dense": 0.16873526839935382,
            "sparse": 0.043234413258108784
          },
          "normalization_details": {
            "dense": {
              "raw_score": 0.4821007668552966,
              "query_max": 0.7908114827948922,
              "query_min": 0.4709574789976808,
              "normalized_score": 0.4821007668552966,
              "weight": 0.35,
              "weighted_score": 0.16873526839935382
            },
            "sparse": {
              "raw_score": 135.10754143158994,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10808603314527195,
              "weight": 0.4,
              "weighted_score": 0.043234413258108784
            }
          },
          "contribution_percentages": {
            "dense": 79.6034919144831,
            "sparse": 20.396508085516896
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.2119696816574626,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.16957574532597008
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.16957574532597008
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.17805453259226858
            }
          },
          "combined_score": 0.17805453259226858
        }
      },
      "similarity": 0.17805453259226858
    },
    {
      "metadata": {
        "doc_id": "CWE-156",
        "name": "Improper Neutralization of Whitespace",
        "type": "Variant",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as whitespace when they are sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 114.8806921524193,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse",
            "graph"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 114.8806921524193,
            "graph": 0.9623999999999999
          },
          "normalized_scores": {
            "sparse": 0.09190455372193544,
            "graph": 0.3437142857142857
          },
          "weighted_scores": {
            "sparse": 0.03676182148877418,
            "graph": 0.08592857142857142
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 114.8806921524193,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09190455372193544,
              "weight": 0.4,
              "weighted_score": 0.03676182148877418
            },
            "graph": {
              "raw_score": 0.9623999999999999,
              "query_max": 2.3295999999999997,
              "query_min": 0.9623999999999999,
              "normalized_score": 0.3437142857142857,
              "weight": 0.25,
              "weighted_score": 0.08592857142857142
            }
          },
          "contribution_percentages": {
            "sparse": 29.963080738962166,
            "graph": 70.03691926103784
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.1226903929173456,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.14722847150081472
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.14722847150081472
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.1619513186508962
            }
          },
          "combined_score": 0.1619513186508962
        }
      },
      "similarity": 0.1619513186508962
    },
    {
      "metadata": {
        "doc_id": "CWE-1236",
        "name": "Improper Neutralization of Formula Elements in a CSV File",
        "type": "Base",
        "original_content": "The product saves user-provided information into a Comma-Separated Value (CSV) file, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as a command when the file is opened by a spreadsheet product.",
        "relationships": [],
        "original_sparse_score": 134.8592716645392,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 134.8592716645392
          },
          "normalized_scores": {
            "sparse": 0.10788741733163136
          },
          "weighted_scores": {
            "sparse": 0.04315496693265255
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 134.8592716645392,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10788741733163136,
              "weight": 0.4,
              "weighted_score": 0.04315496693265255
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.04315496693265255,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.056101457012448314
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.056101457012448314
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.06171160271369315
            }
          },
          "combined_score": 0.06171160271369315
        }
      },
      "similarity": 0.06171160271369315
    },
    {
      "metadata": {
        "doc_id": "CWE-89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
        "relationships": [],
        "original_sparse_score": 127.80015821289959,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 127.80015821289959
          },
          "normalized_scores": {
            "sparse": 0.10224012657031967
          },
          "weighted_scores": {
            "sparse": 0.04089605062812787
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 127.80015821289959,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10224012657031967,
              "weight": 0.4,
              "weighted_score": 0.04089605062812787
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.04089605062812787,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.05316486581656624
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.05316486581656624
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.058481352398222865
            }
          },
          "combined_score": 0.058481352398222865
        }
      },
      "similarity": 0.058481352398222865
    },
    {
      "metadata": {
        "doc_id": "CWE-78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 125.67284250068185,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 125.67284250068185
          },
          "normalized_scores": {
            "sparse": 0.10053827400054548
          },
          "weighted_scores": {
            "sparse": 0.04021530960021819
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 125.67284250068185,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10053827400054548,
              "weight": 0.4,
              "weighted_score": 0.04021530960021819
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.04021530960021819,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.05227990248028365
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.05227990248028365
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05750789272831202
            }
          },
          "combined_score": 0.05750789272831202
        }
      },
      "similarity": 0.05750789272831202
    },
    {
      "metadata": {
        "doc_id": "CWE-113",
        "name": "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')",
        "type": "Variant",
        "original_content": "The product receives data from an HTTP agent/component (e.g., web server, proxy, browser, etc.), but it does not neutralize or incorrectly neutralizes CR and LF characters before the data is included in outgoing HTTP headers.",
        "relationships": [],
        "original_sparse_score": 126.7639963332446,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 126.7639963332446
          },
          "normalized_scores": {
            "sparse": 0.10141119706659568
          },
          "weighted_scores": {
            "sparse": 0.04056447882663827
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 126.7639963332446,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10141119706659568,
              "weight": 0.4,
              "weighted_score": 0.04056447882663827
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.04056447882663827,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.04867737459196592
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04867737459196592
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05354511205116252
            }
          },
          "combined_score": 0.05354511205116252
        }
      },
      "similarity": 0.05354511205116252
    },
    {
      "metadata": {
        "doc_id": "CWE-838",
        "name": "Inappropriate Encoding for Output Context",
        "type": "Base",
        "original_content": "The product uses or specifies an encoding when generating output to a downstream component, but the specified encoding is not the same as the encoding that is expected by the downstream component.",
        "relationships": [],
        "original_sparse_score": 114.09284767509058,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 114.09284767509058
          },
          "normalized_scores": {
            "sparse": 0.09127427814007247
          },
          "weighted_scores": {
            "sparse": 0.03650971125602899
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 114.09284767509058,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09127427814007247,
              "weight": 0.4,
              "weighted_score": 0.03650971125602899
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.3,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.03650971125602899,
            "abstraction": {
              "type": "base",
              "factor": 1.3,
              "score_after": 0.04746262463283769
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.04746262463283769
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.05220888709612146
            }
          },
          "combined_score": 0.05220888709612146
        }
      },
      "similarity": 0.05220888709612146
    },
    {
      "metadata": {
        "doc_id": "CWE-155",
        "name": "Improper Neutralization of Wildcards or Matching Symbols",
        "type": "Variant",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as wildcards or matching symbols when they are sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 119.49512951207218,
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 119.49512951207218
          },
          "normalized_scores": {
            "sparse": 0.09559610360965774
          },
          "weighted_scores": {
            "sparse": 0.0382384414438631
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 119.49512951207218,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09559610360965774,
              "weight": 0.4,
              "weighted_score": 0.0382384414438631
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 1.2,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.1,
          "mapping_usage": "ALLOWED",
          "adjustment_factors": {
            "initial_combined_score": 0.0382384414438631,
            "abstraction": {
              "type": "variant",
              "factor": 1.2,
              "score_after": 0.045886129732635714
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.045886129732635714
            },
            "mapping": {
              "usage": "ALLOWED",
              "boost": 1.1,
              "notes": {
                "usage": "Allowed",
                "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
                "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
                "reasons": [
                  "Acceptable-Use"
                ]
              },
              "score_after": 0.050474742705899286
            }
          },
          "combined_score": 0.050474742705899286
        }
      },
      "similarity": 0.050474742705899286
    },
    {
      "metadata": {
        "doc_id": "CWE-116",
        "name": "Improper Encoding or Escaping of Output",
        "type": "Class",
        "original_content": "The product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.",
        "relationships": [],
        "original_sparse_score": 124.94688600258677,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 124.94688600258677
          },
          "normalized_scores": {
            "sparse": 0.09995750880206941
          },
          "weighted_scores": {
            "sparse": 0.039983003520827766
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 124.94688600258677,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09995750880206941,
              "weight": 0.4,
              "weighted_score": 0.039983003520827766
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.039983003520827766,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.031986402816662214
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.031986402816662214
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.033585722957495324
            }
          },
          "combined_score": 0.033585722957495324
        }
      },
      "similarity": 0.033585722957495324
    },
    {
      "metadata": {
        "doc_id": "CWE-943",
        "name": "Improper Neutralization of Special Elements in Data Query Logic",
        "type": "Class",
        "original_content": "The product generates a query intended to access or manipulate data in a data store such as a database, but it does not neutralize or incorrectly neutralizes special elements that can modify the intended logic of the query.",
        "relationships": [],
        "original_sparse_score": 123.54798148488517,
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 123.54798148488517
          },
          "normalized_scores": {
            "sparse": 0.09883838518790813
          },
          "weighted_scores": {
            "sparse": 0.03953535407516326
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 123.54798148488517,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.09883838518790813,
              "weight": 0.4,
              "weighted_score": 0.03953535407516326
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 1.05,
          "mapping_usage": "ALLOWED-WITH-REVIEW",
          "adjustment_factors": {
            "initial_combined_score": 0.03953535407516326,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.03162828326013061
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.03162828326013061
            },
            "mapping": {
              "usage": "ALLOWED-WITH-REVIEW",
              "boost": 1.05,
              "notes": {
                "usage": "Allowed-with-Review",
                "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
                "comments": "Examine children of this entry to see if there is a better fit",
                "reasons": [
                  "Abstraction"
                ]
              },
              "score_after": 0.03320969742313715
            }
          },
          "combined_score": 0.03320969742313715
        }
      },
      "similarity": 0.03320969742313715
    },
    {
      "metadata": {
        "doc_id": "CWE-74",
        "name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
        "type": "Class",
        "original_content": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
        "relationships": [],
        "original_sparse_score": 131.4124662253325,
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.",
          "comments": "Examine the children and descendants of this entry to find a more precise mapping.",
          "reasons": [
            "Frequent Misuse",
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "sparse"
          ],
          "is_graph_exclusive": false,
          "raw_scores": {
            "sparse": 131.4124662253325
          },
          "normalized_scores": {
            "sparse": 0.10512997298026601
          },
          "weighted_scores": {
            "sparse": 0.042051989192106405
          },
          "normalization_details": {
            "sparse": {
              "raw_score": 131.4124662253325,
              "query_max": 333.01001770118376,
              "query_min": 114.09013100191008,
              "normalized_score": 0.10512997298026601,
              "weight": 0.4,
              "weighted_score": 0.042051989192106405
            }
          },
          "contribution_percentages": {
            "sparse": 100.0
          },
          "abstraction_factor": 0.8,
          "relationship_count": 0,
          "relationship_bonus": 1.0,
          "mapping_boost": 0.8,
          "mapping_usage": "DISCOURAGED",
          "adjustment_factors": {
            "initial_combined_score": 0.042051989192106405,
            "abstraction": {
              "type": "class",
              "factor": 0.8,
              "score_after": 0.03364159135368513
            },
            "relationship": {
              "count": 0,
              "is_graph_exclusive": false,
              "bonus": 1.0,
              "score_after": 0.03364159135368513
            },
            "mapping": {
              "usage": "DISCOURAGED",
              "boost": 0.8,
              "notes": {
                "usage": "Discouraged",
                "rationale": "CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.",
                "comments": "Examine the children and descendants of this entry to find a more precise mapping.",
                "reasons": [
                  "Frequent Misuse",
                  "Abstraction"
                ]
              },
              "score_after": 0.026913273082948105
            }
          },
          "combined_score": 0.026913273082948105
        }
      },
      "similarity": 0.026913273082948105
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-434",
      "CWE-59",
      "CWE-23",
      "CWE-20",
      "CWE-36",
      "CWE-73",
      "CWE-22"
    ],
    "critic_additional": [
      "CWE-706",
      "CWE-75"
    ]
  }
}