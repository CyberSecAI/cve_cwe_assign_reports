# Vulnerability Information: CVE-2021-23206

## Vulnerability Description
A flaw was found in htmldoc in v1.9.12 and prior. A **stack buffer overflow** in parse_table() in ps-pdf.cxx may lead to execute arbitrary code and denial of service.

### Vulnerability Description Key Phrases
- **rootcause:** **stack buffer overflow**
- **impact:** execute arbitrary code and denial of service
- **product:** htmldoc
- **version:** v1.9.12 and prior
- **component:** parse_table() in ps-pdf.cxx

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The vulnerability is due to a stack buffer overflow in the `parse_table` function of `ps-pdf.cxx`. Specifically, the code does not properly validate the `colspan` and `rowspan` attributes of table elements, potentially leading to out-of-bounds writes to the `table.col_widths` array.",
    "weaknesses": [
      "Stack-based buffer overflow",
      "Insufficient input validation"
    ],
    "impact": "The stack buffer overflow can lead to arbitrary code execution and denial of service. This is due to overwriting stack memory, which could corrupt other stack variables, potentially redirect program execution, or cause program termination.",
    "attack_vectors": [
      "Crafted HTML file with malicious table attributes"
    ],
    "required_capabilities": "The attacker needs to provide a specially crafted HTML file as input to htmldoc. The user must then use htmldoc to parse the crafted file, triggering the vulnerability during table processing.",
     "additional_details": "The vulnerability occurs because `htmldoc` fails to validate the `colspan` attribute when parsing HTML tables. It is possible to create a table with a very large `colspan`, which can cause an out-of-bounds write to the `table.col_widths` array on the stack. The vulnerability can be triggered by using a crafted HTML file with a large `colspan`. The fix involves adding range checks to prevent out-of-bounds writes."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7225 | dense, sparse, graph | dense: 0.579, sparse: 0.190, graph: 0.906 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6911 | dense, sparse, graph | dense: 0.577, sparse: 0.199, graph: 0.807 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4120 | dense, sparse | dense: 0.624, sparse: 0.235 |
| 4 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3990 | dense, sparse | dense: 0.576, sparse: 0.194 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3966 | dense, sparse | dense: 0.616, sparse: 0.213 |
| 6 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.3910 | dense, sparse | dense: 0.559, sparse: 0.194 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3855 | dense, sparse | dense: 0.548, sparse: 0.194 |
| 8 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3795 | dense, sparse | dense: 0.550, sparse: 0.182 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3778 | dense, sparse | dense: 0.555, sparse: 0.175 |
| 10 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3760 | dense, sparse | dense: 0.544, sparse: 0.182 |

