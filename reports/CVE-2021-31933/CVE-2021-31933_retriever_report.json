{
  "cve_id": "CVE-2021-31933",
  "query": "A remote code execution vulnerability exists in Chamilo through 1.11.14 due to improper input sanitization of a parameter used for file uploads, and improper file-extension filtering for certain filenames (e.g., .phar or .pht). A remote authenticated administrator is able to upload a file containing arbitrary PHP code into specific directories via main/inc/lib/fileUpload.lib.php directory traversal to achieve PHP code execution.",
  "keyphrases": {
    "rootcause": "improper input sanitization"
  },
  "timestamp": "2025-03-16T22:39:28.206009",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 9,
      "average_score": 0.5908184737525842,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.2902293479096857,
      "unique_finds": 0
    },
    "graph": {
      "hit_count": 6,
      "average_score": 0.7469871317395222,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7705,
      "retriever_count": 0,
      "dense_score": 0.5875,
      "sparse_score": 0.2578,
      "graph_score": 0.9201
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7653,
      "retriever_count": 0,
      "dense_score": 0.5445,
      "sparse_score": 0.29,
      "graph_score": 0.9143
    },
    {
      "cwe_id": "CWE-434",
      "name": "Unrestricted Upload of File with Dangerous Type",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7587,
      "retriever_count": 0,
      "dense_score": 0.6341,
      "sparse_score": 0.3159,
      "graph_score": 0.7292
    },
    {
      "cwe_id": "CWE-96",
      "name": "Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6553,
      "retriever_count": 0,
      "dense_score": 0.6393,
      "sparse_score": 0.2417,
      "graph_score": 0.5511
    },
    {
      "cwe_id": "CWE-94",
      "name": "Improper Control of Generation of Code ('Code Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5757,
      "retriever_count": 0,
      "dense_score": 0.5532,
      "sparse_score": 0.2671,
      "graph_score": 0.4851
    },
    {
      "cwe_id": "CWE-646",
      "name": "Reliance on File Name or Extension of Externally-Supplied File",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.5738,
      "retriever_count": 0,
      "dense_score": 0.6547,
      "sparse_score": 0.5138,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-23",
      "name": "Relative Path Traversal",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4801,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.288,
      "graph_score": 0.8821
    },
    {
      "cwe_id": "CWE-1336",
      "name": "Improper Neutralization of Special Elements Used in a Template Engine",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4291,
      "retriever_count": 0,
      "dense_score": 0.5751,
      "sparse_score": 0.247,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-89",
      "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.422,
      "retriever_count": 0,
      "dense_score": 0.5705,
      "sparse_score": 0.2385,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-502",
      "name": "Deserialization of Untrusted Data",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4181,
      "retriever_count": 0,
      "dense_score": 0.5584,
      "sparse_score": 0.2424,
      "graph_score": "-"
    }
  ]
}