# Vulnerability Information: CVE-2022-0545

## Vulnerability Description
An **integer overflow** in the processing of loaded 2D images leads to a **write-what-where** vulnerability and an **out-of-bounds read** vulnerability, allowing an attacker to leak sensitive information or achieve code execution in the context of the Blender process when a specially crafted image file is loaded. This flaw affects Blender versions prior to 2.83.19, 2.93.8 and 3.1.

### Vulnerability Description Key Phrases
- **rootcause:** **integer overflow**
- **weakness:** **write-what-where and out-of-bounds read**
- **impact:** leak sensitive information and code execution
- **vector:** specially crafted image file
- **attacker:** attacker
- **product:** Blender
- **version:** prior to 2.83.19, 2.93.8 and 3.1

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described in CVE-2022-0545:

**Root Cause:**

*   The vulnerability lies in the `IMB_flipy()` function within `source/blender/imbuf/intern/rotate.c` of Blender.
*   The function is responsible for flipping images vertically.
*   The root cause is a missing bounds check which can lead to an integer overflow.

**Weaknesses/Vulnerabilities Present:**

*   **Out-of-bounds Write:**  By crafting an image with specific large dimensions, the `bottomf` pointer within `IMB_flipy()` can wrap around to point before the `topf` pointer, leading to an out-of-bounds write. This allows an attacker to overwrite memory locations controlled by the attacker via the image data.
*   **Integer Overflow:** A large `ibuf->x` can cause an integer overflow before allocating memory for the `linef` buffer, resulting in a heap buffer overflow/out-of-bounds write.

**Impact of Exploitation:**

*   **Code Execution:** The most severe impact is the potential for arbitrary code execution. By overwriting critical memory locations, like return addresses on the stack or function pointers, an attacker can hijack the execution flow of the Blender process and gain control over the system.
*   **Memory Corruption:** The out-of-bounds write can corrupt other parts of memory, potentially leading to crashes and instability.
*   **Information Leak:** The integer overflow vulnerability could result in an out-of-bounds read which could leak sensitive information.

**Attack Vectors:**

*   **Malicious Image File:** The primary attack vector is through a maliciously crafted image file. An attacker can craft an image with specific dimensions to trigger the out-of-bounds write in `IMB_flipy()` when the image is loaded or flipped.
*   **User Interaction:** The user has to load the crafted image into Blender, often via the "Image Texture" node. This requires user interaction to execute the malicious code.

**Required Attacker Capabilities/Position:**

*   **Craft Image:** The attacker needs the ability to craft a specific image file with tailored dimensions that cause the vulnerable code path to be reached and the out-of-bounds write/read to occur.
*   **Lure User:** The attacker needs a method to lure a user into loading the malicious image file into Blender.

**Additional Details:**

*   The issue is not specific to HDR images, as the vulnerability lies in the `IMB_flipy` function itself, which is used for image flipping regardless of format.
*   The provided example uses an HDR image to trigger the vulnerability, but this is just one way of exploiting it, with specific dimensions.
*  Multiple fixes were proposed because there were multiple ways to trigger the vulnerability.

This vulnerability is described in greater detail than the placeholder CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.9405 | dense, sparse, graph | dense: 0.521, sparse: 0.617, graph: 0.914 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.9273 | dense, sparse, graph | dense: 0.553, sparse: 0.677, graph: 0.738 |
| 3 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.8728 | dense, sparse, graph | dense: 0.492, sparse: 0.607, graph: 0.782 |
| 4 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.6397 | dense, sparse | dense: 0.510, sparse: 0.672 |
| 5 | CWE-193 | Off-by-one Error | Base | Allowed | 0.5665 | dense, sparse | dense: 0.483, sparse: 0.567 |
| 6 | CWE-197 | Numeric Truncation Error | Base | Allowed | 0.5554 | dense, sparse | dense: 0.490, sparse: 0.542 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.5502 | dense, sparse | dense: 0.514, sparse: 0.593 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5365 | dense, sparse | dense: 0.487, sparse: 0.511 |
| 9 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.5159 | dense, sparse | dense: 0.496, sparse: 0.543 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5053 | dense, sparse | dense: 0.496, sparse: 0.523 |

