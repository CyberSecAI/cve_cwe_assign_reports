# Vulnerability Information: CVE-2021-43453

## Vulnerability Description
A Heap-based Buffer Overflow vulnerability exists in JerryScript 2.4.0 and prior versions via an **out-of-bounds read** in parser_parse_for_statement_start in the js-parser-statm.c file. This issue is similar to CVE-2020-29657.

### Vulnerability Description Key Phrases
- **rootcause:** **out-of-bounds read**
- **impact:** Heap-based Buffer Overflow
- **product:** JerryScript
- **version:** 2.4.0 and prior versions
- **component:** parser_parse_for_statement_start in js-parser-statm.c

## CVE Reference Links Content Summary
The content relates to CVE-2021-43453.

**Root cause of vulnerability:**
The vulnerability is caused by a parsing error when encountering an unterminated `let` statement within a JavaScript program. Specifically, the parser fails to handle the case where a `let` statement is immediately followed by a class declaration without a closing brace or semicolon.

**Weaknesses/vulnerabilities present:**
- Heap-buffer-overflow: The primary vulnerability is a heap-buffer-overflow that can be triggered by crafting a malicious JavaScript program with specific syntax, which lacks proper termination of `let` statements.
- Improper parsing: The root cause of the heap overflow is a parsing error within the JavaScript engine's parser.

**Impact of exploitation:**
- Denial of Service (DoS): The crafted JavaScript code can cause a segmentation fault (crash) in the application, leading to a denial of service.
- Potential Remote Code Execution: With ASAN enabled the heap-buffer-overflow has been observed. This indicates the potential for more severe impacts like Remote Code Execution if further exploited.

**Attack vectors:**
- Malicious JavaScript code: The attack vector involves supplying a specially crafted JavaScript program containing an unterminated let statement followed by a class declaration to the vulnerable JavaScript engine.

**Required attacker capabilities/position:**
- The attacker needs the ability to execute arbitrary JavaScript code using the vulnerable JerryScript engine.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7358 | dense, sparse, graph | dense: 0.542, sparse: 0.240, graph: 0.917 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7009 | dense, sparse, graph | dense: 0.558, sparse: 0.235, graph: 0.804 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6673 | dense, sparse, graph | dense: 0.531, sparse: 0.273, graph: 0.686 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6195 | dense, sparse, graph | dense: 0.575, sparse: 0.224, graph: 0.715 |
| 5 | CWE-197 | Numeric Truncation Error | Base | Allowed | 0.4661 | sparse, graph | sparse: 0.232, graph: 0.932 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3992 | dense, sparse | dense: 0.590, sparse: 0.240 |
| 7 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3988 | sparse, graph | sparse: 0.204, graph: 0.789 |
| 8 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3863 | dense, sparse | dense: 0.529, sparse: 0.212 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3854 | dense, sparse | dense: 0.521, sparse: 0.218 |
| 10 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3822 | dense, sparse | dense: 0.538, sparse: 0.198 |

