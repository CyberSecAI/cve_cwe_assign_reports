# Vulnerability Information: CVE-2021-38384

## Vulnerability Description
Serverless Offline 8.0.0 returns a 403 HTTP status code for a route that has a trailing / character, which might cause a developer to implement incorrect access control, because the actual behavior within the Amazon AWS environment is a 200 HTTP status code (i.e., possibly greater than expected permissions).

### Vulnerability Description Key Phrases
- **impact:** incorrect access control
- **vector:** 403 HTTP status code for route with trailing /
- **product:** Serverless Offline
- **version:** 8.0.0

## CVE Reference Links Content Summary
```text
{
  "vulnerability": {
    "root_cause": "The serverless-offline plugin incorrectly handles routes with trailing slashes when using custom authorizers, leading to a discrepancy in authorization behavior between the local development environment and the actual AWS environment.",
    "weaknesses": [
      "Incorrect authorization implementation",
       "Discrepancy between local and production environments"
    ],
    "impact": "A developer using serverless-offline might implement incorrect access controls because the local environment returns a 403 status code for a route with a trailing slash while AWS returns a 200 status code for the same route, potentially granting more permissions than expected.",
    "attack_vectors": [
      "Network requests to routes with trailing slashes"
    ],
    "required_capabilities": "The attacker needs to understand the incorrect behavior of serverless-offline and exploit the discrepancy during development."
  },
  "additional_details": {
      "affected_versions": "<= 8.0.0",
      "patched_versions": "None",
     "cwe": "CWE-863",
     "cvss": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
     "epss_score": "0.579%"
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-393 | Return of Wrong Status Code | Base | Allowed | 0.4981 | dense, sparse, graph | dense: 0.421, sparse: 0.135, graph: 0.589 |
| 2 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.2462 | sparse, graph | sparse: 0.054, graph: 0.602 |
| 3 | CWE-647 | Use of Non-Canonical URL Paths for Authorization Decisions | Variant | Allowed | 0.2126 | dense, sparse | dense: 0.399, sparse: 0.054 |
| 4 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1186 | sparse, graph | sparse: 0.058, graph: 0.472 |
| 5 | CWE-158 | Improper Neutralization of Null Byte or NUL Character | Variant | Allowed | 0.0333 | sparse | sparse: 0.063 |
| 6 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.0328 | sparse | sparse: 0.057 |
| 7 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.0328 | sparse | sparse: 0.057 |
| 8 | CWE-41 | Improper Resolution of Path Equivalence | Base | Allowed | 0.0318 | sparse | sparse: 0.056 |
| 9 | CWE-203 | Observable Discrepancy | Base | Allowed | 0.0315 | sparse | sparse: 0.055 |
| 10 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.0313 | sparse | sparse: 0.055 |

