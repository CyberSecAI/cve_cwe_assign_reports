# Vulnerability Information: CVE-2022-2493

## Vulnerability Description
Data Access from Outside Expected Data Manager Component in GitHub repository openemr/openemr prior to 7.0.0.

### Vulnerability Description Key Phrases
- **impact:** access data from outside expected component
- **product:** openemr/openemr
- **version:** prior to 7.0.0

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "The commit introduces several access control checks using `AclMain::aclCheckCore` in various PHP files. The changes aim to prevent unauthorized access to different features and functionalities within the OpenEMR application. These checks are performed before rendering the page using Twig. If a user doesn't have the required permissions, they are shown an 'unauthorized' page.",
    "weaknesses": [
      "Missing access control checks in multiple files, allowing unauthorized users to potentially access or modify sensitive data and functionality."
    ],
    "impact": "Unauthorized users can potentially gain access to restricted functionalities or data within OpenEMR. This could lead to data breaches, unauthorized modifications, or disruption of service, depending on the specific resource that is being accessed without proper authorization.",
    "attack_vectors": "An attacker could try to directly access restricted URLs without having the necessary privileges, bypassing the authorization checks that were previously missing.",
     "required_attacker_capabilities": "An attacker needs to know or guess the internal paths and URLs, and they must not be authenticated with a role that grants access to the target page. The attacker can be either an unauthenticated user or an authenticated user with insufficient privileges."
  },
  "files_changed": [
    {
      "file": "controllers/C_Document.class.php",
      "changes": "Added ACL check for document access."
    },
    {
      "file": "controllers/C_PracticeSettings.class.php",
      "changes": "Added ACL check for practice settings."
    },
    {
      "file": "interface/billing/edit_payment.php",
      "changes": "Added ACL checks for payment editing."
    },
     {
      "file": "interface/billing/era_payments.php",
      "changes": "Added ACL checks for ERA posting."
    },
    {
      "file": "interface/billing/indigent_patients_report.php",
       "changes":"Added ACL check for indigent patients report."
    },
    {
      "file": "interface/billing/new_payment.php",
       "changes":"Added ACL checks for new payment."
    },
    {
      "file":"interface/billing/search_payments.php",
      "changes": "Added ACL checks for payment search."
    },
    {
      "file":"interface/billing/sl_eob_search.php",
      "changes":"Added ACL checks for EOB search."
    },
      {
      "file":"interface/billing/sl_receipts_report.php",
        "changes":"Added ACL check for receipts report. Also, limited access to doctor-specific data for non-admin users."
     },
    {
      "file":"interface/main/display_documents.php",
       "changes":"Added ACL check for lab documents."
    },
    {
     "file":"interface/orders/orders_results.php",
     "changes":"Added ACL checks for procedure results. Also added extra unauthorized page to avoid leaking information"
    },
     {
     "file":"interface/orders/pending_orders.php",
       "changes":"Added ACL check for pending orders. Also,  removed redundant authorization check"
    },
    {
      "file":"interface/orders/procedure_stats.php",
      "changes":"Added ACL check for procedure statistics report. Also, removed redundant check"
    },
    {
      "file":"interface/orders/types.php",
      "changes":"Added ACL checks for order types."
    },
    {
      "file": "interface/patient_file/ccr_import.php",
       "changes":"Added ACL check for CCR import."
    },
    {
      "file":"interface/patient_file/ccr_pending_approval.php",
      "changes":"Added ACL check for CCR approval."
    },
    {
      "file": "interface/patient_file/encounter/load_form.php",
      "changes": "Added ACL check for form access, showing a custom error page if unauthorized."
    },
     {
      "file":"interface/patient_file/front_payment.php",
      "changes":"Added ACL checks for front payment access. Different messages based on action type."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.3596 | dense, sparse, graph | dense: 0.309, sparse: 0.032, graph: 0.523 |
| 2 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.3116 | sparse, graph | sparse: 0.025, graph: 0.832 |
| 3 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.3106 | sparse, graph | sparse: 0.023, graph: 0.832 |
| 4 | CWE-178 | Improper Handling of Case Sensitivity | Base | Allowed | 0.2846 | sparse, graph | sparse: 0.025, graph: 0.757 |
| 5 | CWE-359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | 0.1700 | dense, sparse | dense: 0.316, sparse: 0.020 |
| 6 | CWE-285 | Improper Authorization | Class | Discouraged | 0.0743 | dense, sparse | dense: 0.304, sparse: 0.024 |
| 7 | CWE-214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | 0.0132 | sparse | sparse: 0.023 |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.0130 | sparse | sparse: 0.023 |
| 9 | CWE-36 | Absolute Path Traversal | Base | Allowed | 0.0127 | sparse | sparse: 0.022 |
| 10 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | 0.0125 | sparse | sparse: 0.022 |

