# Vulnerability Information: CVE-2021-3622

## Vulnerability Description
A flaw was found in the hivex library. This flaw allows an attacker to input a specially crafted Windows Registry (hive) file, which would cause hivex to recursively call the _get_children() function, leading to a **stack overflow**. The highest threat from this vulnerability is to system availability.

### Vulnerability Description Key Phrases
- **rootcause:** **recursive function call**
- **weakness:** **stack overflow**
- **vector:** specially crafted Windows Registry file
- **attacker:** attacker
- **product:** hivex library
- **component:** _get_children() function

## CVE Reference Links Content Summary
```
{
  "vulnerability_data": {
    "CVE-2021-3622": {
      "status": "relevant",
      "details": {
        "root_cause": "The vulnerability is caused by a recursive call to the `_get_children()` function in the `hivex` library when processing a specially crafted Windows Registry hive file. The `ri` records in the hive can be nested arbitrarily, and a deeply nested structure can cause the function to recurse excessively, leading to a stack overflow.",
        "weaknesses": [
          "Unrestricted recursion"
        ],
        "impact": "A stack overflow leading to a crash of the program utilizing the library, causing denial of service.",
        "attack_vectors": "An attacker can exploit this by providing a specially crafted Windows Registry (hive) file with deeply nested `ri` records to the `hivex` library for processing.",
        "attacker_capabilities": "The attacker needs the ability to provide the crafted hive file to the application using the vulnerable `hivex` library."
      },
        "additional_info": {
        "patch_info": "The fix involves limiting recursion depth in `_get_children()` function. A depth of 32 is set and if this limit is exceeded, the program will return an error instead of crashing." ,
        "real_world_impact": "Analysis of real world registry hives showed no depth exceeding 1, therefore, the fix is unlikely to affect real hives.",
        "severity": "The vulnerability was considered low severity as it only caused a crash in hivex and would not result in a crash in libguestfs, and user can always retry the operation",
        "affected_components": "The vulnerability exists within the `lib/node.c` file of the hivex library."
        }
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.7868 | dense, sparse, graph | dense: 0.510, sparse: 0.412, graph: 0.828 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7203 | dense, sparse, graph | dense: 0.514, sparse: 0.410, graph: 0.639 |
| 3 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.7093 | dense, sparse, graph | dense: 0.523, sparse: 0.410, graph: 0.596 |
| 4 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5118 | sparse, graph | sparse: 0.386, graph: 0.813 |
| 5 | CWE-824 | Access of Uninitialized Pointer | Base | Allowed | 0.4998 | sparse, graph | sparse: 0.380, graph: 0.789 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4702 | dense, sparse | dense: 0.511, sparse: 0.375 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4668 | dense, sparse | dense: 0.536, sparse: 0.415 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4413 | dense, sparse | dense: 0.523, sparse: 0.378 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4179 | sparse, graph | sparse: 0.373, graph: 0.572 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.3532 | dense, sparse | dense: 0.548, sparse: 0.571 |

