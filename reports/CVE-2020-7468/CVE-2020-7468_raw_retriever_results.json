{
  "query": "In FreeBSD 12.2-STABLE before r365772, 11.4-STABLE before r365773, 12.1-RELEASE before p10, 11.4-RELEASE before p4 and 11.3-RELEASE before p14 a ftpd(8) bug in the implementation of the file system sandbox, combined with capabilities available to an authenticated FTP user, can be used to escape the file system restriction configured in ftpchroot(5). Moreover, the bug allows a malicious client to gain root privileges.",
  "keyphrases": {
    "rootcause": "bug in the implementation of the file system sandbox"
  },
  "timestamp": "2025-03-17T01:50:40.446631",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.3998000000000004,
        "description": "CWE-1284: Improper Validation of Specified Quantity in Input...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.1189999999999998,
        "description": "CWE-908: Use of Uninitialized Resource...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.04,
        "description": "CWE-789: Memory Allocation with Excessive Size Value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.04,
        "description": "CWE-481: Assigning instead of Comparing...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.9562400000000002,
        "description": "CWE-183: Permissive List of Allowed Inputs...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.7680000000000005,
        "description": "CWE-59: Improper Link Resolution Before File Access ('Link Following')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.7680000000000005,
        "description": "CWE-476: NULL Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.6736000000000002,
        "description": "CWE-20: Improper Input Validation...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.6320000000000003,
        "description": "CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.617257388714707,
        "description": "Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.607898503691358,
        "description": "The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.5552000000000004,
        "description": "CWE-129: Improper Validation of Array Index...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.5381910554094977,
        "description": "The product allows user input to control or influence paths or file names that are used in filesystem operations....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.5024,
        "description": "CWE-942: Permissive Cross-domain Policy with Untrusted Domains...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.4824552971880027,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.4169600000000002,
        "description": "CWE-456: Missing Initialization of a Variable...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.3747200000000002,
        "description": "CWE-187: Partial String Comparison...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.3676000000000001,
        "description": "CWE-94: Improper Control of Generation of Code ('Code Injection')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.3676000000000001,
        "description": "CWE-823: Use of Out-of-range Pointer Offset...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.3600000000000003,
        "description": "CWE-172: Encoding Error...",
        "mapping_usage": "Allowed-with-Review"
      }
    ],
    "dense": [
      {
        "cwe_id": "220",
        "name": "Storage of File With Sensitive Data Under FTP Root",
        "abstraction": "Variant",
        "score": 0.5538535574975691,
        "description": "The product stores sensitive data under the FTP server root with insufficient access control, which might make it accessible to untrusted parties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "243",
        "name": "Creation of chroot Jail Without Changing Working Directory",
        "abstraction": "Variant",
        "score": 0.5388846100590923,
        "description": "The product uses the chroot() system call to create a jail, but does not change the working directory afterward. This does not prevent access to files outside of the jail....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "378",
        "name": "Creation of Temporary File With Insecure Permissions",
        "abstraction": "Base",
        "score": 0.48848106727489443,
        "description": "Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 0.4806906061656341,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "250",
        "name": "Execution with Unnecessary Privileges",
        "abstraction": "Base",
        "score": 0.4764594086601035,
        "description": "The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "abstraction": "Base",
        "score": 0.47232020039927775,
        "description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected d...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "401",
        "name": "Missing Release of Memory after Effective Lifetime",
        "abstraction": "Variant",
        "score": 0.4693810640349754,
        "description": "The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "277",
        "name": "Insecure Inherited Permissions",
        "abstraction": "Variant",
        "score": 0.4688018912327289,
        "description": "A product defines a set of insecure permissions that are inherited by objects that are created by the program....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "269",
        "name": "Improper Privilege Management",
        "abstraction": "Class",
        "score": 0.46549334369233314,
        "description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "abstraction": "Base",
        "score": 0.4624697678101876,
        "description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modi...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "24",
        "name": "Path Traversal: '../filedir'",
        "abstraction": "Variant",
        "score": 0.4614523957801906,
        "description": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize \"../\" sequences that can resolve to a location that is outside...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "346",
        "name": "Origin Validation Error",
        "abstraction": "Class",
        "score": 0.45861451175127693,
        "description": "The product does not properly verify that the source of data or communication is valid....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "121",
        "name": "Stack-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 0.4558824347938498,
        "description": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "276",
        "name": "Incorrect Default Permissions",
        "abstraction": "Base",
        "score": 0.4546577418641563,
        "description": "During installation, installed file permissions are set to allow anyone to modify those files....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "379",
        "name": "Creation of Temporary File in Directory with Insecure Permissions",
        "abstraction": "Base",
        "score": 0.45452168648791735,
        "description": "The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "73",
        "name": "External Control of File Name or Path",
        "abstraction": "Base",
        "score": 0.45341387796229704,
        "description": "The product allows user input to control or influence paths or file names that are used in filesystem operations....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 0.45291108553556725,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "abstraction": "Compound",
        "score": 0.4518823903396258,
        "description": "The product, when opening a file or directory, does not sufficiently account for when the file is a symbolic link that resolves to a target outside of the intended control sphere. This could allow an ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "427",
        "name": "Uncontrolled Search Path Element",
        "abstraction": "Base",
        "score": 0.44979288066061274,
        "description": "The product uses a fixed or controlled search path to find resources, but one or more locations in that path can be under the control of unintended actors....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "36",
        "name": "Absolute Path Traversal",
        "abstraction": "Base",
        "score": 0.448729349448859,
        "description": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as \"/abs/path\" that can resolve t...",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "243",
        "name": "Creation of chroot Jail Without Changing Working Directory",
        "abstraction": "Variant",
        "score": 845.1144336735554,
        "description": "The product uses the chroot() system call to create a jail, but does not change the working directory afterward. This does not prevent access to files outside of the jail....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 424.59683738600427,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "908",
        "name": "Use of Uninitialized Resource",
        "abstraction": "Base",
        "score": 414.962203133761,
        "description": "The product uses or accesses a resource that has not been initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "697",
        "name": "Incorrect Comparison",
        "abstraction": "Pillar",
        "score": 414.69702154822176,
        "description": "The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 413.80513819512953,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 411.49139731790956,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "277",
        "name": "Insecure Inherited Permissions",
        "abstraction": "Variant",
        "score": 410.6746769036424,
        "description": "A product defines a set of insecure permissions that are inherited by objects that are created by the program....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "122",
        "name": "Heap-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 404.46816247223296,
        "description": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine suc...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "267",
        "name": "Privilege Defined With Unsafe Actions",
        "abstraction": "Base",
        "score": 402.95510135969994,
        "description": "A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "665",
        "name": "Improper Initialization",
        "abstraction": "Class",
        "score": 402.47159602170814,
        "description": "The product does not initialize or incorrectly initializes a resource, which might leave the resource in an unexpected state when it is accessed or used....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "284",
        "name": "Improper Access Control",
        "abstraction": "Pillar",
        "score": 402.431213225644,
        "description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 401.17397825563535,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "269",
        "name": "Improper Privilege Management",
        "abstraction": "Class",
        "score": 397.7669486127852,
        "description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "822",
        "name": "Untrusted Pointer Dereference",
        "abstraction": "Base",
        "score": 397.52908510055465,
        "description": "The product obtains a value from an untrusted source, converts this value to a pointer, and dereferences the resulting pointer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 396.2579596426337,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "Base",
        "score": 395.3216885103728,
        "description": "The product writes data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "909",
        "name": "Missing Initialization of Resource",
        "abstraction": "Class",
        "score": 395.14270030521806,
        "description": "The product does not initialize a critical resource....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "abstraction": "Class",
        "score": 392.0078001074666,
        "description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustio...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "755",
        "name": "Improper Handling of Exceptional Conditions",
        "abstraction": "Class",
        "score": 389.68485177028947,
        "description": "The product does not handle or incorrectly handles an exceptional condition....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "abstraction": "Class",
        "score": 388.93180157702955,
        "description": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource....",
        "mapping_usage": "Discouraged"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.448729349448859,
      "max": 0.5538535574975691,
      "mean": 0.47093469357255746,
      "median": 0.46196108179518913,
      "count": 20
    },
    "sparse": {
      "min": 388.93180157702955,
      "max": 845.1144336735554,
      "mean": 425.0742297559747,
      "median": 402.45140462367607,
      "count": 20
    },
    "graph": {
      "min": 1.3600000000000003,
      "max": 2.3998000000000004,
      "mean": 1.6793461122501785,
      "median": 1.6125779462030325,
      "count": 20
    }
  }
}