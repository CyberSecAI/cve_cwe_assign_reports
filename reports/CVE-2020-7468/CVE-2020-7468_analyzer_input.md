# Vulnerability Information: CVE-2020-7468

## Vulnerability Description
In FreeBSD 12.2-STABLE before r365772, 11.4-STABLE before r365773, 12.1-RELEASE before p10, 11.4-RELEASE before p4 and 11.3-RELEASE before p14 a ftpd(8) **bug in the implementation of the file system sandbox**, combined with capabilities available to an authenticated FTP user, can be used to escape the file system restriction configured in ftpchroot(5). Moreover, the bug allows a malicious client to gain root privileges.

### Vulnerability Description Key Phrases
- **rootcause:** **bug in the implementation of the file system sandbox**
- **impact:** escape the file system restriction configured in ftpchroot(5) and gain root privileges
- **attacker:** authenticated FTP user
- **product:** FreeBSD
- **version:** 12.2-STABLE before r365772, 11.4-STABLE before r365773, 12.1-RELEASE before p10, 11.4-RELEASE before p4 and 11.3-RELEASE before p14
- **component:** ftpd(8)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A bug in the implementation of the file system sandbox within `ftpd(8)` when using the `ftpchroot(5)` feature.
- **Weaknesses/vulnerabilities present:** The `ftpd(8)` implementation of the file system sandbox has a flaw that allows a malicious client to escape the restrictions imposed by `ftpchroot(5)`.
- **Impact of exploitation:** An attacker can escape the file system restrictions and gain root privileges on the affected system.
- **Attack vectors:** An authenticated FTP user can exploit the vulnerability. Anonymous access is not sufficient.
- **Required attacker capabilities/position:** The attacker must have a valid login to the FTP server. They also need to be able to leverage the vulnerable `ftpd(8)` implementation of `ftpchroot(5)`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.6134 | dense, sparse, graph | dense: 0.481, sparse: 0.321, graph: 0.529 |
| 2 | CWE-243 | Creation of chroot Jail Without Changing Working Directory | Variant | Allowed | 0.6059 | dense, sparse | dense: 0.539, sparse: 0.676 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.5007 | sparse, graph | sparse: 0.340, graph: 0.857 |
| 4 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.4604 | sparse, graph | sparse: 0.332, graph: 0.757 |
| 5 | CWE-277 | Insecure Inherited Permissions | Variant | Allowed | 0.3901 | dense, sparse | dense: 0.469, sparse: 0.329 |
| 6 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1857 | dense, sparse | dense: 0.465, sparse: 0.318 |
| 7 | CWE-267 | Privilege Defined With Unsafe Actions | Base | Allowed | 0.1844 | sparse | sparse: 0.322 |
| 8 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.1819 | sparse | sparse: 0.318 |
| 9 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.1813 | sparse | sparse: 0.317 |
| 10 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.1809 | sparse | sparse: 0.316 |

