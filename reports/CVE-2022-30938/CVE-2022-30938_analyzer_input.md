# Vulnerability Information: CVE-2022-30938

## Vulnerability Description
A vulnerability has been identified in EN100 Ethernet module DNP3 IP variant (All versions), EN100 Ethernet module IEC 104 variant (All versions), EN100 Ethernet module IEC 61850 variant (All versions < V4.40), EN100 Ethernet module Modbus TCP variant (All versions), EN100 Ethernet module PROFINET IO variant (All versions). Affected applications contains a **memory corruption** vulnerability while parsing specially crafted HTTP packets to /txtrace endpoint manupulating a specific argument. This could allow an attacker to crash the affected application leading to a denial of service condition

### Vulnerability Description Key Phrases
- **weakness:** **memory corruption**
- **impact:** denial of service
- **vector:** specially crafted HTTP packets to /txtrace endpoint
- **attacker:** attacker
- **product:** EN100 Ethernet module
- **version:** IEC 61850 variant (All versions < V4.40) and All versions

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 6)
- CWE-22 (Count: 1)
- CWE-306 (Count: 1)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A memory corruption vulnerability exists in the EN100 Ethernet module while parsing specially crafted HTTP packets to the `/txtrace` endpoint. The vulnerability is triggered by manipulating a specific argument in the HTTP request.
- **Weaknesses/vulnerabilities present**: The vulnerability is classified as CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer. This indicates that the software does not properly validate or restrict operations on memory buffers, leading to the possibility of memory corruption.
- **Impact of exploitation**: Successful exploitation of this vulnerability can allow an attacker to crash the affected application, leading to a denial of service (DoS) condition.
- **Attack vectors**: The attack vector is network-based, using specially crafted HTTP packets sent to the `/txtrace` endpoint.
- **Required attacker capabilities/position**: The attacker does not require any privileges or user interaction. They need to be able to send network traffic to the affected devices and manipulate the relevant HTTP request argument.

The advisory also provides mitigations like blocking access to ports 80/tcp and 443/tcp using a firewall, applying secure substation concept and Defense-in-Depth measures, and disabling the web service within the device configuration if not required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.6705 | dense, sparse, graph | dense: 0.549, sparse: 0.257, graph: 0.695 |
| 2 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5830 | sparse, graph | sparse: 0.468, graph: 0.882 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4345 | dense, sparse | dense: 0.607, sparse: 0.292 |
| 4 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.4293 | dense, sparse | dense: 0.612, sparse: 0.278 |
| 5 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.4224 | dense, sparse | dense: 0.551, sparse: 0.257 |
| 6 | CWE-824 | Access of Uninitialized Pointer | Base | Allowed | 0.3489 | sparse, graph | sparse: 0.263, graph: 0.554 |
| 7 | CWE-400 | Uncontrolled Resource Consumption | Class | Discouraged | 0.2136 | dense, sparse | dense: 0.593, sparse: 0.315 |
| 8 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2008 | dense, sparse | dense: 0.556, sparse: 0.298 |
| 9 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1965 | dense, sparse | dense: 0.563, sparse: 0.274 |
| 10 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1880 | dense, sparse | dense: 0.552, sparse: 0.251 |

