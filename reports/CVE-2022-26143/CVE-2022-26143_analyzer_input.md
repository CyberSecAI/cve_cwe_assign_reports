# Vulnerability Information: CVE-2022-26143

## Vulnerability Description
The TP-240 (aka tp240dvr) component in Mitel MiCollab before 9.4 SP1 FP1 and MiVoice Business Express through 8.1 allows remote attackers to obtain sensitive information and cause a denial of service (performance degradation and excessive outbound traffic). This was exploited in the wild in February and March 2022 for the TP240PhoneHome DDoS attack.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access control**
- **impact:** denial of service, information disclosure
- **product:** Mitel MiCollab and MiVoice Business Express
- **version:** MiCollab before 9.4 SP1 FP1, MiVoice Business Express through 8.1
- **component:** TP-240 (aka tp240dvr) component

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2022-26143:

**1. Verification of CVE Relevance:**

The content directly relates to CVE-2022-26143. It specifically describes the "TP240PhoneHome" reflection/amplification DDoS attack vector, which is identified as CVE-2022-26143 in the Cloudflare blog and Mitel security advisory.

**2. Extracted Information:**

*   **Root Cause of Vulnerability**:
    *   The vulnerability lies in the "tp240dvr" service, a software bridge for Mitel MiCollab and MiVoice Business Express systems, which interfaces with TDM/VoIP PCI cards.
    *   The service has an exposed system test facility meant for debugging/performance testing, but this facility was inadvertently made accessible to the public internet due to incorrect provisioning.
    *   This test facility has a command that can be abused to cause the tp240dvr service to send a stress test to attack victims.

*   **Weaknesses/Vulnerabilities Present**:
    *   **Unauthenticated Access**: The system test facility, which was not designed for public access, was exposed to the internet without authentication requirements.
    *   **Amplification**: An unusual command in the tp240dvr service can be abused to cause a device to send a high volume of status update packets, creating a large amplification effect.
    *   **Sustained Attack Capability**: Attackers can initiate an attack using only one spoofed packet, and the device will sustain the attack for up to 14 hours.
    *   **Single-Threaded Processing**: The tp240dvr service processes commands using a single thread, making the abused service only usable to launch one attack at a time.

*   **Impact of Exploitation**:
    *   **Record-breaking Amplification Ratio**: The potential amplification ratio of up to 4,294,967,296:1 results in significantly larger attacks than typical UDP reflection/amplification.
    *   **Sustained DDoS Attacks**: A single, spoofed initial packet can cause sustained DDoS attacks of up to 14 hours in duration.
    *   **High Packets-per-Second Attacks**: The exposed systems are capable of generating extremely high packet rates.
    *   **Difficult Traceability**: The single-packet nature of the attack initiation makes it difficult to trace back to the attack source.
    *   **Service Disruption**: Collateral impact to abusable systems includes partial or complete disruption of voice communications and additional service disruptions.
    *   **Overwhelming Victim**: This type of attack floods the victims with so much traffic that their bandwidth or processing power is overwhelmed, leading to a denial of service.
    *   **Network Infrastructure**: Can exhaust the state tables of NATs and stateful firewalls.

*   **Attack Vectors**:
    *   The attack vector is through the public internet, specifically via UDP port 10074. The devices listen on that port for commands.
    *   A single spoofed UDP packet to port 10074 on a vulnerable system initiates the attack, directing a much larger volume of amplified traffic to the target.

*  **Required Attacker Capabilities/Position**:
    *   The attacker needs the ability to send spoofed UDP packets.
    *   The attacker does not need to maintain an ongoing connection with the vulnerable device.
    *   No authentication is required.
    *   Attackers can be anywhere on the internet, as long as they can reach the exposed systems.

**3. Additional Notes:**

*   **Mitigation:** Mitel has released patches to disable public access to the system test facility. Network administrators can also use access control lists (ACLs), firewalls, and other access control policies to block internet traffic destined for UDP port 10074.
*   The attack has been observed against a variety of targets, including broadband access ISPs, financial institutions, logistics companies, gaming companies, and other vertical markets.
*  Ingress and egress source address validation can help prevent attackers from launching these types of attacks.
*   The vulnerability is being exploited by sophisticated actors and DDoS-for-hire services.
*   The amplification factor is extremely high, reaching over 2 billion.
*   The abused devices are often located on relatively low-powered hardware.

**4. Content Evaluation:**

The Cloudflare blog post provides the most comprehensive and detailed information, including technical aspects of the attack, amplification ratios, attack duration, and recommended mitigations. The Mitel advisory provides a brief summary of the vulnerability and links to their security bulletin. The other sources primarily provide supplementary information, such as Shodan scans, lists of affected products, and mitigation recommendations.

In summary, the extracted information clearly defines the root cause, impact, and attack vectors associated with CVE-2022-26143, making it relevant and useful for understanding the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.6180 | dense, sparse, graph | dense: 0.512, sparse: 0.252, graph: 0.608 |
| 2 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.5846 | dense, sparse, graph | dense: 0.496, sparse: 0.219, graph: 0.590 |
| 3 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.4244 | sparse, graph | sparse: 0.205, graph: 0.958 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3709 | dense, sparse | dense: 0.503, sparse: 0.209 |
| 5 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.2806 | sparse, graph | sparse: 0.220, graph: 0.498 |
| 6 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.2166 | dense, sparse | dense: 0.499, sparse: 0.208 |
| 7 | CWE-400 | Uncontrolled Resource Consumption | Class | Discouraged | 0.1713 | dense, sparse | dense: 0.533, sparse: 0.203 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1704 | dense, sparse | dense: 0.507, sparse: 0.223 |
| 9 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1695 | dense, sparse | dense: 0.521, sparse: 0.206 |
| 10 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1678 | dense, sparse | dense: 0.513, sparse: 0.206 |

