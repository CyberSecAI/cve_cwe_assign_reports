# Vulnerability Information: CVE-2021-21914

## Vulnerability Description
A **heap-based buffer overflow** vulnerability exists in the DecoderStreamAppend functionality of Accusoft ImageGear 19.10. A specially-crafted file can lead to code execution. An attacker can provide a malicious file to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-based buffer overflow**
- **impact:** code execution
- **vector:** specially-crafted file
- **attacker:** attacker
- **product:** Accusoft ImageGear
- **version:** 19.1
- **component:** DecoderStreamAppend functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 37)
- CWE-1284 (Count: 6)
- CWE-193 (Count: 5)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A heap-based buffer overflow in `DecoderStream::Append` due to an integer overflow when calculating the size of the heap buffer.
- **Weaknesses/vulnerabilities present**: Integer overflow in memory allocation, leading to a heap-based buffer overflow.
- **Impact of exploitation**: Remote code execution.
- **Attack vectors**: A specially crafted JPEG 2000 file.
- **Required attacker capabilities/position**: An attacker can provide a malicious file to trigger this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.7545 | dense, sparse, graph | dense: 0.555, sparse: 0.270, graph: 0.902 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7315 | dense, sparse, graph | dense: 0.521, sparse: 0.262, graph: 0.897 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7099 | dense, sparse, graph | dense: 0.574, sparse: 0.272, graph: 0.747 |
| 4 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.6411 | dense, sparse, graph | dense: 0.593, sparse: 0.269, graph: 0.682 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4170 | dense, sparse | dense: 0.597, sparse: 0.268 |
| 6 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4035 | dense, sparse | dense: 0.536, sparse: 0.237 |
| 7 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3940 | sparse, graph | sparse: 0.196, graph: 0.789 |
| 8 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3912 | dense, sparse | dense: 0.554, sparse: 0.232 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3885 | dense, sparse | dense: 0.584, sparse: 0.225 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3713 | dense, sparse | dense: 0.554, sparse: 0.218 |

