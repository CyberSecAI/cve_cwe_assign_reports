{
  "cve_id": "CVE-2022-24795",
  "query": "yajl-ruby is a C binding to the YAJL JSON parsing and generation library. The 1.x branch and the 2.x branch of `yajl` contain an integer overflow which leads to subsequent heap memory corruption when dealing with large (~2GB) inputs. The reallocation logic at `yajl_buf.c#L64` may result in the `need` 32bit integer wrapping to 0 when `need` approaches a value of 0x80000000 (i.e. ~2GB of data), which results in a reallocation of buf->alloc into a small heap chunk. These integers are declared as `size_t` in the 2.x branch of `yajl`, which practically prevents the issue from triggering on 64bit platforms, however this does not preclude this issue triggering on 32bit builds on which `size_t` is a 32bit integer. Subsequent population of this under-allocated heap chunk is based on the original buffer size, leading to heap memory corruption. This vulnerability mostly impacts process availability. Maintainers believe exploitation for arbitrary code execution is unlikely. A patch is available and anticipated to be part of yajl-ruby version 1.4.2. As a workaround, avoid passing large inputs to YAJL.",
  "keyphrases": {
    "rootcause": "integer overflow"
  },
  "timestamp": "2025-03-18T10:56:41.145766",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 10,
      "average_score": 0.4798082511162079,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.8048874217729537,
      "unique_finds": 0
    },
    "graph": {
      "hit_count": 4,
      "average_score": 0.5992594392559496,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 1.0804,
      "retriever_count": 0,
      "dense_score": 0.5282,
      "sparse_score": 1.0,
      "graph_score": 0.6824
    },
    {
      "cwe_id": "CWE-197",
      "name": "Numeric Truncation Error",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.942,
      "retriever_count": 0,
      "dense_score": 0.4718,
      "sparse_score": 0.839,
      "graph_score": 0.632
    },
    {
      "cwe_id": "CWE-1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.9177,
      "retriever_count": 0,
      "dense_score": 0.463,
      "sparse_score": 0.8433,
      "graph_score": 0.5697
    },
    {
      "cwe_id": "CWE-789",
      "name": "Memory Allocation with Excessive Size Value",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.7949,
      "retriever_count": 0,
      "dense_score": 0.4799,
      "sparse_score": 0.765,
      "graph_score": 0.5129
    },
    {
      "cwe_id": "CWE-770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6756,
      "retriever_count": 0,
      "dense_score": 0.4789,
      "sparse_score": 0.7622,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-193",
      "name": "Off-by-one Error",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6753,
      "retriever_count": 0,
      "dense_score": 0.4547,
      "sparse_score": 0.7828,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6746,
      "retriever_count": 0,
      "dense_score": 0.4759,
      "sparse_score": 0.763,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-681",
      "name": "Incorrect Conversion between Numeric Types",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6667,
      "retriever_count": 0,
      "dense_score": 0.4633,
      "sparse_score": 0.7601,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-131",
      "name": "Incorrect Calculation of Buffer Size",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.6605,
      "retriever_count": 0,
      "dense_score": 0.4766,
      "sparse_score": 0.7377,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-122",
      "name": "Heap-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.6538,
      "retriever_count": 0,
      "dense_score": 0.5058,
      "sparse_score": 0.7958,
      "graph_score": "-"
    }
  ]
}