# Vulnerability Information: CVE-2020-10966

## Vulnerability Description
In the Password Reset Module in VESTA Control Panel through 0.9.8-25 and Hestia Control Panel before 1.1.1, **Host header manipulation** leads to account takeover because the victim receives a reset URL containing an attacker-controlled server name.

### Vulnerability Description Key Phrases
- **rootcause:** **Host header manipulation**
- **impact:** account takeover
- **vector:** receiving reset URL with attacker-controlled server name
- **product:** VESTA Control Panel and Hestia Control Panel
- **version:** through 0.9.8-25 and before 1.1.1
- **component:** Password Reset Module

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described in CVE-2020-10966:

**Root Cause of Vulnerability:**

*   The vulnerability stems from the use of the `$_SERVER['HTTP_HOST']` value without proper validation in the password reset module of VESTA Control Panel and Hestia Control Panel. This value is directly incorporated into the password reset URL sent to the user via email.

**Weaknesses/Vulnerabilities Present:**

*   **Host Header Injection:** The application does not validate or sanitize the `Host` header from the HTTP request. This allows an attacker to inject a malicious hostname into the `HTTP_HOST` variable.
*   **Unvalidated Input:** The injected hostname is then used to construct the password reset link, without verification, resulting in the generation of a malicious reset URL.
*   **Lack of Context-Aware Encoding:** The application lacks proper encoding or escaping when using the HTTP Host value within the password reset email, allowing for arbitrary URL injection.

**Impact of Exploitation:**

*   **Account Takeover:** By manipulating the `Host` header, an attacker can inject a malicious domain name into the password reset email. If a user clicks on the crafted link, they will be redirected to the attacker's server instead of the legitimate password reset page. This allows the attacker to steal the reset token/code and subsequently reset the user's password and take over their account.
*   **Phishing:** Although the email is sent from the legitimate server, the malicious link can be crafted to mimic a legitimate login page, potentially tricking users into revealing their credentials.

**Attack Vectors:**

*   **Network-based:** An attacker can remotely send an HTTP request to the vulnerable password reset endpoint.
*   **HTTP Header Manipulation:** The attacker manipulates the `Host` header of the HTTP request to inject a malicious domain.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to send an HTTP request to the vulnerable application.
*   **No Authentication Required:** The attacker does not need any prior authentication or access to exploit the vulnerability.
*   **User Interaction:** The attacker requires the victim user to click on the manipulated password reset link in the email.

**Additional Details from the Content:**

*   The vulnerability affects VESTA Control Panel through version 0.9.8-25 and Hestia Control Panel before version 1.1.1.
*   The fix implemented involved replacing the usage of `$_SERVER['HTTP_HOST']` with a validated hostname.
*   The provided issue report includes a detailed description of how the vulnerability can be exploited using a crafted `Host` header.
*   The fix was initially implemented without considering the port in the URL and was later corrected.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | 0.4938 | sparse, graph | sparse: 0.343, graph: 0.832 |
| 2 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4425 | sparse, graph | sparse: 0.191, graph: 0.932 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.4127 | sparse, graph | sparse: 0.170, graph: 0.882 |
| 4 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.3896 | sparse, graph | sparse: 0.169, graph: 0.911 |
| 5 | CWE-620 | Unverified Password Change | Base | Allowed | 0.3352 | dense, sparse | dense: 0.492, sparse: 0.155 |
| 6 | CWE-290 | Authentication Bypass by Spoofing | Base | Allowed | 0.3255 | sparse, graph | sparse: 0.167, graph: 0.644 |
| 7 | CWE-291 | Reliance on IP Address for Authentication | Variant | Allowed | 0.2779 | dense, sparse | dense: 0.426, sparse: 0.154 |
| 8 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.0944 | sparse | sparse: 0.165 |
| 9 | CWE-93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | 0.0938 | sparse | sparse: 0.164 |
| 10 | CWE-266 | Incorrect Privilege Assignment | Base | Allowed | 0.0937 | sparse | sparse: 0.164 |

