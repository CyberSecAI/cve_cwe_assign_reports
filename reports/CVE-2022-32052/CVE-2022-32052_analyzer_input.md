# Vulnerability Information: CVE-2022-32052

## Vulnerability Description
TOTOLINK T6 V4.1.9cu.5179_B20201015 was discovered to contain a **stack overflow** via the desc parameter in the function FUN_004137a4.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** TOTOLINK T6
- **version:** V4.1.9cu.5179_B20201015
- **component:** function FUN_004137a4

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 158)
- CWE-120 (Count: 6)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The `FUN_004137a4` function in `/web_cste/cgi-bin/cstecgi.cgi` copies the `desc` JSON parameter to a local stack variable without checking its length, leading to a stack buffer overflow.
- **Weaknesses/vulnerabilities present:** Stack buffer overflow due to missing length validation.
- **Impact of exploitation:** Arbitrary code execution by overwriting the return address on the stack, which could lead to full control of the device.
- **Attack vectors:** Sending a crafted JSON request to the web component of the router with a long value for the `desc` parameter.
- **Required attacker capabilities/position:** Attacker needs network access to the router's web interface.

This content provides more details than the official CVE description placeholder, including the vulnerable function, the vulnerable parameter, and proof of concept code.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5192 | dense, sparse, graph | dense: 0.507, sparse: 0.103, graph: 0.578 |
| 2 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4173 | sparse, graph | sparse: 0.104, graph: 1.000 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3787 | dense, sparse | dense: 0.612, sparse: 0.182 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3135 | dense, sparse | dense: 0.527, sparse: 0.087 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3093 | dense, sparse | dense: 0.520, sparse: 0.086 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3036 | dense, sparse | dense: 0.500, sparse: 0.093 |
| 7 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.2996 | dense, sparse | dense: 0.537, sparse: 0.098 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2928 | dense, sparse | dense: 0.530, sparse: 0.091 |
| 9 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2925 | dense, sparse | dense: 0.501, sparse: 0.097 |
| 10 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.2800 | dense, sparse | dense: 0.509, sparse: 0.085 |

