# Vulnerability Information: CVE-2022-32047

## Vulnerability Description
TOTOLINK T6 V4.1.9cu.5179_B20201015 was discovered to contain a **stack overflow** via the desc parameter in the function FUN_00412ef4.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** TOTOLINK T6
- **version:** V4.1.9cu.5179_B20201015
- **component:** function FUN_00412ef4

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 158)
- CWE-120 (Count: 6)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability is caused by a stack buffer overflow in the `/web_cste/cgi-bin/cstecgi.cgi` binary, specifically within the `FUN_00412ef4` function (address 0x412ef4). The function receives a JSON parameter `desc` and copies it directly to local stack variables without performing any length checks.

- **Weaknesses/vulnerabilities present**:
    - **Stack buffer overflow**: The primary weakness is the lack of bounds checking on the `desc` parameter when copying it to a stack buffer. This allows an attacker to write beyond the buffer's boundaries.
    - **Lack of input validation:** There is no validation of the size of the desc parameter.

- **Impact of exploitation**:
    - **Code Execution**: By overflowing the stack buffer, an attacker can overwrite return addresses or other critical data on the stack, potentially achieving arbitrary code execution on the device.

- **Attack vectors**:
    - **HTTP request**: The vulnerability is exploited via an HTTP request to `/web_cste/cgi-bin/cstecgi.cgi` with a specially crafted JSON payload containing an oversized `desc` parameter when `addEffect` equals to `1`.

- **Required attacker capabilities/position**:
    - **Network access**: The attacker must have network access to the device's web interface.
    - **Knowledge of vulnerable endpoint**: The attacker needs to know the vulnerable endpoint (`/web_cste/cgi-bin/cstecgi.cgi`) and the required parameters.
    - **Ability to craft HTTP requests**: The attacker needs to be able to craft malicious HTTP requests containing the overflowing `desc` parameter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5224 | dense, sparse, graph | dense: 0.513, sparse: 0.103, graph: 0.578 |
| 2 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4173 | sparse, graph | sparse: 0.104, graph: 1.000 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3806 | dense, sparse | dense: 0.616, sparse: 0.182 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3152 | dense, sparse | dense: 0.530, sparse: 0.087 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3114 | dense, sparse | dense: 0.524, sparse: 0.086 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3059 | dense, sparse | dense: 0.505, sparse: 0.093 |
| 7 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.3030 | dense, sparse | dense: 0.544, sparse: 0.098 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2945 | dense, sparse | dense: 0.533, sparse: 0.091 |
| 9 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2943 | dense, sparse | dense: 0.505, sparse: 0.097 |
| 10 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.2818 | dense, sparse | dense: 0.513, sparse: 0.085 |

