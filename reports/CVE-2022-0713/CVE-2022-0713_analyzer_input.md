# Vulnerability Information: CVE-2022-0713

## Vulnerability Description
**Heap-based Buffer Overflow** in GitHub repository radareorg/radare2 prior to 5.6.4.

### Vulnerability Description Key Phrases
- **weakness:** **Heap-based Buffer Overflow**
- **product:** radare2
- **version:** prior to 5.6.4

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 34)
- CWE-122 (Count: 4)

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability associated with CVE-2022-0713:

**Root Cause of Vulnerability:**
- An out-of-bounds read vulnerability exists within the `r_coresym_cache_element_new` function in `libr/bin/format/mach0/coresymbolication.c`. Specifically, the loop condition `cursor < end` was insufficient, allowing `cursor + sizeof(RCoreSymCacheElementSegment)` to go beyond the buffer's end.

**Weaknesses/Vulnerabilities Present:**
- **Out-of-bounds read:** The vulnerability is an out-of-bounds read, where the program attempts to access memory outside the allocated buffer. The size check of `cursor` was not sufficient for cases where the structure being read would overflow the buffer when added to the current cursor position.

**Impact of Exploitation:**
- **Crash:** The vulnerability leads to a crash, as the program tries to read from an invalid memory location which causes the program to terminate unexpectedly.

**Attack Vectors:**
- The vulnerability is triggered when processing a crafted Mach-O file with specific core symbolication data.
- The vulnerability is triggered during core symbolication process of Mach-O files.

**Required Attacker Capabilities/Position:**
- The attacker needs to provide a malicious Mach-O file to be processed by the vulnerable code in `radare2`. This implies that an attacker would either have to have some form of control to get radare2 to process the malicious file or for the victim to attempt to process the malicious file themselves.

**Additional Notes:**
- The fix involves changing the loop condition from `cursor < end` to `cursor + sizeof (RCoreSymCacheElementSegment) < end` which prevents reading past the end of the buffer.
- The vulnerability was reported by `@cnitlrt` via huntr.dev.
- The vulnerability was fixed in commit `a35f89f86ed12161af09330e92e5a213014e46a1`.
- This vulnerability is also addressed in the Fedora update for radare2.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-805 | Buffer Access with Incorrect Length Value | Base | Allowed | 0.7022 | dense, sparse, graph | dense: 0.572, sparse: 0.102, graph: 1.000 |
| 2 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.6764 | dense, sparse, graph | dense: 0.512, sparse: 0.109, graph: 1.000 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6104 | dense, sparse, graph | dense: 0.559, sparse: 0.113, graph: 0.743 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5687 | dense, sparse, graph | dense: 0.595, sparse: 0.126, graph: 0.689 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.5348 | dense, sparse, graph | dense: 0.599, sparse: 0.141, graph: 0.555 |
| 6 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3303 | dense, sparse | dense: 0.543, sparse: 0.102 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3252 | dense, sparse | dense: 0.529, sparse: 0.106 |
| 8 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.3211 | sparse, graph | sparse: 0.109, graph: 0.724 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3154 | dense, sparse | dense: 0.512, sparse: 0.103 |
| 10 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3145 | dense, sparse | dense: 0.522, sparse: 0.093 |

