# Vulnerability Information: CVE-2022-38381

## Vulnerability Description
An **improper handling of malformed request** vulnerability [CWE-228] exists in FortiADC 5.0 all versions, 6.0.0 all versions, 6.1.0 all versions, 6.2.0 through 6.2.3, and 7.0.0 through 7.0.2. This may allow a remote attacker without privileges to bypass some Web Application Firewall (WAF) protection such as the SQL Injection and XSS filters via a malformed HTTP request.

### Vulnerability Description Key Phrases
- **rootcause:** **improper handling of malformed request**
- **impact:** bypass SQL Injection and XSS filters
- **vector:** malformed HTTP request
- **attacker:** remote attacker without privileges
- **product:** FortiADC
- **version:** 5.0 all versions and 6.0.0 all versions and 6.1.0 all versions and 6.2.0 through 6.2.3 and 7.0.0 through 7.0.2

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Improper handling of malformed HTTP requests.
- **Weaknesses/vulnerabilities present**:  The vulnerability lies in the FortiADC's failure to properly handle malformed HTTP requests, which allows for the bypass of Web Application Firewall (WAF) protections. Specifically, SQL Injection and Cross-Site Scripting (XSS) filters can be circumvented.
- **Impact of exploitation**: Successful exploitation can lead to the bypass of WAF protections, potentially allowing an attacker to inject SQL queries, execute arbitrary code or commands.
- **Attack vectors**:  A remote attacker can exploit this vulnerability by sending a malformed HTTP request.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable FortiADC instance. No specific privileges are required.

The provided content gives more detail than the CVE description by specifying the affected versions and providing a timeline for the publication of the advisory. It also specifies that the vulnerability can bypass SQL injection and XSS filters.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | Allowed | 0.6786 | dense, sparse, graph | dense: 0.608, sparse: 0.276, graph: 0.606 |
| 2 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.4750 | sparse, graph | sparse: 0.279, graph: 0.882 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.4710 | sparse, graph | sparse: 0.288, graph: 0.857 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4407 | dense, sparse | dense: 0.578, sparse: 0.265 |
| 5 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4397 | sparse, graph | sparse: 0.275, graph: 0.789 |
| 6 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.4306 | dense, sparse | dense: 0.613, sparse: 0.279 |
| 7 | CWE-228 | Improper Handling of Syntactically Invalid Structure | Class | Allowed-with-Review | 0.3263 | dense, sparse | dense: 0.629, sparse: 0.421 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.2006 | dense, sparse | dense: 0.579, sparse: 0.277 |
| 9 | CWE-74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | 0.1657 | sparse, graph | sparse: 0.274, graph: 0.598 |
| 10 | CWE-209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | 0.1553 | sparse | sparse: 0.272 |

