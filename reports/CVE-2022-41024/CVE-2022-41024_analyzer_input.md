# Vulnerability Information: CVE-2022-41024

## Vulnerability Description
Several **stack-based buffer overflow** vulnerabilities exist in the DetranCLI command parsing functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. A specially-crafted network packet can lead to arbitrary command execution. An attacker can send a sequence of requests to trigger these vulnerabilities.This buffer overflow is in the function that manages the no vpn pptp advanced name WORD dns (yes|no) mtu mru mppe (on|off) stateful (on|off) command template.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** arbitrary command execution
- **vector:** specially-crafted network packet
- **product:** Siretta QUARTZ-GOLD
- **version:** G5.0.1.5-210720-141020
- **component:** DetranCLI command parsing functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-120

#### Top CWEs
- CWE-120 (Count: 115)
- CWE-787 (Count: 50)

## CVE Reference Links Content Summary
The provided content is related to CVE-2022-41024.

**Root cause of vulnerability:**
The root cause is a stack-based buffer overflow vulnerability in the `DetranCLI` command parsing functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. The vulnerability occurs due to the usage of `sprintf` with unchecked input sizes when processing command parameters, leading to buffer overflows on the stack.

**Weaknesses/vulnerabilities present:**
The vulnerability is a classic stack-based buffer overflow (CWE-120). The `sprintf` function is used to format strings into a fixed-size buffer on the stack. When the command parameters provided exceed the buffer's size, a buffer overflow occurs.

**Impact of exploitation:**
Successful exploitation of this vulnerability can lead to arbitrary command execution. An attacker can potentially overwrite parts of the stack, including the return address, and take control of the affected device.

**Attack vectors:**
The attack vector is a specially crafted network packet sent to the device, containing the vulnerable command with oversized parameters.

**Required attacker capabilities/position:**
The attacker needs to be able to send network packets to the device and have the required privileges to access the `DetranCLI` interface. The CVSS score indicates that a high privilege is required.
More specifically the vulnerable command for CVE-2022-41024 is
```
no vpn pptp advanced name WORD dns (yes|no) mtu <128-16384> mru <128-16384> mppe (on|off) stateful (on|off)
```
and the vulnerable code is
```
sprintf(buff_0x100,"%d<%s<%d<%s<%s<%d<%d<%s",1,*argv,based_on_argv[1],argv[2],argv[3],based_on_argv[4],based_on_argv[5],"");
```
The attacker controls the `WORD` parameter, which is copied to stack buffer `buff_0x100` without proper size check.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 1.1030 | dense, sparse, graph | dense: 0.695, sparse: 0.915, graph: 0.795 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.8175 | dense, sparse, graph | dense: 0.556, sparse: 0.382, graph: 0.898 |
| 3 | CWE-193 | Off-by-one Error | Base | Allowed | 0.8133 | dense, sparse, graph | dense: 0.555, sparse: 0.363, graph: 0.918 |
| 4 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7017 | dense, sparse, graph | dense: 0.625, sparse: 0.290, graph: 0.623 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.5001 | dense, sparse | dense: 0.673, sparse: 0.359 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4845 | dense, sparse | dense: 0.562, sparse: 0.355 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4540 | dense, sparse | dense: 0.567, sparse: 0.298 |
| 8 | CWE-170 | Improper Null Termination | Base | Allowed | 0.4485 | sparse, graph | sparse: 0.291, graph: 0.789 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4455 | dense, sparse | dense: 0.582, sparse: 0.334 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4254 | dense, sparse | dense: 0.572, sparse: 0.305 |

