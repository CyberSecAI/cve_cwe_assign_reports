# Vulnerability Information: CVE-2022-43408

## Vulnerability Description
Jenkins Pipeline Stage View Plugin 2.26 and earlier does not correctly encode the ID of input steps when using it to generate URLs to proceed or abort Pipeline builds, allowing attackers able to configure Pipelines to specify input step IDs resulting in URLs that would bypass the CSRF protection of any target URL in Jenkins.

### Vulnerability Description Key Phrases
- **rootcause:** **improper encoding of the ID of input steps**
- **weakness:** **cross-site request forgery**
- **impact:** bypass CSRF protection
- **attacker:** attackers able to configure Pipelines
- **product:** Jenkins Pipeline Stage View Plugin
- **version:** 2.26 and earlier

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2022-43408:

**CVE-2022-43408**

*   **Root Cause:** The Pipeline: Stage View Plugin does not properly encode the ID of `input` steps when generating URLs to proceed or abort Pipeline builds.
*   **Weakness:** Insufficient encoding of user-provided input (`input` step IDs) in URLs. This allows for the bypass of CSRF protection.
*   **Impact:** Attackers can configure Pipelines to specify `input` step IDs that would result in URLs that bypass CSRF protection of any target URL in Jenkins. This can lead to unauthorized actions in Jenkins or potentially external systems.
*   **Attack Vector:** An attacker must be able to configure Pipelines with crafted `input` step IDs. The attack is triggered when a user interacts with the crafted `input` step, specifically through the stage view.
*   **Required Attacker Capabilities/Position:** Attackers need the ability to configure Pipelines within Jenkins, which typically requires some level of authenticated access.  The user needs to interact with the crafted `input` step within the stage view for the attack to succeed.

**Summary of CVE-2022-43408:**

The vulnerability lies in the way the Pipeline: Stage View Plugin handles `input` step IDs when constructing URLs. The lack of proper encoding allows an attacker to inject arbitrary URLs that bypass Jenkins' CSRF protection. By crafting a pipeline with a malicious `input` step ID and tricking a user to interact with it, the attacker can perform actions in Jenkins under the victim's identity, potentially leading to sensitive data exposure or privilege escalation.

This content provides more detail than a typical CVE description by outlining the specific mechanism of the attack and the required attacker capabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-838 | Inappropriate Encoding for Output Context | Base | Allowed | 1.0479 | dense, sparse, graph | dense: 0.537, sparse: 0.980, graph: 0.611 |
| 2 | CWE-549 | Missing Password Field Masking | Base | Allowed | 0.4461 | dense, sparse | dense: 0.441, sparse: 0.394 |
| 3 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4318 | dense, sparse | dense: 0.432, sparse: 0.377 |
| 4 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4185 | sparse, graph | sparse: 0.374, graph: 0.572 |
| 5 | CWE-116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | 0.3691 | dense, sparse, graph | dense: 0.430, sparse: 0.462, graph: 0.417 |
| 6 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.3555 | dense, sparse | dense: 0.453, sparse: 0.412 |
| 7 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2916 | dense, sparse | dense: 0.430, sparse: 0.492 |
| 8 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2496 | sparse, graph | sparse: 0.438, graph: 0.487 |
| 9 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.2289 | sparse | sparse: 0.400 |
| 10 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.2279 | sparse | sparse: 0.398 |

