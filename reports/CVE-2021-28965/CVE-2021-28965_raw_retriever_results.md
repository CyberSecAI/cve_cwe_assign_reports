# Raw Retriever Results for CVE-2021-28965

# Raw Retriever Results for CVE-2021-28965

## Query
The REXML gem before 3.2.5 in Ruby before 2.6.7, 2.7.x before 2.7.3, and 3.x before 3.0.1 does not properly address XML round-trip issues. An incorrect document can be produced after parsing and serializing.

## Keyphrases
- **weakness**: XML round-trip issues

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4157 | 0.5394 | 0.4504 | 0.4303 | 20 |
| Sparse | 181.8841 | 455.8400 | 206.1212 | 191.6588 | 20 |
| Graph | 0.9360 | 2.3296 | 1.4554 | 1.4923 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | base | 2.3296 | Allowed |
| 2 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 3 | 652 | Improper Neutralization of Data within XQuery Expressions ('XQuery Injection') | Base | 1.6528 | Allowed |
| 4 | 112 | Missing XML Validation | Base | 1.6324 | Allowed |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.6016 | Allowed |
| 6 | 41 | Improper Resolution of Path Equivalence | base | 1.6016 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.6016 | Allowed |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | class | 1.5795 | Discouraged |
| 9 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | 1.5164 | Allowed |
| 10 | 611 | Improper Restriction of XML External Entity Reference | Base | 1.5011 | Allowed |
| 11 | 643 | Improper Neutralization of Data within XPath Expressions ('XPath Injection') | Base | 1.4836 | Allowed |
| 12 | 115 | Misinterpretation of Input | Base | 1.4607 | Allowed |
| 13 | 827 | Improper Control of Document Type Definition | Variant | 1.4193 | Allowed |
| 14 | 20 | Improper Input Validation | class | 1.3504 | Discouraged |
| 15 | 116 | Improper Encoding or Escaping of Output | class | 1.3216 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | 0.5394 | 0.5394 | Allowed |
| 2 | 112 | Missing XML Validation | Base | 0.5103 | 0.5103 | Allowed |
| 3 | 611 | Improper Restriction of XML External Entity Reference | Base | 0.5074 | 0.5074 | Allowed |
| 4 | 652 | Improper Neutralization of Data within XQuery Expressions ('XQuery Injection') | Base | 0.4804 | 0.4804 | Allowed |
| 5 | 643 | Improper Neutralization of Data within XPath Expressions ('XPath Injection') | Base | 0.4767 | 0.4767 | Allowed |
| 6 | 777 | Regular Expression without Anchors | Variant | 0.4670 | 0.4670 | Allowed |
| 7 | 91 | XML Injection (aka Blind XPath Injection) | Base | 0.4551 | 0.4551 | Allowed |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | 0.4532 | 0.4532 | Allowed |
| 9 | 185 | Incorrect Regular Expression | Class | 0.4516 | 0.4516 | Allowed-with-Review |
| 10 | 166 | Improper Handling of Missing Special Element | Base | 0.4311 | 0.4311 | Allowed |
| 11 | 163 | Improper Neutralization of Multiple Trailing Special Elements | Variant | 0.4294 | 0.4294 | Allowed |
| 12 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4290 | 0.4290 | Allowed-with-Review |
| 13 | 167 | Improper Handling of Additional Special Element | Base | 0.4274 | 0.4274 | Allowed |
| 14 | 159 | Improper Handling of Invalid Use of Special Elements | Class | 0.4271 | 0.4271 | Allowed-with-Review |
| 15 | 502 | Deserialization of Untrusted Data | Base | 0.4264 | 0.4264 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-777 | Regular Expression without Anchors | 455.8400 | 455.8400 | Allowed |
| 2 | CWE-116 | Improper Encoding or Escaping of Output | 208.2813 | 208.2813 | Allowed-with-Review |
| 3 | CWE-611 | Improper Restriction of XML External Entity Reference | 207.2016 | 207.2016 | Allowed |
| 4 | CWE-115 | Misinterpretation of Input | 204.8542 | 204.8542 | Allowed |
| 5 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 202.5233 | 202.5233 | Allowed |
| 6 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | 202.2121 | 202.2121 | Allowed |
| 7 | CWE-522 | Insufficiently Protected Credentials | 195.8477 | 195.8477 | Allowed-with-Review |
| 8 | CWE-863 | Incorrect Authorization | 192.3889 | 192.3889 | Allowed-with-Review |
| 9 | CWE-674 | Uncontrolled Recursion | 191.8224 | 191.8224 | Allowed-with-Review |
| 10 | CWE-776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | 191.8117 | 191.8117 | Allowed |
| 11 | CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 191.5059 | 191.5059 | Allowed-with-Review |
| 12 | CWE-95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 190.7757 | 190.7757 | Allowed |
| 13 | CWE-1333 | Inefficient Regular Expression Complexity | 190.6504 | 190.6504 | Allowed |
| 14 | CWE-502 | Deserialization of Untrusted Data | 189.8741 | 189.8741 | Allowed |
| 15 | CWE-347 | Improper Verification of Cryptographic Signature | 187.6193 | 187.6193 | Allowed |
