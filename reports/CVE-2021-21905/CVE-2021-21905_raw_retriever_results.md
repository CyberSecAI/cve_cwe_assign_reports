# Raw Retriever Results for CVE-2021-21905

# Raw Retriever Results for CVE-2021-21905

## Query
Stack-based buffer overflow vulnerability exists in how the CMA readfile function of Garrett Metal Detectors iC Module CMA Version 5.0 is used at various locations. The Garrett iC Module exposes an authenticated CLI over TCP port 6877. This interface is used by a secondary GUI client, called CMA Connect, to interact with the iC Module on behalf of the user. After a client successfully authenticates, they can send plaintext commands to manipulate the device.

## Keyphrases
- **rootcause**: Stack-based buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5001 | 0.5562 | 0.5169 | 0.5112 | 20 |
| Sparse | 334.0068 | 419.2006 | 356.9570 | 353.6454 | 20 |
| Graph | 1.7680 | 2.8652 | 2.1581 | 2.1168 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 170 | Improper Null Termination | base | 2.8652 | Allowed |
| 2 | 805 | Buffer Access with Incorrect Length Value | Base | 2.8401 | Allowed |
| 3 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 2.8191 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.4700 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.2100 | Allowed |
| 7 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.2100 | Allowed |
| 9 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 2.2011 | Allowed-with-Review |
| 10 | 129 | Improper Validation of Array Index | variant | 2.1936 | Allowed |
| 11 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 12 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 13 | 231 | Improper Handling of Extra Values | variant | 2.0400 | Allowed |
| 14 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 15 | 126 | Buffer Over-read | Variant | 1.9330 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5562 | 0.5562 | Allowed |
| 2 | 121 | Stack-based Buffer Overflow | Variant | 0.5454 | 0.5454 | Allowed |
| 3 | 126 | Buffer Over-read | Variant | 0.5405 | 0.5405 | Allowed |
| 4 | 680 | Integer Overflow to Buffer Overflow | Compound | 0.5321 | 0.5321 | Discouraged |
| 5 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | 0.5228 | 0.5228 | Allowed |
| 6 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.5222 | 0.5222 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 0.5209 | 0.5209 | Allowed-with-Review |
| 8 | 676 | Use of Potentially Dangerous Function | Base | 0.5202 | 0.5202 | Allowed |
| 9 | 1262 | Improper Access Control for Register Interface | Base | 0.5191 | 0.5191 | Allowed |
| 10 | 1319 | Improper Protection against Electromagnetic Fault Injection (EM-FI) | Base | 0.5121 | 0.5121 | Allowed |
| 11 | 316 | Cleartext Storage of Sensitive Information in Memory | Variant | 0.5103 | 0.5103 | Allowed |
| 12 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5095 | 0.5095 | Allowed |
| 13 | 122 | Heap-based Buffer Overflow | Variant | 0.5087 | 0.5087 | Allowed |
| 14 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.5085 | 0.5085 | Allowed |
| 15 | 190 | Integer Overflow or Wraparound | Base | 0.5054 | 0.5054 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-121 | Stack-based Buffer Overflow | 419.2006 | 419.2006 | Allowed |
| 2 | CWE-20 | Improper Input Validation | 395.7584 | 395.7584 | Discouraged |
| 3 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | 377.8026 | 377.8026 | Allowed-with-Review |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | 366.6736 | 366.6736 | Allowed |
| 5 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 365.0715 | 365.0715 | Allowed |
| 6 | CWE-770 | Allocation of Resources Without Limits or Throttling | 360.7955 | 360.7955 | Allowed |
| 7 | CWE-122 | Heap-based Buffer Overflow | 358.6041 | 358.6041 | Allowed |
| 8 | CWE-125 | Out-of-bounds Read | 357.3896 | 357.3896 | Allowed |
| 9 | CWE-126 | Buffer Over-read | 356.3944 | 356.3944 | Allowed |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 353.9782 | 353.9782 | Discouraged |
| 11 | CWE-190 | Integer Overflow or Wraparound | 353.3125 | 353.3125 | Allowed |
| 12 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 351.6165 | 351.6165 | Allowed-with-Review |
| 13 | CWE-789 | Memory Allocation with Excessive Size Value | 347.5085 | 347.5085 | Allowed |
| 14 | CWE-295 | Improper Certificate Validation | 345.7815 | 345.7815 | Allowed |
| 15 | CWE-345 | Insufficient Verification of Data Authenticity | 342.6874 | 342.6874 | Discouraged |
