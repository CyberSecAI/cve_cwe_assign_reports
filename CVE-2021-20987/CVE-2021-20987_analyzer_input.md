# Vulnerability Information: CVE-2021-20987

## Vulnerability Description
A **denial of service and memory corruption** vulnerability was found in Hilscher EtherNet/IP Core V2 prior to V2.13.0.21that may lead to code injection through network or make devices crash without recovery.

### Vulnerability Description Key Phrases
- **weakness:** **denial of service and memory corruption**
- **impact:** code injection
- **product:** Hilscher EtherNet/IP Core
- **version:** prior to V2.13.0.21

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from an out-of-bounds write in the Hilscher EtherNet/IP Core V2 component.

**Weaknesses/Vulnerabilities:**
- **Out-of-bounds Write (CWE-787):** The core issue is that the software is writing data beyond the intended boundaries of a memory buffer.

**Impact of Exploitation:**
- **Denial of Service (DoS):**  Exploitation can lead to a DoS condition, making the affected devices unresponsive.
- **Remote Code Execution (RCE):** The vulnerability may allow for the injection of malicious code via the network.
- **Code Exposure:** The vulnerability could potentially expose parts of the device's code.
- **Memory Corruption:** The out-of-bounds write can cause memory corruption, potentially leading to unpredictable behavior, including crashes without recovery.

**Attack Vectors:**
- **Network:** The vulnerability is exploitable through network communication. Specifically, the vulnerability exists in the EtherNet/IP stack.

**Required Attacker Capabilities/Position:**
- **Remote:** The attacker can be remote.
- **No Authentication Required:** No prior authentication is needed to exploit this vulnerability.

**Additional Information:**
- The vulnerability affects multiple products from Pepperl+Fuchs that utilize the vulnerable Hilscher EtherNet/IP Core V2.
- The specific versions affected are those prior to V2.13.0.21 of the Hilscher EtherNet/IP Core.
- The provided document includes a link to the Hilscher advisory for further information.
- The vendor recommends mitigations such as minimizing network exposure, isolating affected products, and using VPNs for remote access.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.4712 | sparse, graph | sparse: 0.199, graph: 1.000 |
| 2 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4597 | sparse, graph | sparse: 0.182, graph: 0.995 |
| 3 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.4465 | sparse, graph | sparse: 0.156, graph: 1.000 |
| 4 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4072 | sparse, graph | sparse: 0.171, graph: 0.865 |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3824 | dense, sparse | dense: 0.563, sparse: 0.176 |
| 6 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.3740 | dense, sparse | dense: 0.555, sparse: 0.168 |
| 7 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3736 | sparse, graph | sparse: 0.160, graph: 0.789 |
| 8 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3690 | dense, sparse | dense: 0.595, sparse: 0.178 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3665 | dense, sparse | dense: 0.588, sparse: 0.180 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1744 | dense, sparse | dense: 0.576, sparse: 0.178 |

