# Vulnerability Information: CVE-2022-30475

## Vulnerability Description
Tenda AC Series Router AC18_V15.03.05.19(6318) was discovered to contain a **stack-based buffer overflow** in the httpd module when handling /goform/WifiExtraSet request.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **product:** Tenda AC Series Router
- **version:** AC18_V15.03.05.19(6318)
- **component:** httpd module

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 16)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- A stack-based buffer overflow vulnerability exists in the `fromSetWirelessRepeat` function of the Tenda AC18 router's firmware.

**Vulnerability:**
- The function copies user-provided data from the `wpapsk_crypto` parameter into a stack-based buffer (`victim_buf`) using `strcpy`.
- There is no length check on the input, allowing an attacker to overflow the buffer `vuln_buf` which is located on the stack.

**Impact:**
- Successful exploitation can lead to a denial-of-service (DoS) condition, likely crashing the router.

**Attack Vector:**
- The vulnerability is triggered via an HTTP GET request to `/goform/WifiExtraSet`.
- The attacker needs to provide an overly long string for the `wpapsk_crypto` parameter in the HTTP GET request.

**Required Attacker Capabilities/Position:**
- The attacker needs network access to the router's web interface, typically requiring being on the same LAN or having remote access through port forwarding.
- The attacker doesn't require authentication to exploit this vulnerability because the vulnerable code is reachable without authentication.

**Additional details:**
- The vulnerable code is reachable through the `/goform/WifiExtraSet` endpoint, which is likely part of the router's web-based management interface.
- The PoC provided demonstrates how to send an HTTP GET request with an oversized `wpapsk_crypto` parameter to trigger the overflow.
- The vulnerability affects the latest version of the Tenda AC18 router at the time of reporting ([AC18\_V15.03.05.19(6318)](https://www.tenda.com.cn/download/detail-2683.html)).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4297 | sparse, graph | sparse: 0.126, graph: 1.000 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4142 | dense, sparse | dense: 0.637, sparse: 0.227 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3815 | sparse, graph | sparse: 0.131, graph: 0.857 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3637 | sparse, graph | sparse: 0.130, graph: 0.857 |
| 5 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3527 | dense, sparse | dense: 0.573, sparse: 0.115 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3427 | sparse, graph | sparse: 0.106, graph: 0.789 |
| 7 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3291 | dense, sparse | dense: 0.514, sparse: 0.125 |
| 8 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3183 | dense, sparse | dense: 0.505, sparse: 0.114 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3153 | dense, sparse | dense: 0.529, sparse: 0.135 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3007 | dense, sparse | dense: 0.520, sparse: 0.114 |

