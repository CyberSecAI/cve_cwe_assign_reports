# Vulnerability Information: CVE-2021-45832

## Vulnerability Description
A **Stack-based Buffer Overflow** Vulnerability exists in HDF5 1.13.1-1 at at hdf5/src/H5Eint.c, which causes a Denial of Service (context-dependent).

### Vulnerability Description Key Phrases
- **rootcause:** **Stack-based Buffer Overflow**
- **impact:** Denial of Service
- **product:** HDF5
- **version:** 1.13.1-1
- **component:** hdf5/src/H5Eint.c

## CVE Reference Links Content Summary
The provided content is related to a stack overflow vulnerability in the HDF5 library.

**Root Cause:**
The vulnerability is triggered by a stack overflow within the `H5E_printf_stack` function. This function is called recursively due to an infinite loop in error handling when processing a specially crafted HDF5 file.

**Weaknesses/Vulnerabilities:**
- Recursive calls to `H5E_printf_stack` and `H5E__push_stack` functions without proper termination conditions.
- The `H5I_inc_ref` function also contributes to the recursive loop.
- The error handling mechanism within the HDF5 library does not correctly handle certain error conditions, leading to uncontrolled stack growth.

**Impact of Exploitation:**
- A stack overflow, leading to a segmentation fault and program crash.
- Potential for denial-of-service attacks if an attacker can provide a crafted HDF5 file.

**Attack Vectors:**
- Opening a specially crafted HDF5 file. The specific crafted file (`POC6.zip`) was provided within the issue report.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to provide a specially crafted HDF5 file to the vulnerable application.
- No specific user privileges or local access is mentioned, suggesting remote exploitation might be possible if the HDF5 library is used in a network-facing context.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6864 | dense, sparse, graph | dense: 0.548, sparse: 0.157, graph: 0.901 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6503 | dense, sparse, graph | dense: 0.550, sparse: 0.153, graph: 0.804 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5065 | dense, sparse, graph | dense: 0.525, sparse: 0.145, graph: 0.568 |
| 4 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3630 | sparse, graph | sparse: 0.141, graph: 0.789 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3629 | dense, sparse | dense: 0.573, sparse: 0.185 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3577 | dense, sparse | dense: 0.570, sparse: 0.179 |
| 7 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.3546 | sparse, graph | sparse: 0.127, graph: 0.789 |
| 8 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3502 | dense, sparse | dense: 0.530, sparse: 0.149 |
| 9 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3424 | dense, sparse | dense: 0.513, sparse: 0.149 |
| 10 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3362 | dense, sparse | dense: 0.521, sparse: 0.132 |

