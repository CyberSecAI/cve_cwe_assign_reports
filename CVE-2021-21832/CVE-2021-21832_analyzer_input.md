# Vulnerability Information: CVE-2021-21832

## Vulnerability Description
**A memory corruption vulnerability** exists in the ISO Parsing functionality of Disc Soft Ltd Deamon Tools Pro 8.3.0.0767. A specially crafted malformed file can lead to an out-of-bounds write. An attacker can provide a malicious file to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **A memory corruption vulnerability**
- **vector:** malformed file
- **attacker:** attacker
- **product:** Disc Soft Ltd Deamon Tools Pro
- **version:** 8.3.0.0767
- **component:** ISO Parsing functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: An integer overflow occurs when parsing a crafted ISO file. The size of a directory record is read from the ISO, shifted left by 4 bits, and used as the size for a `malloc` call. Because the shift operation is done in a 32-bit register, an overflow can occur, causing a small or zero-size buffer to be allocated. Subsequent writes to this small buffer will cause a heap out-of-bounds write.
- **Weaknesses/vulnerabilities present**: Integer overflow leading to heap out-of-bounds write.
- **Impact of exploitation**: Memory corruption, leading to a crash. The report doesn't specify if arbitrary code execution is possible, but an attacker could potentially achieve it by further exploiting the memory corruption.
- **Attack vectors**: A specially crafted ISO file needs to be provided to the vulnerable software.
- **Required attacker capabilities/position**: The attacker must be able to provide a malicious ISO file to the vulnerable application. No special position is required, and no user interaction is needed other than opening the crafted file with the vulnerable software.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.7826 | dense, sparse, graph | dense: 0.533, sparse: 0.277, graph: 1.000 |
| 2 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.7638 | dense, sparse, graph | dense: 0.510, sparse: 0.264, graph: 1.000 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7444 | dense, sparse, graph | dense: 0.516, sparse: 0.291, graph: 0.895 |
| 4 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.6194 | dense, sparse, graph | dense: 0.489, sparse: 0.262, graph: 0.772 |
| 5 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.4720 | sparse, graph | sparse: 0.269, graph: 1.000 |
| 6 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3626 | dense, sparse | dense: 0.489, sparse: 0.237 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3512 | dense, sparse | dense: 0.497, sparse: 0.230 |
| 8 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3510 | sparse, graph | sparse: 0.238, graph: 0.602 |
| 9 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.3431 | sparse, graph | sparse: 0.224, graph: 0.602 |
| 10 | CWE-788 | Access of Memory Location After End of Buffer | Base | Discouraged | 0.2722 | dense, sparse | dense: 0.483, sparse: 0.231 |

