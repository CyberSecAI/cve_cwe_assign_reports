# Vulnerability Information: CVE-2022-35887

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the web interface /action/wirelessConnect functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9Z and 6.9X. A specially-crafted HTTP request can lead to memory corruption, information disclosure and denial of service. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.This vulnerability arises from **format string injection** via the `default_key_id` HTTP parameter, as used within the `/action/wirelessConnect` handler.

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9Z and 6.9X
- **component:** /action/wirelessConnect functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `log` function uses `vsnprintf` with a format string controlled by the attacker.
- **Weaknesses/vulnerabilities present**: Format string injection vulnerability. The `log` function takes a user-controlled string from the `default_key_id` parameter, which is used as the format string argument to the `vsnprintf` function.
- **Impact of exploitation**: Memory corruption, information disclosure, and denial of service. Specifically, an attacker can leak stack memory and potentially write arbitrary memory using format string specifiers. However, output from format string injections stemming from misuse of the `log` function will only be available to a physically present attacker who has partially disassembled the device and connected to the UART console.
- **Attack vectors**: An authenticated HTTP request to the `/action/wirelessConnect` endpoint.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the device's web interface after enabling it and changing the admin password. The attacker also needs physical access to the device's UART console to observe the output of the format string injection.

The content provides more detail than the official CVE description by providing the vulnerable code snippets, explanation of the vulnerability, and exploitation example.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.0465 | dense, sparse, graph | dense: 0.696, sparse: 0.825, graph: 0.634 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7098 | dense, sparse, graph | dense: 0.597, sparse: 0.342, graph: 0.602 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5667 | sparse, graph | sparse: 0.366, graph: 1.000 |
| 4 | CWE-1287 | Improper Validation of Specified Type of Input | Base | Allowed | 0.4976 | sparse, graph | sparse: 0.319, graph: 0.882 |
| 5 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4589 | dense, sparse | dense: 0.559, sparse: 0.313 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4372 | dense, sparse | dense: 0.565, sparse: 0.306 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4227 | dense, sparse | dense: 0.571, sparse: 0.301 |
| 8 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2078 | dense, sparse | dense: 0.552, sparse: 0.329 |
| 9 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.1812 | sparse | sparse: 0.317 |
| 10 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1792 | sparse | sparse: 0.313 |

