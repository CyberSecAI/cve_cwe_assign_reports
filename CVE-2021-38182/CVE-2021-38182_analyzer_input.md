# Vulnerability Information: CVE-2021-38182

## Vulnerability Description
Due to **insufficient input validation** of Kyma, authenticated users can pass a Header of their choice and escalate privileges which can completely compromise the cluster.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input validation**
- **impact:** pass Header of their choice and escalate privileges and completely compromise the cluster
- **attacker:** authenticated users
- **product:** Kyma

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
- Insufficient input validation of the "Connection" header in Kyma's apiserver-proxy component.

**Weaknesses/vulnerabilities present:**
- Header Manipulation: The application does not properly sanitize or validate the "Connection" header, allowing attackers to inject arbitrary values.
- CWE-20: Improper Input Validation
- CWE-644: Improper Neutralization of HTTP Headers

**Impact of exploitation:**
- Privilege escalation: An authenticated user can inject malicious headers, potentially gaining elevated privileges and completely compromising the cluster.
- Confidentiality, Integrity, and Availability: Exploitation can lead to high impact on confidentiality, integrity, and availability of the affected system.

**Attack vectors:**
- Network: The vulnerability can be exploited remotely over the network.
- The attack complexity is low

**Required attacker capabilities/position:**
- Low Privileges Required: An attacker needs to be an authenticated user to exploit this vulnerability.
- No User Interaction is required for the exploitation

**Additional Details:**

- The vulnerability affects Kyma versions prior to 1.24.7.
- The issue was patched in version 1.24.7.
- CVSS v3 score: 8.8 (High).
- CVSS v3 vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
- The vulnerable component is located in `components/apiserver-proxy/internal/proxy`.
- The "Connection" header is the vehicle of the attack

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.5065 | dense, sparse, graph | dense: 0.471, sparse: 0.114, graph: 0.575 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3873 | sparse, graph | sparse: 0.126, graph: 0.882 |
| 3 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.3224 | sparse, graph | sparse: 0.121, graph: 0.783 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.2908 | dense, sparse | dense: 0.449, sparse: 0.115 |
| 5 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2568 | dense, sparse, graph | dense: 0.440, sparse: 0.143, graph: 0.760 |
| 6 | CWE-345 | Insufficient Verification of Data Authenticity | Class | Discouraged | 0.1539 | sparse, graph | sparse: 0.126, graph: 0.760 |
| 7 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1299 | dense, sparse | dense: 0.445, sparse: 0.118 |
| 8 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.0696 | sparse | sparse: 0.122 |
| 9 | CWE-356 | Product UI does not Warn User of Unsafe Actions | Base | Allowed | 0.0686 | sparse | sparse: 0.120 |
| 10 | CWE-444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | Allowed | 0.0675 | sparse | sparse: 0.118 |

