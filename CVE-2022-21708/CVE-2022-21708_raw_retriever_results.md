# Raw Retriever Results for CVE-2022-21708

# Raw Retriever Results for CVE-2022-21708

## Query
graphql-go is a GraphQL server with a focus on ease of use. In versions prior to 1.3.0 there exists a DoS vulnerability that is possible due to a bug in the library that would allow an attacker with specifically designed queries to cause stack overflow panics. Any user with access to the GraphQL handler can send these queries and cause stack overflows. This in turn could potentially compromise the ability of the server to serve data to its users. The issue has been patched in version `v1.3.0`. The only known workaround for this issue is to disable the `graphql.MaxDepth` option from your schema which is not recommended.

## Keyphrases
- **rootcause**: bug in the library
- **weakness**: stack overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4248 | 0.5185 | 0.4424 | 0.4361 | 20 |
| Sparse | 630.1269 | 1462.1903 | 1054.1910 | 1053.7250 | 20 |
| Graph | 1.4016 | 2.3296 | 1.7708 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.3296 | Allowed |
| 2 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 3 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 4 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.0316 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.7962 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 9 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 11 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 12 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 13 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.6221 | Allowed |
| 15 | 823 | Use of Out-of-range Pointer Offset | base | 1.6016 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 674 | Uncontrolled Recursion | Class | 0.5185 | 0.5185 | Allowed-with-Review |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4828 | 0.4828 | Allowed |
| 3 | 121 | Stack-based Buffer Overflow | Variant | 0.4552 | 0.4552 | Allowed |
| 4 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4519 | 0.4519 | Allowed-with-Review |
| 5 | 676 | Use of Potentially Dangerous Function | Base | 0.4453 | 0.4453 | Allowed |
| 6 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 0.4446 | 0.4446 | Allowed |
| 7 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.4391 | 0.4391 | Allowed |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4391 | 0.4391 | Allowed |
| 9 | 1176 | Inefficient CPU Computation | Class | 0.4375 | 0.4375 | Allowed-with-Review |
| 10 | 190 | Integer Overflow or Wraparound | Base | 0.4369 | 0.4369 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4353 | 0.4353 | Allowed |
| 12 | 193 | Off-by-one Error | Base | 0.4328 | 0.4328 | Allowed |
| 13 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4319 | 0.4319 | Allowed |
| 14 | 346 | Origin Validation Error | Class | 0.4311 | 0.4311 | Allowed-with-Review |
| 15 | 126 | Buffer Over-read | Variant | 0.4295 | 0.4295 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-674 | Uncontrolled Recursion | 1462.1903 | 1462.1903 | Allowed-with-Review |
| 2 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1136.9803 | 1136.9803 | Allowed |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | 1097.1726 | 1097.1726 | Allowed |
| 4 | CWE-943 | Improper Neutralization of Special Elements in Data Query Logic | 1096.4419 | 1096.4419 | Allowed-with-Review |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1085.0204 | 1085.0204 | Allowed |
| 6 | CWE-789 | Memory Allocation with Excessive Size Value | 1071.4954 | 1071.4954 | Allowed |
| 7 | CWE-696 | Incorrect Behavior Order | 1067.6874 | 1067.6874 | Allowed-with-Review |
| 8 | CWE-190 | Integer Overflow or Wraparound | 1064.1666 | 1064.1666 | Allowed |
| 9 | CWE-863 | Incorrect Authorization | 1059.7338 | 1059.7338 | Allowed-with-Review |
| 10 | CWE-1333 | Inefficient Regular Expression Complexity | 1055.3647 | 1055.3647 | Allowed |
| 11 | CWE-121 | Stack-based Buffer Overflow | 1052.0852 | 1052.0852 | Allowed |
| 12 | CWE-125 | Out-of-bounds Read | 1040.4127 | 1040.4127 | Allowed |
| 13 | CWE-285 | Improper Authorization | 1034.7391 | 1034.7391 | Discouraged |
| 14 | CWE-20 | Improper Input Validation | 1025.9507 | 1025.9507 | Discouraged |
| 15 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | 1024.5188 | 1024.5188 | Allowed |
