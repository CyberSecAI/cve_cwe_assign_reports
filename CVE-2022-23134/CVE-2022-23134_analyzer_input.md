# Vulnerability Information: CVE-2022-23134

## Vulnerability Description
After the initial setup process, some steps of setup.php file are reachable not only by super-administrators, but by unauthenticated users as well. Malicious actor can pass step checks and potentially change the configuration of Zabbix Frontend.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access control**
- **impact:** change configuration of Zabbix Frontend
- **vector:** pass step checks
- **attacker:** unauthenticated users
- **product:** setup.php file

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2022-23134:

**Root Cause of Vulnerability:**
- The vulnerability stems from the fact that after the initial setup of Zabbix, certain steps within the `setup.php` file remain accessible to unauthenticated users. This was due to a lack of proper access controls after the initial setup process.

**Weaknesses/Vulnerabilities Present:**
- **Broken Access Control:**  The core issue is that the `setup.php` file, which should only be accessible to administrators, could be reached by unauthenticated users under certain circumstances (after initial setup).

**Impact of Exploitation:**
- **Configuration Tampering:** An attacker could bypass the checks within `setup.php` and potentially modify the Zabbix Frontend configuration. This could lead to a variety of malicious actions, such as:
    - Injecting malicious scripts into the web interface
    - Creating unauthorized user accounts
    - Redirecting user traffic
    - Disabling or disrupting monitoring capabilities

**Attack Vectors:**
- **Network Access:** The attack vector involves network access to the Zabbix Frontend, where the attacker can directly interact with the vulnerable `setup.php` file if the config file already exists.
- **Unauthenticated Requests:** The attacker does not need to be authenticated to exploit this vulnerability.

**Required Attacker Capabilities/Position:**
- **Network Access:**  The attacker needs to have network connectivity to the Zabbix server hosting the vulnerable web interface.
- **Basic Web Knowledge:** The attacker needs the knowledge of how to interact with a web application and its associated files.

**Additional Details:**
- **Severity:** The vulnerability is considered "Low" severity.
- **Affected Versions:**  Zabbix versions 5.4.0 - 5.4.8 and 6.0.0 - 6.0.0beta1 are affected.
- **Workaround:** If immediate patching is not feasible, a workaround is to remove the `setup.php` file.
- **Fix:** The vulnerability is fixed in Zabbix versions 5.4.9rc2, 6.0.0beta2 and 6.0 (plan).

The content provides more detail than the basic description of the CVE, including the specific file involved (`setup.php`), the attack vector (unauthenticated network access), and potential impact scenarios.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5166 | dense, sparse, graph | dense: 0.415, sparse: 0.164, graph: 0.601 |
| 2 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.3908 | dense, sparse, graph | dense: 0.413, sparse: 0.177, graph: 0.561 |
| 3 | CWE-290 | Authentication Bypass by Spoofing | Base | Allowed | 0.3167 | sparse, graph | sparse: 0.160, graph: 0.630 |
| 4 | CWE-841 | Improper Enforcement of Behavioral Workflow | Base | Allowed | 0.2877 | dense, sparse | dense: 0.405, sparse: 0.149 |
| 5 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.2847 | dense, sparse | dense: 0.405, sparse: 0.143 |
| 6 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1713 | sparse, graph | sparse: 0.160, graph: 0.814 |
| 7 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.1695 | dense, sparse | dense: 0.410, sparse: 0.145 |
| 8 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.0997 | dense, sparse | dense: 0.416, sparse: 0.155 |
| 9 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.0856 | sparse | sparse: 0.150 |
| 10 | CWE-59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | 0.0842 | sparse | sparse: 0.147 |

