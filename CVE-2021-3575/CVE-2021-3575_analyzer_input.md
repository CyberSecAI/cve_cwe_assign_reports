# Vulnerability Information: CVE-2021-3575

## Vulnerability Description
A **heap-based buffer overflow** was found in openjpeg in color.c37942 in sycc420_to_rgb when decompressing a crafted .j2k file. An attacker could use this to execute arbitrary code with the permissions of the application compiled against openjpeg.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-based buffer overflow**
- **impact:** arbitrary code execution
- **vector:** crafted .j2k file
- **attacker:** attacker
- **product:** openjpeg
- **component:** sycc420_to_rgb in color.c37942

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2021-3575:

**Root Cause:**
- The vulnerability is a heap-based buffer overflow located in the `sycc420_to_rgb` function within the `color.c` file of the OpenJPEG library. Specifically, the issue occurs at line 379, column 42. The root cause is insufficient validation of the `*cb` value, which leads to out-of-bounds read when decompressing a crafted J2K file, this occurs when x0 and y0 values are odd.

**Weaknesses/Vulnerabilities:**
- Heap-based buffer overflow: Reading past the allocated buffer.

**Impact of Exploitation:**
-  The primary impact is the potential for arbitrary code execution. An attacker could exploit this vulnerability by crafting a malicious .j2k file that, when decompressed, triggers the buffer overflow. This could allow the attacker to execute code with the privileges of the application linked with the vulnerable OpenJPEG library.
-  Denial of Service (DoS): The vulnerability could also lead to a denial-of-service condition, if the overflow causes the application to crash.

**Attack Vectors:**
- The attack vector is local, meaning an attacker would need to have access to the local system to execute the crafted j2k file.
- The attacker can exploit this vulnerability by providing a malicious j2k file to a vulnerable application linked with the OpenJPEG library, which processes user supplied images for decompression.
 
**Required Attacker Capabilities/Position:**
- An attacker needs to be able to provide a crafted j2k file to the application using the vulnerable OpenJPEG library.
- No special privileges are needed to trigger this vulnerability, however user interaction is required.
- An attacker would need to have some knowledge on how the openjpeg library works to craft the malicious j2k file.

**Additional Details:**
- The vulnerability is triggered during the decompression of a specially crafted .j2k file.
- The issue affects multiple versions of the OpenJPEG library, including versions 2.3.1 to 2.4.0 and current master.
- The vulnerability has a CVSS v3 severity score of 7.8 (High).
- Patches were created for the vulnerability, and have been included in updated packages for various linux distributions.
- The fix was implemented and merged into the project via the pull request [#1509](https://github.com/uclouvain/openjpeg/pull/1509) with commit `7bd884f`.

This information is more detailed than what is provided in the official CVE description, which is a placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7268 | dense, sparse, graph | dense: 0.548, sparse: 0.217, graph: 0.918 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7012 | dense, sparse, graph | dense: 0.598, sparse: 0.233, graph: 0.751 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5761 | dense, sparse, graph | dense: 0.583, sparse: 0.227, graph: 0.567 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4781 | sparse, graph | sparse: 0.211, graph: 1.000 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4229 | dense, sparse | dense: 0.630, sparse: 0.250 |
| 6 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.4027 | sparse, graph | sparse: 0.196, graph: 0.813 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3941 | dense, sparse | dense: 0.550, sparse: 0.208 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3912 | dense, sparse | dense: 0.544, sparse: 0.208 |
| 9 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3733 | dense, sparse | dense: 0.526, sparse: 0.193 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3731 | dense, sparse | dense: 0.572, sparse: 0.206 |

