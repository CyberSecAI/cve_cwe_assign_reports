# Vulnerability Information: CVE-2022-35875

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the XCMD testWifiAP functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9X and 6.9Z. Specially-crafted configuration values can lead to memory corruption, information disclosure and denial of service. An attacker can modify a configuration value and then execute an XCMD to trigger these vulnerabilities.This vulnerability arises from **format string injection** via the `wpapsk` configuration parameter, as used within the `testWifiAP` XCMD handler

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9X and 6.9Z
- **component:** XCMD testWifiAP functionality

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `log` function uses `vsnprintf` with a format string that can be controlled by an attacker through the device's configuration parameters. This function is used to create log messages, and the format string vulnerability allows an attacker to read stack memory and potentially write arbitrary memory via format string specifiers.",
  "Weaknesses/vulnerabilities present": [
    "Format string injection vulnerability in the `log` function due to the use of attacker-controlled input as the format string parameter in `vsnprintf`."
  ],
  "Impact of exploitation": "An attacker can cause memory corruption, information disclosure (reading stack memory) and potentially achieve denial of service. The format string vulnerability is exposed on the device's UART console.",
  "Attack vectors": "The attacker can modify Wi-Fi configuration parameters via mobile application, web application, `setWifiAP` XCMD, `/action/wirelessPost` or `/action/configPost` endpoints, then trigger the vulnerable `testWifiAP` XCMD via UDP/55050. The format string injection is triggered within the `do_test_wifiap` function when processing the configuration data for logging purposes.",
  "Required attacker capabilities/position": "The attacker must be able to modify the device's Wi-Fi configuration via the mobile application, the web application or using the exposed API endpoints. The attacker needs network access to the device to send the `testWifiAP` XCMD via UDP/55050. To view the output of the format string injection, physical access to the device's UART console is required."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.1118 | dense, sparse, graph | dense: 0.707, sparse: 0.881, graph: 0.711 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7179 | dense, sparse, graph | dense: 0.622, sparse: 0.332, graph: 0.606 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5404 | sparse, graph | sparse: 0.320, graph: 1.000 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5071 | sparse, graph | sparse: 0.335, graph: 0.882 |
| 5 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.4578 | dense, sparse | dense: 0.565, sparse: 0.306 |
| 6 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4501 | sparse, graph | sparse: 0.294, graph: 0.789 |
| 7 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4388 | dense, sparse | dense: 0.575, sparse: 0.300 |
| 8 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2085 | dense, sparse | dense: 0.574, sparse: 0.312 |
| 9 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.1783 | sparse | sparse: 0.312 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.1780 | sparse | sparse: 0.311 |

