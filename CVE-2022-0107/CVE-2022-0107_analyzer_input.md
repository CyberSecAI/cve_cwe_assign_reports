# Vulnerability Information: CVE-2022-0107

## Vulnerability Description
Use after free in File Manager API in Google Chrome on Chrome OS prior to 97.0.4692.71 allowed an attacker who convinced a user to install a malicious extension to potentially exploit **heap corruption** via a crafted HTML page.

### Vulnerability Description Key Phrases
- **rootcause:** **use after free**
- **weakness:** **heap corruption**
- **vector:** crafted HTML page
- **attacker:** attacker who convinced a user to install a malicious extension
- **product:** Google Chrome on Chrome OS
- **version:** prior to 97.0.4692.71
- **component:** File Manager API

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2022-0107:

**Root Cause of Vulnerability:**
- Use-after-free (UAF) vulnerability.

**Weaknesses/Vulnerabilities Present:**
- The vulnerability is located in the File Manager API of the Chromium browser.
- It involves a use-after-free condition, meaning a program attempts to access memory that has already been freed.

**Impact of Exploitation:**
- Exploitation could lead to arbitrary code execution.
- Other potential impacts include denial of service (crashes), data corruption, or information disclosure.

**Attack Vectors:**
- The attack vector is through the File Manager API, which is part of the browser functionality.
- It would require a malicious website or code that can trigger the vulnerable condition in the File Manager API.

**Required Attacker Capabilities/Position:**
- The attacker would need to be able to interact with the vulnerable File Manager API, which would likely require a malicious web page or other malicious content that the victim interacts with through the browser.
- The attacker would need the ability to trigger the use-after-free condition to exploit the vulnerability.

**Additional Notes:**
- The vulnerability was reported by raven (@raid_akame) on 2021-09-10.
- The severity of this vulnerability is considered "Medium".
- It was fixed in Chrome version 97.0.4692.71.
- Fedora also issued updates to address the vulnerability in their Chromium packages on versions 34, 35, and 36.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-416 | Use After Free | Variant | Allowed | 0.8866 | dense, sparse, graph | dense: 0.646, sparse: 0.620, graph: 0.791 |
| 2 | CWE-366 | Race Condition within a Thread | Base | Allowed | 0.8068 | dense, sparse, graph | dense: 0.574, sparse: 0.523, graph: 0.617 |
| 3 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.7461 | dense, sparse, graph | dense: 0.502, sparse: 0.436, graph: 0.685 |
| 4 | CWE-1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | 0.6653 | dense, sparse, graph | dense: 0.528, sparse: 0.317, graph: 0.615 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4793 | dense, sparse | dense: 0.527, sparse: 0.447 |
| 6 | CWE-415 | Double Free | Variant | Allowed | 0.4350 | dense, sparse | dense: 0.527, sparse: 0.363 |
| 7 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.3990 | dense, sparse, graph | dense: 0.494, sparse: 0.365, graph: 0.624 |
| 8 | CWE-356 | Product UI does not Warn User of Unsafe Actions | Base | Allowed | 0.3761 | dense, sparse | dense: 0.537, sparse: 0.187 |
| 9 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.3536 | dense, sparse | dense: 0.501, sparse: 0.180 |
| 10 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3187 | sparse, graph | sparse: 0.181, graph: 0.602 |

