# Vulnerability Information: CVE-2022-36620

## Vulnerability Description
D-link DIR-816 A2_v1.10CNB04, DIR-878 DIR_878_FW1.30B08.img is vulnerable to Buffer Overflow via /goform/addRouting.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** D-link DIR-816 and DIR-878
- **version:** A2_v1.10CNB04 and FW1.30B08
- **component:** /goform/addRouting

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "A stack buffer overflow vulnerability exists in the `/goform/addRouting` endpoint. The `netmask` parameter's content is copied into a stack buffer without any size checks.",
    "weaknesses": [
      "Stack-based buffer overflow",
      "Lack of input validation",
      "Unsafe memory operations"
    ],
    "impact": "The vulnerability can cause a denial of service (router crash) and potentially lead to arbitrary code execution if an attacker crafts a malicious payload to overwrite the return address on the stack.",
    "attack_vectors": [
      "HTTP POST request to `/goform/addRouting`",
      "Sending a crafted payload as the `netmask` parameter"
    ],
    "required_capabilities": [
      "Attacker needs to be able to access the router's web interface, which might require being on the same network or having gained access through other vulnerabilities.",
      "Knowledge of the required tokenid parameter (obtainable by parsing the webpage)"
    ]
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.5461 | dense, sparse, graph | dense: 0.553, sparse: 0.087, graph: 0.614 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4774 | dense, sparse, graph | dense: 0.498, sparse: 0.079, graph: 0.576 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3608 | sparse, graph | sparse: 0.111, graph: 0.832 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3369 | dense, sparse | dense: 0.596, sparse: 0.116 |
| 5 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3177 | sparse, graph | sparse: 0.062, graph: 0.789 |
| 6 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.2674 | dense, sparse | dense: 0.508, sparse: 0.062 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.2595 | dense, sparse | dense: 0.493, sparse: 0.060 |
| 8 | CWE-77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | 0.1813 | dense, sparse | dense: 0.548, sparse: 0.060 |
| 9 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1223 | dense, sparse | dense: 0.478, sparse: 0.059 |
| 10 | CWE-193 | Off-by-one Error | Base | Allowed | 0.0350 | sparse | sparse: 0.061 |

