# Vulnerability Information: CVE-2021-21960

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in both the LLMNR functionality of Sealevel Systems, Inc. SeaConnect 370W v1.3.34. A specially-crafted network packet can lead to remote code execution. An attacker can send a malicious packet to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially-crafted network packet
- **attacker:** attacker
- **product:** Sealevel Systems SeaConnect 370W
- **version:** v1.3.34
- **component:** LLMNR functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 39)
- CWE-120 (Count: 2)
- CWE-119 (Count: 1)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A stack-based buffer overflow vulnerability exists in the LLMNR and NBNS implementations of the Sealevel Systems, Inc. SeaConnect 370W device. This is due to a lack of bounds checking when copying the queried name from a network packet into a fixed-size stack buffer.

- **Weaknesses/vulnerabilities present:**
    - **CWE-121 Stack-based Buffer Overflow:** The code directly copies data from a network packet into a fixed-size stack buffer without checking the length of the incoming data. This allows an attacker to write beyond the bounds of the buffer, overwriting adjacent memory on the stack.
    - **Lack of Input Validation:** The application does not validate the length of the queried name before copying it into the buffer.

- **Impact of exploitation:**
    - **Remote Code Execution:** By overflowing the buffer on the stack, an attacker can overwrite the return address, allowing them to control the program counter and execute arbitrary code on the device.
    - **Device Compromise:** Successful exploitation allows an attacker to fully compromise the vulnerable device, potentially allowing them to control connected I/O, pivot to other networks, or use the device as part of a botnet.

- **Attack vectors:**
    - **Network Packet Injection:** An attacker can send a specially crafted network packet containing a malicious LLMNR or NBNS query to the target device.
    - **Targeted Services:** The vulnerability affects the LLMNR (UDP port 5355) and NBNS (UDP port 137) services.

- **Required attacker capabilities/position:**
    - **Network Access:** The attacker needs to be on the same network as the vulnerable device or have network access to reach it.
    - **Packet Forging:** The attacker needs to be able to forge network packets.
    - **No Authentication Required:** The vulnerabilities can be triggered by sending a crafted packet; no prior authentication is required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7600 | dense, sparse, graph | dense: 0.545, sparse: 0.290, graph: 1.000 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7160 | dense, sparse, graph | dense: 0.527, sparse: 0.251, graph: 0.863 |
| 3 | CWE-170 | Improper Null Termination | Base | Allowed | 0.5162 | sparse, graph | sparse: 0.277, graph: 1.000 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4501 | sparse, graph | sparse: 0.267, graph: 0.832 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4288 | dense, sparse | dense: 0.620, sparse: 0.270 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3880 | dense, sparse | dense: 0.524, sparse: 0.220 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3817 | dense, sparse | dense: 0.523, sparse: 0.209 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3774 | dense, sparse | dense: 0.538, sparse: 0.244 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3575 | dense, sparse | dense: 0.528, sparse: 0.215 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2259 | dense, sparse | dense: 0.518, sparse: 0.219 |

