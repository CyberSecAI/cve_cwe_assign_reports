# Vulnerability Information: CVE-2021-4099

## Vulnerability Description
Use after free in Swiftshader in Google Chrome prior to 96.0.4664.110 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page.

### Vulnerability Description Key Phrases
- **rootcause:** **use after free**
- **impact:** heap corruption
- **vector:** crafted HTML page
- **attacker:** remote attacker
- **product:** Google Chrome
- **version:** prior to 96.0.4664.110
- **component:** Swiftshader

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-416

#### Top CWEs
- CWE-416 (Count: 989)
- CWE-787 (Count: 230)
- CWE-362 (Count: 16)

## CVE Reference Links Content Summary
The provided content is related to CVE-2021-4099.

**Root cause of vulnerability:**
- Use-after-free in Swiftshader.

**Weaknesses/vulnerabilities present:**
- Use-after-free vulnerability.

**Impact of exploitation:**
- The vulnerability is rated as "High" severity.
- Exploitation can lead to arbitrary code execution, denial of service, or information disclosure.

**Attack vectors:**
- The vulnerability exists in Swiftshader, which is a software rasterizer used by Chrome.
- An attacker would need to trigger the use-after-free condition in Swiftshader through a specially crafted input that utilizes the graphics API.

**Required attacker capabilities/position:**
- An attacker would need to be able to influence the input to the Swiftshader module. This could potentially be achieved through a malicious website, or other means that cause the application to process untrusted content.
- The attacker would likely need to have some knowledge of the Swiftshader API.

**Additional details:**
- The vulnerability was reported by Aki Helin of Solita on 2021-11-16.
- A reward of $5000 was given for reporting this issue.
- The fix is included in Chrome version 96.0.4664.110.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-416 | Use After Free | Variant | Allowed | 0.7087 | dense, sparse, graph | dense: 0.656, sparse: 0.255, graph: 0.821 |
| 2 | CWE-366 | Race Condition within a Thread | Base | Allowed | 0.6514 | dense, sparse, graph | dense: 0.609, sparse: 0.225, graph: 0.610 |
| 3 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | 0.6251 | dense, sparse, graph | dense: 0.521, sparse: 0.206, graph: 0.691 |
| 4 | CWE-415 | Double Free | Variant | Allowed | 0.6194 | dense, sparse, graph | dense: 0.557, sparse: 0.178, graph: 0.813 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3517 | dense, sparse | dense: 0.553, sparse: 0.182 |
| 6 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3340 | dense, sparse | dense: 0.515, sparse: 0.133 |
| 7 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.3330 | dense, sparse | dense: 0.509, sparse: 0.137 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3318 | dense, sparse | dense: 0.514, sparse: 0.131 |
| 9 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.2071 | dense, sparse | dense: 0.509, sparse: 0.171 |
| 10 | CWE-451 | User Interface (UI) Misrepresentation of Critical Information | Class | Allowed-with-Review | 0.2030 | dense, sparse | dense: 0.520, sparse: 0.149 |

