# Vulnerability Information: CVE-2021-21961

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in the NBNS functionality of Sealevel Systems, Inc. SeaConnect 370W v1.3.34. A specially-crafted network packet can lead to remote code execution. An attacker can send a malicious packet to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially-crafted network packet
- **attacker:** attacker
- **product:** Sealevel Systems Inc. SeaConnect 370W
- **version:** v1.3.34
- **component:** NBNS functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 33)
- CWE-1284 (Count: 6)
- CWE-120 (Count: 2)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability stems from a stack-based buffer overflow in the parsing of network queries within the LLMNR and NBNS services of the SeaConnect 370W device. Specifically, the device's firmware does not perform bounds checking when copying the queried name from an incoming packet to a fixed-size buffer on the stack.

- **Weaknesses/vulnerabilities present**: The primary weakness is the lack of input validation when handling the length field within LLMNR and NBNS packets. The code directly uses the attacker-provided length field to control the number of bytes copied, without checking if it exceeds the bounds of the destination buffer.
    -  CWE-121: Stack-based Buffer Overflow

- **Impact of exploitation**: A successful exploit can lead to remote code execution. By overflowing the stack buffer, an attacker can overwrite the return address on the stack, allowing them to hijack the program's control flow and execute arbitrary code on the device.

- **Attack vectors**: The attack vector is through specially crafted network packets sent to the device's LLMNR (port 5355) and NBNS (port 137) services.

- **Required attacker capabilities/position**: The attacker needs to be able to send UDP packets to the target device on ports 5355 or 137. No authentication is required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7584 | dense, sparse, graph | dense: 0.516, sparse: 0.249, graph: 1.000 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7576 | dense, sparse, graph | dense: 0.540, sparse: 0.290, graph: 1.000 |
| 3 | CWE-170 | Improper Null Termination | Base | Allowed | 0.5162 | sparse, graph | sparse: 0.277, graph: 1.000 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4468 | sparse, graph | sparse: 0.261, graph: 0.832 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4304 | dense, sparse | dense: 0.624, sparse: 0.269 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3848 | dense, sparse | dense: 0.517, sparse: 0.220 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3826 | dense, sparse | dense: 0.525, sparse: 0.209 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3792 | dense, sparse | dense: 0.544, sparse: 0.242 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3612 | dense, sparse | dense: 0.536, sparse: 0.215 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1748 | dense, sparse | dense: 0.536, sparse: 0.214 |

