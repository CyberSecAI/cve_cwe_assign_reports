# Vulnerability Information: CVE-2022-35244

## Vulnerability Description
A **format string injection** vulnerability exists in the XCMD getVarHA functionality of abode systems, inc. iota All-In-One Security Kit 6.9X and 6.9Z. A specially-crafted XCMD can lead to memory corruption, information disclosure, and denial of service. An attacker can send a malicious XML payload to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **vector:** malicious XML payload
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9X and 6.9Z
- **component:** XCMD getVarHA functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `getVarHA` XCMD handler in the Abode iota All-In-One Security Kit uses an attacker-controlled string (HA variable name set via `setVarHA` XCMD) as the format string in `xvsprintfcat`. This function is used within `xml_construct_response` to build an XML response.
- **Weaknesses/vulnerabilities present**: Format string injection vulnerability (CWE-134).
- **Impact of exploitation**:
    - Memory corruption: By crafting a specific format string, an attacker can overwrite memory.
    - Information disclosure: Stack data can be leaked by using format string specifiers like `%x`.
    - Denial of service (DoS): Using the `%n` specifier, an attacker can attempt to write to invalid memory addresses, causing a segmentation fault and crashing the device.
- **Attack vectors**: The attacker sends a malicious XML payload containing the `setVarHA` XCMD with a crafted variable name, followed by a `getVarHA` XCMD to trigger the format string vulnerability.
- **Required attacker capabilities/position**: An attacker needs to be able to send XCMDs to the device, which can be done via UDP/55050 without authentication. The attacker must also know the MAC address of the target device, which is transmitted in the XCMD.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 0.8820 | dense, sparse, graph | dense: 0.634, sparse: 0.550, graph: 0.699 |
| 2 | CWE-1287 | Improper Validation of Specified Type of Input | Base | Allowed | 0.4678 | sparse, graph | sparse: 0.235, graph: 0.932 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4330 | sparse, graph | sparse: 0.237, graph: 0.832 |
| 4 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.4324 | sparse, graph | sparse: 0.235, graph: 0.934 |
| 5 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4092 | dense, sparse | dense: 0.556, sparse: 0.229 |
| 6 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.3898 | sparse, graph | sparse: 0.235, graph: 0.714 |
| 7 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3755 | dense, sparse | dense: 0.538, sparse: 0.217 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3755 | dense, sparse | dense: 0.555, sparse: 0.225 |
| 9 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3444 | sparse, graph | sparse: 0.226, graph: 0.602 |
| 10 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1770 | dense, sparse | dense: 0.533, sparse: 0.225 |

