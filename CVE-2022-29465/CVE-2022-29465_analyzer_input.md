# Vulnerability Information: CVE-2022-29465

## Vulnerability Description
An **out-of-bounds write** vulnerability exists in the PSD Header processing memory allocation functionality of Accusoft ImageGear 20.0. A specially-crafted malformed file can lead to memory corruption. An attacker can provide a malicious file to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **out-of-bounds write**
- **impact:** memory corruption
- **vector:** specially-crafted malformed file
- **attacker:** attacker
- **product:** Accusoft ImageGear
- **version:** 20.0
- **component:** PSD Header processing memory allocation functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability lies in the `allocation_function_mem` function of Accusoft ImageGear library, where a missing check for memory bounds within a heap buffer leads to a buffer overflow. Specifically, the size of the allocated buffer (`psd_buffer_oobw`) is calculated based on the width and bits per channel from the PSD file, but this calculation doesn't account for a minimum buffer size when `bits_per_channel` is 1. This allows for a smaller buffer than required, resulting in an out-of-bounds write during subsequent operations.
- **Weaknesses/vulnerabilities present**: An out-of-bounds write vulnerability is present due to insufficient memory allocation in the `allocation_function_mem` function during the processing of PSD files. The buffer `psd_buffer_oobw` can be undersized, leading to writes beyond the allocated region.
- **Impact of exploitation**: Successful exploitation leads to memory corruption, which can potentially result in arbitrary code execution. The crash information shows an access violation due to an attempt to write to an invalid memory address.
- **Attack vectors**: The attack vector is a specially crafted PSD file. An attacker can provide a malicious PSD file that triggers the vulnerability when processed by the vulnerable Accusoft ImageGear library.
- **Required attacker capabilities/position**: The attacker needs to be able to supply a malicious PSD file to the vulnerable application or service using the affected library. No special privileges are required, but the attacker needs to be able to control the contents of the PSD file.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.7883 | dense, sparse, graph | dense: 0.538, sparse: 0.282, graph: 1.000 |
| 2 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.7799 | dense, sparse, graph | dense: 0.537, sparse: 0.269, graph: 1.000 |
| 3 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.7596 | dense, sparse, graph | dense: 0.542, sparse: 0.291, graph: 0.900 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7526 | dense, sparse, graph | dense: 0.533, sparse: 0.289, graph: 0.897 |
| 5 | CWE-129 | Improper Validation of Array Index | Variant | Allowed | 0.6777 | dense, sparse, graph | dense: 0.572, sparse: 0.293, graph: 0.784 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4313 | sparse, graph | sparse: 0.261, graph: 0.789 |
| 7 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.4167 | sparse, graph | sparse: 0.235, graph: 0.789 |
| 8 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.4012 | dense, sparse | dense: 0.533, sparse: 0.235 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3832 | dense, sparse | dense: 0.526, sparse: 0.265 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3555 | dense, sparse | dense: 0.516, sparse: 0.222 |

