# Critic Input for CVE-2020-15935



# Original Analyzer Input
## Vulnerability Description
A **cleartext storage of sensitive information** in GUI in FortiADC versions 5.4.3 and below, 6.0.0 and below may allow a remote authenticated attacker to retrieve some sensitive information such as users LDAP passwords and RADIUS shared secret by deobfuscating the passwords entry fields.

### Vulnerability Description Key Phrases
- **rootcause:** **cleartext storage of sensitive information**
- **impact:** retrieve sensitive information
- **vector:** deobfuscating the passwords entry fields
- **attacker:** remote authenticated attacker
- **product:** FortiADC
- **version:** 5.4.3 and below, 6.0.0 and below
- **component:** GUI

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Cleartext storage of sensitive information in the GUI. Specifically, user passwords (LDAP), RADIUS shared secret, and the Elastic Cloud database password are not properly encrypted.
- **Weaknesses/vulnerabilities present:**
    - Cleartext storage of sensitive data.
    - Lack of proper obfuscation or encryption for password entry fields within the GUI.
- **Impact of exploitation:** A remote authenticated attacker can retrieve sensitive information like LDAP passwords, RADIUS shared secrets, and the Elastic Cloud database password. This can lead to unauthorized access to systems and data.
- **Attack vectors:**
    - The attack is performed remotely via the GUI of affected products.
    - Attackers need to be authenticated to access the GUI.
- **Required attacker capabilities/position:**
    - The attacker must be a remote user with valid credentials to log in to the affected product's GUI.
    - The attacker needs to be able to deobfuscate the password entry fields.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-317 | Cleartext Storage of Sensitive Information in GUI | Variant | Allowed | 0.7290 | dense, sparse, graph | dense: 0.703, sparse: 0.409, graph: 0.570 |
| 2 | CWE-312 | Cleartext Storage of Sensitive Information | Base | Allowed | 0.6950 | dense, sparse, graph | dense: 0.608, sparse: 0.252, graph: 0.689 |
| 3 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.6635 | dense, sparse, graph | dense: 0.584, sparse: 0.262, graph: 0.620 |
| 4 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.6000 | dense, sparse, graph | dense: 0.513, sparse: 0.266, graph: 0.535 |
| 5 | CWE-316 | Cleartext Storage of Sensitive Information in Memory | Variant | Allowed | 0.5838 | dense, sparse, graph | dense: 0.607, sparse: 0.226, graph: 0.557 |
| 6 | CWE-257 | Storing Passwords in a Recoverable Format | Base | Allowed | 0.4997 | dense, sparse, graph | dense: 0.531, sparse: 0.220, graph: 0.301 |
| 7 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.3808 | dense, sparse | dense: 0.517, sparse: 0.214 |
| 8 | CWE-798 | Use of Hard-coded Credentials | Base | Allowed | 0.3807 | dense, sparse | dense: 0.512, sparse: 0.217 |
| 9 | CWE-321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | 0.3744 | dense, sparse | dense: 0.544, sparse: 0.233 |
| 10 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.3279 | dense, sparse, graph | dense: 0.545, sparse: 0.257, graph: 0.387 |



# Analysis to Review
# Summary
| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-317 | Cleartext Storage of Sensitive Information in GUI | 1.0 | Variant | Allowed | Primary CWE |
| CWE-312 | Cleartext Storage of Sensitive Information | 0.75 | Base | Allowed | Secondary Candidate CWE |

## Evidence and Confidence

*   **Confidence Score:** 0.9
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**  
  - *Explanation:* The vulnerability description clearly states a **"cleartext storage of sensitive information in GUI."** This directly aligns with CWE-317 (Cleartext Storage of Sensitive Information in GUI), which is a Variant-level CWE and thus more specific than its parent. The "**root cause**" is also listed as "**cleartext storage of sensitive information**" and the vulnerability description states that the **"component"** is the **"GUI"**. The CVE Reference Links Content Summary further supports this, stating that "user passwords (LDAP), RADIUS shared secret, and the Elastic Cloud database password are not properly encrypted" and are stored in **cleartext** within the GUI. The Retriever Results also lists CWE-317 as the top match. Therefore, CWE-317 is the most appropriate primary CWE.
  
  - *Relationship Analysis:* CWE-317 is a variant of CWE-312 (Cleartext Storage of Sensitive Information). While CWE-312 is applicable, CWE-317 provides a more specific classification due to the vulnerability's location within the GUI. No direct relationships were identified that would alter the primary classification.

- **Confidence Score:**  
  - Confidence: 1.0 (High confidence due to strong evidence from the vulnerability description, CVE reference materials, and retriever results.)

---
- **Analysis and Justification:**
  - *Explanation:* CWE-312 (Cleartext Storage of Sensitive Information) is a valid secondary CWE because it represents the broader class of the vulnerability. While CWE-317 is more specific, CWE-312 captures the fundamental weakness of storing sensitive data in cleartext. As CWE-317 is a variant of CWE-312, the parent is a good secondary candidate to capture the general vulnerability class.

  - *Relationship Analysis:* CWE-312 is a parent of CWE-317. Including CWE-312 provides a broader context for the vulnerability, but is less descriptive than CWE-317.
- **Confidence Score:**
  - Confidence: 0.75 (Moderate confidence as it is a broader classification, but relevant as a parent of the primary CWE.)

# CWE Examples from Database


## Known Examples for CWE-312: Cleartext Storage of Sensitive Information
### Observed Examples
- **CVE-2022-30275** [https://www.cve.org/CVERecord?id=CVE-2022-30275](https://www.cve.org/CVERecord?id=CVE-2022-30275): Remote Terminal Unit (RTU) uses a driver that relies on a password stored in plaintext.
- **CVE-2009-2272** [https://www.cve.org/CVERecord?id=CVE-2009-2272](https://www.cve.org/CVERecord?id=CVE-2009-2272): password and username stored in cleartext in a cookie
- **CVE-2009-1466** [https://www.cve.org/CVERecord?id=CVE-2009-1466](https://www.cve.org/CVERecord?id=CVE-2009-1466): password stored in cleartext in a file with insecure permissions
- **CVE-2009-0152** [https://www.cve.org/CVERecord?id=CVE-2009-0152](https://www.cve.org/CVERecord?id=CVE-2009-0152): chat program disables SSL in some circumstances even when the user says to use SSL.
- **CVE-2009-1603** [https://www.cve.org/CVERecord?id=CVE-2009-1603](https://www.cve.org/CVERecord?id=CVE-2009-1603): Chain: product uses an incorrect public exponent when generating an RSA key, which effectively disables the encryption
- **CVE-2009-0964** [https://www.cve.org/CVERecord?id=CVE-2009-0964](https://www.cve.org/CVERecord?id=CVE-2009-0964): storage of unencrypted passwords in a database
- **CVE-2008-6157** [https://www.cve.org/CVERecord?id=CVE-2008-6157](https://www.cve.org/CVERecord?id=CVE-2008-6157): storage of unencrypted passwords in a database
- **CVE-2008-6828** [https://www.cve.org/CVERecord?id=CVE-2008-6828](https://www.cve.org/CVERecord?id=CVE-2008-6828): product stores a password in cleartext in memory
- **CVE-2008-1567** [https://www.cve.org/CVERecord?id=CVE-2008-1567](https://www.cve.org/CVERecord?id=CVE-2008-1567): storage of a secret key in cleartext in a temporary file
- **CVE-2008-0174** [https://www.cve.org/CVERecord?id=CVE-2008-0174](https://www.cve.org/CVERecord?id=CVE-2008-0174): SCADA product uses HTTP Basic Authentication, which is not encrypted


# Relevant CWE Specifications

## CWE-312: Cleartext Storage of Sensitive Information
**Abstraction:** Base
**Status:** Draft

### Description
The product stores sensitive information in cleartext within a resource that might be accessible to another control sphere.

### Extended Description


Because the information is stored in cleartext (i.e., unencrypted), attackers could potentially read it. Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information.


When organizations adopt cloud services, it can be easier for attackers to access the data from anywhere on the Internet.


In some systems/environments such as cloud, the use of "double encryption" (at both the software and hardware layer) might be required, and the developer might be solely responsible for both layers, instead of shared responsibility with the administrator of the broader system/environment.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-311
ChildOf -> CWE-311
ChildOf -> CWE-922
ParentOf -> CWE-313
ParentOf -> CWE-314
ParentOf -> CWE-315
ParentOf -> CWE-316
ParentOf -> CWE-317
ParentOf -> CWE-318
ParentOf -> CWE-526

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Potential Mitigations
**Mitigation 1:**
- **Phase:** Implementation, System Configuration, Operation
- **Description:** When storing data in the cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to encrypt the data at rest. [REF-1297] [REF-1299] [REF-1301]



### Additional Notes
**[Terminology]** Different people use "cleartext" and "plaintext" to mean the same thing: the lack of encryption. However, within cryptography, these have more precise meanings. Plaintext is the information just before it is fed into a cryptographic algorithm, including already-encrypted text. Cleartext is any information that is unencrypted, although it might be in an encoded form that is not easily human-readable (such as base64 encoding).



### Observed Examples
- **CVE-2022-30275:** Remote Terminal Unit (RTU) uses a driver that relies on a password stored in plaintext.
- **CVE-2009-2272:** password and username stored in cleartext in a cookie
- **CVE-2009-1466:** password stored in cleartext in a file with insecure permissions



## CWE-317: Cleartext Storage of Sensitive Information in GUI
**Abstraction:** Variant
**Status:** Draft

### Description
The product stores sensitive information in cleartext within the GUI.

### Extended Description
An attacker can often obtain data from a GUI, even if hidden, by using an API to directly access GUI objects such as windows and menus. Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-312

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Additional Notes
**[Terminology]** Different people use "cleartext" and "plaintext" to mean the same thing: the lack of encryption. However, within cryptography, these have more precise meanings. Plaintext is the information just before it is fed into a cryptographic algorithm, including already-encrypted text. Cleartext is any information that is unencrypted, although it might be in an encoded form that is not easily human-readable (such as base64 encoding).



### Observed Examples
- **CVE-2002-1848:** Unencrypted passwords stored in GUI dialog may allow local users to access the passwords.

