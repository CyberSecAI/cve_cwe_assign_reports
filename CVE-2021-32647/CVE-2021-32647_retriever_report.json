{
  "cve_id": "CVE-2021-32647",
  "query": "Emissary is a P2P based data-driven workflow engine. Affected versions of Emissary are vulnerable to post-authentication Remote Code Execution (RCE). The [`CreatePlace`](https//github.com/NationalSecurityAgency/emissary/blob/30c54ef16c6eb6ed09604a929939fb9f66868382/src/main/java/emissary/server/mvc/internal/CreatePlaceAction.java#L36) REST endpoint accepts an `sppClassName` parameter which is used to load an arbitrary class. This class is later instantiated using a constructor with the following signature `(String, String, String)`. An attacker may find a gadget (class) in the application classpath that could be used to achieve Remote Code Execution (RCE) or disrupt the application. Even though the chances to find a gadget (class) that allow arbitrary code execution are low, an attacker can still find gadgets that could potentially crash the application or leak sensitive data. As a work around disable network access to Emissary from untrusted sources.",
  "keyphrases": {
    "weakness": "Remote Code Execution"
  },
  "timestamp": "2025-03-17T01:40:09.511428",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 5,
      "average_score": 0.5119167905633125,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.532918053947282,
      "unique_finds": 3
    },
    "graph": {
      "hit_count": 6,
      "average_score": 0.605586091731389,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-470",
      "name": "Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 1.0514,
      "retriever_count": 0,
      "dense_score": 0.5324,
      "sparse_score": 1.0,
      "graph_score": 0.5957
    },
    {
      "cwe_id": "CWE-502",
      "name": "Deserialization of Untrusted Data",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7322,
      "retriever_count": 0,
      "dense_score": 0.5005,
      "sparse_score": 0.5112,
      "graph_score": 0.5296
    },
    {
      "cwe_id": "CWE-918",
      "name": "Server-Side Request Forgery (SSRF)",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7201,
      "retriever_count": 0,
      "dense_score": 0.5096,
      "sparse_score": 0.4809,
      "graph_score": 0.5316
    },
    {
      "cwe_id": "CWE-94",
      "name": "Improper Control of Generation of Code ('Code Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7174,
      "retriever_count": 0,
      "dense_score": 0.509,
      "sparse_score": 0.4897,
      "graph_score": 0.6061
    },
    {
      "cwe_id": "CWE-1336",
      "name": "Improper Neutralization of Special Elements Used in a Template Engine",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5962,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4909,
      "graph_score": 0.8821
    },
    {
      "cwe_id": "CWE-917",
      "name": "Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.5164,
      "retriever_count": 0,
      "dense_score": 0.5081,
      "sparse_score": 0.4582,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.448,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4779,
      "graph_score": 0.4884
    },
    {
      "cwe_id": "CWE-1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.273,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4773,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.2716,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4749,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.2678,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4683,
      "graph_score": "-"
    }
  ]
}