{
  "cve_id": "CVE-2022-22249",
  "query": "An Improper Control of a Resource Through its Lifetime vulnerability in the Packet Forwarding Engine (PFE) of Juniper Networks Junos OS on MX Series allows an unauthenticated adjacent attacker to cause a Denial of Service (DoS). When there is a continuous mac move a memory corruption causes one or more FPCs to crash and reboot. These MAC moves can be between two local interfaces or between core/EVPN and local interface. The below error logs can be seen in PFE syslog when this issue happens xss_event_handler(1071) EA[00]_PPE 46.xss[0] ADDR Error. ppe_error_interrupt(4298) EA[00]_PPE 46 Errors sync xtxn error xss_event_handler(1071) EA[00]_PPE 1.xss[0] ADDR Error. ppe_error_interrupt(4298) EA[00]_PPE 1 Errors sync xtxn error xss_event_handler(1071) EA[00]_PPE 2.xss[0] ADDR Error. This issue affects Juniper Networks Junos OS on MX Series All versions prior to 15.1R7-S13 19.1 versions prior to 19.1R3-S9 19.2 versions prior to 19.2R3-S6 19.3 versions prior to 19.3R3-S6 19.4 versions prior to 19.4R2-S7, 19.4R3-S8 20.1 version 20.1R1 and later versions 20.2 versions prior to 20.2R3-S5 20.3 versions prior to 20.3R3-S5 20.4 versions prior to 20.4R3-S2 21.1 versions prior to 21.1R3 21.2 versions prior to 21.2R3 21.3 versions prior to 21.3R2.",
  "keyphrases": {
    "rootcause": "Improper Control of a Resource Through its Lifetime",
    "weakness": "memory corruption"
  },
  "timestamp": "2025-03-18T10:20:41.251147",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 8,
      "average_score": 0.6251566368125018,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 1.0,
      "unique_finds": 2
    },
    "graph": {
      "hit_count": 5,
      "average_score": 0.6195928932443057,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-410",
      "name": "Insufficient Resource Pool",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 1.2568,
      "retriever_count": 0,
      "dense_score": 0.654,
      "sparse_score": 1.0,
      "graph_score": 1.0
    },
    {
      "cwe_id": "CWE-1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 1.1077,
      "retriever_count": 0,
      "dense_score": 0.6455,
      "sparse_score": 1.0,
      "graph_score": 0.5948
    },
    {
      "cwe_id": "CWE-1250",
      "name": "Improper Preservation of Consistency Between Independent Representations of Shared State",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 1.1029,
      "retriever_count": 0,
      "dense_score": 0.6172,
      "sparse_score": 1.0,
      "graph_score": 0.6209
    },
    {
      "cwe_id": "CWE-401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.9943,
      "retriever_count": 0,
      "dense_score": 0.6491,
      "sparse_score": 1.0,
      "graph_score": 0.5041
    },
    {
      "cwe_id": "CWE-770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.8874,
      "retriever_count": 0,
      "dense_score": 0.6301,
      "sparse_score": 1.0,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-606",
      "name": "Unchecked Input for Loop Condition",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.8633,
      "retriever_count": 0,
      "dense_score": 0.5821,
      "sparse_score": 1.0,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.8018,
      "retriever_count": 0,
      "dense_score": 0.5926,
      "sparse_score": 1.0,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-696",
      "name": "Incorrect Behavior Order",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.6008,
      "retriever_count": 0,
      "dense_score": 0.6306,
      "sparse_score": 1.0,
      "graph_score": 0.3782
    },
    {
      "cwe_id": "CWE-1286",
      "name": "Improper Validation of Syntactic Correctness of Input",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.572,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 1.0,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-250",
      "name": "Execution with Unnecessary Privileges",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.572,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 1.0,
      "graph_score": "-"
    }
  ]
}