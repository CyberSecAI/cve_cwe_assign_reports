# Vulnerability Information: CVE-2022-22249

## Vulnerability Description
An **Improper Control of a Resource Through its Lifetime** vulnerability in the Packet Forwarding Engine (PFE) of Juniper Networks Junos OS on MX Series allows an unauthenticated adjacent attacker to cause a Denial of Service (DoS). When there is a continuous mac move a **memory corruption** causes one or more FPCs to crash and reboot. These MAC moves can be between two local interfaces or between core/EVPN and local interface. The below error logs can be seen in PFE syslog when this issue happens xss_event_handler(1071) EA[00]_PPE 46.xss[0] ADDR Error. ppe_error_interrupt(4298) EA[00]_PPE 46 Errors sync xtxn error xss_event_handler(1071) EA[00]_PPE 1.xss[0] ADDR Error. ppe_error_interrupt(4298) EA[00]_PPE 1 Errors sync xtxn error xss_event_handler(1071) EA[00]_PPE 2.xss[0] ADDR Error. This issue affects Juniper Networks Junos OS on MX Series All versions prior to 15.1R7-S13 19.1 versions prior to 19.1R3-S9 19.2 versions prior to 19.2R3-S6 19.3 versions prior to 19.3R3-S6 19.4 versions prior to 19.4R2-S7, 19.4R3-S8 20.1 version 20.1R1 and later versions 20.2 versions prior to 20.2R3-S5 20.3 versions prior to 20.3R3-S5 20.4 versions prior to 20.4R3-S2 21.1 versions prior to 21.1R3 21.2 versions prior to 21.2R3 21.3 versions prior to 21.3R2.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Control of a Resource Through its Lifetime**
- **weakness:** **memory corruption**
- **impact:** denial of service
- **vector:** continuous mac move
- **attacker:** unauthenticated adjacent attacker
- **product:** Juniper Networks Junos OS on MX Series
- **version:** All versions prior to 15.1R7-S13 and 19.1 versions prior to 19.1R3-S9 and 19.2 versions prior to 19.2R3-S6 and 19.3 versions prior to 19.3R3-S6 and 19.4 versions prior to 19.4R2-S7 and 19.4R3-S8 and 20.1 version 20.1R1 and later versions and 20.2 versions prior to 20.2R3-S5 and 20.3 versions prior to 20.3R3-S5 and 20.4 versions prior to 20.4R3-S2 and 21.1 versions prior to 21.1R3 and 21.2 versions prior to 21.2R3 and 21.3 versions prior to 21.3R2
- **component:** Packet Forwarding Engine (PFE) of Juniper Networks Junos OS

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-410 | Insufficient Resource Pool | Base | Allowed | 1.2567 | dense, sparse, graph | dense: 0.654, sparse: 1.000, graph: 1.000 |
| 2 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 1.1074 | dense, sparse, graph | dense: 0.645, sparse: 1.000, graph: 0.595 |
| 3 | CWE-1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | Allowed | 1.1028 | dense, sparse, graph | dense: 0.617, sparse: 1.000, graph: 0.621 |
| 4 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.9938 | dense, sparse, graph | dense: 0.648, sparse: 1.000, graph: 0.504 |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.8869 | dense, sparse | dense: 0.629, sparse: 1.000 |
| 6 | CWE-606 | Unchecked Input for Loop Condition | Base | Allowed | 0.8631 | dense, sparse | dense: 0.582, sparse: 1.000 |
| 7 | CWE-775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | Allowed | 0.8015 | dense, sparse | dense: 0.592, sparse: 1.000 |
| 8 | CWE-696 | Incorrect Behavior Order | Class | Allowed-with-Review | 0.6006 | dense, sparse, graph | dense: 0.630, sparse: 1.000, graph: 0.378 |
| 9 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |
| 10 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.5720 | sparse | sparse: 1.000 |

