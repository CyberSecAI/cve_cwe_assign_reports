# Vulnerability Information: CVE-2022-35881

## Vulnerability Description
Four **format string injection** vulnerabilities exist in the UPnP logging functionality of Abode Systems, Inc. iota All-In-One Security Kit 6.9Z and 6.9X. A specially-crafted UPnP negotiation can lead to memory corruption, information disclosure, and denial of service. An attacker can host a malicious UPnP service to trigger these vulnerabilities.This vulnerability arises from **format string injection** via `errorCode` and `errorDescription` XML tags, as used within the `DoUpdateUPnPbyService` action handler.

### Vulnerability Description Key Phrases
- **rootcause:** **format string injection**
- **impact:** memory corruption and information disclosure and denial of service
- **vector:** specially-crafted UPnP negotiation
- **attacker:** attacker
- **product:** Abode Systems iota All-In-One Security Kit
- **version:** 6.9Z and 6.9X
- **component:** UPnP logging functionality

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `log` function uses `vsnprintf` with a format string controlled by user-supplied data.",
  "Weaknesses/vulnerabilities present": [
    "Format string injection vulnerability in UPnP logging functionality.",
    "Misuse of the `log` function in multiple locations within the UPnP functionality of the Abode `iota`."
  ],
  "Impact of exploitation": "Memory corruption, information disclosure, and denial of service.",
  "Attack vectors": "A malicious UPnP service can be hosted by an attacker to trigger the vulnerabilities. The attacker needs to be able to listen for and reply to M-SEARCH packets.",
  "Required attacker capabilities/position": "The attacker must be on the same network and able to send and receive UPnP messages.",
  "Additional Details": "The specific vulnerable instances are:\n  - CVE-2022-35878: `DoEnumUPnPService` action, using the `ST` and `Location` fields from the M-SEARCH reply.\n  - CVE-2022-35879: `DoUpdateUPnPbyService` action, using the `controlURL` field from the device description.\n  - CVE-2022-35880: `DoUpdateUPnPbyService` action, using the `NewInternalClient` field in a SOAP response to a `GetSpecificPortMappingEntry` request.\n  - CVE-2022-35881: `DoUpdateUPnPbyService` action, using the `errorCode` and `errorDescription` fields in a SOAP response to an `AddPortMapping` request.\nExploitation requires physical access to the device's UART console to see the log output."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 1.0843 | dense, sparse, graph | dense: 0.694, sparse: 0.846, graph: 0.709 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.6873 | dense, sparse, graph | dense: 0.595, sparse: 0.305, graph: 0.602 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5284 | sparse, graph | sparse: 0.299, graph: 1.000 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4933 | sparse, graph | sparse: 0.311, graph: 0.882 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4191 | dense, sparse | dense: 0.591, sparse: 0.276 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.4148 | dense, sparse | dense: 0.547, sparse: 0.281 |
| 7 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.2004 | dense, sparse | dense: 0.553, sparse: 0.299 |
| 8 | CWE-115 | Misinterpretation of Input | Base | Allowed | 0.1690 | sparse | sparse: 0.296 |
| 9 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.1679 | sparse | sparse: 0.294 |
| 10 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.1675 | sparse | sparse: 0.293 |

