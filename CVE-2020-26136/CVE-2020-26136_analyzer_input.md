# Vulnerability Information: CVE-2020-26136

## Vulnerability Description
In SilverStripe through 4.6.0-rc1, GraphQL doesnt honour MFA (multi-factor authentication) when using basic authentication.

### Vulnerability Description Key Phrases
- **impact:** doesnt honour MFA (multi-factor authentication) when using basic authentication
- **product:** SilverStripe
- **version:** through 4.6.0-rc1
- **component:** GraphQL

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2020-26136

**Root Cause of Vulnerability:**
The GraphQL module in Silverstripe CMS, by default, accepts basic authentication. This allows a bypass of Multi-Factor Authentication (MFA) if the `silverstripe/mfa` module is installed.

**Weaknesses/Vulnerabilities Present:**
-   **MFA Bypass:** The vulnerability allows attackers to bypass MFA, which is intended to add an extra layer of security.
-   **Basic Authentication Default:** The default configuration of the GraphQL module enabled basic authentication, which was the main weakness here.

**Impact of Exploitation:**
-   **Compromised User Accounts:** An attacker could gain unauthorized access to user accounts by bypassing MFA, provided they have the user's password.
-   **Data Breach/Manipulation:** Successful exploitation could lead to unauthorized access and potential manipulation of data, depending on the compromised user's permissions.

**Attack Vectors:**
-   **Basic Authentication:** The attacker leverages the GraphQL module's basic authentication to bypass MFA.

**Required Attacker Capabilities/Position:**
-   **User Credentials:** The attacker needs a valid username and password to exploit this vulnerability.
-   **Network Access:** The attacker needs to access the GraphQL endpoint which was exposing the vulnerability.

**Additional Information:**
-   **Affected Versions:** `silverstripe/graphql` versions `^3.0.0` and `^4.0.0-alpha1`.
-   **Fixed Versions:** `silverstripe/graphql` versions `^3.5.0` and `^4.0.0-alpha2`.
-   **Severity:** Medium.
-   **Mitigation:** Basic authentication has been removed as a default method. It can be re-enabled, if desired, through configuration.
-   **CVSS Score:** 4.2 (AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)
-   **Reporter:** Maxime Rainville from Silverstripe Ltd.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-308 | Use of Single-factor Authentication | Base | Allowed | 0.4804 | dense, sparse, graph | dense: 0.467, sparse: 0.056, graph: 0.601 |
| 2 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.3867 | dense, sparse, graph | dense: 0.330, sparse: 0.023, graph: 0.583 |
| 3 | CWE-41 | Improper Resolution of Path Equivalence | Base | Allowed | 0.3693 | sparse, graph | sparse: 0.021, graph: 1.000 |
| 4 | CWE-1289 | Improper Validation of Unsafe Equivalence in Input | Base | Allowed | 0.3152 | sparse, graph | sparse: 0.020, graph: 0.850 |
| 5 | CWE-178 | Improper Handling of Case Sensitivity | Base | Allowed | 0.2564 | sparse, graph | sparse: 0.017, graph: 0.690 |
| 6 | CWE-303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | 0.1750 | dense, sparse | dense: 0.330, sparse: 0.017 |
| 7 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1039 | dense, sparse | dense: 0.336, sparse: 0.015 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.0792 | dense, sparse | dense: 0.329, sparse: 0.022 |
| 9 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.0094 | sparse | sparse: 0.016 |
| 10 | CWE-291 | Reliance on IP Address for Authentication | Variant | Allowed | 0.0093 | sparse | sparse: 0.018 |

