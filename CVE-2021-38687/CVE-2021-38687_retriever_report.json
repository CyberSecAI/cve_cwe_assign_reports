{
  "cve_id": "CVE-2021-38687",
  "query": "A stack buffer overflow vulnerability has been reported to affect QNAP NAS running Surveillance Station. If exploited, this vulnerability allows attackers to execute arbitrary code. We have already fixed this vulnerability in the following versions of Surveillance Station QTS 5.0.0 (64 bit) Surveillance Station 5.2.0.4.2 ( 2021/10/26 ) and later QTS 5.0.0 (32 bit) Surveillance Station 5.2.0.3.2 ( 2021/10/26 ) and later QTS 4.3.6 (64 bit) Surveillance Station 5.1.5.4.6 ( 2021/10/26 ) and later QTS 4.3.6 (32 bit) Surveillance Station 5.1.5.3.6 ( 2021/10/26 ) and later QTS 4.3.3 Surveillance Station 5.1.5.3.6 ( 2021/10/26 ) and later",
  "keyphrases": {
    "rootcause": "stack buffer overflow"
  },
  "timestamp": "2025-03-18T00:56:05.940169",
  "summary": {
    "total_unique_cwes": 10,
    "retrievers_used": {
      "dense": true,
      "sparse": true,
      "graph": true
    },
    "retriever_weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    }
  },
  "retriever_statistics": {
    "dense": {
      "hit_count": 8,
      "average_score": 0.5340373330087338,
      "unique_finds": 0
    },
    "sparse": {
      "hit_count": 10,
      "average_score": 0.4809246733961385,
      "unique_finds": 1
    },
    "graph": {
      "hit_count": 3,
      "average_score": 0.6194619948591945,
      "unique_finds": 0
    }
  },
  "results_table": [
    {
      "cwe_id": "CWE-120",
      "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.9327,
      "retriever_count": 0,
      "dense_score": 0.5575,
      "sparse_score": 0.8367,
      "graph_score": 0.6139
    },
    {
      "cwe_id": "CWE-78",
      "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.7293,
      "retriever_count": 0,
      "dense_score": 0.5391,
      "sparse_score": 0.4201,
      "graph_score": 0.6131
    },
    {
      "cwe_id": "CWE-121",
      "name": "Stack-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.6005,
      "retriever_count": 0,
      "dense_score": 0.6001,
      "sparse_score": 0.6123,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4998,
      "retriever_count": 0,
      "dense_score": 0.5169,
      "sparse_score": 0.4215,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.493,
      "retriever_count": 0,
      "dense_score": 0.4985,
      "sparse_score": 0.4256,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-122",
      "name": "Heap-based Buffer Overflow",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.4494,
      "retriever_count": 0,
      "dense_score": 0.5201,
      "sparse_score": 0.396,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "mapping_usage": "Not specified",
      "combined_score": 0.441,
      "retriever_count": 0,
      "dense_score": 0.5019,
      "sparse_score": 0.3961,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.4388,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.3724,
      "graph_score": 0.6314
    },
    {
      "cwe_id": "CWE-77",
      "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')",
      "abstraction": "Class",
      "mapping_usage": "Not specified",
      "combined_score": 0.3215,
      "retriever_count": 0,
      "dense_score": 0.5382,
      "sparse_score": 0.4861,
      "graph_score": "-"
    },
    {
      "cwe_id": "CWE-23",
      "name": "Relative Path Traversal",
      "abstraction": "Base",
      "mapping_usage": "Not specified",
      "combined_score": 0.2531,
      "retriever_count": 0,
      "dense_score": "-",
      "sparse_score": 0.4426,
      "graph_score": "-"
    }
  ]
}