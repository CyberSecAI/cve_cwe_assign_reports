# Vulnerability Information: CVE-2021-38687

## Vulnerability Description
A **stack buffer overflow** vulnerability has been reported to affect QNAP NAS running Surveillance Station. If exploited, this vulnerability allows attackers to execute arbitrary code. We have already fixed this vulnerability in the following versions of Surveillance Station QTS 5.0.0 (64 bit) Surveillance Station 5.2.0.4.2 ( 2021/10/26 ) and later QTS 5.0.0 (32 bit) Surveillance Station 5.2.0.3.2 ( 2021/10/26 ) and later QTS 4.3.6 (64 bit) Surveillance Station 5.1.5.4.6 ( 2021/10/26 ) and later QTS 4.3.6 (32 bit) Surveillance Station 5.1.5.3.6 ( 2021/10/26 ) and later QTS 4.3.3 Surveillance Station 5.1.5.3.6 ( 2021/10/26 ) and later

### Vulnerability Description Key Phrases
- **rootcause:** **stack buffer overflow**
- **impact:** execute arbitrary code
- **attacker:** attackers
- **product:** QNAP NAS

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A stack buffer overflow vulnerability exists in QNAP Surveillance Station.
- **Weaknesses/vulnerabilities present**: Stack buffer overflow.
- **Impact of exploitation**: Attackers can execute arbitrary code.
- **Attack vectors**: Not specified in detail.
- **Required attacker capabilities/position**: The attacker would need to be able to exploit the stack buffer overflow, though the specific method isn't described.

This content provides more detail than the CVE description by specifying the affected product and versions, the impact, and the fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.9327 | dense, sparse, graph | dense: 0.557, sparse: 0.837, graph: 0.614 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7293 | dense, sparse, graph | dense: 0.539, sparse: 0.420, graph: 0.613 |
| 3 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.6005 | dense, sparse | dense: 0.600, sparse: 0.612 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4998 | dense, sparse | dense: 0.517, sparse: 0.421 |
| 5 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4930 | dense, sparse | dense: 0.499, sparse: 0.426 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4494 | dense, sparse | dense: 0.520, sparse: 0.396 |
| 7 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.4410 | dense, sparse | dense: 0.502, sparse: 0.396 |
| 8 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4388 | sparse, graph | sparse: 0.372, graph: 0.631 |
| 9 | CWE-77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | 0.3215 | dense, sparse | dense: 0.538, sparse: 0.486 |
| 10 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.2531 | sparse | sparse: 0.443 |

