# Vulnerability Information: CVE-2021-46509

## Vulnerability Description
Cesanta MJS v2.20.0 was discovered to contain a **stack overflow** via snquote at mjs/src/mjs_json.c.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** Cesanta MJS
- **version:** v2.20.0
- **component:** mjs/src/mjs_json.c

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A stack overflow occurs due to an issue in the `snquote` function when processing a crafted JSON string, specifically within the `mjs_json.c` file at line 102.
- **Weaknesses/vulnerabilities present**: Stack overflow due to unbounded recursion or excessive stack allocation within the `snquote` function during JSON string processing.
- **Impact of exploitation**: Crash of the application due to stack overflow, potentially leading to denial of service.
- **Attack vectors**:  Crafted JavaScript code containing nested or complex JSON structures can trigger the vulnerability when processed by the `mjs` engine. The specific code `(JSON.stringify([1, 2, 3]))((JSON.parse - 6.5 - 321e2)(JSON.stringify([1, 2, 3])));` shows how to trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs the ability to execute arbitrary JavaScript code within the vulnerable `mjs` environment.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6516 | dense, sparse, graph | dense: 0.513, sparse: 0.117, graph: 0.917 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6037 | dense, sparse, graph | dense: 0.546, sparse: 0.074, graph: 0.806 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4789 | dense, sparse, graph | dense: 0.557, sparse: 0.066, graph: 0.566 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4428 | dense, sparse, graph | dense: 0.510, sparse: 0.077, graph: 0.460 |
| 5 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3272 | sparse, graph | sparse: 0.079, graph: 0.789 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3260 | dense, sparse | dense: 0.559, sparse: 0.128 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3208 | dense, sparse | dense: 0.557, sparse: 0.120 |
| 8 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3117 | dense, sparse | dense: 0.529, sparse: 0.082 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.2968 | dense, sparse | dense: 0.508, sparse: 0.074 |
| 10 | CWE-1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | 0.2965 | dense, sparse | dense: 0.517, sparse: 0.066 |

