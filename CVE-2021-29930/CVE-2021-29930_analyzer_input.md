# Vulnerability Information: CVE-2021-29930

## Vulnerability Description
An issue was discovered in the arenavec crate through 2021-01-12 for Rust. A drop of uninitialized memory can sometimes occur upon a panic in Tdefault().

### Vulnerability Description Key Phrases
- **weakness:** **uninitialized memory drop**
- **product:** arenavec crate
- **version:** through 2021-01-12
- **component:** Tdefault()

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `arenavec` crate does not handle panics within user-provided `T::default()` and `T::drop()` functions.
- **Weaknesses/vulnerabilities present**:
    - **Uninitialized drop**: A panic in `T::default()` leads to dropping an uninitialized `T` object when `common::Slice::<T, H>::new()` is called.
    - **Double drop**: A panic in `T::drop()` leads to a double drop of `T` when `common::SliceVec::<T, H>::resize_with()` or `common::SliceVec::<T, H>::resize()` is called.
- **Impact of exploitation**: Memory corruption in the heap memory due to uninitialized or double drops of `T` objects.
- **Attack vectors**: The vulnerability can be triggered by providing `T` types with implementations of `default()` or `drop()` that panic.
- **Required attacker capabilities/position**: The attacker needs the ability to provide types `T` with panicking implementations of `default()` or `drop()`, typically through using the library in a way that permits user-defined types. The vulnerability is reachable via network access with low complexity, no user interaction and no privileges needed.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.7763 | dense, sparse, graph | dense: 0.554, sparse: 0.248, graph: 1.000 |
| 2 | CWE-252 | Unchecked Return Value | Base | Allowed | 0.6500 | dense, sparse, graph | dense: 0.495, sparse: 0.145, graph: 0.893 |
| 3 | CWE-457 | Use of Uninitialized Variable | Variant | Allowed | 0.4977 | dense, sparse, graph | dense: 0.527, sparse: 0.141, graph: 0.545 |
| 4 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.4969 | dense, sparse, graph | dense: 0.522, sparse: 0.112, graph: 0.596 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3468 | sparse, graph | sparse: 0.113, graph: 0.789 |
| 6 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.3433 | dense, sparse, graph | dense: 0.541, sparse: 0.155, graph: 0.629 |
| 7 | CWE-366 | Race Condition within a Thread | Base | Allowed | 0.3302 | dense, sparse | dense: 0.509, sparse: 0.132 |
| 8 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.2659 | sparse, graph | sparse: 0.122, graph: 0.548 |
| 9 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.1865 | dense, sparse | dense: 0.493, sparse: 0.124 |
| 10 | CWE-665 | Improper Initialization | Class | Discouraged | 0.1487 | dense, sparse | dense: 0.512, sparse: 0.133 |

