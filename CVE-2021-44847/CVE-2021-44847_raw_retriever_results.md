# Raw Retriever Results for CVE-2021-44847

# Raw Retriever Results for CVE-2021-44847

## Query
A stack-based buffer overflow in handle_request function in DHT.c in toxcore 0.1.9 through 0.1.11 and 0.2.0 through 0.2.12 (caused by an improper length calculation during the handling of received network packets) allows remote attackers to crash the process or potentially execute arbitrary code via a network packet.

## Keyphrases
- **rootcause**: improper length calculation
- **weakness**: stack-based buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5114 | 0.6047 | 0.5389 | 0.5359 | 20 |
| Sparse | 289.2782 | 793.9300 | 535.4694 | 535.3581 | 20 |
| Graph | 1.6712 | 3.0420 | 2.0562 | 1.9884 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 3.0420 | Allowed |
| 2 | 128 | Wrap-around Error | base | 2.9250 | Allowed |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 2.5537 | Allowed-with-Review |
| 4 | 190 | Integer Overflow or Wraparound | Base | 2.2603 | Allowed |
| 5 | 839 | Numeric Range Comparison Without Minimum Check | base | 2.2100 | Allowed |
| 6 | 681 | Incorrect Conversion between Numeric Types | base | 2.2100 | Allowed |
| 7 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 10 | 231 | Improper Handling of Extra Values | variant | 2.0400 | Allowed |
| 11 | 126 | Buffer Over-read | Variant | 1.9367 | Allowed |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.7680 | Allowed |
| 13 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | base | 1.7680 | Allowed |
| 14 | 364 | Signal Handler Race Condition | base | 1.7680 | Allowed |
| 15 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | 0.6047 | 0.6047 | Allowed |
| 2 | 122 | Heap-based Buffer Overflow | Variant | 0.5802 | 0.5802 | Allowed |
| 3 | 674 | Uncontrolled Recursion | Class | 0.5678 | 0.5678 | Allowed-with-Review |
| 4 | 126 | Buffer Over-read | Variant | 0.5545 | 0.5545 | Allowed |
| 5 | 190 | Integer Overflow or Wraparound | Base | 0.5542 | 0.5542 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5505 | 0.5505 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5466 | 0.5466 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5441 | 0.5441 | Allowed |
| 9 | 193 | Off-by-one Error | Base | 0.5415 | 0.5415 | Allowed |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.5364 | 0.5364 | Allowed |
| 11 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5354 | 0.5354 | Allowed |
| 12 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5256 | 0.5256 | Allowed |
| 13 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.5208 | 0.5208 | Allowed |
| 14 | 416 | Use After Free | Variant | 0.5201 | 0.5201 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 0.5187 | 0.5187 | Allowed-with-Review |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-682 | Incorrect Calculation | 793.9300 | 793.9300 | Discouraged |
| 2 | CWE-121 | Stack-based Buffer Overflow | 635.6283 | 635.6283 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 593.5770 | 593.5770 | Allowed |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | 565.6206 | 565.6206 | Allowed-with-Review |
| 5 | CWE-122 | Heap-based Buffer Overflow | 560.4879 | 560.4879 | Allowed |
| 6 | CWE-126 | Buffer Over-read | 550.7348 | 550.7348 | Allowed |
| 7 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 546.7056 | 546.7056 | Discouraged |
| 8 | CWE-193 | Off-by-one Error | 543.5627 | 543.5627 | Allowed |
| 9 | CWE-190 | Integer Overflow or Wraparound | 542.8246 | 542.8246 | Allowed |
| 10 | CWE-789 | Memory Allocation with Excessive Size Value | 535.9993 | 535.9993 | Allowed |
| 11 | CWE-130 | Improper Handling of Length Parameter Inconsistency | 534.7169 | 534.7169 | Allowed |
| 12 | CWE-125 | Out-of-bounds Read | 522.1059 | 522.1059 | Allowed |
| 13 | CWE-20 | Improper Input Validation | 520.9734 | 520.9734 | Discouraged |
| 14 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 517.8406 | 517.8406 | Allowed |
| 15 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 505.9413 | 505.9413 | Allowed |
