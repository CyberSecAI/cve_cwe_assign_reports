# Vulnerability Information: CVE-2022-30476

## Vulnerability Description
Tenda AC Series Router AC18_V15.03.05.19(6318) was discovered to contain a **stack-based buffer overflow** in the httpd module when handling /goform/SetFirewallCfg request.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **product:** Tenda AC Series Router
- **version:** AC18_V15.03.05.19(6318)
- **component:** httpd module

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 16)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A stack-based buffer overflow in the `formSetFirewallCfg` function.
- **Weaknesses/vulnerabilities present:** The `strcpy` function is used without proper length checks when copying the user-provided `firewallEn` parameter into a stack-based buffer.
- **Impact of exploitation:** An attacker can trigger a Denial of Service (DoS) or achieve Remote Code Execution (RCE) by sending a crafted `firewallEn` parameter.
- **Attack vectors:** Sending a GET request to `/goform/SetFirewallCfg` with an overly long `firewallEn` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the Tenda Router. No special privileges are required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.4297 | sparse, graph | sparse: 0.126, graph: 1.000 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4191 | dense, sparse | dense: 0.646, sparse: 0.229 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3815 | sparse, graph | sparse: 0.131, graph: 0.857 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3637 | sparse, graph | sparse: 0.130, graph: 0.857 |
| 5 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3597 | dense, sparse | dense: 0.587, sparse: 0.115 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3427 | sparse, graph | sparse: 0.106, graph: 0.789 |
| 7 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3315 | dense, sparse | dense: 0.519, sparse: 0.125 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3165 | dense, sparse | dense: 0.531, sparse: 0.135 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2992 | dense, sparse | dense: 0.517, sparse: 0.114 |
| 10 | CWE-193 | Off-by-one Error | Base | Allowed | 0.0691 | sparse | sparse: 0.121 |

