# Vulnerability Information: CVE-2021-21419

## Vulnerability Description
Eventlet is a concurrent networking library for Python. A websocket peer may exhaust memory on Eventlet side by sending very large websocket frames. Malicious peer may exhaust memory on Eventlet side by sending highly compressed data frame. A patch in version 0.31.0 restricts websocket frame to reasonable limits. As a workaround, restricting memory usage via OS limits would help against overall machine exhaustion, but there is no workaround to protect Eventlet process.

### Vulnerability Description Key Phrases
- **weakness:** **memory leak**
- **impact:** memory exhaustion
- **vector:** very large websocket frames
- **attacker:** websocket peer
- **product:** Eventlet
- **version:** prior to 0.31.0

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-21419:

**Root Cause of Vulnerability:**
The vulnerability stems from the improper handling of highly compressed data and memory allocation with excessive size values when processing websocket frames in the `eventlet` library.

**Weaknesses/Vulnerabilities Present:**
- **Data Amplification:** The library doesn't properly limit the size of decompressed data, leading to potential data amplification where a small compressed payload expands to a much larger size in memory.
- **Unbounded Memory Allocation:** The library allocates memory based on the size of the incoming data without proper size checks, allowing an attacker to trigger excessive memory allocation.

**Impact of Exploitation:**
- **Denial of Service (DoS):** A malicious peer can exploit this vulnerability by sending highly compressed websocket frames, causing the Eventlet process to exhaust its memory, leading to a denial of service.

**Attack Vectors:**
- **Network:** The vulnerability is exploitable over the network through the websocket protocol.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send websocket frames to a vulnerable Eventlet server. No specific user privileges or interaction is required.

**Additional Information:**
- The vulnerability is present in versions of `eventlet` prior to 0.31.0 (specifically >= 0.10 and < 0.31.0).
- Version 0.31.0 includes a patch that restricts the websocket frame size to reasonable limits.
- The vulnerability has been assigned CWE-409 (Improper Handling of Compressed Data) and CWE-789 (Uncontrolled Memory Allocation).
- Mitigation also includes using OS limits to restrict memory usage, which can help prevent overall machine exhaustion.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | 0.8112 | dense, sparse, graph | dense: 0.404, sparse: 0.703, graph: 0.579 |
| 2 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.6738 | dense, sparse, graph | dense: 0.419, sparse: 0.340, graph: 0.911 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.5895 | dense, sparse, graph | dense: 0.402, sparse: 0.307, graph: 0.594 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4207 | sparse, graph | sparse: 0.242, graph: 0.789 |
| 5 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3282 | dense, sparse | dense: 0.424, sparse: 0.250 |
| 6 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.2967 | sparse, graph | sparse: 0.228, graph: 0.465 |
| 7 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.2839 | dense, sparse | dense: 0.354, sparse: 0.228 |
| 8 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.1740 | dense, sparse | dense: 0.355, sparse: 0.207 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1335 | sparse, graph | sparse: 0.218, graph: 0.486 |
| 10 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.1305 | sparse | sparse: 0.228 |

