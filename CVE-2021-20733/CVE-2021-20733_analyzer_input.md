# Vulnerability Information: CVE-2021-20733

## Vulnerability Description
**Improper authorization** in handler for custom URL scheme vulnerability in ????????? (asken diet) for Android versions from v.3.0.0 to v.4.2.x allows a remote attacker to lead a user to access an arbitrary website via the vulnerable App.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper authorization**
- **impact:** access arbitrary website
- **attacker:** remote attacker
- **product:** asken diet
- **version:** Android versions from v.3.0.0 to v.4.2.x

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-20733:

**Root Cause of Vulnerability:**

The `asken` App for Android does not properly restrict access to its custom URL scheme functionality. This means it doesn't adequately validate or sanitize the URLs it's asked to access via custom schemes.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Restriction of Custom URL Schemes (CWE-939):** The core vulnerability lies in the app's failure to restrict what URLs can be opened via its custom URL scheme.

**Impact of Exploitation:**

*   **Arbitrary Website Access:** An attacker can craft a malicious URL using the app's custom scheme to redirect users to an arbitrary website, not controlled by the app's developers.
*   **Phishing Attacks:** This redirection capability can be used to conduct phishing attacks, where the attacker can direct users to a fake website mimicking a trusted service and steal their credentials or other sensitive information.

**Attack Vectors:**

*   **Remote Attack:** The vulnerability can be exploited remotely by tricking the user into clicking a specially crafted URL. This can be done through various means such as email, messages, or malicious advertisements.

**Required Attacker Capabilities/Position:**

*   **No special privileges needed:** An attacker doesn't need to have any prior access or specific user credentials to exploit the vulnerability.
*   **User Interaction required:**  The attacker needs the victim to click on the malicious URL.

**Additional Details:**

*   The vulnerability affects versions v.3.0.0 to v.4.2.x of the `asken` App for Android.
*   The CVSS v3 score is 4.3, indicating a moderate severity.
*   The CVSS v2 score is also 4.3.
*   The application is only available in Japan.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-939 | Improper Authorization in Handler for Custom URL Scheme | Base | Allowed | 0.7894 | dense, sparse, graph | dense: 0.725, sparse: 0.344, graph: 0.643 |
| 2 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.5701 | dense, sparse, graph | dense: 0.479, sparse: 0.196, graph: 0.611 |
| 3 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.3441 | sparse, graph | sparse: 0.183, graph: 0.670 |
| 4 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.3438 | dense, sparse | dense: 0.479, sparse: 0.182 |
| 5 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3123 | sparse, graph | sparse: 0.177, graph: 0.631 |
| 6 | CWE-285 | Improper Authorization | Class | Discouraged | 0.2382 | dense, sparse, graph | dense: 0.471, sparse: 0.204, graph: 0.503 |
| 7 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.2099 | dense, sparse | dense: 0.485, sparse: 0.200 |
| 8 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1720 | sparse, graph | sparse: 0.198, graph: 0.503 |
| 9 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1561 | dense, sparse | dense: 0.488, sparse: 0.183 |
| 10 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.1170 | dense, sparse | dense: 0.485, sparse: 0.185 |

