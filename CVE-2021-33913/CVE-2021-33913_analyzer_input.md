# Vulnerability Information: CVE-2021-33913

## Vulnerability Description
libspf2 before 1.2.11 has a heap-based buffer overflow that might allow remote attackers to execute arbitrary code (via an unauthenticated e-mail message from anywhere on the Internet) with a crafted SPF DNS record, because of SPF_record_expand_data in spf_expand.c. The amount of overflowed data depends on the relationship between the length of an entire domain name and the length of its leftmost label. The vulnerable code may be part of the supply chain of a sites e-mail infrastructure (e.g., with additional configuration, Exim can use libspf2 the Postfix web site links to unofficial patches for use of libspf2 with Postfix older versions of spfquery relied on libspf2) but most often is not.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-based buffer overflow in SPF_record_expand_data in spf_expand.c**
- **impact:** execute arbitrary code
- **vector:** crafted SPF DNS record
- **attacker:** remote attackers
- **product:** libspf2
- **version:** before 1.2.11
- **component:** SPF_record_expand_data in spf_expand.c

## CVE Reference Links Content Summary
```
{
  "guidelines_followed": "YES",
  "CVE_details": {
    "cve_id": "CVE-2021-33913",
    "root_cause": "Heap-based buffer overflows.",
    "vulnerabilities": [
      "Heap-based buffer overflow"
    ],
    "impact": "Denial of service and possibly arbitrary code execution.",
    "attack_vectors": [
      "Remote"
    ],
     "required_capabilities": "The attacker needs to be able to send a malicious email that will be processed by libspf2."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.8073 | dense, sparse, graph | dense: 0.537, sparse: 0.513, graph: 0.686 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6104 | sparse, graph | sparse: 0.532, graph: 0.857 |
| 3 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.6020 | dense, sparse | dense: 0.581, sparse: 0.631 |
| 4 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5893 | dense, sparse | dense: 0.563, sparse: 0.537 |
| 5 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.5630 | dense, sparse | dense: 0.551, sparse: 0.503 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.5599 | dense, sparse | dense: 0.554, sparse: 0.494 |
| 7 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5576 | sparse, graph | sparse: 0.466, graph: 0.813 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5409 | dense, sparse | dense: 0.548, sparse: 0.466 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.5386 | dense, sparse | dense: 0.532, sparse: 0.476 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5372 | dense, sparse | dense: 0.566, sparse: 0.522 |

