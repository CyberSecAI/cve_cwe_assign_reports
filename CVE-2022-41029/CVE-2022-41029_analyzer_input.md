# Vulnerability Information: CVE-2022-41029

## Vulnerability Description
Several **stack-based buffer overflow** vulnerabilities exist in the DetranCLI command parsing functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. A specially-crafted network packet can lead to arbitrary command execution. An attacker can send a sequence of requests to trigger these vulnerabilities.This buffer overflow is in the function that manages the wlan filter mac address WORD descript WORD command template.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** arbitrary command execution
- **product:** Siretta QUARTZ-GOLD
- **version:** G5.0.1.5-210720-141020
- **component:** DetranCLI command parsing functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-120

#### Top CWEs
- CWE-120 (Count: 137)
- CWE-787 (Count: 34)
- CWE-78 (Count: 4)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The `DetranCLI` binary in Siretta QUARTZ-GOLD devices uses `sprintf` to format strings based on user-provided input without checking the size of the input against the destination buffer, leading to stack-based buffer overflows.
- **Weaknesses/vulnerabilities present:** Stack-based buffer overflows exist in multiple command parsing functions within the `DetranCLI` binary due to improper usage of `sprintf`. The size of the input is not validated against the buffer size before being written to memory
- **Impact of exploitation:** Successful exploitation of the buffer overflows can lead to arbitrary command execution on the affected device.
- **Attack vectors:** An attacker can send specially-crafted network packets to trigger the vulnerable commands in `DetranCLI`.
- **Required attacker capabilities/position:** The attacker needs to be able to send network packets to the device and have the ability to execute commands using `DetranCLI`. The CVSS score indicates that high privileges are required (PR:H).

Specifically for **CVE-2022-41029**:
- The vulnerability lies within the `wlan filter mac address` command.
- The vulnerable code:
  ```c
    sprintf(buff_0x20,"%s%s%s%s%s%s<%s",octet_from_argv0[0],octet_from_argv0[1],octet_from_argv0[2],octet_from_argv0[3],octet_from_argv0[4],octet_from_argv0[5],argv[1]);
  ```
- A buffer of size 0x20 is filled using `sprintf` where the last argument `argv[1]` which is derived from user input is not checked for length.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 1.0524 | dense, sparse, graph | dense: 0.701, sparse: 0.817, graph: 0.796 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7481 | dense, sparse, graph | dense: 0.565, sparse: 0.351, graph: 0.739 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6630 | dense, sparse, graph | dense: 0.582, sparse: 0.312, graph: 0.695 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4871 | dense, sparse | dense: 0.664, sparse: 0.342 |
| 5 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4653 | dense, sparse | dense: 0.611, sparse: 0.279 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4583 | dense, sparse | dense: 0.560, sparse: 0.311 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4471 | dense, sparse | dense: 0.571, sparse: 0.282 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4366 | dense, sparse | dense: 0.587, sparse: 0.313 |
| 9 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2618 | dense, sparse | dense: 0.565, sparse: 0.284 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.2059 | dense, sparse | dense: 0.571, sparse: 0.305 |

