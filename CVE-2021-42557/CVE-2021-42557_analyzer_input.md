# Vulnerability Information: CVE-2021-42557

## Vulnerability Description
In Jeedom through 4.1.19, a **bug** allows a remote attacker to bypass API access and retrieve users credentials.

### Vulnerability Description Key Phrases
- **weakness:** **bug**
- **impact:** bypass API access and retrieve users credentials
- **attacker:** remote attacker
- **product:** Jeedom
- **version:** through 4.1.19

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2021-42557:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a type juggling issue in the `jeedom::apiAccess` function within the Jeedom home automation software. The function uses a loose comparison (`==`) instead of a strict comparison (`===`) when verifying API keys.

**Weaknesses/Vulnerabilities Present:**

*   **Type Juggling:** The use of `==` allows for type coercion, meaning an integer `0` can be loosely equal to a string API key.
*   **Authentication Bypass:** By providing an integer `0` as the API key, an attacker can bypass the authentication check within the `jeedom::apiAccess` function.

**Impact of Exploitation:**

*   **Unauthorized API Access:** Successful exploitation allows an attacker to bypass authentication and gain access to the Jeedom API.
*   **Information Disclosure:**  The attacker can use the API to retrieve sensitive information, including user credentials such as usernames and passwords (including http and ssh credentials).
*   **Remote Command Execution:** Through the API and the web interface, a remote attacker can execute arbitrary commands on the web server.

**Attack Vectors:**

*   **HTTP Requests:** The attack is performed by sending crafted HTTP POST requests to the `/core/api/proApi.php` or `/core/api/jeeApi.php` endpoints.
*   **API Parameter Manipulation:** The attacker manipulates the `apikey`, `api`, or `proapi` parameters in the POST request by setting them to the integer `0`.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker must be able to send HTTP requests to the Jeedom server.
*   **No Prior Credentials:** The attacker does not need a valid API key to exploit this vulnerability.

**Additional Notes:**

*   The provided content indicates that this vulnerability affects Jeedom versions 4.1.26 and below, and is fixed in version 4.1.27.
*   The vulnerability was discovered by Synacktiv.
*   The report notes that thousands of Jeedom applications are exposed on the internet according to shodan.io and fofa.so, increasing the potential attack surface.
*   The advisory recommends using the strict comparison operator (`===`) to prevent the type juggling issue.

**Summary:** This is a critical vulnerability that allows an attacker to completely bypass authentication and gain control of a Jeedom system. The combination of API access and command execution makes it a high-severity issue.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5349 | dense, sparse, graph | dense: 0.529, sparse: 0.088, graph: 0.615 |
| 2 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.3137 | dense, sparse | dense: 0.520, sparse: 0.093 |
| 3 | CWE-256 | Plaintext Storage of a Password | Base | Allowed | 0.3068 | dense, sparse | dense: 0.510, sparse: 0.090 |
| 4 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2777 | dense, sparse, graph | dense: 0.497, sparse: 0.096, graph: 0.472 |
| 5 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.2740 | sparse, graph | sparse: 0.098, graph: 0.610 |
| 6 | CWE-597 | Use of Wrong Operator in String Comparison | Variant | Allowed | 0.2081 | sparse, graph | sparse: 0.126, graph: 0.429 |
| 7 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1822 | dense, sparse | dense: 0.509, sparse: 0.097 |
| 8 | CWE-862 | Missing Authorization | Class | Allowed-with-Review | 0.1793 | dense, sparse | dense: 0.508, sparse: 0.089 |
| 9 | CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | 0.1055 | sparse, graph | sparse: 0.098, graph: 0.503 |
| 10 | CWE-523 | Unprotected Transport of Credentials | Base | Allowed | 0.0536 | sparse | sparse: 0.094 |

