# Vulnerability Information: CVE-2022-46155

## Vulnerability Description
Airtable.js is the JavaScript client for Airtable. Prior to version 0.11.6, Airtable.js had a **misconfigured build script** in its source package. When the build script is run, it would bundle environment variables into the build target of a transpiled bundle. Specifically, the AIRTABLE_API_KEY and AIRTABLE_ENDPOINT_URL environment variables are inserted during Browserify builds due to being referenced in Airtable.js code. This only affects copies of Airtable.js built from its source, not those installed via npm or yarn. Airtable API keys set in users environments via the AIRTABLE_API_KEY environment variable may be bundled into local copies of Airtable.js source code if all of the following conditions are met 1) the user has cloned the Airtable.js source onto their machine, 2) the user runs the `npm prepare` script, and 3) the user has the AIRTABLE_API_KEY environment variable set. If these conditions are met, a users local build of Airtable.js would be modified to include the value of the AIRTABLE_API_KEY environment variable, which could then be accidentally shipped in the bundled code. Users who do not meet all three of these conditions are not impacted by this issue. Users should upgrade to Airtable.js version 0.11.6 or higher or, as a workaround unset the AIRTABLE_API_KEY environment variable in their shell and/or remove it from your .bashrc, .zshrc, or other shell configuration files. Users should also regenerate any Airtable API keys they use, as the keysy may be present in bundled code.

### Vulnerability Description Key Phrases
- **rootcause:** **misconfigured build script**
- **weakness:** **inclusion of sensitive information in build target**
- **product:** Airtable.js
- **version:** prior to 0.11.6

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   A misconfigured build script in the `airtable.js` package was bundling environment variables into the browser build. Specifically, `AIRTABLE_API_KEY` and `AIRTABLE_ENDPOINT_URL` were being included in the generated bundle when referenced in the code.

**Weaknesses/vulnerabilities present:**

*   **Credentials Exposure:** The primary vulnerability is the unintentional inclusion of the `AIRTABLE_API_KEY` within the browser build of the library, potentially exposing sensitive API keys.
*   **Build Process Misconfiguration:** The core issue stems from the build script's failure to properly exclude environment variables during the bundling process, which was using `envify` to inject the environment variables.

**Impact of exploitation:**

*   **Unauthorized API access:** If the bundled `airtable.js` code containing the API key is distributed, attackers could extract the key and gain unauthorized access to the corresponding Airtable account.
*   **Data Breach/Modification:** With access to the API key, attackers could potentially view, modify, or delete data stored in the associated Airtable base.

**Attack vectors:**

*   **Accidental Distribution of Bundled Code:** The primary attack vector involves a developer who cloned the `airtable.js` source code, ran the `npm prepare` script (triggering the problematic build process), and then inadvertently distributed the modified bundle containing the API key (e.g., by including it in their website or application).
*   **Man-in-the-Middle (Potentially):** While less likely, an attacker who could intercept the distribution channel might also be able to access the bundled javascript and extract the API key.

**Required attacker capabilities/position:**

*   The attacker needs access to a copy of the modified `airtable.js` code bundled by a developer who cloned the repository, ran the build script with the environment variable set.

**Additional details:**

*   The vulnerability only affects developers who build `airtable.js` from the source using `npm prepare` with the `AIRTABLE_API_KEY` environment variable set. Users who install `airtable.js` through npm or yarn are not affected.
*   The fix involves modifying the build script to explicitly mask out the environment variables `AIRTABLE_ENDPOINT_URL` and `AIRTABLE_API_KEY` using the `envify` transform by setting them to empty strings during the build process.
*   The fixed version of the package is `0.11.6`.
*   The advisory recommends upgrading to `airtable.js` version `0.11.6` or higher, unsetting the `AIRTABLE_API_KEY` environment variable, and regenerating any Airtable API keys that were used during affected builds.
*   The vulnerability is categorized under CWE-522: Insufficiently Protected Credentials
*   CVSS v3 base metrics are: AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H which translates to: Network Attack Vector, High Attack Complexity, High Privileges Required, User Interaction Required, Scope Changed, High Confidentiality, High Integrity, High Availability

The provided information is more detailed than a typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.9897 | dense, sparse, graph | dense: 0.364, sparse: 1.000, graph: 0.658 |
| 2 | CWE-212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | 0.9295 | sparse, graph | sparse: 1.000, graph: 1.000 |
| 3 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.9204 | sparse, graph | sparse: 1.000, graph: 0.975 |
| 4 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.8542 | sparse, graph | sparse: 1.000, graph: 0.789 |
| 5 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.8426 | sparse, graph | sparse: 1.000, graph: 0.757 |
| 6 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7977 | sparse, graph | sparse: 1.000, graph: 0.631 |
| 7 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.7437 | dense, sparse | dense: 0.343, sparse: 1.000 |
| 8 | CWE-335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | 0.7416 | dense, sparse | dense: 0.339, sparse: 1.000 |
| 9 | CWE-526 | Cleartext Storage of Sensitive Information in an Environment Variable | Variant | Allowed | 0.7378 | dense, sparse | dense: 0.454, sparse: 1.000 |
| 10 | CWE-61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | 0.6019 | sparse, graph | sparse: 1.000, graph: 0.589 |

