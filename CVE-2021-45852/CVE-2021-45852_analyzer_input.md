# Vulnerability Information: CVE-2021-45852

## Vulnerability Description
An issue was discovered in Projectworlds Hospital Management System v1.0. Unauthorized malicious attackers can add patients without restriction via add_patient.php.

### Vulnerability Description Key Phrases
- **impact:** add patients without restriction
- **attacker:** unauthorized malicious attackers
- **product:** Projectworlds Hospital Management System
- **version:** v1.0
- **component:** add_patient.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

The vulnerability lies in the `add_patient.php` file of the hospital management system. The code attempts to restrict access to logged-in users by redirecting unauthenticated users. However, the `exit()` function is not called after the redirection which causes the script execution to continue and allows an unauthorized user to add patient data.

**Weaknesses/Vulnerabilities Present:**

*   **Inadequate Access Control:** The system attempts to implement access control but fails to terminate script execution after redirection. This allows users who should be redirected to bypass authentication.
*   **Missing `exit()` After Redirection:** The critical missing piece is the absence of an `exit()` or `die()` statement after the `header("Location: login.php");` which would prevent the rest of the script from executing and allowing unauthorized access.

**Impact of Exploitation:**

*   **Unauthorized Data Modification:** An attacker can add patient data without being authenticated, leading to data integrity issues. They could potentially add fake or malicious data.
*   **Data Tampering:** The ability to add unauthorized data could have a negative impact on the integrity and reliability of the system.

**Attack Vectors:**

*   **Direct HTTP Request:** An attacker can directly send an HTTP POST request to the `add_patient.php` script without any session or cookie, bypassing the intended login and authentication checks.
*   **Lack of Authentication Check:** The attack relies on the lack of proper authentication checks in the `add_patient.php` file, bypassing redirection attempts by continuing the script.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to be able to send HTTP requests to the web server hosting the hospital management system.
*   **No Prior Authentication:** The attacker doesn't need a valid account or be logged in to exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.5739 | dense, sparse, graph | dense: 0.528, sparse: 0.024, graph: 0.829 |
| 2 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.5523 | dense, sparse, graph | dense: 0.493, sparse: 0.025, graph: 0.815 |
| 3 | CWE-472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | 0.5138 | dense, sparse, graph | dense: 0.516, sparse: 0.026, graph: 0.674 |
| 4 | CWE-698 | Execution After Redirect (EAR) | Base | Allowed | 0.3053 | sparse, graph | sparse: 0.061, graph: 0.757 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.2556 | dense, sparse | dense: 0.483, sparse: 0.024 |
| 6 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.2548 | dense, sparse | dense: 0.484, sparse: 0.022 |
| 7 | CWE-96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | 0.2494 | dense, sparse | dense: 0.469, sparse: 0.026 |
| 8 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.2392 | sparse, graph | sparse: 0.023, graph: 0.631 |
| 9 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1505 | dense, sparse | dense: 0.486, sparse: 0.023 |
| 10 | CWE-285 | Improper Authorization | Class | Discouraged | 0.1139 | dense, sparse | dense: 0.479, sparse: 0.026 |

