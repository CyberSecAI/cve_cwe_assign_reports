# Vulnerability Information: CVE-2021-45939

## Vulnerability Description
wolfSSL wolfMQTT 1.9 has a **heap-based buffer overflow** in MqttClient_DecodePacket (called from MqttClient_WaitType and MqttClient_Subscribe).

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** wolfSSL wolfMQTT
- **version:** 1.9
- **component:** MqttClient_DecodePacket

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 21)

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "A null-dereference vulnerability exists in the `MqttProps_Free` function within the wolfMQTT library.",
    "weaknesses": [
      "Null-dereference"
    ],
    "impact": "A successful exploit could lead to a crash due to a null pointer dereference.",
    "attack_vectors": "The vulnerability was discovered by a fuzzer, suggesting that the crash can be triggered through malformed MQTT packets that manipulate the state related to properties, specifically within the `MqttProps_Free` function.",
    "required_capabilities": "An attacker needs to be able to send a specially crafted MQTT packet to the vulnerable MQTT client/server."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6724 | dense, sparse, graph | dense: 0.561, sparse: 0.108, graph: 0.923 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6190 | dense, sparse, graph | dense: 0.561, sparse: 0.115, graph: 0.762 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5427 | dense, sparse, graph | dense: 0.578, sparse: 0.116, graph: 0.650 |
| 4 | CWE-681 | Incorrect Conversion between Numeric Types | Base | Allowed | 0.3745 | sparse, graph | sparse: 0.106, graph: 0.878 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3586 | dense, sparse | dense: 0.593, sparse: 0.160 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3319 | sparse, graph | sparse: 0.087, graph: 0.789 |
| 7 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3284 | dense, sparse | dense: 0.545, sparse: 0.097 |
| 8 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3273 | dense, sparse | dense: 0.546, sparse: 0.095 |
| 9 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3232 | dense, sparse | dense: 0.532, sparse: 0.100 |
| 10 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3217 | dense, sparse | dense: 0.527, sparse: 0.102 |

