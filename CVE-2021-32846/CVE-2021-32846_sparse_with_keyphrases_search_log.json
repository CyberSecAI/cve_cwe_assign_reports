{
  "method": "sparse_with_keyphrases",
  "query": "HyperKit is a toolkit for embedding hypervisor capabilities in an application. In versions 0.20210107, function `pci_vtsock_proc_tx` in `virtio-sock` can lead to to uninitialized memory use. In this situation, there is a check for the return value to be less or equal to `VTSOCK_MAXSEGS`, but that check is not sufficient because the function can return `-1` if it finds an error it cannot recover from. Moreover, the negative return value will be used by `iovec_pull` in a while condition that can further lead to more corruption because the function is not designed to handle a negative `iov_len`. This issue may lead to a guest crashing the host causing a denial of service and, under certain circumstance, memory corruption. This issue is fixed in commit af5eba2360a7351c08dfd9767d9be863a50ebaba.",
  "keyphrases": {
    "rootcause": "uninitialized memory use"
  },
  "timestamp": "2025-03-17T23:48:39.477912",
  "results_count": 20,
  "results_summary": [
    {
      "doc_id": "CWE-394",
      "name": "Unexpected Status Code or Return Value",
      "score": 1374.0956884563655
    },
    {
      "doc_id": "CWE-252",
      "name": "Unchecked Return Value",
      "score": 917.6738683707674
    },
    {
      "doc_id": "CWE-909",
      "name": "Missing Initialization of Resource",
      "score": 781.9852355002686
    },
    {
      "doc_id": "CWE-824",
      "name": "Access of Uninitialized Pointer",
      "score": 765.9198920499504
    },
    {
      "doc_id": "CWE-754",
      "name": "Improper Check for Unusual or Exceptional Conditions",
      "score": 764.705348557289
    }
  ]
}