# Vulnerability Information: CVE-2021-46474

## Vulnerability Description
Jsish v3.5.0 was discovered to contain a **heap buffer overflow** via jsiEvalCodeSub in src/jsiEval.c. This vulnerability can lead to a Denial of Service (DoS).

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **impact:** Denial of Service (DoS)
- **version:** v3.5.0
- **component:** jsiEvalCodeSub in src/jsiEval.c

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-416

#### Top CWEs
- CWE-416 (Count: 40)
- CWE-NVD-noinfo (Count: 21)
- CWE-787 (Count: 20)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A heap-buffer-overflow vulnerability exists in the `jsiEvalCodeSub` function in `src/jsiEval.c` at line 1366.
- **Weaknesses/vulnerabilities present**: Heap-buffer-overflow. This occurs during the execution of the `jsiEvalCodeSub` function when evaluating code.
- **Impact of exploitation**: The heap-buffer-overflow can lead to a crash, denial of service, or potentially arbitrary code execution. The provided output shows that the program crashed with an AddressSanitizer error, indicating memory corruption.
- **Attack vectors**: The vulnerability can be triggered by evaluating crafted JavaScript code, specifically involving the use of `eval` within a function in strict mode and an object property access.
- **Required attacker capabilities/position**: An attacker needs the ability to provide input to the `jsish` interpreter to execute the malicious JavaScript code.

The provided content gives more detail than a typical CVE description, including the exact code location of the bug, a test case, and the full output from AddressSanitizer showing the memory corruption.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6880 | dense, sparse, graph | dense: 0.527, sparse: 0.170, graph: 0.915 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6517 | dense, sparse, graph | dense: 0.536, sparse: 0.169, graph: 0.802 |
| 3 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5292 | dense, sparse, graph | dense: 0.554, sparse: 0.166, graph: 0.561 |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.5026 | dense, sparse, graph | dense: 0.522, sparse: 0.146, graph: 0.442 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3694 | dense, sparse | dense: 0.553, sparse: 0.216 |
| 6 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3669 | sparse, graph | sparse: 0.148, graph: 0.789 |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3481 | dense, sparse | dense: 0.529, sparse: 0.146 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3477 | dense, sparse | dense: 0.555, sparse: 0.173 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3468 | dense, sparse | dense: 0.509, sparse: 0.161 |
| 10 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.3179 | dense, sparse | dense: 0.522, sparse: 0.146 |

