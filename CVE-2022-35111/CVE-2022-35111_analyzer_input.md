# Vulnerability Information: CVE-2022-35111

## Vulnerability Description
SWFTools commit 772e55a2 was discovered to contain a **stack overflow** via __sanitizerStackDepotNodehash(__sanitizerStackTrace const&) at /sanitizer_common/sanitizer_stackdepot.cpp.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** SWFTools
- **version:** commit 772e55a2
- **component:** __sanitizerStackDepotNodehash

## CVE Reference Links Content Summary
The provided content details multiple vulnerabilities reported in `swftools/swftools` project, specifically affecting the `pdf2swf` utility. These include:

**1. Heap Buffer Overflow:**
   - **Root cause:**  A heap buffer overflow occurs in the `draw_stroke` function within `stroke.c`.
   - **Vulnerability:** Writing beyond the allocated memory boundary.
   - **Impact:** Program crash, potential for arbitrary code execution.
   - **Attack vector:** Processing a specially crafted PDF file.
   - **Required attacker capabilities/position:** Ability to provide a malicious PDF file to `pdf2swf`.

**2. Stack Buffer Overflow:**
   - **Root cause:** Stack overflow during the processing of a crafted PDF file. There are multiple instances, one in `sanitizer_stackdepot.cpp`, one in `vfprintf.c`, and another in `asan_allocator.cpp`.
   - **Vulnerability:** Overwriting stack memory.
   - **Impact:** Program crash, potential for arbitrary code execution.
   - **Attack vector:** Processing a specially crafted PDF file.
  - **Required attacker capabilities/position:** Ability to provide a malicious PDF file to `pdf2swf`.

**3. Memory Leak:**
    - **Root cause:** Memory leak in `rfx_alloc` within `mem.c`
    - **Vulnerability:** Failure to free allocated memory.
    - **Impact:** Memory exhaustion, potential denial of service.
    - **Attack vector:** Processing a specific PDF file.
    - **Required attacker capabilities/position:** Ability to provide a malicious PDF file to `pdf2swf`.

**4. Segmentation Fault (SEGV):**
    - **Root cause:** A segmentation fault occurs within the `DCTStream::getChar` function, likely due to a read from an invalid memory address.
    - **Vulnerability:** Attempting to read from an invalid memory location.
    - **Impact:** Program crash.
    - **Attack vector:** Processing a specially crafted PDF file that triggers the faulty code in `DCTStream::getChar`.
    - **Required attacker capabilities/position:** Ability to provide a malicious PDF file to `pdf2swf`.

The provided information includes the crash information, stack traces, and the commands to reproduce each of the mentioned vulnerabilities. It also includes the specific files that trigger each of these issues.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5815 | dense, sparse, graph | dense: 0.552, sparse: 0.102, graph: 0.690 |
| 2 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4584 | dense, sparse, graph | dense: 0.528, sparse: 0.066, graph: 0.544 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3231 | sparse, graph | sparse: 0.092, graph: 0.757 |
| 4 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3173 | sparse, graph | sparse: 0.061, graph: 0.789 |
| 5 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.3017 | dense, sparse | dense: 0.526, sparse: 0.067 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3005 | dense, sparse | dense: 0.549, sparse: 0.089 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.2974 | dense, sparse | dense: 0.541, sparse: 0.090 |
| 8 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.2962 | dense, sparse | dense: 0.507, sparse: 0.075 |
| 9 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.2959 | dense, sparse | dense: 0.513, sparse: 0.069 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.2930 | dense, sparse | dense: 0.504, sparse: 0.071 |

