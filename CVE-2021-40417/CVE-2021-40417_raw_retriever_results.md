# Raw Retriever Results for CVE-2021-40417

# Raw Retriever Results for CVE-2021-40417

## Query
When parsing a file that is submitted to the DPDecoder service as a job, the service will use the combination of decoding parameters that were submitted with the job along with fields that were parsed for the submitted video by the R3D SDK to calculate the size of a heap buffer. Due to an integer overflow with regards to this calculation, this can result in an undersized heap buffer being allocated. When this heap buffer is written to, a heap-based buffer overflow will occur. This can result in code execution under the context of the application.

## Keyphrases
- **rootcause**: integer overflow
- **weakness**: heap-based buffer overflow

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3930 | 0.4487 | 0.4106 | 0.4058 | 20 |
| Sparse | 626.4386 | 1437.5044 | 1096.1653 | 1080.6890 | 20 |
| Graph | 1.4040 | 2.4796 | 1.8156 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | 2.4796 | Allowed |
| 2 | 131 | Incorrect Calculation of Buffer Size | Base | 2.4709 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 5 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 6 | 195 | Signed to Unsigned Conversion Error | variant | 2.2032 | Allowed |
| 7 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 8 | 197 | Numeric Truncation Error | Base | 1.7429 | Allowed |
| 9 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 10 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | base | 1.6848 | Allowed |
| 11 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 12 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 1.6848 | Allowed |
| 13 | 805 | Buffer Access with Incorrect Length Value | Base | 1.6392 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.5743 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 1.5399 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | 0.4487 | 0.4487 | Allowed |
| 2 | 122 | Heap-based Buffer Overflow | Variant | 0.4460 | 0.4460 | Allowed |
| 3 | 126 | Buffer Over-read | Variant | 0.4383 | 0.4383 | Allowed |
| 4 | 680 | Integer Overflow to Buffer Overflow | Compound | 0.4288 | 0.4288 | Discouraged |
| 5 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4271 | 0.4271 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | 0.4145 | 0.4145 | Allowed-with-Review |
| 7 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 0.4141 | 0.4141 | Allowed |
| 8 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4071 | 0.4071 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4066 | 0.4066 | Allowed |
| 10 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4058 | 0.4058 | Allowed |
| 11 | 674 | Uncontrolled Recursion | Class | 0.4057 | 0.4057 | Allowed-with-Review |
| 12 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.4053 | 0.4053 | Allowed |
| 13 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | Variant | 0.4016 | 0.4016 | Allowed |
| 14 | 788 | Access of Memory Location After End of Buffer | Base | 0.3970 | 0.3970 | Discouraged |
| 15 | 806 | Buffer Access Using Size of Source Buffer | Variant | 0.3958 | 0.3958 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | 1437.5044 | 1437.5044 | Allowed |
| 2 | CWE-122 | Heap-based Buffer Overflow | 1211.0004 | 1211.0004 | Allowed |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | 1200.6214 | 1200.6214 | Allowed |
| 4 | CWE-131 | Incorrect Calculation of Buffer Size | 1195.8734 | 1195.8734 | Allowed |
| 5 | CWE-197 | Numeric Truncation Error | 1154.4825 | 1154.4825 | Allowed |
| 6 | CWE-193 | Off-by-one Error | 1150.0697 | 1150.0697 | Allowed |
| 7 | CWE-126 | Buffer Over-read | 1146.2748 | 1146.2748 | Allowed |
| 8 | CWE-125 | Out-of-bounds Read | 1127.3439 | 1127.3439 | Allowed |
| 9 | CWE-681 | Incorrect Conversion between Numeric Types | 1123.0334 | 1123.0334 | Allowed |
| 10 | CWE-191 | Integer Underflow (Wrap or Wraparound) | 1081.8746 | 1081.8746 | Allowed |
| 11 | CWE-121 | Stack-based Buffer Overflow | 1079.5034 | 1079.5034 | Allowed |
| 12 | CWE-194 | Unexpected Sign Extension | 1077.4545 | 1077.4545 | Allowed |
| 13 | CWE-195 | Signed to Unsigned Conversion Error | 1063.5156 | 1063.5156 | Allowed |
| 14 | CWE-787 | Out-of-bounds Write | 1059.8129 | 1059.8129 | Allowed |
| 15 | CWE-843 | Access of Resource Using Incompatible Type ('Type Confusion') | 1049.5778 | 1049.5778 | Allowed |
