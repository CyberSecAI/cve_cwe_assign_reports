# Vulnerability Information: CVE-2022-45552

## Vulnerability Description
An **Insecure Permissions** vulnerability in Shenzhen Zhiboton Electronics ZBT WE1626 Router v 21.06.18 allows attackers to obtain sensitive information via SPI bus interface connected to pinout of the NAND flash memory.

### Vulnerability Description Key Phrases
- **rootcause:** **Insecure Permissions**
- **impact:** obtain sensitive information
- **vector:** SPI bus interface connected to pinout of the NAND flash memory
- **attacker:** attackers
- **product:** Shenzhen Zhiboton Electronics ZBT WE1626 Router
- **version:** v 21.06.18

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerabilities found in the ZBT WE1626 Wireless Router:

**1. Unauthenticated Remote Code Execution**

*   **Root Cause:** The router's web application allows unauthenticated users to submit requests to the `test_wget` endpoint, enabling them to execute arbitrary WGET commands. This is due to the lack of proper authentication checks on this endpoint. Additionally, the web application verifies authentication via the local filesystem, and does not properly secure the `/etc/shadow` file allowing it to be overwritten.
*   **Vulnerability:**
    *   Unauthenticated access to the `test_wget` endpoint.
    *   Arbitrary file write due to the lack of input sanitization in the `test_wget` endpoint which can be used to overwrite the `/etc/shadow` file, gaining administrator access.
    *   Arbitrary file write can also be used to overwrite the `start_4g_entry.sh` file with a malicious reverse shell payload.
*   **Impact:**
    *   Complete compromise of the router.
    *   Ability to execute arbitrary code as root.
    *   Manipulation of router configuration.
    *   Potential for further network attacks.
*   **Attack Vector:**
    1.  An attacker sends an unauthenticated request to the `test_wget` endpoint to download a malicious `/etc/shadow` replacement file, changing the password for the root user.
    2.  The attacker logs into the web application with the new credentials and obtains an access token.
    3.  The attacker sends another unauthenticated request to the `test_wget` endpoint to download a malicious reverse shell payload and overwrite the `start_4g_entry.sh` file.
    4.  The attacker sends an authenticated request to trigger the execution of the `start_4g_entry.sh` file via the `set_4g` function and obtain a reverse shell.
*   **Required Attacker Capabilities:**
    *   Network access to the router's web interface.
    *   Ability to host a payload on a server accessible by the router.

**2. Insufficient Debug Interface Protection**

*   **Root Cause:** The router's firmware is unencrypted, and no signature validation is performed, allowing an attacker to easily extract the firmware, modify it and redeploy it. Additionally, access to the device's flash memory via the SPI bus is not protected.
*   **Vulnerabilities:**
    *   Unencrypted firmware.
    *   Lack of firmware signature validation.
    *   Unprotected access to the SPI bus interface.
*   **Impact:**
    *   Extraction of sensitive information, including passwords from `/etc/shadow` and `/etc/passwd`.
    *   Ability to modify and redeploy compromised firmware.
    *   Full compromise of the device.
*   **Attack Vector:**
    1.  An attacker connects a SPI bus interface device to the flash memory pinout.
    2.  The attacker uses `flashrom` to extract the firmware.
    3.  The attacker modifies the firmware (e.g., adds a backdoor).
    4.  The attacker uses `flashrom` to flash the modified firmware to the device.
*   **Required Attacker Capabilities:**
    *   Physical access to the device.
    *   Knowledge of the device's flash memory pinout.
    *   Ability to use SPI bus interface device.

**3. Insufficient UART Interface Protections**

*  **Root Cause:** The UART interface is accessible without authentication, providing a command line shell with root privileges.
*   **Vulnerabilities:**
    *   Unprotected UART interface access.
    *   Direct root access through the UART console.
*   **Impact:**
    *   Complete control over the device.
    *   Ability to execute arbitrary code with root privileges.
    *   Access to sensitive system information.
*   **Attack Vector:**
    1.  An attacker connects a UART serial adapter to the device's UART ports (TX, RX, and GND).
    2.  The attacker uses a tool like `screen` to connect to the UART console.
    3.  The attacker gains a root shell when the device powers on.
*   **Required Attacker Capabilities:**
    *   Physical access to the device.
    *   Knowledge of the device's UART pinout.
    *   Ability to connect to the UART interface.

The provided document describes multiple vulnerabilities and provides specific technical details about how to exploit them.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | Allowed | 0.8356 | dense, sparse, graph | dense: 0.646, sparse: 0.345, graph: 0.880 |
| 2 | CWE-420 | Unprotected Alternate Channel | Base | Allowed | 0.4162 | sparse, graph | sparse: 0.108, graph: 0.991 |
| 3 | CWE-276 | Incorrect Default Permissions | Base | Allowed | 0.3804 | sparse, graph | sparse: 0.114, graph: 0.882 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3393 | dense, sparse | dense: 0.558, sparse: 0.105 |
| 5 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.2869 | sparse, graph | sparse: 0.126, graph: 0.601 |
| 6 | CWE-184 | Incomplete List of Disallowed Inputs | Base | Allowed | 0.2730 | sparse, graph | sparse: 0.101, graph: 0.602 |
| 7 | CWE-522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | 0.1965 | dense, sparse | dense: 0.549, sparse: 0.104 |
| 8 | CWE-287 | Improper Authentication | Class | Discouraged | 0.1506 | dense, sparse | dense: 0.552, sparse: 0.105 |
| 9 | CWE-284 | Improper Access Control | Pillar | Discouraged | 0.1150 | dense, sparse | dense: 0.567, sparse: 0.103 |
| 10 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.0609 | sparse | sparse: 0.107 |

