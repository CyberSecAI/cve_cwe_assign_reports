# Vulnerability Information: CVE-2021-36762

## Vulnerability Description
An issue was discovered in HCC Embedded InterNiche NicheStack through 4.3. The tfshnd()tftpsrv.c TFTP packet processing function doesnt ensure that a filename is adequately \0 terminated therefore, a subsequent call to strlen for the filename might read out of bounds of the protocol packet buffer (if no \0 byte exists within a reasonable range).

### Vulnerability Description Key Phrases
- **rootcause:** **lack of zero termination**
- **weakness:** **out-of-bounds read**
- **product:** HCC Embedded InterNiche NicheStack
- **version:** through 4.3
- **component:** tfshnd() function in tftpsrv.c

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2021-36762:

**Root cause of vulnerability:**
- The TFTP packet processing function in NicheStack does not ensure that a filename is null-terminated.

**Weaknesses/vulnerabilities present:**
- **Missing null termination:** The code fails to ensure that the filename within a TFTP packet is properly null-terminated.
- **Out-of-bounds read:** When `strlen()` is subsequently called on the filename, it may read beyond the bounds of the protocol packet buffer if the filename is not null-terminated.

**Impact of exploitation:**
- Denial of Service (DoS): The out-of-bounds read can lead to a crash or unexpected behavior, resulting in a denial of service.

**Attack vectors:**
- Network: The vulnerability can be exploited by sending a specially crafted TFTP packet with a filename that lacks a null terminator to a vulnerable device.

**Required attacker capabilities/position:**
- Network access: The attacker needs to be able to send network packets to the target device.
- No authentication needed: The vulnerability does not require any authentication.

**Additional Notes:**
- The affected component is the TFTP module within the NicheStack TCP/IP stack.
- The vulnerability affects all versions of NicheStack prior to 4.3.
- The vendor, HCC Embedded, has released a fix for the issue in the `in_tftp` module version 1.2.
- The provided table of vulnerabilities (INFRA:HALT) indicates a CVSS v3.1 score of 7.5 for this vulnerability, classifying it as high severity.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-170 | Improper Null Termination | Base | Allowed | 1.0302 | dense, sparse, graph | dense: 0.554, sparse: 0.773, graph: 0.870 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6065 | sparse, graph | sparse: 0.435, graph: 1.000 |
| 3 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5259 | sparse, graph | sparse: 0.378, graph: 0.865 |
| 4 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.5247 | dense, sparse | dense: 0.504, sparse: 0.477 |
| 5 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.4861 | dense, sparse | dense: 0.510, sparse: 0.404 |
| 6 | CWE-823 | Use of Out-of-range Pointer Offset | Base | Allowed | 0.4856 | sparse, graph | sparse: 0.224, graph: 1.000 |
| 7 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4844 | dense, sparse | dense: 0.505, sparse: 0.405 |
| 8 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.4807 | dense, sparse | dense: 0.510, sparse: 0.394 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4506 | dense, sparse | dense: 0.505, sparse: 0.412 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4485 | dense, sparse | dense: 0.506, sparse: 0.407 |

