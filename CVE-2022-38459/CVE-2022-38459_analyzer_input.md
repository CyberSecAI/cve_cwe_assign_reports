# Vulnerability Information: CVE-2022-38459

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in the httpd downfile.cgi functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. A specially-crafted HTTP request can lead to remote code execution. An attacker can send an HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially-crafted HTTP request
- **attacker:** attacker
- **product:** Siretta QUARTZ-GOLD
- **version:** G5.0.1.5-210720-141020
- **component:** httpd downfile.cgi functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 36)
- CWE-120 (Count: 6)
- CWE-1284 (Count: 1)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The `downfile.cgi` script in Siretta QUARTZ-GOLD routers uses `sprintf` to construct a file path without checking the size of the input `_filename` parameter, leading to a stack-based buffer overflow.
- **Weaknesses/vulnerabilities present:** A classic stack-based buffer overflow (CWE-120) due to the usage of `sprintf` without bounds checking.
- **Impact of exploitation:** Successful exploitation can lead to remote code execution, allowing an attacker to gain control of the device.
- **Attack vectors:** Sending a specially crafted HTTP POST request to the `/downfile.cgi` endpoint with an overly long `_filename` parameter.
- **Required attacker capabilities/position:** An attacker must be able to send HTTP requests to the vulnerable device and have valid authentication credentials for the router's web interface.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7535 | dense, sparse, graph | dense: 0.590, sparse: 0.488, graph: 0.601 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6331 | dense, sparse, graph | dense: 0.532, sparse: 0.242, graph: 0.639 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4338 | sparse, graph | sparse: 0.238, graph: 0.832 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4214 | dense, sparse | dense: 0.612, sparse: 0.263 |
| 5 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3914 | dense, sparse | dense: 0.527, sparse: 0.223 |
| 6 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3853 | dense, sparse | dense: 0.526, sparse: 0.213 |
| 7 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3845 | dense, sparse | dense: 0.527, sparse: 0.211 |
| 8 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3833 | dense, sparse | dense: 0.532, sparse: 0.204 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3729 | dense, sparse | dense: 0.548, sparse: 0.227 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2343 | dense, sparse | dense: 0.535, sparse: 0.229 |

