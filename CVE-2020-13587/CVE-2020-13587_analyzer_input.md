# Vulnerability Information: CVE-2020-13587

## Vulnerability Description
An exploitable **SQL injection** vulnerability exists in the forms_fields_rules/rules page of the Rukovoditel Project Management App 2.7.2. A specially crafted HTTP request can lead to **SQL injection**. An attacker can make an authenticated HTTP request to trigger this vulnerability, this can be done either with administrator credentials or through cross-site request forgery.

### Vulnerability Description Key Phrases
- **weakness:** **SQL injection**
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Rukovoditel Project Management App
- **version:** 2.7.2
- **component:** forms_fields_rules/rules page

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 22)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `id` parameter in the `forms_fields_rules/rules` page is vulnerable to SQL injection due to the lack of sanitization/filtering. The unsanitized `id` parameter is directly used in an SQL query.
- **Weaknesses/vulnerabilities present**: SQL injection (CWE-89)
- **Impact of exploitation**: An attacker can execute arbitrary SQL queries on the database, potentially leading to data exfiltration, modification, or other malicious actions. The impact is rated as having low confidentiality and integrity impact and no availability impact.
- **Attack vectors**: A specially crafted HTTP POST request to the `/crm/index.php?module=forms_fields_rules/rules&action=get_fields_choices` endpoint with a malicious SQL payload in the `id` parameter.
- **Required attacker capabilities/position**: The attacker needs to be authenticated or trigger the vulnerability through cross-site request forgery. Authentication can be done with administrator credentials.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.7805 | dense, sparse, graph | dense: 0.533, sparse: 0.273, graph: 1.000 |
| 2 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.7561 | dense, sparse, graph | dense: 0.586, sparse: 0.433, graph: 0.602 |
| 3 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.6634 | dense, sparse, graph | dense: 0.518, sparse: 0.261, graph: 0.713 |
| 4 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.4681 | dense, sparse, graph | dense: 0.514, sparse: 0.275, graph: 0.543 |
| 5 | CWE-502 | Deserialization of Untrusted Data | Base | Allowed | 0.4119 | dense, sparse | dense: 0.512, sparse: 0.272 |
| 6 | CWE-918 | Server-Side Request Forgery (SSRF) | Base | Allowed | 0.3932 | dense, sparse | dense: 0.488, sparse: 0.261 |
| 7 | CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | 0.3772 | sparse, graph | sparse: 0.259, graph: 0.729 |
| 8 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3738 | dense, sparse | dense: 0.498, sparse: 0.249 |
| 9 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3690 | sparse, graph | sparse: 0.250, graph: 0.631 |
| 10 | CWE-611 | Improper Restriction of XML External Entity Reference | Base | Allowed | 0.1485 | sparse | sparse: 0.260 |

