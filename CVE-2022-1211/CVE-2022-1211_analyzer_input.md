# Vulnerability Information: CVE-2022-1211

## Vulnerability Description
A vulnerability classified as critical has been found in tildearrow Furnace dev73. This affects the FUR to VGM converter in console mode which causes **stack-based overflows** and crashes. It is possible to initiate the attack remotely but it requires user-interaction. A POC has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based overflows**
- **impact:** crashes
- **product:** tildearrow Furnace
- **version:** dev73
- **component:** FUR to VGM converter in console mode

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
A stack-based buffer overflow vulnerability in the FUR to VGM converter within tildearrow Furnace dev73.

Weaknesses/vulnerabilities present:
- Stack-based buffer overflow (CWE-121, CWE-787, CWE-119)

Impact of exploitation:
- Crashes and potentially other impacts related to confidentiality, integrity, and availability.
-  The vulnerability can lead to arbitrary code execution if successfully exploited.

Attack vectors:
- Network: The vulnerability can be exploited remotely, but requires user interaction.

Required attacker capabilities/position:
- An attacker needs to provide a specially crafted input to the FUR to VGM converter.
- User interaction is required to trigger the vulnerability.

Additional details:
- A proof-of-concept exploit is publicly available.
- The vulnerability was discovered through fuzz testing.
- The issue was addressed by hardening the file loader, specifically for .fur and .dmf files, to prevent out-of-bounds access.
- The fix was deployed in commits `3a7a132` and `258a905` for `tildearrow/furnace`
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6564 | dense, sparse, graph | dense: 0.561, sparse: 0.225, graph: 0.690 |
| 2 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.4933 | sparse, graph | sparse: 0.237, graph: 1.000 |
| 3 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.4511 | sparse, graph | sparse: 0.253, graph: 0.857 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4171 | dense, sparse | dense: 0.615, sparse: 0.252 |
| 5 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.4105 | dense, sparse | dense: 0.565, sparse: 0.224 |
| 6 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.4062 | sparse, graph | sparse: 0.202, graph: 0.813 |
| 7 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.4005 | dense, sparse | dense: 0.558, sparse: 0.212 |
| 8 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3444 | sparse, graph | sparse: 0.207, graph: 0.631 |
| 9 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2523 | dense, sparse | dense: 0.587, sparse: 0.237 |
| 10 | CWE-1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | 0.1213 | sparse | sparse: 0.212 |

