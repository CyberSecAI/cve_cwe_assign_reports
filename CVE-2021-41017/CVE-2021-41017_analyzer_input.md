# Vulnerability Information: CVE-2021-41017

## Vulnerability Description
Multiple **heap-based buffer overflow** vulnerabilities in some web API controllers of FortiWeb 6.4.1, 6.4.0, and 6.3.0 through 6.3.15 may allow a remote authenticated attacker to execute arbitrary code or commands via specifically crafted HTTP requests.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **impact:** execute arbitrary code or commands
- **vector:** specifically crafted HTTP requests
- **attacker:** remote authenticated attacker
- **product:** FortiWeb
- **version:** 6.4.1, 6.4.0, and 6.3.0 through 6.3.15
- **component:** web API controllers

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Multiple heap-based buffer overflows in web API controllers.
- **Weaknesses/vulnerabilities present**: Heap-based buffer overflow (CWE-122).
- **Impact of exploitation**: Remote authenticated attacker can execute arbitrary code or commands on the affected system.
- **Attack vectors**: Specifically crafted HTTP requests to the web API controllers.
- **Required attacker capabilities/position**: Authenticated attacker with network access to the FortiWeb interface.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7136 | dense, sparse, graph | dense: 0.568, sparse: 0.185, graph: 1.000 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6733 | dense, sparse, graph | dense: 0.576, sparse: 0.209, graph: 0.742 |
| 3 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.6614 | dense, sparse, graph | dense: 0.585, sparse: 0.180, graph: 0.744 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4330 | sparse, graph | sparse: 0.206, graph: 0.882 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4032 | dense, sparse | dense: 0.630, sparse: 0.212 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4019 | dense, sparse | dense: 0.619, sparse: 0.220 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3968 | dense, sparse | dense: 0.575, sparse: 0.190 |
| 8 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3910 | dense, sparse | dense: 0.579, sparse: 0.177 |
| 9 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.3797 | sparse, graph | sparse: 0.170, graph: 0.789 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3791 | dense, sparse | dense: 0.595, sparse: 0.198 |

