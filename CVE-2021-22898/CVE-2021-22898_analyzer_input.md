# Vulnerability Information: CVE-2021-22898

## Vulnerability Description
curl 7.7 through 7.76.1 suffers from an information disclosure when the `-t` command line option, known as `CURLOPT_TELNETOPTIONS` in libcurl, is used to send variable=content pairs to TELNET servers. Due to a flaw in the option parser for sending NEW_ENV variables, libcurl could be made to pass on **uninitialized data from a stack based buffer** to the server, resulting in potentially revealing sensitive internal information to the server using a clear-text network protocol.

### Vulnerability Description Key Phrases
- **rootcause:** **uninitialized data from a stack based buffer**
- **impact:** information disclosure
- **vector:** using the -t command line option
- **product:** curl
- **version:** 7.7 through 7.76.1
- **component:** -t command line option

## CVE Reference Links Content Summary
```
{
  "guidelines": [
    "1. First verify if the content relates to the CVE specified based on the official description",
    "2. If the content does not relate to this CVE, respond with \"UNRELATED\"",
    "3. If no useful vulnerability information is found, respond with \"NOINFO\"",
    "4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position",
    "Additional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description"
  ],
  "response": {
    "related": true,
    "information": {
      "root_cause": "A flaw in the option parser for sending NEW_ENV variables, libcurl could be made to pass on uninitialized data from a stack based buffer to the server, resulting in potentially revealing sensitive internal information to the server using a clear-text network protocol. This occurs because curl did not check the return code from a sscanf() function invoke correctly.",
      "weaknesses": [
        "Improper handling of sscanf return code",
        "Use of uninitialized stack-based buffer",
        "Information disclosure via clear-text network protocol"
      ],
      "impact": "Exposure of sensitive internal information from the stack to the TELNET server via a clear-text network protocol.",
       "attack_vectors": [
        "Malicious TELNET server",
        "Specially crafted NEW_ENV option in curl"
      ],
      "required_capabilities": "Attacker needs to be able to control the server response or be in a position to MITM the connection to a TELNET server.",
	    "additional_details" : "A single curl TELNET handshake could send around 1800 bytes of (non-contiguous) stack contents in an interleaved format."
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.6364 | dense, sparse, graph | dense: 0.502, sparse: 0.338, graph: 0.537 |
| 2 | CWE-253 | Incorrect Check of Function Return Value | Base | Allowed | 0.5840 | sparse, graph | sparse: 0.689, graph: 0.532 |
| 3 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.5754 | sparse, graph | sparse: 0.381, graph: 1.000 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4721 | sparse, graph | sparse: 0.352, graph: 0.757 |
| 5 | CWE-212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | 0.4419 | dense, sparse | dense: 0.484, sparse: 0.349 |
| 6 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.4212 | sparse, graph | sparse: 0.342, graph: 0.729 |
| 7 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4147 | dense, sparse | dense: 0.496, sparse: 0.351 |
| 8 | CWE-457 | Use of Uninitialized Variable | Variant | Allowed | 0.3646 | sparse, graph | sparse: 0.353, graph: 0.540 |
| 9 | CWE-909 | Missing Initialization of Resource | Class | Allowed-with-Review | 0.3114 | sparse, graph | sparse: 0.357, graph: 0.911 |
| 10 | CWE-193 | Off-by-one Error | Base | Allowed | 0.1955 | sparse | sparse: 0.342 |

