# Vulnerability Information: CVE-2021-44170

## Vulnerability Description
A **stack-based buffer overflow** vulnerability [CWE-121] in the command line interpreter of FortiOS before 7.0.4 and FortiProxy before 2.0.8 may allow an authenticated attacker to execute unauthorized code or commands via specially crafted command line arguments.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **impact:** execute unauthorized code or commands
- **vector:** specially crafted command line arguments
- **attacker:** authenticated attacker
- **product:** FortiOS and FortiProxy
- **version:** before 7.0.4 and before 2.0.8
- **component:** command line interpreter

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A stack-based buffer overflow exists in the command line interpreter.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-121).
- **Impact of exploitation**: An authenticated attacker can execute unauthorized code or commands.
- **Attack vectors**: By providing specially crafted command-line arguments to the diagnostic CLI commands.
- **Required attacker capabilities/position**: The attacker needs to be authenticated.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.7327 | dense, sparse, graph | dense: 0.588, sparse: 0.186, graph: 0.929 |
| 2 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.7288 | dense, sparse, graph | dense: 0.592, sparse: 0.208, graph: 0.975 |
| 3 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7237 | dense, sparse, graph | dense: 0.556, sparse: 0.207, graph: 0.916 |
| 4 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4241 | dense, sparse | dense: 0.635, sparse: 0.248 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4142 | sparse, graph | sparse: 0.204, graph: 0.832 |
| 6 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.4005 | dense, sparse | dense: 0.596, sparse: 0.179 |
| 7 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3876 | dense, sparse | dense: 0.569, sparse: 0.180 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3679 | dense, sparse | dense: 0.565, sparse: 0.203 |
| 9 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3559 | dense, sparse | dense: 0.561, sparse: 0.183 |
| 10 | CWE-269 | Improper Privilege Management | Class | Discouraged | 0.1733 | dense, sparse | dense: 0.569, sparse: 0.179 |

