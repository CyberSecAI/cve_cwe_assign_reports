# Vulnerability Information: CVE-2021-25314

## Vulnerability Description
A Creation of Temporary File With Insecure Permissions vulnerability in hawk2 of SUSE Linux Enterprise High Availability 12-SP3, SUSE Linux Enterprise High Availability 12-SP5, SUSE Linux Enterprise High Availability 15-SP2 allows local attackers to escalate to root. This issue affects SUSE Linux Enterprise High Availability 12-SP3 hawk2 versions prior to 2.6.3+git.1614685906.812c31e9. SUSE Linux Enterprise High Availability 12-SP5 hawk2 versions prior to 2.6.3+git.1614685906.812c31e9. SUSE Linux Enterprise High Availability 15-SP2 hawk2 versions prior to 2.6.3+git.1614684118.af555ad9.

### Vulnerability Description Key Phrases
- **rootcause:** **creation of temporary file with insecure permissions**
- **impact:** escalate to root
- **attacker:** local attackers
- **product:** SUSE Linux Enterprise High Availability
- **version:** 12-SP3 hawk2 prior to 2.6.3+git.1614685906.812c31e9 and 12-SP5 hawk2 prior to 2.6.3+git.1614685906.812c31e9 and 15-SP2 hawk2 prior to 2.6.3+git.1614684118.af555ad9
- **component:** hawk2

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Insecure file permissions set on temporary files created by the `hawk2` application. Specifically, files were created with `0666` permissions, allowing any local user to read and write them.
- **Weaknesses/vulnerabilities present**:
    - Insecure file permissions (0666) on temporary files.
    - Ability for local users to modify the Cluster Information Base (CIB) through `hawk/app/lib/invoker.rb`.
    - Potential root exploit through `hawk/app/lib/crm_script.rb`.
- **Impact of exploitation**:
    - **Denial of Service (DoS)** through modification of graph generation files (`hawk/app/models/report.rb`).
    - **Arbitrary CIB manipulation** by local users, potentially leading to cluster disruption and unauthorized actions.
    - **Root privilege escalation** through misuse of the crm utility (`hawk/app/lib/crm_script.rb`).
- **Attack vectors**:
    - Exploitation of insecure file permissions by local users.
- **Required attacker capabilities/position**:
    - Local access to the system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-378 | Creation of Temporary File With Insecure Permissions | Base | Allowed | 1.0900 | dense, sparse, graph | dense: 0.594, sparse: 1.000, graph: 0.617 |
| 2 | CWE-379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | 0.7095 | dense, sparse, graph | dense: 0.573, sparse: 0.356, graph: 0.613 |
| 3 | CWE-267 | Privilege Defined With Unsafe Actions | Base | Allowed | 0.6826 | dense, sparse, graph | dense: 0.503, sparse: 0.420, graph: 0.534 |
| 4 | CWE-61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | 0.5962 | dense, sparse, graph | dense: 0.507, sparse: 0.512, graph: 0.639 |
| 5 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.4733 | dense, sparse | dense: 0.505, sparse: 0.386 |
| 6 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.4226 | dense, sparse | dense: 0.484, sparse: 0.315 |
| 7 | CWE-303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | 0.4166 | sparse, graph | sparse: 0.398, graph: 0.528 |
| 8 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.4163 | dense, sparse, graph | dense: 0.512, sparse: 0.409, graph: 0.611 |
| 9 | CWE-23 | Relative Path Traversal | Base | Allowed | 0.2272 | sparse | sparse: 0.397 |
| 10 | CWE-285 | Improper Authorization | Class | Discouraged | 0.2023 | dense, sparse | dense: 0.494, sparse: 0.358 |

