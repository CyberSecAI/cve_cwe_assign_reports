# Vulnerability Information: CVE-2021-22649

## Vulnerability Description
Luxion KeyShot versions prior to 10.1, Luxion KeyShot Viewer versions prior to 10.1, Luxion KeyShot Network Rendering versions prior to 10.1, and Luxion KeyVR versions prior to 10.1 have multiple **NULL pointer dereference** issues while processing project files, which may allow an attacker to execute arbitrary code.

### Vulnerability Description Key Phrases
- **rootcause:** **NULL pointer dereference**
- **impact:** execute arbitrary code
- **vector:** processing project files
- **attacker:** attacker
- **product:** Luxion KeyShot and Luxion KeyShot Viewer and Luxion KeyShot Network Rendering and Luxion KeyVR
- **version:** prior to 10.1

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-22649

**Root Cause:** The vulnerability stems from the lack of proper validation of a user-supplied value before it is dereferenced as a pointer within the parsing process of specific file types.

**Weakness:** Untrusted Pointer Dereference (CWE-822)

**Impact:** Successful exploitation allows an attacker to execute arbitrary code in the context of the current process. This could lead to a complete compromise of the affected system.

**Attack Vectors:**
   - The vulnerability is triggered through the parsing of malicious 3DS or JT files.
   - The attacker must provide a malicious file that is opened by the user in the affected software. This suggests a likely attack vector of either social engineering (email attachments, malicious websites) or by having a malicious file placed in a shared directory that users are likely to access.

**Required Attacker Capabilities/Position:**
   - The attacker needs to craft a malicious 3DS or JT file.
   - The attacker needs to convince the user to open the crafted file with the vulnerable software.

**Affected Products:**
   - Siemens Solid Edge Viewer (parsing 3DS or JT files)
   - KeyShot versions prior to 10.1
   - KeyShot Viewer versions prior to 10.1
   - KeyShot Network Rendering versions prior to 10.1
   - KeyVR versions prior to 10.1
   - Solid Edge SE2020 and SE2021 (due to bundled vulnerable KeyShot versions)
**Additional Notes:**

* The vulnerability requires user interaction.
* The advisory from Siemens mentions that the issue is within the KeyShot component that is bundled with their Solid Edge product.
* The vulnerability was reported by rgod from Zero Day Initiative.
* The vulnerability was present in both parsing of 3DS and JT file formats, indicating a similar issue across these file type parsing routines

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.8138 | dense, sparse, graph | dense: 0.468, sparse: 0.456, graph: 0.892 |
| 2 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.7201 | dense, sparse, graph | dense: 0.450, sparse: 0.240, graph: 1.000 |
| 3 | CWE-824 | Access of Uninitialized Pointer | Base | Allowed | 0.5823 | dense, sparse, graph | dense: 0.442, sparse: 0.201, graph: 0.688 |
| 4 | CWE-252 | Unchecked Return Value | Base | Allowed | 0.4715 | sparse, graph | sparse: 0.201, graph: 0.998 |
| 5 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.3922 | sparse, graph | sparse: 0.192, graph: 0.789 |
| 6 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3263 | sparse, graph | sparse: 0.176, graph: 0.631 |
| 7 | CWE-908 | Use of Uninitialized Resource | Base | Allowed | 0.3156 | dense, sparse | dense: 0.429, sparse: 0.177 |
| 8 | CWE-456 | Missing Initialization of a Variable | Variant | Allowed | 0.2732 | sparse, graph | sparse: 0.182, graph: 0.537 |
| 9 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.2608 | sparse, graph | sparse: 0.172, graph: 0.488 |
| 10 | CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | 0.1600 | sparse, graph | sparse: 0.173, graph: 0.486 |

