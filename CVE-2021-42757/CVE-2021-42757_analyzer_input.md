# Vulnerability Information: CVE-2021-42757

## Vulnerability Description
A **buffer overflow** [CWE-121] in the TFTP client library of FortiOS before 6.4.7 and FortiOS 7.0.0 through 7.0.2, may allow an authenticated local attacker to achieve arbitrary code execution via specially crafted **command line arguments**.

### Vulnerability Description Key Phrases
- **rootcause:** **command line arguments**
- **weakness:** **buffer overflow**
- **impact:** arbitrary code execution
- **attacker:** authenticated local attacker
- **product:** FortiOS
- **version:** before 6.4.7 and FortiOS 7.0.0 through 7.0.2
- **component:** TFTP client library

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A buffer overflow exists in the TFTP client library of FortiOS.
- **Weaknesses/vulnerabilities present:** The vulnerability is a buffer overflow (CWE-121) in the TFTP client library.
- **Impact of exploitation:** An authenticated local attacker can achieve arbitrary code execution by providing specially crafted command line arguments.
- **Attack vectors:** The attack vector is local, exploiting the CLI with malicious command line arguments.
- **Required attacker capabilities/position:** The attacker needs to be an authenticated local user.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.7939 | dense, sparse, graph | dense: 0.602, sparse: 0.319, graph: 0.868 |
| 2 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.7291 | dense, sparse, graph | dense: 0.594, sparse: 0.180, graph: 0.919 |
| 3 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.5535 | sparse, graph | sparse: 0.343, graph: 1.000 |
| 4 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.5446 | sparse, graph | sparse: 0.327, graph: 1.000 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4833 | dense, sparse | dense: 0.625, sparse: 0.369 |
| 6 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4589 | dense, sparse | dense: 0.565, sparse: 0.308 |
| 7 | CWE-494 | Download of Code Without Integrity Check | Base | Allowed | 0.4461 | dense, sparse | dense: 0.564, sparse: 0.287 |
| 8 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4457 | dense, sparse | dense: 0.571, sparse: 0.345 |
| 9 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4288 | sparse, graph | sparse: 0.298, graph: 0.722 |
| 10 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.1816 | sparse | sparse: 0.317 |

