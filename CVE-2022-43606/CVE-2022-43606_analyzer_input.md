# Vulnerability Information: CVE-2022-43606

## Vulnerability Description
A **use-of-uninitialized-pointer** vulnerability exists in the Forward Open connection_management_entry functionality of EIP Stack Group OpENer development commit 58ee13c. A specially-crafted EtherNet/IP request can lead to use of a null pointer, causing the server to crash. An attacker can send a series of EtherNet/IP requests to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **use-of-uninitialized-pointer**
- **impact:** crash
- **vector:** specially-crafted EtherNet/IP request
- **attacker:** attacker
- **product:** EIP Stack Group OpENer
- **version:** development commit 58ee13c
- **component:** Forward Open connection_management_entry functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability stems from a use-of-uninitialized-pointer in the `Forward Open connection_management_entry` functionality. Specifically, when processing a `LargeForwardOpen` request, the `remaining_path` variable is set to the value of `connection_path_size` directly from the request. If the `connection_path_size` is set to `0x00` and no connection path is provided, parsing is bypassed but the code execution continues.
- **Weaknesses/vulnerabilities present**:
    - Use of an uninitialized pointer: The `g_connection_management_list` is initialized with null bytes, but these entries are not overwritten with a valid connection function when no connection path is given in the request and no valid connection is established. The code then tries to dereference the uninitialized function pointer from this list leading to a crash.
    - Lack of input validation: The code does not properly validate the `remaining_path` variable, or ensure that a valid connection management entry exists before attempting to call the `open_connection_function`.
- **Impact of exploitation**: Successful exploitation of this vulnerability leads to a server crash, resulting in a denial-of-service condition.
- **Attack vectors**: An attacker can trigger the vulnerability by sending a specially crafted EtherNet/IP request with a connection path size set to 0x00 and no connection path provided.
- **Required attacker capabilities/position**: The attacker needs to be able to send EtherNet/IP requests to the vulnerable server. No prior authentication is required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.7952 | dense, sparse, graph | dense: 0.499, sparse: 0.329, graph: 1.000 |
| 2 | CWE-824 | Access of Uninitialized Pointer | Base | Allowed | 0.7273 | dense, sparse, graph | dense: 0.577, sparse: 0.429, graph: 0.541 |
| 3 | CWE-457 | Use of Uninitialized Variable | Variant | Allowed | 0.5764 | dense, sparse, graph | dense: 0.521, sparse: 0.297, graph: 0.543 |
| 4 | CWE-252 | Unchecked Return Value | Base | Allowed | 0.5329 | sparse, graph | sparse: 0.307, graph: 1.000 |
| 5 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.5105 | sparse, graph | sparse: 0.285, graph: 0.971 |
| 6 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.4363 | sparse, graph | sparse: 0.269, graph: 0.789 |
| 7 | CWE-562 | Return of Stack Variable Address | Base | Allowed | 0.4008 | dense, sparse | dense: 0.502, sparse: 0.261 |
| 8 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3892 | dense, sparse | dense: 0.520, sparse: 0.282 |
| 9 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3832 | sparse, graph | sparse: 0.275, graph: 0.631 |
| 10 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3697 | sparse, graph | sparse: 0.283, graph: 0.631 |

