# Vulnerability Information: CVE-2021-3031

## Vulnerability Description
Padding bytes in Ethernet packets on PA-200, PA-220, PA-500, PA-800, PA-2000 Series, PA-3000 Series, PA-3200 Series, PA-5200 Series, and PA-7000 Series firewalls are not cleared before the data frame is created. This leaks a small amount of random information from the firewall memory into the Ethernet packets. An attacker on the same Ethernet subnet as the PAN-OS firewall is able to collect potentially sensitive information from these packets. This issue is also known as Etherleak and is detected by security scanners as CVE-2003-0001. This issue impacts PAN-OS 8.1 version earlier than PAN-OS 8.1.18 PAN-OS 9.0 versions earlier than PAN-OS 9.0.12 PAN-OS 9.1 versions earlier than PAN-OS 9.1.5.

### Vulnerability Description Key Phrases
- **rootcause:** **Padding bytes in Ethernet packets ... are not cleared**
- **impact:** leak a small amount of random information
- **attacker:** attacker on the same Ethernet subnet
- **product:** PA-200, PA-220, PA-500, PA-800, PA-2000 Series, PA-3000 Series, PA-3200 Series, PA-5200 Series, and PA-7000 Series firewalls
- **version:** PAN-OS 8.1 earlier than 8.1.18, 9.0 earlier than 9.0.12, 9.1 earlier than 9.1.5

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Padding bytes in Ethernet packets are not cleared before the data frame is created, leading to the leakage of random information from firewall memory.
- **Weaknesses/vulnerabilities present:** Information exposure due to the inclusion of uninitialized memory content in Ethernet packets.
- **Impact of exploitation:** An attacker on the same Ethernet subnet can collect potentially sensitive information from the leaked memory contents in the Ethernet packets.
- **Attack vectors:** The attacker needs to be on the same Ethernet subnet as the vulnerable PAN-OS firewall.
- **Required attacker capabilities/position:** The attacker must be on the same local network segment as the targeted firewall.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | 0.9980 | dense, sparse, graph | dense: 0.474, sparse: 1.000, graph: 0.528 |
| 2 | CWE-226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | 0.6842 | dense, sparse, graph | dense: 0.488, sparse: 0.487, graph: 0.452 |
| 3 | CWE-347 | Improper Verification of Cryptographic Signature | Base | Allowed | 0.6600 | sparse, graph | sparse: 0.681, graph: 0.757 |
| 4 | CWE-401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | 0.6515 | dense, sparse, graph | dense: 0.548, sparse: 0.542, graph: 0.340 |
| 5 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.6247 | sparse, graph | sparse: 0.619, graph: 0.757 |
| 6 | CWE-532 | Insertion of Sensitive Information into Log File | Base | Allowed | 0.5634 | sparse, graph | sparse: 0.628, graph: 0.571 |
| 7 | CWE-406 | Insufficient Control of Network Message Volume (Network Amplification) | Class | Allowed-with-Review | 0.4868 | dense, sparse, graph | dense: 0.546, sparse: 0.742, graph: 0.367 |
| 8 | CWE-916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | 0.3505 | sparse | sparse: 0.613 |
| 9 | CWE-290 | Authentication Bypass by Spoofing | Base | Allowed | 0.2986 | sparse | sparse: 0.522 |
| 10 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.2827 | sparse | sparse: 0.494 |

