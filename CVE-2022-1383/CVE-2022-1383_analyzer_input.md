# Vulnerability Information: CVE-2022-1383

## Vulnerability Description
**Heap-based Buffer Overflow** in GitHub repository radareorg/radare2 prior to 5.6.8. The bug causes the program reads data past the end of the intented buffer. Typically, this can allow attackers to read sensitive information from other memory locations or cause a crash.

### Vulnerability Description Key Phrases
- **weakness:** **Heap-based Buffer Overflow**
- **impact:** read sensitive information from other memory locations or cause a crash
- **attacker:** attackers
- **product:** radare2
- **version:** prior to 5.6.8

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 6)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability is an out-of-bounds read in the NE parser of radare2, specifically within the `r_coresym_cache_element_new` function in `libr/bin/format/mach0/coresymbolication.c`.

**Vulnerabilities:**
- **Out-of-bounds read:** The code calculates the offset of a string (`sect_name_off`) and adds it to `string_origin` to locate a string in the buffer `b`. However, there is no proper check to make sure the `sect_name_off` offset is valid. This allows an attacker to provide a large value for `sect_name_off` and cause a read outside the bounds of the buffer.
- **Improper bounds check:** The code initially has an incorrect bound check `if (sect_name_off < (ut64)(size_t)(end - string_origin))`. The code calculates the available size for the string name but does not check that the calculated address `string_origin + sect_name_off` is within valid memory address bounds.

**Impact:**
- **Crash:** As indicated by the commit message "Fix oobread bug in NE parser ##crash," the out-of-bounds read can lead to a crash of the radare2 program.
- **Potential for Information Disclosure:** Although not explicitly mentioned, out-of-bounds reads can potentially leak sensitive information present in memory. However, there is no evidence presented here that indicates that the vulnerability is exploitable for information disclosure.

**Attack Vectors:**
- **Malicious NE file:** An attacker can craft a malicious NE (New Executable) file with a large or invalid `sect_name_off`. When radare2 parses this file, it will trigger the out-of-bounds read.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to provide the crafted NE file to be analyzed by radare2. This could be achieved through different ways depending on the context of usage of the tool.

**Additional Details:**
- The commit includes a fix for the vulnerability by checking if the `sect_name_off` is within valid bounds, and if not, it will default to an empty string.
- The vulnerability was reported by `@cnitlrt` via huntr.dev, and was assigned a BountyID `02b4b563-b946-4343-9092-38d1c5cd60c9`.
- The reproducer is named `neoobread`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6960 | dense, sparse, graph | dense: 0.574, sparse: 0.250, graph: 0.743 |
| 2 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.6261 | dense, sparse, graph | dense: 0.616, sparse: 0.298, graph: 0.558 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.6057 | dense, sparse, graph | dense: 0.524, sparse: 0.238, graph: 0.579 |
| 4 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4267 | dense, sparse | dense: 0.604, sparse: 0.280 |
| 5 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4041 | dense, sparse | dense: 0.538, sparse: 0.236 |
| 6 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3991 | dense, sparse | dense: 0.550, sparse: 0.216 |
| 7 | CWE-170 | Improper Null Termination | Base | Allowed | 0.3983 | sparse, graph | sparse: 0.203, graph: 0.789 |
| 8 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.3876 | sparse, graph | sparse: 0.249, graph: 0.686 |
| 9 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3835 | dense, sparse | dense: 0.532, sparse: 0.205 |
| 10 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3830 | dense, sparse | dense: 0.527, sparse: 0.209 |

