# Vulnerability Information: CVE-2020-10698

## Vulnerability Description
A flaw was found in Ansible Tower when running jobs. This flaw allows an attacker to access the stdout of the executed jobs which are run from other organizations. Some sensible data can be disclosed. However, critical data should not be disclosed, as it should be protected by the no_log flag when debugging is enabled. This flaw affects Ansible Tower versions before 3.6.4, Ansible Tower versions before 3.5.6 and Ansible Tower versions before 3.4.6.

### Vulnerability Description Key Phrases
- **impact:** access stdout of executed jobs from other organizations
- **attacker:** attacker
- **product:** Ansible Tower
- **version:** versions before 3.6.4, 3.5.6, and 3.4.6

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2020-10698:

**Root Cause:**

The vulnerability stems from insufficient access control in Ansible Tower. It does not properly restrict WebSocket group subscriptions, allowing unauthorized users to intercept job output.

**Weaknesses/Vulnerabilities:**

*   **Inadequate Access Control:** The primary weakness is the lack of proper validation or authorization when users subscribe to WebSocket groups related to job execution.
*   **Information Disclosure:** The vulnerability leads to the disclosure of sensitive information via job stdout streams.

**Impact of Exploitation:**

*   **Information Disclosure:** Normal users can potentially access the standard output (stdout) of jobs that are running in different organizations. This could leak sensitive data, though the document notes that critical data should be protected by the `no_log` flag when debugging is enabled.

**Attack Vectors:**

*   **WebSocket Subscription:** The attack vector involves a normal user improperly subscribing to WebSocket groups associated with jobs running in other organizations.

**Required Attacker Capabilities/Position:**

*   **Normal User Access:** The attacker needs to have valid user credentials within the Ansible Tower system.
*   **Network Access:** The attacker needs to be able to connect to the Ansible Tower system, presumably over a network.

**Additional Details:**

*   **Affected Versions:** Ansible Tower versions 3.4.5, 3.5.5, 3.6.3 and prior versions are affected.
*   **Mitigation:**  Disabling the `/websocket` location in Nginx can mitigate the issue but also disables job output functionality for all users.
*   **Fix:** The vulnerability is fixed in Ansible Tower versions 3.6.4, 3.5.6, and 3.4.6
*  **AWX:** The related fix in AWX can be found at <https://github.com/ansible/awx/pull/6465>

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | 0.5774 | dense, sparse, graph | dense: 0.559, sparse: 0.135, graph: 0.617 |
| 2 | CWE-497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | Allowed | 0.5336 | dense, sparse, graph | dense: 0.509, sparse: 0.105, graph: 0.612 |
| 3 | CWE-201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | 0.5037 | dense, sparse, graph | dense: 0.485, sparse: 0.112, graph: 0.550 |
| 4 | CWE-842 | Placement of User into Incorrect Group | Base | Allowed | 0.3366 | sparse, graph | sparse: 0.227, graph: 0.578 |
| 5 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.3130 | dense, sparse | dense: 0.497, sparse: 0.112 |
| 6 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3024 | dense, sparse | dense: 0.486, sparse: 0.103 |
| 7 | CWE-319 | Cleartext Transmission of Sensitive Information | Base | Allowed | 0.3018 | dense, sparse | dense: 0.484, sparse: 0.104 |
| 8 | CWE-212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | 0.2608 | sparse, graph | sparse: 0.124, graph: 0.532 |
| 9 | CWE-285 | Improper Authorization | Class | Discouraged | 0.2062 | dense, sparse, graph | dense: 0.510, sparse: 0.128, graph: 0.371 |
| 10 | CWE-259 | Use of Hard-coded Password | Variant | Allowed | 0.1868 | sparse, graph | sparse: 0.105, graph: 0.398 |

