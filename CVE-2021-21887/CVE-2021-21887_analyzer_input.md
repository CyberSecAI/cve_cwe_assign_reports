# Vulnerability Information: CVE-2021-21887

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in the Web Manager SslGenerateCSR functionality of Lantronix PremierWave 2050 8.9.0.0R4 (in QEMU). A specially crafted HTTP request can lead to remote code execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Lantronix PremierWave 2050
- **version:** 8.9.0.0R4
- **component:** Web Manager SslGenerateCSR functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 31)
- CWE-120 (Count: 4)
- CWE-1284 (Count: 1)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability is due to a stack-based buffer overflow in the `SslGenerateCSR` functionality of the Lantronix PremierWave 2050 Web Manager. Specifically, the `strcat` function is used to concatenate user-supplied input parameters into a fixed-size buffer on the stack without proper bounds checking.
- **Weaknesses/vulnerabilities present:**
    - Stack-based buffer overflow
    - Lack of input validation for HTTP POST parameters `s`, `l`, `o`, `ou`, and `cn`.
    - Usage of `strcat` on a stack-allocated buffer without sufficient size checks.
- **Impact of exploitation:** Successful exploitation allows an attacker to overwrite the stack frame, gain control of the program counter, and achieve remote code execution.
- **Attack vectors:** The attack vector is through a specially crafted HTTP POST request to the `/` endpoint, specifically targeting the `SslGenerateCSR` ajax directive in the `ltrx_evo` web application. The vulnerable parameters are `s` (State), `l` (Locality), `o` (Organization), `ou` (Organizational Unit), and `cn` (Common Name), all of which are related to the CSR generation.
- **Required attacker capabilities/position:**
    - The attacker needs to be authenticated with the `ssl` permission to access the vulnerable functionality.
    - The attacker needs to be able to send HTTP POST requests to the device's web server.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6721 | dense, sparse, graph | dense: 0.582, sparse: 0.262, graph: 0.645 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4653 | dense, sparse | dense: 0.660, sparse: 0.304 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4405 | sparse, graph | sparse: 0.250, graph: 0.832 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4338 | dense, sparse | dense: 0.592, sparse: 0.277 |
| 5 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4114 | dense, sparse | dense: 0.566, sparse: 0.224 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3946 | dense, sparse | dense: 0.579, sparse: 0.241 |
| 7 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3781 | dense, sparse | dense: 0.565, sparse: 0.222 |
| 8 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.3562 | sparse, graph | sparse: 0.228, graph: 0.631 |
| 9 | CWE-134 | Use of Externally-Controlled Format String | Base | Allowed | 0.3415 | sparse, graph | sparse: 0.221, graph: 0.602 |
| 10 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2502 | dense, sparse | dense: 0.560, sparse: 0.254 |

