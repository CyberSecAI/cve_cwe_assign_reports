# Fully Enhanced Analysis for Critic Review - CVE-2020-15185

# Summary
| CWE ID  | CWE Name                                                                  | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
| :-------- | :------------------------------------------------------------------------ | :--------- | :---------------------- | :------------------------------ | :------------------------------ |
| CWE-694 | Use of Multiple Resources with Duplicate Identifier                     | 0.95       | Base                    | Primary                         | Allowed                       |

## Evidence and Confidence

*   **Confidence Score:** 0.95
*   **Evidence Strength:** HIGH

- **Analysis and Justification:**
  - *Explanation:* The vulnerability lies in the Helm repository allowing duplicate chart entries within the index file. The Helm client then uses the last entry which allows an attacker to inject a bad chart into the repository. This aligns with CWE-694 (Use of Multiple Resources with Duplicate Identifier) because the Helm repository uses multiple chart entries with the same identifier (chart name) and the last one is used, leading to the vulnerability. The **root cause** is the lack of deduplication allowing the **weakness** to exist.
  - *Relationship Analysis:* No direct relationships found.

- **Confidence Score:**
  - *Example:* Confidence: 0.95 (High evidence from technical description and CVE reference materials)

---



## Known Examples for CWE-694: Use of Multiple Resources with Duplicate Identifier
### Observed Examples
- **CVE-2013-4787** [https://www.cve.org/CVERecord?id=CVE-2013-4787](https://www.cve.org/CVERecord?id=CVE-2013-4787): chain: mobile OS verifies cryptographic signature of file in an archive, but then installs a different file with the same name that is also listed in the archive.
### Top 25 Examples
- **CVE-2020-15185**: In Helm before versions 2.16.11 and 3.3.2, a Helm repository can contain duplicates of the same chart, with the last one always used. If a repository is compromised, this lowers the level of access that an attacker needs to inject a bad chart into a repository. To perform this attack, an attacker must have write access to the index file (which can occur during a MITM attack on a non-SSL connection). This issue has been patched in Helm 3.3.2 and 2.16.11. A possible workaround is to manually review the index file in the Helm repository cache before installing software.
- **CVE-2021-3436**: BT: Possible to overwrite an existing bond during keys distribution phase when the identity address of the bond is known. Zephyr versions >= 1.14.2, >= 2.4.0, >= 2.5.0 contain Use of Multiple Resources with Duplicate Identifier (CWE-694). For more information, see https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-j76f-35mc-4h63
