# Vulnerability Information: CVE-2021-21889

## Vulnerability Description
A **stack-based buffer overflow** vulnerability exists in the Web Manager Ping functionality of Lantronix PremierWave 2050 8.9.0.0R4 (in QEMU). A specially crafted HTTP request can lead to remote code execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **stack-based buffer overflow**
- **impact:** remote code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Lantronix PremierWave 2050
- **version:** 8.9.0.0R4
- **component:** Web Manager Ping functionality

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 13)
- CWE-89 (Count: 2)
- CWE-120 (Count: 2)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A stack-based buffer overflow exists in the `ltrx_evo` web application due to a vulnerable call to `sprintf`. The function uses a fixed-size buffer and a user-controlled source without proper bounds checking.
- **Weaknesses/vulnerabilities present:**
    - Stack-based buffer overflow (CWE-121)
    - Insufficient input validation of the `host` parameter in the `Ping` functionality.
    - Use of `sprintf` with a fixed-size buffer and user-controlled input.
- **Impact of exploitation:** Successful exploitation allows a remote, authenticated attacker to overwrite the stack, gain control of the program counter and achieve remote code execution.
- **Attack vectors:** An attacker can send a specially crafted HTTP request with a long `host` parameter to the vulnerable `Ping` ajax directive.
- **Required attacker capabilities/position:**
    - The attacker needs to be authenticated to the web application.
    - The attacker does not need any special permissions.
    - The attacker can be remote.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6537 | dense, sparse, graph | dense: 0.548, sparse: 0.262, graph: 0.641 |
| 2 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4554 | dense, sparse | dense: 0.639, sparse: 0.303 |
| 3 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4405 | sparse, graph | sparse: 0.250, graph: 0.832 |
| 4 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.4203 | dense, sparse | dense: 0.564, sparse: 0.277 |
| 5 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3798 | dense, sparse | dense: 0.547, sparse: 0.241 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3681 | dense, sparse | dense: 0.543, sparse: 0.222 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.3585 | sparse, graph | sparse: 0.232, graph: 0.631 |
| 8 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.3562 | sparse, graph | sparse: 0.228, graph: 0.631 |
| 9 | CWE-20 | Improper Input Validation | Class | Discouraged | 0.1830 | dense, sparse | dense: 0.546, sparse: 0.237 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1801 | dense, sparse | dense: 0.552, sparse: 0.220 |

