# Vulnerability Information: CVE-2022-35407

## Vulnerability Description
An issue was discovered in Insyde InsydeH2O with kernel 5.0 through 5.5. A **stack buffer overflow** leads to arbitrary code execution in the SetupUtility driver on Intel platforms. An attacker can change the values of certain UEFI variables. If the size of the second variable exceeds the size of the first, then the buffer will be overwritten. This issue affects the SetupUtility driver of InsydeH2O.

### Vulnerability Description Key Phrases
- **weakness:** **stack buffer overflow**
- **impact:** arbitrary code execution
- **product:** Insyde InsydeH2O
- **version:** kernel 5.0 through 5.5
- **component:** SetupUtility driver

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2022-35407:

**Root cause of vulnerability:**
- A stack buffer overflow vulnerability exists in the `SetupUtility` driver of InsydeH2O UEFI firmware.

**Weaknesses/vulnerabilities present:**
- Stack buffer overflow: The vulnerability is a classic stack buffer overflow, where writing beyond the allocated buffer space on the stack occurs.

**Impact of exploitation:**
- Arbitrary code execution: Successful exploitation of this vulnerability can lead to the execution of arbitrary code. This means an attacker could potentially take full control of the system during the UEFI phase.
- CVSS v3.1 score: 7.7 - AV:L/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H

**Attack vectors:**
- The attack vector is local (AV:L). This suggests that the attacker needs to have local access to the system.
- The attacker needs high privileges (PR:H) to exploit this vulnerability.
- User Interaction is Required (UI:R).

**Required attacker capabilities/position:**
- Local access to the target system is required.
- The attacker must have high privileges to trigger the vulnerability.
- The attacker needs to interact with the system, likely through the BIOS/UEFI setup utility interface.

**Additional details:**
- The vulnerability was discovered by the Binarly efiXplorer team.
- The vulnerability affects specific chipsets of InsydeH2O.
- The vulnerability has been fixed in various InsydeH2O chipset versions, detailed in the provided document.

**Affected Platforms**
- Elkhart Lake
- Greenlow-R(Kaby Lake)
- Mehlow(Coffee Lake)
- Whiskey Lake
- Comet Lake
- Tatlow
- Alder Lake (server)
- Tiger Lake
- Jasper Lake
- Rocket Lake
- Alder Lake
- Ice Lake
- Kaby Lake
- Coffee Lake 3-in-1
- Whiskey Lake CP
- Comet Lake
- Rocket Lake CMP

All other Intel and all AMD platforms are unaffected.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.8176 | dense, sparse, graph | dense: 0.601, sparse: 0.339, graph: 0.904 |
| 2 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.7156 | dense, sparse, graph | dense: 0.617, sparse: 0.342, graph: 0.591 |
| 3 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.7044 | dense, sparse, graph | dense: 0.569, sparse: 0.350, graph: 0.613 |
| 4 | CWE-193 | Off-by-one Error | Base | Allowed | 0.5190 | sparse, graph | sparse: 0.345, graph: 0.899 |
| 5 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.4849 | dense, sparse | dense: 0.582, sparse: 0.338 |
| 6 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.4827 | dense, sparse | dense: 0.609, sparse: 0.381 |
| 7 | CWE-822 | Untrusted Pointer Dereference | Base | Allowed | 0.4598 | dense, sparse | dense: 0.564, sparse: 0.310 |
| 8 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.4550 | dense, sparse | dense: 0.570, sparse: 0.296 |
| 9 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4364 | dense, sparse | dense: 0.588, sparse: 0.312 |
| 10 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.4261 | dense, sparse | dense: 0.570, sparse: 0.309 |

