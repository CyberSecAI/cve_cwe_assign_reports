# Vulnerability Information: CVE-2021-43703

## Vulnerability Description
An **Incorrect Access Control** vulnerability exists in zzcms less than or equal to 2019 via admin.php. After disabling JavaScript, you can directly access the administrator console.

### Vulnerability Description Key Phrases
- **rootcause:** **Incorrect Access Control**
- **impact:** access administrator console
- **product:** zzcms
- **version:** less than or equal to 2019
- **component:** admin.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability stems from a flawed authentication mechanism in the `admin/admin.php` file of the zzcms application. After authentication fails, the page uses JavaScript to redirect to the login page, but the script doesn't halt execution immediately.

**Weaknesses/Vulnerabilities:**
- **Insecure Redirection:** The primary weakness is using client-side JavaScript for redirection after a failed authentication attempt.
- **Lack of Server-Side Enforcement:** The application does not properly terminate the script execution after redirection is triggered, which is a server-side enforcement failure.

**Impact of Exploitation:**
- **Bypass of Authentication:** By disabling JavaScript in the browser, an attacker can bypass the intended redirection, gaining direct access to the administrator console despite failing the authentication.
- **Unauthorized Access:** This bypass grants unauthorized access to the application's administrator functions and resources.

**Attack Vectors:**
- **Client-Side Manipulation:** The attacker manipulates the client-side (browser) behavior by disabling JavaScript.
- **Direct Access:** The attacker then directly accesses the administrator console by bypassing the JavaScript redirect.

**Required Attacker Capabilities/Position:**
- **Knowledge of Application:** The attacker needs to know the application's structure and the specific endpoint that handles administrator authentication (`admin/admin.php`).
- **Browser Manipulation:** The attacker must be able to disable JavaScript in their web browser.
- **Network Access:** Standard network access to the application's web interface.

**Additional Notes:**
- The issue report mentions that the administrator authentication code uses a JavaScript redirect after authentication fails, indicating that the server-side script doesn't properly enforce access control.
- The vulnerability allows unauthorized access to administrator privileges by simply disabling javascript on the client side.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.6939 | dense, sparse, graph | dense: 0.540, sparse: 0.115, graph: 1.000 |
| 2 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.5875 | dense, sparse, graph | dense: 0.558, sparse: 0.117, graph: 0.675 |
| 3 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.5486 | dense, sparse, graph | dense: 0.517, sparse: 0.122, graph: 0.615 |
| 4 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.5409 | dense, sparse, graph | dense: 0.513, sparse: 0.124, graph: 0.597 |
| 5 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.3417 | sparse, graph | sparse: 0.117, graph: 0.813 |
| 6 | CWE-613 | Insufficient Session Expiration | Base | Allowed | 0.3369 | sparse, graph | sparse: 0.122, graph: 0.748 |
| 7 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3211 | dense, sparse | dense: 0.509, sparse: 0.116 |
| 8 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.1996 | dense, sparse | dense: 0.531, sparse: 0.130 |
| 9 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.1864 | dense, sparse | dense: 0.502, sparse: 0.116 |
| 10 | CWE-285 | Improper Authorization | Class | Discouraged | 0.1489 | dense, sparse | dense: 0.523, sparse: 0.124 |

