{
  "query": "The JS Compute Runtime for Fastlys Compute@Edge platform provides the environment JavaScript is executed in when using the Compute@Edge JavaScript SDK. In versions prior to 0.5.3, the `Math.random` and `crypto.getRandomValues` methods fail to use sufficiently random values. The initial value to seed the PRNG (pseudorandom number generator) is baked-in to the final WebAssembly module, making the sequence of random values for that specific WebAssembly module predictable. An attacker can use the fixed seed to predict random numbers generated by these functions and bypass cryptographic security controls, for example to disclose sensitive data encrypted by functions that use these generators. The problem has been patched in version 0.5.3. No known workarounds exist.",
  "keyphrases": {
    "rootcause": "fixed seed for PRNG"
  },
  "timestamp": "2025-03-17T03:56:34.984235",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 2.2100000000000004,
        "description": "CWE-804: Guessable CAPTCHA...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.7313180374152513,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.7218767976459586,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.5537578237171852,
        "description": "A Pseudo-Random Number Generator (PRNG) uses the same seed each time the product is initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.5350496001451828,
        "description": "A Pseudo-Random Number Generator (PRNG) is initialized from a predictable seed, such as the process ID or system time....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.376561466938392,
        "description": "The lack of entropy available for, or used by, a Pseudo-Random Number Generator (PRNG) can be a stability and security threat....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.054945298945982,
        "description": "The product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 1.0062,
        "description": "CWE-344: Use of Invariant Value in Dynamically Changing Context...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.8922539376963076,
        "description": "A number or object is predictable based on observations that the attacker can make about the state of the system or network, such as time, process ID, etc....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.8366691566426159,
        "description": "The device uses an algorithm that is predictable and generates a pseudo-random number....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.8281350211881657,
        "description": "The number of possible random values is smaller than needed by the product, making it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.8062661404320073,
        "description": "The product uses an algorithm or scheme that produces insufficient entropy, leaving patterns or clusters of values that are more likely to occur than others....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.8049600000000001,
        "description": "CWE-798: Use of Hard-coded Credentials...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.8049600000000001,
        "description": "CWE-323: Reusing a Nonce, Key Pair in Encryption...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.7964704067040766,
        "description": "The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.7909239977443976,
        "description": "A Pseudo-Random Number Generator (PRNG) uses a relatively small seed space, which makes it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.76992,
        "description": "CWE-587: Assignment of a Fixed Address to a Pointer...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.76992,
        "description": "CWE-6: J2EE Misconfiguration: Insufficient Session-ID Length...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.76992,
        "description": "CWE-329: Generation of Predictable IV with CBC Mode...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "unknown",
        "name": "Unknown",
        "abstraction": "unknown",
        "score": 0.7200000000000001,
        "description": "CWE-384: Session Fixation...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "336",
        "name": "Same Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 0.6177997646645204,
        "description": "A Pseudo-Random Number Generator (PRNG) uses the same seed each time the product is initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "335",
        "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 0.5859390299865722,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "337",
        "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 0.5615079298912716,
        "description": "A Pseudo-Random Number Generator (PRNG) is initialized from a predictable seed, such as the process ID or system time....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "338",
        "name": "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 0.55176910353804,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "332",
        "name": "Insufficient Entropy in PRNG",
        "abstraction": "Variant",
        "score": 0.5439335101982532,
        "description": "The lack of entropy available for, or used by, a Pseudo-Random Number Generator (PRNG) can be a stability and security threat....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1241",
        "name": "Use of Predictable Algorithm in Random Number Generator",
        "abstraction": "Base",
        "score": 0.5374196477982083,
        "description": "The device uses an algorithm that is predictable and generates a pseudo-random number....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "339",
        "name": "Small Seed Space in PRNG",
        "abstraction": "Variant",
        "score": 0.5049271001489058,
        "description": "A Pseudo-Random Number Generator (PRNG) uses a relatively small seed space, which makes it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "334",
        "name": "Small Space of Random Values",
        "abstraction": "Base",
        "score": 0.5038445986364408,
        "description": "The number of possible random values is smaller than needed by the product, making it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "330",
        "name": "Use of Insufficiently Random Values",
        "abstraction": "Class",
        "score": 0.46305419399683867,
        "description": "The product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 0.4565629249553531,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1240",
        "name": "Use of a Cryptographic Primitive with a Risky Implementation",
        "abstraction": "Base",
        "score": 0.44819904315327064,
        "description": "To fulfill the need for a cryptographic primitive, the product implements a cryptographic algorithm using a non-standard, unproven, or disallowed/non-compliant cryptographic implementation....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "343",
        "name": "Predictable Value Range from Previous Values",
        "abstraction": "Base",
        "score": 0.44612757250611823,
        "description": "The product's random number generator produces a series of values which, when observed, can be used to infer a relatively small range of possibilities for the next value that could be generated....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1339",
        "name": "Insufficient Precision or Accuracy of a Real Number",
        "abstraction": "Base",
        "score": 0.445731105495932,
        "description": "The product processes a real number with an implementation in which the number's representation does not preserve required accuracy and precision in its fractional part, causing an incorrect result....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "331",
        "name": "Insufficient Entropy",
        "abstraction": "Base",
        "score": 0.4454915074778109,
        "description": "The product uses an algorithm or scheme that produces insufficient entropy, leaving patterns or clusters of values that are more likely to occur than others....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "194",
        "name": "Unexpected Sign Extension",
        "abstraction": "Variant",
        "score": 0.44481278153439185,
        "description": "The product performs an operation on a number that causes it to be sign extended when it is transformed into a larger data type. When the original number is negative, this can produce unexpected value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "340",
        "name": "Generation of Predictable Numbers or Identifiers",
        "abstraction": "Class",
        "score": 0.44215889354229143,
        "description": "The product uses a scheme that generates numbers or identifiers that are more predictable than required....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "342",
        "name": "Predictable Exact Value from Previous Values",
        "abstraction": "Base",
        "score": 0.4334209843964319,
        "description": "An exact value or random number can be precisely predicted by observing previous values....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "834",
        "name": "Excessive Iteration",
        "abstraction": "Class",
        "score": 0.4324959183403558,
        "description": "The product performs an iteration or loop without sufficiently limiting the number of times that the loop is executed....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "760",
        "name": "Use of a One-Way Hash with a Predictable Salt",
        "abstraction": "Variant",
        "score": 0.4277605366049649,
        "description": "The product uses a one-way cryptographic hash against an input that should not be reversible, such as a password, but the product uses a predictable salt as part of the input....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1204",
        "name": "Generation of Weak Initialization Vector (IV)",
        "abstraction": "Base",
        "score": 0.42631127918120615,
        "description": "The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n...",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "336",
        "name": "Same Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 1438.2549547491444,
        "description": "A Pseudo-Random Number Generator (PRNG) uses the same seed each time the product is initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "335",
        "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 824.1681331102847,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "338",
        "name": "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 757.5941785318091,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "337",
        "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 746.488016719682,
        "description": "A Pseudo-Random Number Generator (PRNG) is initialized from a predictable seed, such as the process ID or system time....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "330",
        "name": "Use of Insufficiently Random Values",
        "abstraction": "Class",
        "score": 713.3588503546732,
        "description": "The product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "1204",
        "name": "Generation of Weak Initialization Vector (IV)",
        "abstraction": "Base",
        "score": 694.9097444430486,
        "description": "The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "abstraction": "Base",
        "score": 624.0767143738631,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "340",
        "name": "Generation of Predictable Numbers or Identifiers",
        "abstraction": "Class",
        "score": 610.0622122080038,
        "description": "The product uses a scheme that generates numbers or identifiers that are more predictable than required....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "916",
        "name": "Use of Password Hash With Insufficient Computational Effort",
        "abstraction": "Base",
        "score": 600.5341366746811,
        "description": "The product generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 593.2427664632319,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 584.3525257938021,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1391",
        "name": "Use of Weak Credentials",
        "abstraction": "Class",
        "score": 583.9867121935861,
        "description": "The product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "287",
        "name": "Improper Authentication",
        "abstraction": "Class",
        "score": 582.1220893236117,
        "description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "341",
        "name": "Predictable from Observable State",
        "abstraction": "Base",
        "score": 566.2400137280836,
        "description": "A number or object is predictable based on observations that the attacker can make about the state of the system or network, such as time, process ID, etc....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "345",
        "name": "Insufficient Verification of Data Authenticity",
        "abstraction": "Class",
        "score": 564.9398150784341,
        "description": "The product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "abstraction": "Base",
        "score": 562.2196641018256,
        "description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "203",
        "name": "Observable Discrepancy",
        "abstraction": "Base",
        "score": 561.2607247768967,
        "description": "The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the s...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "334",
        "name": "Small Space of Random Values",
        "abstraction": "Base",
        "score": 559.8104323084704,
        "description": "The number of possible random values is smaller than needed by the product, making it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "abstraction": "Base",
        "score": 559.4447361529371,
        "description": "The product uses a template engine to insert or process externally-influenced input, but it does not neutralize or incorrectly neutralizes special elements or syntax that can be interpreted as templat...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "502",
        "name": "Deserialization of Untrusted Data",
        "abstraction": "Base",
        "score": 557.5454136943558,
        "description": "The product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.42631127918120615,
      "max": 0.6177997646645204,
      "mean": 0.4859633713023589,
      "median": 0.4523809840543119,
      "count": 20
    },
    "sparse": {
      "min": 557.5454136943558,
      "max": 1438.2549547491444,
      "mean": 664.2305917390212,
      "median": 588.797646128517,
      "count": 20
    },
    "graph": {
      "min": 0.7200000000000001,
      "max": 2.2100000000000004,
      "mean": 1.0890053842607759,
      "median": 0.8324020889153908,
      "count": 20
    }
  }
}