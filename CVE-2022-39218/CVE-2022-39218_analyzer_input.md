# Vulnerability Information: CVE-2022-39218

## Vulnerability Description
The JS Compute Runtime for Fastlys Compute@Edge platform provides the environment JavaScript is executed in when using the Compute@Edge JavaScript SDK. In versions prior to 0.5.3, the `Math.random` and `crypto.getRandomValues` methods fail to use sufficiently random values. The initial value to seed the PRNG (pseudorandom number generator) is baked-in to the final WebAssembly module, making the sequence of random values for that specific WebAssembly module predictable. An attacker can use the fixed seed to predict random numbers generated by these functions and bypass cryptographic security controls, for example to disclose sensitive data encrypted by functions that use these generators. The problem has been patched in version 0.5.3. No known workarounds exist.

### Vulnerability Description Key Phrases
- **rootcause:** **fixed seed for PRNG**
- **impact:** bypass cryptographic security controls
- **product:** Fastly's Compute@Edge platform
- **version:** prior to 0.5.3

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The initial seed for the CSPRNG used by `Math.random` and `crypto.getRandomValues` was baked into the WebAssembly module during compilation due to the use of Wizer.
- **Weaknesses/vulnerabilities present:** Predictable random number generation. The sequence of numbers generated by `Math.random` and `crypto.getRandomValues` was predictable because the seed for the CSPRNG was fixed during compilation.
- **Impact of exploitation:** An attacker with access to the WebAssembly module could predict the random numbers generated by these functions. This could be used to bypass cryptographic security controls and potentially disclose sensitive data encrypted by functions using these generators.
- **Attack vectors:** An attacker needs access to the specific WebAssembly module where the affected functions are called.
- **Required attacker capabilities/position:** The attacker must have access to the WebAssembly module that utilizes the vulnerable random number generation methods.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-336 | Same Seed in Pseudo-Random Number Generator (PRNG) | Variant | Allowed | 0.9965 | dense, sparse, graph | dense: 0.618, sparse: 1.000, graph: 0.555 |
| 2 | CWE-335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | 0.8915 | dense, sparse, graph | dense: 0.586, sparse: 0.659, graph: 0.618 |
| 3 | CWE-338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | Allowed | 0.8427 | dense, sparse, graph | dense: 0.552, sparse: 0.606, graph: 0.615 |
| 4 | CWE-337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | Allowed | 0.7556 | dense, sparse, graph | dense: 0.562, sparse: 0.597, graph: 0.548 |
| 5 | CWE-1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | 0.6331 | dense, sparse, graph | dense: 0.426, sparse: 0.556, graph: 0.284 |
| 6 | CWE-334 | Small Space of Random Values | Base | Allowed | 0.6141 | dense, sparse, graph | dense: 0.504, sparse: 0.448, graph: 0.296 |
| 7 | CWE-341 | Predictable from Observable State | Base | Allowed | 0.3730 | sparse, graph | sparse: 0.453, graph: 0.319 |
| 8 | CWE-330 | Use of Insufficiently Random Values | Class | Discouraged | 0.3101 | dense, sparse, graph | dense: 0.463, sparse: 0.571, graph: 0.377 |
| 9 | CWE-340 | Generation of Predictable Numbers or Identifiers | Class | Allowed-with-Review | 0.2940 | dense, sparse | dense: 0.442, sparse: 0.488 |
| 10 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | 0.2913 | dense, sparse | dense: 0.457, sparse: 0.467 |

