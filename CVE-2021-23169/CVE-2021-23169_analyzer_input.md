# Vulnerability Information: CVE-2021-23169

## Vulnerability Description
A **heap-buffer overflow** was found in the copyIntoFrameBuffer function of OpenEXR in versions before 3.0.1. An attacker could use this flaw to execute arbitrary code with the permissions of the user running the application compiled against OpenEXR.

### Vulnerability Description Key Phrases
- **rootcause:** **heap-buffer overflow**
- **impact:** execute arbitrary code
- **attacker:** attacker
- **product:** OpenEXR
- **version:** before 3.0.1
- **component:** copyIntoFrameBuffer function

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "Heap-buffer-overflow in the `Imf_2_5::copyIntoFrameBuffer` function.",
    "weaknesses": [
      "Heap-buffer-overflow"
    ],
    "impact": "An attacker could exploit this vulnerability to execute arbitrary code with the permissions of the user running the application compiled against OpenEXR.",
    "attack_vectors": [
      "Processing a crafted OpenEXR image file"
    ],
    "required_capabilities": "Ability to provide a malicious OpenEXR file to a vulnerable application.",
    "additional_details": "The vulnerability occurs when the framebuffer doesn't handle images with nonzero `dataWindow.min.x!=0` and `xSampling!=1`."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6970 | dense, sparse, graph | dense: 0.557, sparse: 0.264, graph: 0.747 |
| 2 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6958 | dense, sparse, graph | dense: 0.481, sparse: 0.226, graph: 0.912 |
| 3 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6377 | dense, sparse, graph | dense: 0.503, sparse: 0.245, graph: 0.687 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5943 | dense, sparse, graph | dense: 0.524, sparse: 0.222, graph: 0.712 |
| 5 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.5652 | dense, sparse, graph | dense: 0.481, sparse: 0.209, graph: 0.572 |
| 6 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.4082 | sparse, graph | sparse: 0.205, graph: 0.813 |
| 7 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3931 | dense, sparse | dense: 0.562, sparse: 0.253 |
| 8 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.3668 | dense, sparse | dense: 0.493, sparse: 0.210 |
| 9 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3611 | dense, sparse | dense: 0.484, sparse: 0.207 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3468 | dense, sparse | dense: 0.506, sparse: 0.214 |

