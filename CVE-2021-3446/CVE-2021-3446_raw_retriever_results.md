# Raw Retriever Results for CVE-2021-3446

# Raw Retriever Results for CVE-2021-3446

## Query
A flaw was found in libtpms in versions before 0.8.2. The commonly used integration of libtpms with OpenSSL contained a vulnerability related to the returned IV (initialization vector) when certain symmetric ciphers were used. Instead of returning the last IV it returned the initial IV to the caller, thus weakening the subsequent encryption and decryption steps. The highest threat from this vulnerability is to data confidentiality.

## Keyphrases
- **weakness**: returned initial IV instead of last IV

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4844 | 0.5971 | 0.5046 | 0.4931 | 20 |
| Sparse | 314.7641 | 767.1974 | 359.1631 | 325.5476 | 20 |
| Graph | 0.9360 | 1.7680 | 1.4086 | 1.5175 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 2 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.7680 | Allowed |
| 3 | 1204 | Generation of Weak Initialization Vector (IV) | Base | 1.7360 | Allowed |
| 4 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 1.7189 | Allowed |
| 5 | 757 | Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') | Base | 1.6505 | Allowed |
| 6 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | 1.6231 | Allowed |
| 7 | 208 | Observable Timing Discrepancy | Base | 1.5429 | Allowed |
| 8 | 301 | Reflection Attack in an Authentication Protocol | base | 1.5210 | Allowed |
| 9 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | base | 1.5210 | Allowed |
| 10 | 1328 | Security Version Number Mutable to Older Versions | base | 1.5210 | Allowed |
| 11 | 259 | Use of Hard-coded Password | Variant | 1.5141 | Allowed |
| 12 | 329 | Generation of Predictable IV with CBC Mode | Variant | 1.5084 | Allowed |
| 13 | 656 | Reliance on Security Through Obscurity | class | 1.3600 | Allowed-with-Review |
| 14 | 321 | Use of Hard-coded Cryptographic Key | Variant | 1.2122 | Allowed |
| 15 | 257 | Storing Passwords in a Recoverable Format | base | 1.1466 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1204 | Generation of Weak Initialization Vector (IV) | Base | 0.5971 | 0.5971 | Allowed |
| 2 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.5380 | 0.5380 | Allowed |
| 3 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.5292 | 0.5292 | Allowed-with-Review |
| 4 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | 0.5188 | 0.5188 | Allowed |
| 5 | 326 | Inadequate Encryption Strength | Class | 0.5108 | 0.5108 | Allowed-with-Review |
| 6 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.5093 | 0.5093 | Allowed |
| 7 | 294 | Authentication Bypass by Capture-replay | Base | 0.5078 | 0.5078 | Allowed |
| 8 | 1391 | Use of Weak Credentials | Class | 0.5063 | 0.5063 | Allowed-with-Review |
| 9 | 1394 | Use of Default Cryptographic Key | Base | 0.5046 | 0.5046 | Allowed |
| 10 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.4966 | 0.4966 | Allowed |
| 11 | 208 | Observable Timing Discrepancy | Base | 0.4895 | 0.4895 | Allowed |
| 12 | 325 | Missing Cryptographic Step | Base | 0.4895 | 0.4895 | Allowed |
| 13 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4894 | 0.4894 | Allowed |
| 14 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4892 | 0.4892 | Allowed |
| 15 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4868 | 0.4868 | Allowed |

## Sparse Retriever Results (20)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | CWE-1204 | Generation of Weak Initialization Vector (IV) | 767.1974 | 767.1974 | Allowed |
| 2 | CWE-329 | Generation of Predictable IV with CBC Mode | 465.3701 | 465.3701 | Allowed |
| 3 | CWE-757 | Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') | 366.6274 | 366.6274 | Allowed |
| 4 | CWE-321 | Use of Hard-coded Cryptographic Key | 363.5425 | 363.5425 | Allowed |
| 5 | CWE-1240 | Use of a Cryptographic Primitive with a Risky Implementation | 351.6228 | 351.6228 | Allowed |
| 6 | CWE-327 | Use of a Broken or Risky Cryptographic Algorithm | 349.8416 | 349.8416 | Allowed-with-Review |
| 7 | CWE-201 | Insertion of Sensitive Information Into Sent Data | 347.3318 | 347.3318 | Allowed |
| 8 | CWE-203 | Observable Discrepancy | 326.7712 | 326.7712 | Allowed |
| 9 | CWE-125 | Out-of-bounds Read | 326.0052 | 326.0052 | Allowed |
| 10 | CWE-476 | NULL Pointer Dereference | 325.6206 | 325.6206 | Allowed |
| 11 | CWE-319 | Cleartext Transmission of Sensitive Information | 325.4746 | 325.4746 | Allowed |
| 12 | CWE-1390 | Weak Authentication | 321.7430 | 321.7430 | Allowed-with-Review |
| 13 | CWE-1391 | Use of Weak Credentials | 321.2582 | 321.2582 | Allowed-with-Review |
| 14 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 320.2368 | 320.2368 | Discouraged |
| 15 | CWE-208 | Observable Timing Discrepancy | 320.1633 | 320.1633 | Allowed |
