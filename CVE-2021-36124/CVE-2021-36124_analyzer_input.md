# Vulnerability Information: CVE-2021-36124

## Vulnerability Description
An issue was discovered in Echo ShareCare 8.15.5. It does not perform authentication or authorization checks when accessing a subset of sensitive resources, leading to the ability for unauthenticated users to access pages that are vulnerable to attacks such as SQL injection.

### Vulnerability Description Key Phrases
- **rootcause:** **missing authentication or authorization checks**
- **impact:** SQL injection
- **attacker:** unauthenticated users
- **product:** Echo ShareCare
- **version:** 8.15.5

## CVE Reference Links Content Summary
The provided content is related to CVE-2021-36124. It describes multiple vulnerabilities in ShareCare version 8.15.5, including SQL Injection, Local File Inclusion, Improper Authorization, Unrestricted File Upload, and Command Argument Injection. CVE-2021-36124 specifically refers to the **Unrestricted File Upload** vulnerability.

Here's a breakdown of the Unrestricted File Upload vulnerability as described in the content:

*   **Root cause:** The ShareCare application's file upload feature at `/Access/DownloadFeed_Mnt/FileUpload_Upd.cfm` does not properly sanitize the filename provided by the user through the `name1` parameter. Although a backslash (`\`) filter is implemented, it can be bypassed using forward slashes (`/`) as path delimiters.
*   **Weaknesses/vulnerabilities:**
    *   **Inadequate path sanitization:** The application attempts to filter backslashes from the filename but fails to handle forward slashes, enabling directory traversal.
    *   **Unrestricted file upload:** The application allows the upload of arbitrary file types and does not validate or limit the upload location beyond the Z drive, where the application files reside.
*   **Impact of exploitation:**
    *   **Arbitrary file write:** An attacker can upload arbitrary files to any location on the `Z:` drive accessible to the ShareCare service user.
    *   **Remote code execution:** Because the service runs as `NT AUTHORITY\SYSTEM`, an attacker could upload and execute malicious code, leading to full system compromise.
*   **Attack vectors:**
    *   **HTTP request:** The vulnerability is exploited by sending a crafted HTTP request to the `/Access/DownloadFeed_Mnt/FileUpload_Upd.cfm` endpoint with a malicious filename (via `name1` parameter) containing directory traversal sequences using forward slashes, along with the file to upload.
*   **Required attacker capabilities/position:**
    *   **Authenticated user:** The attacker needs to be an authenticated user of the ShareCare application to access the vulnerable upload endpoint.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.6436 | dense, sparse, graph | dense: 0.559, sparse: 0.251, graph: 0.615 |
| 2 | CWE-639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | 0.6339 | dense, sparse, graph | dense: 0.555, sparse: 0.237, graph: 0.617 |
| 3 | CWE-425 | Direct Request ('Forced Browsing') | Base | Allowed | 0.5899 | dense, sparse, graph | dense: 0.549, sparse: 0.234, graph: 0.506 |
| 4 | CWE-89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | 0.3937 | dense, sparse | dense: 0.532, sparse: 0.222 |
| 5 | CWE-288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | 0.3883 | dense, sparse | dense: 0.539, sparse: 0.208 |
| 6 | CWE-434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | 0.3874 | sparse, graph | sparse: 0.248, graph: 0.687 |
| 7 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.3488 | sparse, graph | sparse: 0.215, graph: 0.631 |
| 8 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.3457 | sparse, graph | sparse: 0.210, graph: 0.631 |
| 9 | CWE-352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | 0.3073 | dense, sparse | dense: 0.531, sparse: 0.233 |
| 10 | CWE-863 | Incorrect Authorization | Class | Allowed-with-Review | 0.2464 | dense, sparse | dense: 0.551, sparse: 0.251 |

