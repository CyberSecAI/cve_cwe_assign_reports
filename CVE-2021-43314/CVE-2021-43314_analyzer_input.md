# Vulnerability Information: CVE-2021-43314

## Vulnerability Description
A **heap-based buffer overflows** was discovered in upx, during the generic pointer p points to an inaccessible address in func get_le32(). The problem is essentially caused in PackLinuxElf32elf_lookup() at p_lx_elf.cpp5368

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflows**
- **product:** upx
- **component:** func get_le32()

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 21)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Multiple heap-based buffer overflows occur in the `get_le32()` function of UPX when a generic pointer 'p' points to an inaccessible address. This is due to insufficient checks when dereferencing the pointer.
- **Weaknesses/vulnerabilities present**: Heap-based buffer overflows in `get_le32()` function at multiple locations within `p_lx_elf.cpp`.
- **Impact of exploitation**: Denial of service. The overflows can be triggered by specially crafted files, leading to program crashes.
- **Attack vectors**: By providing crafted input files that cause the vulnerable code paths to be executed.
- **Required attacker capabilities/position**: The attacker must be able to provide a crafted file to be processed by `upx`.

The provided content gives significantly more detail than a typical CVE description, including specific code locations, ASAN output, debugging information, and Proof of Concept files for each location.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-193 | Off-by-one Error | Base | Allowed | 0.6850 | dense, sparse, graph | dense: 0.529, sparse: 0.161, graph: 0.918 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.6540 | dense, sparse, graph | dense: 0.586, sparse: 0.162, graph: 0.750 |
| 3 | CWE-191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | 0.5805 | dense, sparse, graph | dense: 0.577, sparse: 0.140, graph: 0.591 |
| 4 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.5175 | dense, sparse, graph | dense: 0.573, sparse: 0.160, graph: 0.510 |
| 5 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.3913 | sparse, graph | sparse: 0.148, graph: 0.857 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3829 | dense, sparse | dense: 0.585, sparse: 0.213 |
| 7 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.3491 | dense, sparse | dense: 0.549, sparse: 0.130 |
| 8 | CWE-131 | Incorrect Calculation of Buffer Size | Base | Allowed | 0.3354 | dense, sparse | dense: 0.525, sparse: 0.127 |
| 9 | CWE-761 | Free of Pointer not at Start of Buffer | Variant | Allowed | 0.3289 | dense, sparse | dense: 0.555, sparse: 0.137 |
| 10 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3245 | dense, sparse | dense: 0.534, sparse: 0.148 |

