# Vulnerability Information: CVE-2022-24191

## Vulnerability Description
In HTMLDOC 1.9.14, an **infinite loop in the gif_read_lzw function** can lead to a **pointer arbitrarily pointing to heap memory** and resulting in a buffer overflow.

### Vulnerability Description Key Phrases
- **rootcause:** **infinite loop in the gif_read_lzw function**
- **weakness:** **pointer arbitrarily pointing to heap memory**
- **impact:** buffer overflow
- **product:** HTMLDOC
- **version:** 1.9.14

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:** An infinite loop within the `gif_read_lzw` function.

**Weaknesses/Vulnerabilities:**
*   **Infinite Loop:** The `while` loop in `gif_read_lzw` lacks proper exit conditions, leading to continuous execution.
*   **Stack Buffer Overflow:** The `sp` variable, which is used as a stack pointer, is continuously incremented within the infinite loop. This causes the `sp` pointer to write past the allocated memory on the stack leading to a stack buffer overflow.
*   **Incorrect memory allocation:** The initial report mentioned a heap buffer overflow, but the final analysis and fix identified the issue as stack overflow because `sp` points to the stack memory.

**Impact of Exploitation:**
*   **Crash:** The primary impact is a program crash due to the stack buffer overflow when the `sp` pointer goes out of bounds.
*   **Potential for further exploitation:** While the provided information focuses on a crash, a stack buffer overflow can be further exploited in certain circumstances to achieve code execution.

**Attack Vectors:**
*   **Malicious GIF File:** The vulnerability is triggered by processing a specially crafted GIF file. In the provided example, the crafted html file contains a malicious GIF file.
*   **Command-line Execution:** The vulnerability can be triggered by using the `htmldoc` tool in command line as shown in the example `htmldoc --webpage -f out.pdf ./crash.html` which includes the crafted html and gif files.

**Required Attacker Capabilities/Position:**
*   The attacker needs to be able to provide a malicious GIF file as input to `htmldoc` to trigger the vulnerability.
*   The attacker has to be able to execute the vulnerable program with the crafted file as input.

**Additional details:**

*   The vulnerability was identified by user `Voiddy-Dev`.
*   A patch was quickly implemented by `michaelrsweet`, the maintainer of `htmldoc`, and was committed on the same day the issue was reported.
*   The fix was included in the version 1.9.15 of the `htmldoc` package.
*   The Fedora update advisory FEDORA-2022-39533c087f addresses this CVE by providing an updated htmldoc package.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | 0.7312 | dense, sparse, graph | dense: 0.518, sparse: 0.453, graph: 0.596 |
| 2 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7126 | dense, sparse, graph | dense: 0.505, sparse: 0.325, graph: 0.766 |
| 3 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.4142 | dense, sparse | dense: 0.524, sparse: 0.326 |
| 4 | CWE-193 | Off-by-one Error | Base | Allowed | 0.4140 | dense, sparse | dense: 0.490, sparse: 0.295 |
| 5 | CWE-1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | 0.4139 | sparse, graph | sparse: 0.191, graph: 0.852 |
| 6 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3976 | dense, sparse | dense: 0.515, sparse: 0.302 |
| 7 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.3424 | dense, sparse | dense: 0.479, sparse: 0.180 |
| 8 | CWE-674 | Uncontrolled Recursion | Class | Allowed-with-Review | 0.2134 | dense, sparse | dense: 0.508, sparse: 0.190 |
| 9 | CWE-197 | Numeric Truncation Error | Base | Allowed | 0.1747 | sparse | sparse: 0.305 |
| 10 | CWE-415 | Double Free | Variant | Allowed | 0.1728 | sparse | sparse: 0.327 |

