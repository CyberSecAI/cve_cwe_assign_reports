# Vulnerability Information: CVE-2020-27212

## Vulnerability Description
STMicroelectronics STM32L4 devices through 2020-10-19 have **incorrect access control**. The flash read-out protection (RDP) can be degraded from RDP level 2 (no access via debug interface) to level 1 (limited access via debug interface) by injecting a fault during the boot phase.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect access control**
- **impact:** degrade flash read-out protection (RDP) from level 2 to level 1
- **vector:** fault injection during boot phase
- **product:** STMicroelectronics STM32L4 devices
- **version:** through 2020-10-19

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability related to CVE-2020-27212:

**Root Cause:**

The root cause is a flaw in the implementation of the read-out protection mechanism of the ST Microelectronics STM32L4 microcontroller. This flaw allows attackers to circumvent the intended protection. Specifically, fault injection attacks were used to bypass the read-out protection.

**Weaknesses/Vulnerabilities:**

*   **Circumvented Read-Out Protection:** The primary weakness is the ability to bypass the read-out protection mechanism of the STM32L4 microcontroller. This mechanism is meant to prevent the extraction of firmware from the device.

**Impact of Exploitation:**

*   **Firmware Extraction:** Successful exploitation allows an attacker to extract the firmware from the microcontroller, potentially exposing sensitive information like cryptographic keys, algorithms, and intellectual property.

**Attack Vectors:**

*   **Fault Injection:** The attack vector is fault injection. Fault injection techniques, in combination with side-channel analysis, are used to manipulate the behavior of the microcontroller and bypass the read-out protection mechanism.
*   **Physical Access:** The attack requires physical access to the device containing the vulnerable microcontroller.

**Required Attacker Capabilities/Position:**

*   **Physical Access:**  The attacker needs physical access to the device containing the STM32L4 microcontroller.
*   **Fault Injection Expertise:** The attacker needs expertise in fault injection techniques and side-channel analysis. They need to be able to setup and execute these types of attacks.
*   **Specialized Equipment:** The attacker requires access to specialized equipment for fault injection and side-channel analysis such as UV-C light sources, EM probes, and oscilloscopes.

**Additional Notes:**

*   The provided text mentions the STM32L4 is used in several devices, including the SoloKeys Solo & Somu, the Nitrokey FIDO2. This means that the vulnerability affects multiple products using this microcontroller.
*   The content also describes attacks against the nRF52840 microcontroller, which is related to CVE-2021-29415, and micro-ecc (CVE-2020-27209).
* Countermeasures are mentioned as a way to mitigate the vulnerabilities.

The provided text offers much more detail about the vulnerability than the typical CVE description and shows how the vulnerability can be practically exploited.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | Allowed | 0.7235 | dense, sparse, graph | dense: 0.602, sparse: 0.395, graph: 0.550 |
| 2 | CWE-1296 | Incorrect Chaining or Granularity of Debug Components | Base | Allowed | 0.6580 | dense, sparse, graph | dense: 0.592, sparse: 0.243, graph: 0.622 |
| 3 | CWE-1300 | Improper Protection of Physical Side Channels | Base | Allowed | 0.5974 | dense, sparse, graph | dense: 0.530, sparse: 0.214, graph: 0.586 |
| 4 | CWE-1244 | Internal Asset Exposed to Unsafe Debug Access Level or State | Base | Allowed | 0.5814 | dense, sparse, graph | dense: 0.580, sparse: 0.167, graph: 0.547 |
| 5 | CWE-1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | Allowed | 0.5696 | dense, sparse, graph | dense: 0.557, sparse: 0.179, graph: 0.528 |
| 6 | CWE-1263 | Improper Physical Access Control | Class | Allowed-with-Review | 0.3392 | dense, sparse, graph | dense: 0.553, sparse: 0.184, graph: 0.546 |
| 7 | CWE-420 | Unprotected Alternate Channel | Base | Allowed | 0.1015 | sparse | sparse: 0.177 |
| 8 | CWE-306 | Missing Authentication for Critical Function | Base | Allowed | 0.0965 | sparse | sparse: 0.169 |
| 9 | CWE-1269 | Product Released in Non-Release Configuration | Base | Allowed | 0.0962 | sparse | sparse: 0.168 |
| 10 | CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | 0.0920 | sparse | sparse: 0.161 |

