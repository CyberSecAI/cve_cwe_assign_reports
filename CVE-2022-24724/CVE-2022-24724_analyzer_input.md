# Vulnerability Information: CVE-2022-24724

## Vulnerability Description
cmark-gfm is GitHubs extended version of the C reference implementation of CommonMark. Prior to versions 0.29.0.gfm.3 and 0.28.3.gfm.21, an **integer overflow** in cmark-gfms table row parsing `table.crow_from_string` may lead to **heap memory corruption** when parsing tables whos marker rows contain more than UINT16_MAX columns. The impact of this heap corruption ranges from Information Leak to Arbitrary Code Execution depending on how and where `cmark-gfm` is used. If `cmark-gfm` is used for rendering remote user controlled markdown, this vulnerability may lead to Remote Code Execution (RCE) in applications employing affected versions of the `cmark-gfm` library. This vulnerability has been patched in the following cmark-gfm versions 0.29.0.gfm.3 and 0.28.3.gfm.21. A workaround is available. The vulnerability exists in the table markdown extensions of cmark-gfm. Disabling the table extension will prevent this vulnerability from being triggered.

### Vulnerability Description Key Phrases
- **rootcause:** **integer overflow**
- **weakness:** **heap memory corruption**
- **impact:** Remote Code Execution
- **vector:** parsing tables with more than UINT16_MAX columns
- **product:** cmark-gfm
- **version:** Prior to versions 0.29.0.gfm.3 and 0.28.3.gfm.2
- **component:** table row parsing

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability details related to CVE-2022-24724:

**Root Cause of Vulnerability:**
- Integer overflow in cmark-gfm's table row parsing (`table.c:row_from_string`).

**Weaknesses/Vulnerabilities Present:**
- CWE-190: Integer Overflow.
- Heap memory corruption.

**Impact of Exploitation:**
- Information Leak
- Arbitrary Code Execution.
- Remote Code Execution (RCE) if `cmark-gfm` is used for rendering remote user-controlled markdown.

**Attack Vectors:**
- Parsing specifically crafted Markdown tables with marker rows containing more than `UINT16_MAX` (65535) columns.

**Required Attacker Capabilities/Position:**
- Ability to supply a crafted markdown document to an application using the vulnerable `cmark-gfm` library.
- If the application renders user-controlled markdown, then the attacker can be remote.

**Additional Notes:**
- The vulnerability exists in the table markdown extensions of `cmark-gfm`.
- Disabling the table extension is a potential workaround.
- Patched versions include cmark-gfm 0.29.0.gfm.3 and 0.28.3.gfm.21
- Several Fedora updates address this vulnerability in `ghostwriter`, `ghc-cmark-gfm` and `pandoc-citeproc`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 1.1314 | dense, sparse, graph | dense: 0.570, sparse: 1.000, graph: 0.767 |
| 2 | CWE-125 | Out-of-bounds Read | Base | Allowed | 1.1091 | dense, sparse, graph | dense: 0.533, sparse: 0.957, graph: 0.826 |
| 3 | CWE-770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | 0.7735 | dense, sparse | dense: 0.519, sparse: 0.898 |
| 4 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.7693 | dense, sparse | dense: 0.563, sparse: 0.964 |
| 5 | CWE-476 | NULL Pointer Dereference | Base | Allowed | 0.7594 | dense, sparse | dense: 0.508, sparse: 0.883 |
| 6 | CWE-789 | Memory Allocation with Excessive Size Value | Variant | Allowed | 0.7431 | dense, sparse, graph | dense: 0.538, sparse: 0.519, graph: 0.670 |
| 7 | CWE-193 | Off-by-one Error | Base | Allowed | 0.7424 | dense, sparse | dense: 0.521, sparse: 0.842 |
| 8 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.7261 | dense, sparse | dense: 0.558, sparse: 0.887 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.6933 | dense, sparse | dense: 0.521, sparse: 0.857 |
| 10 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.5415 | sparse | sparse: 0.947 |

