# Vulnerability Information: CVE-2021-34874

## Vulnerability Description
This vulnerability allows remote attackers to execute arbitrary code on affected installations of Bentley View 10.15.0.75. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the processing of 3DS files. The issue results from the **lack of proper validation of user-supplied data**, which can result in a **memory corruption** condition. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-14736.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of proper validation of user-supplied data**
- **weakness:** **memory corruption**
- **impact:** execute arbitrary code
- **vector:** malicious page or file
- **attacker:** remote attackers
- **product:** Bentley View
- **version:** 10.15.0.75
- **component:** processing of 3DS files

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 306)
- CWE-416 (Count: 283)
- CWE-125 (Count: 142)

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:** The vulnerability stems from a lack of proper validation of user-supplied data when processing 3DS files, leading to memory corruption. Specifically, the issue is related to out-of-bounds and use-after-free errors when parsing maliciously crafted 3DS files.

**Weaknesses/Vulnerabilities:**
*   **Memory Corruption:**  Improper handling of 3DS file data results in a memory corruption condition.
*   **Out-of-bounds read/write:** Maliciously crafted 3DS files can trigger out-of-bounds memory access.
*  **Use-after-free:** Malicious 3DS files can lead to use-after-free conditions in the parsing process.

**Impact of Exploitation:** Successful exploitation allows a remote attacker to execute arbitrary code within the context of the current process. This could lead to complete system compromise, including data theft, modification, or denial of service.

**Attack Vectors:** The attack vector involves user interaction, where the target must either visit a malicious page or, more specifically, open a maliciously crafted 3DS file using an affected version of Bentley View or MicroStation.

**Required Attacker Capabilities/Position:**
*   The attacker needs to create a malicious 3DS file.
*   The attacker needs to convince the victim to open the crafted 3DS file using vulnerable software.
* No special privileges are required as the exploit occurs within the application's normal execution context.

**Additional Notes:**
* The vulnerability is present in Bentley View and MicroStation, and potentially other MicroStation-based applications.
* The vendor has released updated versions of the software (10.16.02.* and later) that address this vulnerability.
* The vulnerability was discovered by Trend Micro's Zero Day Initiative (ZDI).
* Multiple CVEs are associated with this same root cause (parsing of 3DS files): CVE-2021-34874, CVE-2021-34875, CVE-2021-34880, CVE-2021-34889, CVE-2021-34894, CVE-2021-34895, CVE-2021-34901, CVE-2021-34911, CVE-2021-46575, CVE-2021-46586, CVE-2021-46587, CVE-2021-46592, CVE-2021-46595, CVE-2021-46602, CVE-2021-46607, CVE-2021-46623.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-787 | Out-of-bounds Write | Base | Allowed | 0.8109 | sparse, graph | sparse: 0.866, graph: 0.882 |
| 2 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.7626 | sparse, graph | sparse: 0.782, graph: 0.882 |
| 3 | CWE-250 | Execution with Unnecessary Privileges | Base | Allowed | 0.6702 | dense, sparse | dense: 0.549, sparse: 0.691 |
| 4 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.6509 | sparse, graph | sparse: 0.750, graph: 0.772 |
| 5 | CWE-125 | Out-of-bounds Read | Base | Allowed | 0.6391 | sparse, graph | sparse: 0.723, graph: 0.631 |
| 6 | CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | 0.4136 | sparse | sparse: 0.723 |
| 7 | CWE-732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | 0.4084 | dense, sparse | dense: 0.557, sparse: 0.728 |
| 8 | CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | 0.4036 | sparse | sparse: 0.706 |
| 9 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3942 | sparse | sparse: 0.747 |
| 10 | CWE-457 | Use of Uninitialized Variable | Variant | Allowed | 0.3677 | sparse | sparse: 0.696 |

