# Vulnerability Information: CVE-2021-23803

## Vulnerability Description
This affects the package latte/latte before 2.10.6. There is a way to bypass allowFunctions that will affect the security of the application. When the template is set to allow/disallow the use of certain functions, adding control characters (x00-x08) after the function will bypass these restrictions.

### Vulnerability Description Key Phrases
- **impact:** bypass allowFunctions restrictions
- **vector:** adding control characters (x00-x08) after the function
- **product:** latte/latte
- **version:** before 2.10.6

## CVE Reference Links Content Summary
```json
{
  "CVE-2021-23803": {
    "Description": "There is a way to bypass `allowFunctions` that will affect the security of the application. When the template is set to allow/disallow the use of certain functions, adding control characters (x00-x08) after the function will bypass these restrictions.",
    "Root cause": "The template engine did not properly sanitize function names, allowing control characters to bypass restrictions set by `allowFunctions`.",
    "Weaknesses": [
      "Access Control Bypass",
       "Improper Input Validation",
      "CWE-863"
    ],
    "Impact": "An attacker could execute arbitrary PHP functions that are not explicitly allowed, leading to potential remote code execution, data compromise, and denial of service.",
    "Attack vectors": "By inserting control characters (x00-x08) after a function name within a Latte template.",
    "Required attacker capabilities/position": "The attacker needs the ability to control the content of a Latte template being processed by the vulnerable application. No authentication is needed."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | 0.5297 | dense, sparse, graph | dense: 0.419, sparse: 0.066, graph: 0.789 |
| 2 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.3950 | sparse, graph | sparse: 0.066, graph: 1.000 |
| 3 | CWE-88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | 0.3940 | sparse, graph | sparse: 0.070, graph: 0.991 |
| 4 | CWE-150 | Improper Neutralization of Escape, Meta, or Control Sequences | Variant | Allowed | 0.3180 | dense, sparse | dense: 0.543, sparse: 0.127 |
| 5 | CWE-1333 | Inefficient Regular Expression Complexity | Base | Allowed | 0.3101 | sparse, graph | sparse: 0.069, graph: 0.757 |
| 6 | CWE-94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | 0.2527 | sparse, graph | sparse: 0.068, graph: 0.631 |
| 7 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.2482 | dense, sparse | dense: 0.421, sparse: 0.066 |
| 8 | CWE-277 | Insecure Inherited Permissions | Variant | Allowed | 0.2386 | dense, sparse | dense: 0.438, sparse: 0.068 |
| 9 | CWE-1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | 0.0384 | sparse | sparse: 0.067 |
| 10 | CWE-1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | 0.0383 | sparse | sparse: 0.067 |

