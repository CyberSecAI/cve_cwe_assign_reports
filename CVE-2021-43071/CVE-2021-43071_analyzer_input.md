# Vulnerability Information: CVE-2021-43071

## Vulnerability Description
A **heap-based buffer overflow** in Fortinet FortiWeb version 6.4.1 and 6.4.0, version 6.3.15 and below, version 6.2.6 and below allows attacker to execute unauthorized code or commands via crafted HTTP requests to the LogReport API controller.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **impact:** execute unauthorized code or commands
- **vector:** crafted HTTP requests
- **attacker:** attacker
- **product:** Fortinet FortiWeb
- **version:** 6.4.1 and 6.4.0 and 6.3.15 and below and 6.2.6 and below
- **component:** LogReport API controller

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A heap-based buffer overflow exists in the FortiWeb API v1.0 controller, specifically within the LogAccess and LogReport API functionality.
- **Weaknesses/vulnerabilities present:** Heap-based buffer overflow (CWE-122).
- **Impact of exploitation:** An authenticated attacker can execute arbitrary code or commands.
- **Attack vectors:** Crafted HTTP requests to the LogAccess and LogReport API controller.
- **Required attacker capabilities/position:** The attacker needs to be authenticated to exploit the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage | Combined Score | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|---------------|------------|-------------------|
| 1 | CWE-190 | Integer Overflow or Wraparound | Base | Allowed | 0.7404 | dense, sparse, graph | dense: 0.521, sparse: 0.214, graph: 1.000 |
| 2 | CWE-124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | 0.6519 | dense, sparse, graph | dense: 0.545, sparse: 0.201, graph: 0.740 |
| 3 | CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | 0.6325 | dense, sparse, graph | dense: 0.550, sparse: 0.200, graph: 0.679 |
| 4 | CWE-1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | 0.4165 | sparse, graph | sparse: 0.208, graph: 0.832 |
| 5 | CWE-121 | Stack-based Buffer Overflow | Variant | Allowed | 0.3940 | dense, sparse | dense: 0.591, sparse: 0.229 |
| 6 | CWE-122 | Heap-based Buffer Overflow | Variant | Allowed | 0.3865 | dense, sparse | dense: 0.568, sparse: 0.235 |
| 7 | CWE-130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | 0.3736 | dense, sparse | dense: 0.523, sparse: 0.195 |
| 8 | CWE-126 | Buffer Over-read | Variant | Allowed | 0.3631 | dense, sparse | dense: 0.544, sparse: 0.211 |
| 9 | CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | 0.3585 | dense, sparse | dense: 0.533, sparse: 0.190 |
| 10 | CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | 0.1672 | dense, sparse | dense: 0.517, sparse: 0.201 |

